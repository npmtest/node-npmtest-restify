{"/home/travis/build/npmtest/node-npmtest-restify/test.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/test.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":1,"12":1,"13":1,"14":1,"15":2,"16":2,"17":2,"18":2,"19":1,"20":1,"21":2,"22":2,"23":2,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":1,"36":1,"37":1,"38":1,"39":2,"40":2,"41":1,"42":2,"43":2,"44":1,"45":2,"46":2,"47":1,"48":2,"49":2,"50":1,"51":1,"52":1,"53":1,"54":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[1,1],"5":[1,1],"6":[1,1],"7":[1,1],"8":[1,1],"9":[1,1],"10":[1,1,1],"11":[1,1],"12":[1,1],"13":[1,1],"14":[1,1],"15":[1,1],"16":[1,1],"17":[1,1]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":1,"7":1,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}},"4":{"name":"(anonymous_4)","line":61,"loc":{"start":{"line":61,"column":5},"end":{"line":61,"column":17}}},"5":{"name":"(anonymous_5)","line":82,"loc":{"start":{"line":82,"column":5},"end":{"line":82,"column":17}}},"6":{"name":"(anonymous_6)","line":91,"loc":{"start":{"line":91,"column":77},"end":{"line":94,"column":10}}},"7":{"name":"(anonymous_7)","line":112,"loc":{"start":{"line":112,"column":83},"end":{"line":115,"column":10}},"skip":true},"8":{"name":"(anonymous_8)","line":123,"loc":{"start":{"line":123,"column":77},"end":{"line":126,"column":10}},"skip":true},"9":{"name":"(anonymous_9)","line":139,"loc":{"start":{"line":139,"column":12},"end":{"line":139,"column":40}},"skip":true},"10":{"name":"(anonymous_10)","line":147,"loc":{"start":{"line":147,"column":77},"end":{"line":150,"column":10}},"skip":true},"11":{"name":"(anonymous_11)","line":158,"loc":{"start":{"line":158,"column":83},"end":{"line":161,"column":10}},"skip":true},"12":{"name":"(anonymous_12)","line":169,"loc":{"start":{"line":169,"column":79},"end":{"line":172,"column":10}},"skip":true},"13":{"name":"(anonymous_13)","line":180,"loc":{"start":{"line":180,"column":75},"end":{"line":183,"column":10}},"skip":true}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":195,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":56,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":40,"column":8},"end":{"line":53,"column":9}},"11":{"start":{"line":43,"column":12},"end":{"line":46,"column":14}},"12":{"start":{"line":47,"column":12},"end":{"line":47,"column":18}},"13":{"start":{"line":50,"column":12},"end":{"line":51,"column":33}},"14":{"start":{"line":52,"column":12},"end":{"line":52,"column":18}},"15":{"start":{"line":55,"column":8},"end":{"line":55,"column":35}},"16":{"start":{"line":61,"column":4},"end":{"line":63,"column":9}},"17":{"start":{"line":62,"column":8},"end":{"line":62,"column":15}},"18":{"start":{"line":64,"column":4},"end":{"line":77,"column":5}},"19":{"start":{"line":70,"column":8},"end":{"line":70,"column":14}},"20":{"start":{"line":76,"column":8},"end":{"line":76,"column":14}},"21":{"start":{"line":82,"column":4},"end":{"line":84,"column":9}},"22":{"start":{"line":83,"column":8},"end":{"line":83,"column":15}},"23":{"start":{"line":85,"column":4},"end":{"line":194,"column":5}},"24":{"start":{"line":91,"column":8},"end":{"line":99,"column":10}},"25":{"start":{"line":98,"column":12},"end":{"line":98,"column":35}},"26":{"start":{"line":102,"column":8},"end":{"line":104,"column":63}},"27":{"start":{"line":105,"column":8},"end":{"line":105,"column":14}},"28":{"start":{"line":112,"column":8},"end":{"line":121,"column":10},"skip":true},"29":{"start":{"line":119,"column":12},"end":{"line":119,"column":55},"skip":true},"30":{"start":{"line":120,"column":12},"end":{"line":120,"column":48},"skip":true},"31":{"start":{"line":123,"column":8},"end":{"line":136,"column":10},"skip":true},"32":{"start":{"line":130,"column":12},"end":{"line":130,"column":76},"skip":true},"33":{"start":{"line":131,"column":12},"end":{"line":131,"column":73},"skip":true},"34":{"start":{"line":132,"column":12},"end":{"line":132,"column":74},"skip":true},"35":{"start":{"line":133,"column":12},"end":{"line":133,"column":79},"skip":true},"36":{"start":{"line":134,"column":12},"end":{"line":134,"column":25},"skip":true},"37":{"start":{"line":135,"column":12},"end":{"line":135,"column":45},"skip":true},"38":{"start":{"line":138,"column":8},"end":{"line":145,"column":14},"skip":true},"39":{"start":{"line":143,"column":16},"end":{"line":143,"column":29},"skip":true},"40":{"start":{"line":144,"column":16},"end":{"line":144,"column":55},"skip":true},"41":{"start":{"line":147,"column":8},"end":{"line":156,"column":10},"skip":true},"42":{"start":{"line":154,"column":12},"end":{"line":154,"column":25},"skip":true},"43":{"start":{"line":155,"column":12},"end":{"line":155,"column":45},"skip":true},"44":{"start":{"line":158,"column":8},"end":{"line":167,"column":10},"skip":true},"45":{"start":{"line":165,"column":12},"end":{"line":165,"column":25},"skip":true},"46":{"start":{"line":166,"column":12},"end":{"line":166,"column":48},"skip":true},"47":{"start":{"line":169,"column":8},"end":{"line":178,"column":10},"skip":true},"48":{"start":{"line":176,"column":12},"end":{"line":176,"column":25},"skip":true},"49":{"start":{"line":177,"column":12},"end":{"line":177,"column":46},"skip":true},"50":{"start":{"line":180,"column":8},"end":{"line":189,"column":10},"skip":true},"51":{"start":{"line":187,"column":12},"end":{"line":187,"column":94},"skip":true},"52":{"start":{"line":188,"column":12},"end":{"line":188,"column":48},"skip":true},"53":{"start":{"line":192,"column":8},"end":{"line":192,"column":35},"skip":true},"54":{"start":{"line":193,"column":8},"end":{"line":193,"column":14},"skip":true}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":40,"type":"switch","locations":[{"start":{"line":42,"column":8},"end":{"line":47,"column":18}},{"start":{"line":49,"column":8},"end":{"line":52,"column":18}}]},"5":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":44}},{"start":{"line":44,"column":48},"end":{"line":44,"column":66}}]},"6":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":21},"end":{"line":50,"column":49}},{"start":{"line":50,"column":53},"end":{"line":50,"column":72}}]},"7":{"line":64,"type":"switch","locations":[{"start":{"line":69,"column":4},"end":{"line":70,"column":14}},{"start":{"line":75,"column":4},"end":{"line":76,"column":14}}]},"8":{"line":85,"type":"switch","locations":[{"start":{"line":90,"column":4},"end":{"line":105,"column":14}},{"start":{"line":111,"column":4},"end":{"line":193,"column":14},"skip":true}]},"9":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":42},"end":{"line":91,"column":73}},{"start":{"line":91,"column":77},"end":{"line":99,"column":9}}]},"10":{"line":102,"type":"binary-expr","locations":[{"start":{"line":102,"column":18},"end":{"line":102,"column":32}},{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},{"start":{"line":104,"column":12},"end":{"line":104,"column":61}}]},"11":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":45},"end":{"line":112,"column":79},"skip":true},{"start":{"line":112,"column":83},"end":{"line":121,"column":9},"skip":true}]},"12":{"line":123,"type":"binary-expr","locations":[{"start":{"line":123,"column":42},"end":{"line":123,"column":73},"skip":true},{"start":{"line":123,"column":77},"end":{"line":136,"column":9},"skip":true}]},"13":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":48},"end":{"line":138,"column":85},"skip":true},{"start":{"line":139,"column":12},"end":{"line":145,"column":13},"skip":true}]},"14":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":42},"end":{"line":147,"column":73},"skip":true},{"start":{"line":147,"column":77},"end":{"line":156,"column":9},"skip":true}]},"15":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":45},"end":{"line":158,"column":79},"skip":true},{"start":{"line":158,"column":83},"end":{"line":167,"column":9},"skip":true}]},"16":{"line":169,"type":"binary-expr","locations":[{"start":{"line":169,"column":43},"end":{"line":169,"column":75},"skip":true},{"start":{"line":169,"column":79},"end":{"line":178,"column":9},"skip":true}]},"17":{"line":180,"type":"binary-expr","locations":[{"start":{"line":180,"column":41},"end":{"line":180,"column":71},"skip":true},{"start":{"line":180,"column":75},"end":{"line":189,"column":9},"skip":true}]}},"code":["/* istanbul instrument in package npmtest_restify */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        switch (local.modeJs) {","        // re-init local from window.local","        case 'browser':","            local = local.global.utility2.objectSetDefault(","                local.global.utility2_rollup || local.global.local,","                local.global.utility2","            );","            break;","        // re-init local from example.js","        case 'node':","            local = (local.global.utility2_rollup || require('utility2'))","                .requireReadme();","            break;","        }","        // export local","        local.global.local = local;","    }());","","","","    // run shared js-env code - function","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - function","    case 'browser':","        break;","","","","    // run node js-env code - function","    case 'node':","        break;","    }","","","","    // run shared js-env code - init-after","    (function () {","        return;","    }());","    switch (local.modeJs) {","","","","    // run browser js-env code - init-after","    case 'browser':","        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (","            options,","            onError","        ) {","        /*","         * this function will test browsers's null-case handling-behavior-behavior","         */","            onError(null, options);","        };","","        // run tests","        local.nop(local.modeTest &&","            document.querySelector('#testRunButton1') &&","            document.querySelector('#testRunButton1').click());","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApidoc's default handling-behavior-behavior","         */","            options = { modulePathList: module.paths };","            local.buildApidoc(options, onError);","        };","","        local.testCase_buildApp_default = local.testCase_buildApp_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildApp's default handling-behavior-behavior","         */","            local.testCase_buildReadme_default(options, local.onErrorThrow);","            local.testCase_buildLib_default(options, local.onErrorThrow);","            local.testCase_buildTest_default(options, local.onErrorThrow);","            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);","            options = [];","            local.buildApp(options, onError);","        };","","        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||","            function (options, onError) {","            /*","             * this function will test buildCustomOrg's default handling-behavior","             */","                options = {};","                local.buildCustomOrg(options, onError);","            };","","        local.testCase_buildLib_default = local.testCase_buildLib_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildLib's default handling-behavior","         */","            options = {};","            local.buildLib(options, onError);","        };","","        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildReadme's default handling-behavior-behavior","         */","            options = {};","            local.buildReadme(options, onError);","        };","","        local.testCase_buildTest_default = local.testCase_buildTest_default || function (","            options,","            onError","        ) {","        /*","         * this function will test buildTest's default handling-behavior","         */","            options = {};","            local.buildTest(options, onError);","        };","","        local.testCase_webpage_default = local.testCase_webpage_default || function (","            options,","            onError","        ) {","        /*","         * this function will test webpage's default handling-behavior","         */","            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };","            local.browserTest(options, onError);","        };","","        // run test-server","        local.testRunServer(local);","        break;","    }","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"40":2,"43":1,"47":1,"50":1,"52":1,"55":2,"61":2,"62":2,"64":2,"70":1,"76":1,"82":2,"83":2,"85":2,"91":1,"98":1,"102":1,"105":1,"112":1,"119":1,"120":1,"123":1,"130":1,"131":1,"132":1,"133":1,"134":1,"135":1,"138":1,"143":2,"144":2,"147":1,"154":2,"155":2,"158":1,"165":2,"166":2,"169":1,"176":2,"177":2,"180":1,"187":1,"188":1,"192":1,"193":1}},"/home/travis/build/npmtest/node-npmtest-restify/lib.npmtest_restify.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/lib.npmtest_restify.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":1,"15":1,"16":1},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1]},"f":{"1":2,"2":2,"3":2},"fnMap":{"1":{"name":"(anonymous_1)","line":12,"loc":{"start":{"line":12,"column":1},"end":{"line":12,"column":13}}},"2":{"name":"(anonymous_2)","line":19,"loc":{"start":{"line":19,"column":5},"end":{"line":19,"column":17}}},"3":{"name":"(anonymous_3)","line":23,"loc":{"start":{"line":23,"column":24},"end":{"line":23,"column":36}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":53,"column":5}},"2":{"start":{"line":14,"column":4},"end":{"line":14,"column":14}},"3":{"start":{"line":19,"column":4},"end":{"line":52,"column":9}},"4":{"start":{"line":21,"column":8},"end":{"line":21,"column":19}},"5":{"start":{"line":23,"column":8},"end":{"line":35,"column":13}},"6":{"start":{"line":24,"column":12},"end":{"line":34,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":28,"column":30}},"8":{"start":{"line":30,"column":16},"end":{"line":33,"column":27}},"9":{"start":{"line":37,"column":8},"end":{"line":39,"column":21}},"10":{"start":{"line":41,"column":8},"end":{"line":41,"column":54}},"11":{"start":{"line":43,"column":8},"end":{"line":43,"column":52}},"12":{"start":{"line":45,"column":8},"end":{"line":51,"column":9}},"13":{"start":{"line":46,"column":12},"end":{"line":46,"column":58}},"14":{"start":{"line":48,"column":12},"end":{"line":48,"column":35}},"15":{"start":{"line":49,"column":12},"end":{"line":49,"column":49}},"16":{"start":{"line":50,"column":12},"end":{"line":50,"column":43}}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":23},"end":{"line":25,"column":62}},{"start":{"line":26,"column":20},"end":{"line":26,"column":70}},{"start":{"line":27,"column":20},"end":{"line":27,"column":71}},{"start":{"line":28,"column":20},"end":{"line":28,"column":29}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":23},"end":{"line":30,"column":37}},{"start":{"line":31,"column":20},"end":{"line":31,"column":61}},{"start":{"line":32,"column":20},"end":{"line":32,"column":70}},{"start":{"line":33,"column":20},"end":{"line":33,"column":26}}]},"3":{"line":37,"type":"cond-expr","locations":[{"start":{"line":38,"column":14},"end":{"line":38,"column":20}},{"start":{"line":39,"column":14},"end":{"line":39,"column":20}}]},"4":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":44}},{"start":{"line":41,"column":48},"end":{"line":41,"column":53}}]},"5":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]}},"code":["/* istanbul instrument in package npmtest_restify */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || local;","        // init lib","        local.local = local.npmtest_restify = local;","        // init exports","        if (local.modeJs === 'browser') {","            local.global.utility2_npmtest_restify = local;","        } else {","            module.exports = local;","            module.exports.__dirname = __dirname;","            module.exports.module = module;","        }","    }());","}());",""],"l":{"12":2,"14":2,"19":2,"21":2,"23":2,"24":2,"25":2,"30":1,"37":2,"41":2,"43":2,"45":2,"46":1,"48":1,"49":1,"50":1}},"/home/travis/build/npmtest/node-npmtest-restify/example.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/example.js","s":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":1,"9":2,"10":2,"11":2,"12":2,"13":1,"14":2,"15":2,"16":2,"17":2,"18":2,"19":0,"20":2,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":2,"31":0,"32":0,"33":0,"34":1,"35":2,"36":2,"37":3,"38":3,"39":3,"40":3,"41":0,"42":3,"43":3,"44":3,"45":1,"46":3,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":0,"58":1,"59":6,"60":6,"61":1,"62":2,"63":0,"64":2,"65":1,"66":1,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0},"b":{"1":[2,1,1,1],"2":[1,1,1,1],"3":[1,1],"4":[2,2],"5":[1,1],"6":[1,1],"7":[2,0],"8":[2,1,1,1,1,1],"9":[0,2,0],"10":[1,1],"11":[2,1,1],"12":[1,0],"13":[0,2],"14":[2,0,0,0,0,0,0],"15":[0,3],"16":[3,0],"17":[1,1],"18":[0,1],"19":[1,2,0,2],"20":[1,0],"21":[1,1],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0]},"f":{"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":3,"8":3,"9":3,"10":1,"11":6,"12":0},"fnMap":{"1":{"name":"(anonymous_1)","line":26,"loc":{"start":{"line":26,"column":1},"end":{"line":26,"column":13}}},"2":{"name":"(anonymous_2)","line":33,"loc":{"start":{"line":33,"column":5},"end":{"line":33,"column":17}}},"3":{"name":"(anonymous_3)","line":37,"loc":{"start":{"line":37,"column":24},"end":{"line":37,"column":36}}},"4":{"name":"(anonymous_4)","line":69,"loc":{"start":{"line":69,"column":31},"end":{"line":69,"column":48}},"skip":true},"5":{"name":"(anonymous_5)","line":78,"loc":{"start":{"line":78,"column":26},"end":{"line":78,"column":45}},"skip":true},"6":{"name":"(anonymous_6)","line":123,"loc":{"start":{"line":123,"column":33},"end":{"line":123,"column":48}},"skip":true},"7":{"name":"(anonymous_7)","line":125,"loc":{"start":{"line":125,"column":27},"end":{"line":125,"column":39}},"skip":true},"8":{"name":"(anonymous_8)","line":133,"loc":{"start":{"line":133,"column":59},"end":{"line":133,"column":74}},"skip":true},"9":{"name":"(anonymous_9)","line":143,"loc":{"start":{"line":143,"column":45},"end":{"line":143,"column":62}},"skip":true},"10":{"name":"(anonymous_10)","line":144,"loc":{"start":{"line":144,"column":73},"end":{"line":144,"column":92}},"skip":true},"11":{"name":"(anonymous_11)","line":272,"loc":{"start":{"line":272,"column":51},"end":{"line":272,"column":77}},"skip":true},"12":{"name":"(anonymous_12)","line":315,"loc":{"start":{"line":315,"column":32},"end":{"line":315,"column":61}},"skip":true}},"statementMap":{"1":{"start":{"line":26,"column":0},"end":{"line":326,"column":5}},"2":{"start":{"line":28,"column":4},"end":{"line":28,"column":14}},"3":{"start":{"line":33,"column":4},"end":{"line":60,"column":9}},"4":{"start":{"line":35,"column":8},"end":{"line":35,"column":19}},"5":{"start":{"line":37,"column":8},"end":{"line":49,"column":13}},"6":{"start":{"line":38,"column":12},"end":{"line":48,"column":13}},"7":{"start":{"line":39,"column":16},"end":{"line":42,"column":30}},"8":{"start":{"line":44,"column":16},"end":{"line":47,"column":27}},"9":{"start":{"line":51,"column":8},"end":{"line":53,"column":21}},"10":{"start":{"line":55,"column":8},"end":{"line":57,"column":45}},"11":{"start":{"line":59,"column":8},"end":{"line":59,"column":35}},"12":{"start":{"line":61,"column":4},"end":{"line":325,"column":5}},"13":{"start":{"line":69,"column":8},"end":{"line":121,"column":10},"skip":true},"14":{"start":{"line":70,"column":12},"end":{"line":88,"column":13},"skip":true},"15":{"start":{"line":76,"column":16},"end":{"line":87,"column":19},"skip":true},"16":{"start":{"line":79,"column":20},"end":{"line":86,"column":21},"skip":true},"17":{"start":{"line":82,"column":24},"end":{"line":82,"column":43},"skip":true},"18":{"start":{"line":83,"column":24},"end":{"line":83,"column":30},"skip":true},"19":{"start":{"line":85,"column":24},"end":{"line":85,"column":49},"skip":true},"20":{"start":{"line":89,"column":12},"end":{"line":107,"column":13},"skip":true},"21":{"start":{"line":92,"column":16},"end":{"line":102,"column":17},"skip":true},"22":{"start":{"line":93,"column":20},"end":{"line":93,"column":86},"skip":true},"23":{"start":{"line":94,"column":20},"end":{"line":95,"column":45},"skip":true},"24":{"start":{"line":96,"column":20},"end":{"line":96,"column":42},"skip":true},"25":{"start":{"line":97,"column":20},"end":{"line":97,"column":48},"skip":true},"26":{"start":{"line":100,"column":20},"end":{"line":100,"column":85},"skip":true},"27":{"start":{"line":101,"column":20},"end":{"line":101,"column":96},"skip":true},"28":{"start":{"line":103,"column":16},"end":{"line":103,"column":22},"skip":true},"29":{"start":{"line":106,"column":16},"end":{"line":106,"column":22},"skip":true},"30":{"start":{"line":108,"column":12},"end":{"line":120,"column":13},"skip":true},"31":{"start":{"line":114,"column":16},"end":{"line":119,"column":17},"skip":true},"32":{"start":{"line":116,"column":20},"end":{"line":116,"column":78},"skip":true},"33":{"start":{"line":118,"column":20},"end":{"line":118,"column":47},"skip":true},"34":{"start":{"line":123,"column":8},"end":{"line":141,"column":11},"skip":true},"35":{"start":{"line":124,"column":12},"end":{"line":124,"column":54},"skip":true},"36":{"start":{"line":125,"column":12},"end":{"line":140,"column":14},"skip":true},"37":{"start":{"line":126,"column":16},"end":{"line":126,"column":28},"skip":true},"38":{"start":{"line":127,"column":16},"end":{"line":127,"column":69},"skip":true},"39":{"start":{"line":128,"column":16},"end":{"line":128,"column":75},"skip":true},"40":{"start":{"line":129,"column":16},"end":{"line":131,"column":17},"skip":true},"41":{"start":{"line":130,"column":20},"end":{"line":130,"column":27},"skip":true},"42":{"start":{"line":133,"column":16},"end":{"line":137,"column":36},"skip":true},"43":{"start":{"line":134,"column":20},"end":{"line":136,"column":55},"skip":true},"44":{"start":{"line":139,"column":16},"end":{"line":139,"column":57},"skip":true},"45":{"start":{"line":143,"column":8},"end":{"line":147,"column":11},"skip":true},"46":{"start":{"line":144,"column":12},"end":{"line":146,"column":15},"skip":true},"47":{"start":{"line":145,"column":16},"end":{"line":145,"column":70},"skip":true},"48":{"start":{"line":149,"column":8},"end":{"line":149,"column":31},"skip":true},"49":{"start":{"line":150,"column":8},"end":{"line":150,"column":14},"skip":true},"50":{"start":{"line":158,"column":8},"end":{"line":158,"column":31},"skip":true},"51":{"start":{"line":160,"column":8},"end":{"line":160,"column":33},"skip":true},"52":{"start":{"line":161,"column":8},"end":{"line":161,"column":37},"skip":true},"53":{"start":{"line":162,"column":8},"end":{"line":162,"column":35},"skip":true},"54":{"start":{"line":164,"column":8},"end":{"line":164,"column":50},"skip":true},"55":{"start":{"line":166,"column":8},"end":{"line":256,"column":2},"skip":true},"56":{"start":{"line":258,"column":8},"end":{"line":286,"column":9},"skip":true},"57":{"start":{"line":259,"column":12},"end":{"line":269,"column":14},"skip":true},"58":{"start":{"line":271,"column":12},"end":{"line":285,"column":19},"skip":true},"59":{"start":{"line":274,"column":20},"end":{"line":274,"column":35},"skip":true},"60":{"start":{"line":275,"column":20},"end":{"line":284,"column":21},"skip":true},"61":{"start":{"line":277,"column":24},"end":{"line":277,"column":64},"skip":true},"62":{"start":{"line":279,"column":24},"end":{"line":279,"column":40},"skip":true},"63":{"start":{"line":281,"column":24},"end":{"line":281,"column":40},"skip":true},"64":{"start":{"line":283,"column":24},"end":{"line":283,"column":39},"skip":true},"65":{"start":{"line":288,"column":8},"end":{"line":290,"column":9},"skip":true},"66":{"start":{"line":289,"column":12},"end":{"line":289,"column":18},"skip":true},"67":{"start":{"line":291,"column":8},"end":{"line":293,"column":54},"skip":true},"68":{"start":{"line":296,"column":8},"end":{"line":301,"column":37},"skip":true},"69":{"start":{"line":303,"column":8},"end":{"line":303,"column":82},"skip":true},"70":{"start":{"line":306,"column":8},"end":{"line":308,"column":9},"skip":true},"71":{"start":{"line":307,"column":12},"end":{"line":307,"column":82},"skip":true},"72":{"start":{"line":310,"column":8},"end":{"line":312,"column":9},"skip":true},"73":{"start":{"line":311,"column":12},"end":{"line":311,"column":18},"skip":true},"74":{"start":{"line":313,"column":8},"end":{"line":313,"column":54},"skip":true},"75":{"start":{"line":314,"column":8},"end":{"line":314,"column":69},"skip":true},"76":{"start":{"line":315,"column":8},"end":{"line":323,"column":36},"skip":true},"77":{"start":{"line":316,"column":12},"end":{"line":316,"column":61},"skip":true},"78":{"start":{"line":317,"column":12},"end":{"line":320,"column":13},"skip":true},"79":{"start":{"line":318,"column":16},"end":{"line":318,"column":75},"skip":true},"80":{"start":{"line":319,"column":16},"end":{"line":319,"column":23},"skip":true},"81":{"start":{"line":321,"column":12},"end":{"line":321,"column":38},"skip":true},"82":{"start":{"line":322,"column":12},"end":{"line":322,"column":27},"skip":true},"83":{"start":{"line":324,"column":8},"end":{"line":324,"column":14},"skip":true}},"branchMap":{"1":{"line":39,"type":"binary-expr","locations":[{"start":{"line":39,"column":23},"end":{"line":39,"column":62}},{"start":{"line":40,"column":20},"end":{"line":40,"column":70}},{"start":{"line":41,"column":20},"end":{"line":41,"column":71}},{"start":{"line":42,"column":20},"end":{"line":42,"column":29}}]},"2":{"line":44,"type":"binary-expr","locations":[{"start":{"line":44,"column":23},"end":{"line":44,"column":37}},{"start":{"line":45,"column":20},"end":{"line":45,"column":61}},{"start":{"line":46,"column":20},"end":{"line":46,"column":70}},{"start":{"line":47,"column":20},"end":{"line":47,"column":26}}]},"3":{"line":51,"type":"cond-expr","locations":[{"start":{"line":52,"column":14},"end":{"line":52,"column":20}},{"start":{"line":53,"column":14},"end":{"line":53,"column":20}}]},"4":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":16},"end":{"line":55,"column":44}},{"start":{"line":55,"column":49},"end":{"line":57,"column":43}}]},"5":{"line":55,"type":"cond-expr","locations":[{"start":{"line":56,"column":14},"end":{"line":56,"column":51}},{"start":{"line":57,"column":14},"end":{"line":57,"column":43}}]},"6":{"line":61,"type":"switch","locations":[{"start":{"line":68,"column":4},"end":{"line":150,"column":14},"skip":true},{"start":{"line":156,"column":4},"end":{"line":324,"column":14},"skip":true}]},"7":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true},{"start":{"line":70,"column":12},"end":{"line":70,"column":12},"skip":true}]},"8":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":16},"end":{"line":70,"column":22},"skip":true},{"start":{"line":70,"column":27},"end":{"line":70,"column":32},"skip":true},{"start":{"line":71,"column":20},"end":{"line":71,"column":39},"skip":true},{"start":{"line":72,"column":20},"end":{"line":72,"column":49},"skip":true},{"start":{"line":73,"column":20},"end":{"line":73,"column":58},"skip":true},{"start":{"line":74,"column":20},"end":{"line":74,"column":69},"skip":true}]},"9":{"line":79,"type":"switch","locations":[{"start":{"line":80,"column":20},"end":{"line":80,"column":33},"skip":true},{"start":{"line":81,"column":20},"end":{"line":83,"column":30},"skip":true},{"start":{"line":84,"column":20},"end":{"line":85,"column":49},"skip":true}]},"10":{"line":89,"type":"switch","locations":[{"start":{"line":90,"column":12},"end":{"line":103,"column":22},"skip":true},{"start":{"line":105,"column":12},"end":{"line":106,"column":22},"skip":true}]},"11":{"line":89,"type":"binary-expr","locations":[{"start":{"line":89,"column":20},"end":{"line":89,"column":25},"skip":true},{"start":{"line":89,"column":29},"end":{"line":89,"column":48},"skip":true},{"start":{"line":89,"column":52},"end":{"line":89,"column":74},"skip":true}]},"12":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true},{"start":{"line":92,"column":16},"end":{"line":92,"column":16},"skip":true}]},"13":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true},{"start":{"line":108,"column":12},"end":{"line":108,"column":12},"skip":true}]},"14":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":16},"end":{"line":108,"column":61},"skip":true},{"start":{"line":108,"column":66},"end":{"line":108,"column":72},"skip":true},{"start":{"line":108,"column":77},"end":{"line":108,"column":82},"skip":true},{"start":{"line":109,"column":20},"end":{"line":109,"column":39},"skip":true},{"start":{"line":110,"column":20},"end":{"line":110,"column":49},"skip":true},{"start":{"line":111,"column":20},"end":{"line":111,"column":58},"skip":true},{"start":{"line":112,"column":20},"end":{"line":112,"column":68},"skip":true}]},"15":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true},{"start":{"line":129,"column":16},"end":{"line":129,"column":16},"skip":true}]},"16":{"line":134,"type":"cond-expr","locations":[{"start":{"line":135,"column":26},"end":{"line":135,"column":29},"skip":true},{"start":{"line":136,"column":26},"end":{"line":136,"column":54},"skip":true}]},"17":{"line":164,"type":"binary-expr","locations":[{"start":{"line":164,"column":27},"end":{"line":164,"column":43},"skip":true},{"start":{"line":164,"column":47},"end":{"line":164,"column":49},"skip":true}]},"18":{"line":258,"type":"if","locations":[{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true},{"start":{"line":258,"column":8},"end":{"line":258,"column":8},"skip":true}]},"19":{"line":275,"type":"switch","locations":[{"start":{"line":276,"column":20},"end":{"line":277,"column":64},"skip":true},{"start":{"line":278,"column":20},"end":{"line":279,"column":40},"skip":true},{"start":{"line":280,"column":20},"end":{"line":281,"column":40},"skip":true},{"start":{"line":282,"column":20},"end":{"line":283,"column":39},"skip":true}]},"20":{"line":288,"type":"if","locations":[{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true},{"start":{"line":288,"column":8},"end":{"line":288,"column":8},"skip":true}]},"21":{"line":288,"type":"binary-expr","locations":[{"start":{"line":288,"column":12},"end":{"line":288,"column":40},"skip":true},{"start":{"line":288,"column":44},"end":{"line":288,"column":67},"skip":true}]},"22":{"line":292,"type":"binary-expr","locations":[{"start":{"line":292,"column":12},"end":{"line":292,"column":50},"skip":true},{"start":{"line":293,"column":12},"end":{"line":293,"column":53},"skip":true}]},"23":{"line":297,"type":"binary-expr","locations":[{"start":{"line":297,"column":12},"end":{"line":297,"column":65},"skip":true},{"start":{"line":298,"column":12},"end":{"line":301,"column":36},"skip":true}]},"24":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":43},"end":{"line":303,"column":75},"skip":true},{"start":{"line":303,"column":79},"end":{"line":303,"column":81},"skip":true}]},"25":{"line":306,"type":"if","locations":[{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true},{"start":{"line":306,"column":8},"end":{"line":306,"column":8},"skip":true}]},"26":{"line":310,"type":"if","locations":[{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true},{"start":{"line":310,"column":8},"end":{"line":310,"column":8},"skip":true}]},"27":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":27},"end":{"line":313,"column":43},"skip":true},{"start":{"line":313,"column":47},"end":{"line":313,"column":53},"skip":true}]},"28":{"line":317,"type":"if","locations":[{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true},{"start":{"line":317,"column":12},"end":{"line":317,"column":12},"skip":true}]}},"code":["/*","example.js","","quickstart example","","instruction","    1. save this script as example.js","    2. run the shell command:","        $ npm install npmtest-restify && PORT=8081 node example.js","    3. play with the browser-demo on http://127.0.0.1:8081","*/","","","","/* istanbul instrument in package npmtest_restify */","/*jslint","    bitwise: true,","    browser: true,","    maxerr: 8,","    maxlen: 96,","    node: true,","    nomen: true,","    regexp: true,","    stupid: true","*/","(function () {","    'use strict';","    var local;","","","","    // run shared js-env code - init-before","    (function () {","        // init local","        local = {};","        // init modeJs","        local.modeJs = (function () {","            try {","                return typeof navigator.userAgent === 'string' &&","                    typeof document.querySelector('body') === 'object' &&","                    typeof XMLHttpRequest.prototype.open === 'function' &&","                    'browser';","            } catch (errorCaughtBrowser) {","                return module.exports &&","                    typeof process.versions.node === 'string' &&","                    typeof require('http').createServer === 'function' &&","                    'node';","            }","        }());","        // init global","        local.global = local.modeJs === 'browser'","            ? window","            : global;","        // init utility2_rollup","        local = local.global.utility2_rollup || (local.modeJs === 'browser'","            ? local.global.utility2_npmtest_restify","            : global.utility2_moduleExports);","        // export local","        local.global.local = local;","    }());","    switch (local.modeJs) {","","","","    // init-after","    // run browser js-env code - init-after","    /* istanbul ignore next */","    case 'browser':","        local.testRunBrowser = function (event) {","            if (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('onreset'))) {","                // reset output","                Array.from(","                    document.querySelectorAll('body > .resettable')","                ).forEach(function (element) {","                    switch (element.tagName) {","                    case 'INPUT':","                    case 'TEXTAREA':","                        element.value = '';","                        break;","                    default:","                        element.textContent = '';","                    }","                });","            }","            switch (event && event.currentTarget && event.currentTarget.id) {","            case 'testRunButton1':","                // show tests","                if (document.querySelector('#testReportDiv1').style.display === 'none') {","                    document.querySelector('#testReportDiv1').style.display = 'block';","                    document.querySelector('#testRunButton1').textContent =","                        'hide internal test';","                    local.modeTest = true;","                    local.testRunDefault(local);","                // hide tests","                } else {","                    document.querySelector('#testReportDiv1').style.display = 'none';","                    document.querySelector('#testRunButton1').textContent = 'run internal test';","                }","                break;","            // custom-case","            default:","                break;","            }","            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&","                    event.currentTarget &&","                    event.currentTarget.className &&","                    event.currentTarget.className.includes &&","                    event.currentTarget.className.includes('oneval')))) {","                // try to eval input-code","                try {","                    /*jslint evil: true*/","                    eval(document.querySelector('#inputTextareaEval1').value);","                } catch (errorCaught) {","                    console.error(errorCaught);","                }","            }","        };","        // log stderr and stdout to #outputTextareaStdout1","        ['error', 'log'].forEach(function (key) {","            console[key + '_original'] = console[key];","            console[key] = function () {","                var element;","                console[key + '_original'].apply(console, arguments);","                element = document.querySelector('#outputTextareaStdout1');","                if (!element) {","                    return;","                }","                // append text to #outputTextareaStdout1","                element.value += Array.from(arguments).map(function (arg) {","                    return typeof arg === 'string'","                        ? arg","                        : JSON.stringify(arg, null, 4);","                }).join(' ') + '\\n';","                // scroll textarea to bottom","                element.scrollTop = element.scrollHeight;","            };","        });","        // init event-handling","        ['change', 'click', 'keyup'].forEach(function (event) {","            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {","                element.addEventListener(event, local.testRunBrowser);","            });","        });","        // run tests","        local.testRunBrowser();","        break;","","","","    // run node js-env code - init-after","    /* istanbul ignore next */","    case 'node':","        // export local","        module.exports = local;","        // require modules","        local.fs = require('fs');","        local.http = require('http');","        local.url = require('url');","        // init assets","        local.assetsDict = local.assetsDict || {};","        /* jslint-ignore-begin */","        local.assetsDict['/assets.index.template.html'] = '\\","<!doctype html>\\n\\","<html lang=\"en\">\\n\\","<head>\\n\\","<meta charset=\"UTF-8\">\\n\\","<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\","<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\","<style>\\n\\","/*csslint\\n\\","    box-sizing: false,\\n\\","    universal-selector: false\\n\\","*/\\n\\","* {\\n\\","    box-sizing: border-box;\\n\\","}\\n\\","body {\\n\\","    background: #dde;\\n\\","    font-family: Arial, Helvetica, sans-serif;\\n\\","    margin: 2rem;\\n\\","}\\n\\","body > * {\\n\\","    margin-bottom: 1rem;\\n\\","}\\n\\",".utility2FooterDiv {\\n\\","    margin-top: 20px;\\n\\","    text-align: center;\\n\\","}\\n\\","</style>\\n\\","<style>\\n\\","/*csslint\\n\\","*/\\n\\","textarea {\\n\\","    font-family: monospace;\\n\\","    height: 10rem;\\n\\","    width: 100%;\\n\\","}\\n\\","textarea[readonly] {\\n\\","    background: #ddd;\\n\\","}\\n\\","</style>\\n\\","</head>\\n\\","<body>\\n\\","<!-- utility2-comment\\n\\","<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\","utility2-comment -->\\n\\","<h1>\\n\\","<!-- utility2-comment\\n\\","    <a\\n\\","        {{#if env.npm_package_homepage}}\\n\\","        href=\"{{env.npm_package_homepage}}\"\\n\\","        {{/if env.npm_package_homepage}}\\n\\","        target=\"_blank\"\\n\\","    >\\n\\","utility2-comment -->\\n\\","        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\","<!-- utility2-comment\\n\\","    </a>\\n\\","utility2-comment -->\\n\\","</h1>\\n\\","<h3>{{env.npm_package_description}}</h3>\\n\\","<!-- utility2-comment\\n\\","<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\","<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\","<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\","utility2-comment -->\\n\\","\\n\\","\\n\\","\\n\\","<label>stderr and stdout</label>\\n\\","<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\","<!-- utility2-comment\\n\\","{{#if isRollup}}\\n\\","<script src=\"assets.app.js\"></script>\\n\\","{{#unless isRollup}}\\n\\","utility2-comment -->\\n\\","<script src=\"assets.utility2.rollup.js\"></script>\\n\\","<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\","<script src=\"assets.npmtest_restify.rollup.js\"></script>\\n\\","<script src=\"assets.example.js\"></script>\\n\\","<script src=\"assets.test.js\"></script>\\n\\","<!-- utility2-comment\\n\\","{{/if isRollup}}\\n\\","utility2-comment -->\\n\\","<div class=\"utility2FooterDiv\">\\n\\","    [ this app was created with\\n\\","    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\","    ]\\n\\","</div>\\n\\","</body>\\n\\","</html>\\n\\","';","        /* jslint-ignore-end */","        if (local.templateRender) {","            local.assetsDict['/'] = local.templateRender(","                local.assetsDict['/assets.index.template.html'],","                {","                    env: local.objectSetDefault(local.env, {","                        npm_package_description: 'the greatest app in the world!',","                        npm_package_name: 'my-app',","                        npm_package_nameAlias: 'my_app',","                        npm_package_version: '0.0.1'","                    })","                }","            );","        } else {","            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']","                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {","                    // jslint-hack","                    String(match0);","                    switch (match1) {","                    case 'npm_package_description':","                        return 'the greatest app in the world!';","                    case 'npm_package_name':","                        return 'my-app';","                    case 'npm_package_nameAlias':","                        return 'my_app';","                    case 'npm_package_version':","                        return '0.0.1';","                    }","                });","        }","        // run the cli","        if (local.global.utility2_rollup || module !== require.main) {","            break;","        }","        local.assetsDict['/assets.example.js'] =","            local.assetsDict['/assets.example.js'] ||","            local.fs.readFileSync(__filename, 'utf8');","        // bug-workaround - long $npm_package_buildCustomOrg","        /* jslint-ignore-begin */","        local.assetsDict['/assets.npmtest_restify.rollup.js'] =","            local.assetsDict['/assets.npmtest_restify.rollup.js'] ||","            local.fs.readFileSync(","                local.npmtest_restify.__dirname + '/lib.npmtest_restify.js',","                'utf8'","            ).replace((/^#!/), '//');","        /* jslint-ignore-end */","        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';","        // if $npm_config_timeout_exit exists,","        // then exit this process after $npm_config_timeout_exit ms","        if (Number(process.env.npm_config_timeout_exit)) {","            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));","        }","        // start server","        if (local.global.utility2_serverHttp1) {","            break;","        }","        process.env.PORT = process.env.PORT || '8081';","        console.error('server starting on port ' + process.env.PORT);","        local.http.createServer(function (request, response) {","            request.urlParsed = local.url.parse(request.url);","            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {","                response.end(local.assetsDict[request.urlParsed.pathname]);","                return;","            }","            response.statusCode = 404;","            response.end();","        }).listen(process.env.PORT);","        break;","    }","}());",""],"l":{"26":2,"28":2,"33":2,"35":2,"37":2,"38":2,"39":2,"44":1,"51":2,"55":2,"59":2,"61":2,"69":1,"70":2,"76":2,"79":2,"82":2,"83":2,"85":1,"89":2,"92":1,"93":1,"94":1,"96":1,"97":1,"100":1,"101":1,"103":1,"106":1,"108":2,"114":1,"116":1,"118":1,"123":1,"124":2,"125":2,"126":3,"127":3,"128":3,"129":3,"130":1,"133":3,"134":3,"139":3,"143":1,"144":3,"145":1,"149":1,"150":1,"158":1,"160":1,"161":1,"162":1,"164":1,"166":1,"258":1,"259":1,"271":1,"274":6,"275":6,"277":1,"279":2,"281":1,"283":2,"288":1,"289":1,"291":1,"296":1,"303":1,"306":1,"307":1,"310":1,"311":1,"313":1,"314":1,"315":1,"316":1,"317":1,"318":1,"319":1,"321":1,"322":1,"324":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/index.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":0,"61":0,"62":0,"63":1,"64":2,"65":2,"66":2,"67":2,"68":1,"69":1,"70":58,"71":58,"72":1,"73":1,"74":1,"75":1,"76":1,"77":1,"78":1,"79":1,"80":20,"81":20},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[1,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":2,"10":2,"11":2,"12":2,"13":58,"14":20},"fnMap":{"1":{"name":"createClient","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":31}}},"2":{"name":"createJsonClient","line":70,"loc":{"start":{"line":70,"column":0},"end":{"line":70,"column":35}}},"3":{"name":"createStringClient","line":90,"loc":{"start":{"line":90,"column":0},"end":{"line":90,"column":37}}},"4":{"name":"createHttpClient","line":110,"loc":{"start":{"line":110,"column":0},"end":{"line":110,"column":35}}},"5":{"name":"createServer","line":130,"loc":{"start":{"line":130,"column":0},"end":{"line":130,"column":31}}},"6":{"name":"(anonymous_6)","line":146,"loc":{"start":{"line":146,"column":39},"end":{"line":146,"column":69}}},"7":{"name":"realizeUrl","line":173,"loc":{"start":{"line":173,"column":0},"end":{"line":173,"column":37}}},"8":{"name":"(anonymous_8)","line":174,"loc":{"start":{"line":174,"column":43},"end":{"line":174,"column":63}}},"9":{"name":"(anonymous_9)","line":192,"loc":{"start":{"line":192,"column":18},"end":{"line":192,"column":21}}},"10":{"name":"(anonymous_10)","line":195,"loc":{"start":{"line":195,"column":18},"end":{"line":195,"column":21}}},"11":{"name":"(anonymous_11)","line":198,"loc":{"start":{"line":198,"column":20},"end":{"line":198,"column":23}}},"12":{"name":"(anonymous_12)","line":203,"loc":{"start":{"line":203,"column":14},"end":{"line":203,"column":17}}},"13":{"name":"(anonymous_13)","line":212,"loc":{"start":{"line":212,"column":28},"end":{"line":212,"column":41}}},"14":{"name":"(anonymous_14)","line":225,"loc":{"start":{"line":225,"column":33},"end":{"line":225,"column":46}}}},"statementMap":{"1":{"start":{"line":12,"column":0},"end":{"line":12,"column":49}},"2":{"start":{"line":24,"column":0},"end":{"line":60,"column":1}},"3":{"start":{"line":25,"column":4},"end":{"line":29,"column":5}},"4":{"start":{"line":26,"column":8},"end":{"line":28,"column":10}},"5":{"start":{"line":31,"column":4},"end":{"line":31,"column":40}},"6":{"start":{"line":32,"column":4},"end":{"line":32,"column":44}},"7":{"start":{"line":33,"column":4},"end":{"line":33,"column":39}},"8":{"start":{"line":35,"column":4},"end":{"line":35,"column":38}},"9":{"start":{"line":37,"column":4},"end":{"line":37,"column":15}},"10":{"start":{"line":38,"column":4},"end":{"line":38,"column":36}},"11":{"start":{"line":39,"column":4},"end":{"line":39,"column":31}},"12":{"start":{"line":40,"column":4},"end":{"line":40,"column":39}},"13":{"start":{"line":41,"column":4},"end":{"line":41,"column":56}},"14":{"start":{"line":42,"column":4},"end":{"line":42,"column":58}},"15":{"start":{"line":44,"column":4},"end":{"line":57,"column":5}},"16":{"start":{"line":46,"column":12},"end":{"line":46,"column":50}},"17":{"start":{"line":47,"column":12},"end":{"line":47,"column":18}},"18":{"start":{"line":50,"column":12},"end":{"line":50,"column":52}},"19":{"start":{"line":51,"column":12},"end":{"line":51,"column":18}},"20":{"start":{"line":55,"column":12},"end":{"line":55,"column":50}},"21":{"start":{"line":56,"column":12},"end":{"line":56,"column":18}},"22":{"start":{"line":59,"column":4},"end":{"line":59,"column":20}},"23":{"start":{"line":70,"column":0},"end":{"line":80,"column":1}},"24":{"start":{"line":71,"column":4},"end":{"line":75,"column":5}},"25":{"start":{"line":72,"column":8},"end":{"line":74,"column":10}},"26":{"start":{"line":77,"column":4},"end":{"line":77,"column":50}},"27":{"start":{"line":78,"column":4},"end":{"line":78,"column":26}},"28":{"start":{"line":79,"column":4},"end":{"line":79,"column":35}},"29":{"start":{"line":90,"column":0},"end":{"line":100,"column":1}},"30":{"start":{"line":91,"column":4},"end":{"line":95,"column":5}},"31":{"start":{"line":92,"column":8},"end":{"line":94,"column":10}},"32":{"start":{"line":97,"column":4},"end":{"line":97,"column":50}},"33":{"start":{"line":98,"column":4},"end":{"line":98,"column":28}},"34":{"start":{"line":99,"column":4},"end":{"line":99,"column":35}},"35":{"start":{"line":110,"column":0},"end":{"line":120,"column":1}},"36":{"start":{"line":111,"column":4},"end":{"line":115,"column":5}},"37":{"start":{"line":112,"column":8},"end":{"line":114,"column":10}},"38":{"start":{"line":117,"column":4},"end":{"line":117,"column":50}},"39":{"start":{"line":118,"column":4},"end":{"line":118,"column":26}},"40":{"start":{"line":119,"column":4},"end":{"line":119,"column":35}},"41":{"start":{"line":130,"column":0},"end":{"line":158,"column":1}},"42":{"start":{"line":131,"column":4},"end":{"line":131,"column":44}},"43":{"start":{"line":132,"column":4},"end":{"line":132,"column":58}},"44":{"start":{"line":133,"column":4},"end":{"line":133,"column":37}},"45":{"start":{"line":134,"column":4},"end":{"line":134,"column":37}},"46":{"start":{"line":136,"column":4},"end":{"line":136,"column":42}},"47":{"start":{"line":137,"column":4},"end":{"line":137,"column":15}},"48":{"start":{"line":139,"column":4},"end":{"line":139,"column":39}},"49":{"start":{"line":140,"column":4},"end":{"line":140,"column":58}},"50":{"start":{"line":141,"column":4},"end":{"line":141,"column":50}},"51":{"start":{"line":143,"column":4},"end":{"line":143,"column":30}},"52":{"start":{"line":145,"column":4},"end":{"line":155,"column":5}},"53":{"start":{"line":146,"column":8},"end":{"line":154,"column":11}},"54":{"start":{"line":147,"column":12},"end":{"line":150,"column":13}},"55":{"start":{"line":149,"column":16},"end":{"line":149,"column":31}},"56":{"start":{"line":152,"column":12},"end":{"line":152,"column":76}},"57":{"start":{"line":153,"column":12},"end":{"line":153,"column":26}},"58":{"start":{"line":157,"column":4},"end":{"line":157,"column":20}},"59":{"start":{"line":173,"column":0},"end":{"line":180,"column":1}},"60":{"start":{"line":174,"column":4},"end":{"line":176,"column":7}},"61":{"start":{"line":175,"column":8},"end":{"line":175,"column":68}},"62":{"start":{"line":179,"column":4},"end":{"line":179,"column":48}},"63":{"start":{"line":185,"column":0},"end":{"line":209,"column":2}},"64":{"start":{"line":193,"column":8},"end":{"line":193,"column":49}},"65":{"start":{"line":196,"column":8},"end":{"line":196,"column":49}},"66":{"start":{"line":199,"column":8},"end":{"line":199,"column":51}},"67":{"start":{"line":204,"column":8},"end":{"line":204,"column":44}},"68":{"start":{"line":211,"column":0},"end":{"line":211,"column":33}},"69":{"start":{"line":212,"column":0},"end":{"line":215,"column":3}},"70":{"start":{"line":213,"column":4},"end":{"line":213,"column":41}},"71":{"start":{"line":214,"column":4},"end":{"line":214,"column":34}},"72":{"start":{"line":217,"column":0},"end":{"line":229,"column":1}},"73":{"start":{"line":219,"column":4},"end":{"line":219,"column":47}},"74":{"start":{"line":220,"column":4},"end":{"line":220,"column":53}},"75":{"start":{"line":221,"column":4},"end":{"line":221,"column":43}},"76":{"start":{"line":222,"column":4},"end":{"line":222,"column":56}},"77":{"start":{"line":223,"column":4},"end":{"line":223,"column":32}},"78":{"start":{"line":224,"column":4},"end":{"line":224,"column":39}},"79":{"start":{"line":225,"column":4},"end":{"line":228,"column":7}},"80":{"start":{"line":226,"column":8},"end":{"line":226,"column":47}},"81":{"start":{"line":227,"column":8},"end":{"line":227,"column":39}}},"branchMap":{"1":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":4}},{"start":{"line":25,"column":4},"end":{"line":25,"column":4}}]},"2":{"line":40,"type":"binary-expr","locations":[{"start":{"line":40,"column":16},"end":{"line":40,"column":25}},{"start":{"line":40,"column":29},"end":{"line":40,"column":38}}]},"3":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":25}},{"start":{"line":41,"column":29},"end":{"line":41,"column":55}}]},"4":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":15},"end":{"line":42,"column":23}},{"start":{"line":42,"column":27},"end":{"line":42,"column":57}}]},"5":{"line":44,"type":"switch","locations":[{"start":{"line":45,"column":8},"end":{"line":47,"column":18}},{"start":{"line":49,"column":8},"end":{"line":51,"column":18}},{"start":{"line":53,"column":8},"end":{"line":53,"column":20}},{"start":{"line":54,"column":8},"end":{"line":56,"column":18}}]},"6":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":4},"end":{"line":71,"column":4}},{"start":{"line":71,"column":4},"end":{"line":71,"column":4}}]},"7":{"line":77,"type":"cond-expr","locations":[{"start":{"line":77,"column":24},"end":{"line":77,"column":44}},{"start":{"line":77,"column":47},"end":{"line":77,"column":49}}]},"8":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":91,"column":4}},{"start":{"line":91,"column":4},"end":{"line":91,"column":4}}]},"9":{"line":97,"type":"cond-expr","locations":[{"start":{"line":97,"column":24},"end":{"line":97,"column":44}},{"start":{"line":97,"column":47},"end":{"line":97,"column":49}}]},"10":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":4},"end":{"line":111,"column":4}},{"start":{"line":111,"column":4},"end":{"line":111,"column":4}}]},"11":{"line":117,"type":"cond-expr","locations":[{"start":{"line":117,"column":24},"end":{"line":117,"column":44}},{"start":{"line":117,"column":47},"end":{"line":117,"column":49}}]},"12":{"line":136,"type":"binary-expr","locations":[{"start":{"line":136,"column":27},"end":{"line":136,"column":34}},{"start":{"line":136,"column":38},"end":{"line":136,"column":40}}]},"13":{"line":139,"type":"binary-expr","locations":[{"start":{"line":139,"column":16},"end":{"line":139,"column":25}},{"start":{"line":139,"column":29},"end":{"line":139,"column":38}}]},"14":{"line":140,"type":"binary-expr","locations":[{"start":{"line":140,"column":15},"end":{"line":140,"column":23}},{"start":{"line":140,"column":27},"end":{"line":140,"column":57}}]},"15":{"line":141,"type":"binary-expr","locations":[{"start":{"line":141,"column":18},"end":{"line":141,"column":29}},{"start":{"line":141,"column":33},"end":{"line":141,"column":49}}]},"16":{"line":145,"type":"if","locations":[{"start":{"line":145,"column":4},"end":{"line":145,"column":4}},{"start":{"line":145,"column":4},"end":{"line":145,"column":4}}]},"17":{"line":147,"type":"if","locations":[{"start":{"line":147,"column":12},"end":{"line":147,"column":12}},{"start":{"line":147,"column":12},"end":{"line":147,"column":12}}]},"18":{"line":147,"type":"binary-expr","locations":[{"start":{"line":147,"column":16},"end":{"line":147,"column":62}},{"start":{"line":148,"column":16},"end":{"line":148,"column":31}}]},"19":{"line":152,"type":"binary-expr","locations":[{"start":{"line":152,"column":42},"end":{"line":152,"column":51}},{"start":{"line":152,"column":55},"end":{"line":152,"column":73}}]},"20":{"line":175,"type":"cond-expr","locations":[{"start":{"line":175,"column":43},"end":{"line":175,"column":58}},{"start":{"line":175,"column":61},"end":{"line":175,"column":66}}]},"21":{"line":217,"type":"if","locations":[{"start":{"line":217,"column":0},"end":{"line":217,"column":0}},{"start":{"line":217,"column":0},"end":{"line":217,"column":0}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","//","// Restify supports both a client and server API, and in the essence of not","// loading the kitchen sink on clients, the exports here is chunked up into","// client and server; note clients will have to opt in by setting the env","// var \"RESTIFY_CLIENT_ONLY\", but if you're in that boat, it's not hard to do,","// and enables much faster load times","//","","'use strict';","","var shallowCopy = require('./utils').shallowCopy;","","","/**"," * creates an http request client. based on options passed in, will create one"," * of three existing clients: Http, String, or Json."," * @public"," * @function createClient"," * @param    {Object} options      an options object"," * @param    {String} options.type 'http' | 'json' | 'string'"," * @returns  {HttpClient | JsonClient | StringClient}"," */","function createClient(options) {","    if (typeof (options) === 'string') {","        options = {","            url: options","        };","    }","","    var assert = require('assert-plus');","    var bunyan = require('./bunyan_helper');","    var clients = require('./clients');","","    assert.object(options, 'options');","","    var client;","    var opts = shallowCopy(options);","    opts.agent = options.agent;","    opts.name = opts.name || 'restify';","    opts.type = opts.type || 'application/octet-stream';","    opts.log = opts.log || bunyan.createLogger(opts.name);","","    switch (opts.type) {","        case 'json':","            client = new clients.JsonClient(opts);","            break;","","        case 'string':","            client = new clients.StringClient(opts);","            break;","","        case 'http':","        default:","            client = new clients.HttpClient(opts);","            break;","    }","","    return (client);","}","","","/**"," * creates a json httpclient."," * @public"," * @function createJsonClient"," * @param    {Object}     options an options object"," * @returns  {JsonClient}         a json client"," */","function createJsonClient(options) {","    if (typeof (options) === 'string') {","        options = {","            url: options","        };","    }","","    options = options ? shallowCopy(options) : {};","    options.type = 'json';","    return (createClient(options));","}","","","/**"," * creates a string httpclient."," * @public"," * @function createStringClient"," * @param    {Object}       options an options object"," * @returns  {StringClient}         a string client"," */","function createStringClient(options) {","    if (typeof (options) === 'string') {","        options = {","            url: options","        };","    }","","    options = options ? shallowCopy(options) : {};","    options.type = 'string';","    return (createClient(options));","}","","","/**"," * creates a regular httpclient."," * @public"," * @function createHttpClient"," * @param    {Object}     options an options object"," * @returns  {HttpClient}         an http client"," */","function createHttpClient(options) {","    if (typeof (options) === 'string') {","        options = {","            url: options","        };","    }","","    options = options ? shallowCopy(options) : {};","    options.type = 'http';","    return (createClient(options));","}","","","/**"," * creates a server."," * @public"," * @function createServer"," * @param    {Object} options an options object"," * @returns  {Server}"," */","function createServer(options) {","    var bunyan = require('./bunyan_helper');","    var InternalError = require('./errors').InternalError;","    var Router = require('./router');","    var Server = require('./server');","","    var opts = shallowCopy(options || {});","    var server;","","    opts.name = opts.name || 'restify';","    opts.log = opts.log || bunyan.createLogger(opts.name);","    opts.router = opts.router || new Router(opts);","","    server = new Server(opts);","","    if (server.handleUncaughtExceptions) {","        server.on('uncaughtException', function (req, res, route, e) {","            if (this.listeners('uncaughtException').length > 1 ||","                res.headersSent) {","                return (false);","            }","","            res.send(new InternalError(e, e.message || 'unexpected error'));","            return (true);","        });","    }","","    return (server);","}","","","/**"," * Returns a string representation of a URL pattern , with its"," * parameters filled in by the passed hash."," *"," * If a key is not found in the hash for a param, it is left alone."," * @public"," * @function realizeUrl"," * @param   {String} pattern a url string"," * @param   {Object} params  a hash of parameter names to values for"," *                           substitution"," * @returns {String}"," */","function realizeUrl(pattern, params) {","    var p = pattern.replace(/\\/:([^/]+)/g, function (match, k) {","        return (params.hasOwnProperty(k) ? '/' + params[k] : match);","    });","","","    return (require('./utils').sanitizePath(p));","}","","","///--- Exports","","module.exports = {","    // Client API","    createClient: createClient,","    createJsonClient: createJsonClient,","    createJSONClient: createJsonClient,","    createStringClient: createStringClient,","    createHttpClient: createHttpClient,","    get HttpClient() {","        return (require('./clients').HttpClient);","    },","    get JsonClient() {","        return (require('./clients').JsonClient);","    },","    get StringClient() {","        return (require('./clients').StringClient);","    },","","    // Miscellaneous API","    get bunyan() {","        return (require('./bunyan_helper'));","    },","","    errors: {}","","};","","var errors = require('./errors');","Object.keys(errors).forEach(function (k) {","    module.exports.errors[k] = errors[k];","    module.exports[k] = errors[k];","});","","if (!process.env.RESTIFY_CLIENT_ONLY) {","","    module.exports.createServer = createServer;","    module.exports.httpDate = require('./http_date');","    module.exports.realizeUrl = realizeUrl;","    module.exports.formatters = require('./formatters');","    module.exports.plugins = {};","    var plugins = require('./plugins');","    Object.keys(plugins).forEach(function (k) {","        module.exports.plugins[k] = plugins[k];","        module.exports[k] = plugins[k];","    });","}",""],"l":{"12":1,"24":1,"25":0,"26":0,"31":0,"32":0,"33":0,"35":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"44":0,"46":0,"47":0,"50":0,"51":0,"55":0,"56":0,"59":0,"70":1,"71":0,"72":0,"77":0,"78":0,"79":0,"90":1,"91":0,"92":0,"97":0,"98":0,"99":0,"110":1,"111":0,"112":0,"117":0,"118":0,"119":0,"130":1,"131":0,"132":0,"133":0,"134":0,"136":0,"137":0,"139":0,"140":0,"141":0,"143":0,"145":0,"146":0,"147":0,"149":0,"152":0,"153":0,"157":0,"173":1,"174":0,"175":0,"179":0,"185":1,"193":2,"196":2,"199":2,"204":2,"211":1,"212":1,"213":58,"214":58,"217":1,"219":1,"220":1,"221":1,"222":1,"223":1,"224":1,"225":1,"226":20,"227":20}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/utils.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/utils.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"sanitizePath","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":28}}},"2":{"name":"shallowCopy","line":37,"loc":{"start":{"line":37,"column":0},"end":{"line":37,"column":26}}},"3":{"name":"(anonymous_3)","line":42,"loc":{"start":{"line":42,"column":29},"end":{"line":42,"column":42}}},"4":{"name":"mergeQs","line":58,"loc":{"start":{"line":58,"column":0},"end":{"line":58,"column":29}}},"5":{"name":"(anonymous_5)","line":64,"loc":{"start":{"line":64,"column":34},"end":{"line":64,"column":49}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":15,"column":0},"end":{"line":27,"column":1}},"3":{"start":{"line":16,"column":4},"end":{"line":16,"column":20}},"4":{"start":{"line":19,"column":4},"end":{"line":19,"column":39}},"5":{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},"6":{"start":{"line":23,"column":8},"end":{"line":23,"column":47}},"7":{"start":{"line":26,"column":4},"end":{"line":26,"column":18}},"8":{"start":{"line":37,"column":0},"end":{"line":46,"column":1}},"9":{"start":{"line":38,"column":4},"end":{"line":40,"column":5}},"10":{"start":{"line":39,"column":8},"end":{"line":39,"column":21}},"11":{"start":{"line":41,"column":4},"end":{"line":41,"column":18}},"12":{"start":{"line":42,"column":4},"end":{"line":44,"column":7}},"13":{"start":{"line":43,"column":8},"end":{"line":43,"column":25}},"14":{"start":{"line":45,"column":4},"end":{"line":45,"column":18}},"15":{"start":{"line":58,"column":0},"end":{"line":80,"column":1}},"16":{"start":{"line":60,"column":4},"end":{"line":60,"column":41}},"17":{"start":{"line":63,"column":4},"end":{"line":77,"column":5}},"18":{"start":{"line":64,"column":8},"end":{"line":76,"column":11}},"19":{"start":{"line":67,"column":12},"end":{"line":75,"column":13}},"20":{"start":{"line":68,"column":16},"end":{"line":68,"column":44}},"21":{"start":{"line":71,"column":16},"end":{"line":71,"column":44}},"22":{"start":{"line":74,"column":16},"end":{"line":74,"column":40}},"23":{"start":{"line":79,"column":4},"end":{"line":79,"column":20}},"24":{"start":{"line":85,"column":0},"end":{"line":89,"column":2}}},"branchMap":{"1":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":22,"column":4}},{"start":{"line":22,"column":4},"end":{"line":22,"column":4}}]},"2":{"line":22,"type":"binary-expr","locations":[{"start":{"line":22,"column":8},"end":{"line":22,"column":51}},{"start":{"line":22,"column":55},"end":{"line":22,"column":70}}]},"3":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":4},"end":{"line":38,"column":4}},{"start":{"line":38,"column":4},"end":{"line":38,"column":4}}]},"4":{"line":60,"type":"binary-expr","locations":[{"start":{"line":60,"column":17},"end":{"line":60,"column":34}},{"start":{"line":60,"column":38},"end":{"line":60,"column":40}}]},"5":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":4},"end":{"line":63,"column":4}},{"start":{"line":63,"column":4},"end":{"line":63,"column":4}}]},"6":{"line":63,"type":"binary-expr","locations":[{"start":{"line":63,"column":8},"end":{"line":63,"column":12}},{"start":{"line":63,"column":16},"end":{"line":63,"column":42}}]},"7":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":12},"end":{"line":67,"column":12}},{"start":{"line":67,"column":12},"end":{"line":67,"column":12}}]},"8":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":16},"end":{"line":67,"column":42}},{"start":{"line":67,"column":46},"end":{"line":67,"column":77}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","","","/**"," * Cleans up sloppy URL paths, like /foo////bar/// to /foo/bar."," * @public"," * @method  sanitizePath"," * @param   {String} path the HTTP resource path."," * @returns {String}      Cleaned up form of path."," */","function sanitizePath(path) {","    assert.ok(path);","","    // Be nice like apache and strip out any //my//foo//bar///blah","    path = path.replace(/\\/\\/+/g, '/');","","    // Kill a trailing '/'","    if (path.lastIndexOf('/') === (path.length - 1) && path.length > 1) {","        path = path.substr(0, path.length - 1);","    }","","    return (path);","}","","","/**"," * Return a shallow copy of the given object;"," * @public"," * @method  shallowCopy"," * @param   {Object} obj the object to copy"," * @returns {Object}     the new copy of the object"," */","function shallowCopy(obj) {","    if (!obj) {","        return (obj);","    }","    var copy = {};","    Object.keys(obj).forEach(function (k) {","        copy[k] = obj[k];","    });","    return (copy);","}","","","/**"," * Merges two query parameter objects. Merges to array"," * if the same key is encountered."," * @public"," * @method  mergeQs"," * @param   {Object} obj1 first qs object"," * @param   {Object} obj2 second qs object"," * @returns {Object}      the merged object"," */","function mergeQs(obj1, obj2) {","","    var merged = shallowCopy(obj1) || {};","","    // defend against null cause null is an object. yay js.","    if (obj2 && typeof (obj2) === 'object') {","        Object.keys(obj2).forEach(function (key) {","            // if we already have this key and it isn't an array,","            // make it one array of the same element.","            if (merged.hasOwnProperty(key) && !(merged[key] instanceof Array)) {","                merged[key] = [merged[key]];","","                // push the new value down","                merged[key].push(obj2[key]);","            } else {","                // otherwise just set it","                merged[key] = obj2[key];","            }","        });","    }","","    return (merged);","}","","","///--- Exports","","module.exports = {","    sanitizePath: sanitizePath,","    shallowCopy: shallowCopy,","    mergeQs: mergeQs","};",""],"l":{"5":1,"15":1,"16":0,"19":0,"22":0,"23":0,"26":0,"37":1,"38":0,"39":0,"41":0,"42":0,"43":0,"45":0,"58":1,"60":0,"63":0,"64":0,"67":0,"68":0,"71":0,"74":0,"79":0,"85":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/errors/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/errors/index.js","s":{"1":1,"2":1,"3":1,"4":1,"5":43,"6":1,"7":16},"b":{},"f":{"1":43,"2":16},"fnMap":{"1":{"name":"(anonymous_1)","line":11,"loc":{"start":{"line":11,"column":32},"end":{"line":11,"column":45}}},"2":{"name":"(anonymous_2)","line":16,"loc":{"start":{"line":16,"column":32},"end":{"line":16,"column":45}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":41}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"3":{"start":{"line":9,"column":0},"end":{"line":9,"column":20}},"4":{"start":{"line":11,"column":0},"end":{"line":13,"column":3}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":38}},"6":{"start":{"line":16,"column":0},"end":{"line":18,"column":3}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":38}}},"branchMap":{},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var httpErrors = require('./http_error');","var restErrors = require('./rest_error');","","","module.exports = {};","","Object.keys(httpErrors).forEach(function (k) {","    module.exports[k] = httpErrors[k];","});","","// Note some of the RestErrors overwrite plain HTTP errors.","Object.keys(restErrors).forEach(function (k) {","    module.exports[k] = restErrors[k];","});",""],"l":{"5":1,"6":1,"9":1,"11":1,"12":43,"16":1,"17":16}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/errors/http_error.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/errors/http_error.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":41,"8":41,"9":41,"10":0,"11":41,"12":41,"13":41,"14":96,"15":41,"16":41,"17":40,"18":41,"19":1,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":1,"39":62,"40":21,"41":41,"42":41,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":41,"60":41},"b":{"1":[0,41],"2":[40,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[21,41],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":41,"2":96,"3":0,"4":0,"5":62,"6":0},"fnMap":{"1":{"name":"codeToErrorName","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":31}}},"2":{"name":"(anonymous_2)","line":42,"loc":{"start":{"line":42,"column":19},"end":{"line":42,"column":32}}},"3":{"name":"HttpError","line":64,"loc":{"start":{"line":64,"column":0},"end":{"line":64,"column":28}}},"4":{"name":"codeToHttpError","line":88,"loc":{"start":{"line":88,"column":21},"end":{"line":88,"column":67}}},"5":{"name":"(anonymous_5)","line":117,"loc":{"start":{"line":117,"column":14},"end":{"line":117,"column":30}}},"6":{"name":"(anonymous_6)","line":124,"loc":{"start":{"line":124,"column":27},"end":{"line":124,"column":53}}}},"statementMap":{"1":{"start":{"line":9,"column":0},"end":{"line":9,"column":27}},"2":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"3":{"start":{"line":12,"column":0},"end":{"line":12,"column":36}},"4":{"start":{"line":13,"column":0},"end":{"line":13,"column":38}},"5":{"start":{"line":18,"column":0},"end":{"line":18,"column":64}},"6":{"start":{"line":31,"column":0},"end":{"line":53,"column":1}},"7":{"start":{"line":32,"column":4},"end":{"line":32,"column":30}},"8":{"start":{"line":33,"column":4},"end":{"line":33,"column":41}},"9":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"10":{"start":{"line":36,"column":8},"end":{"line":36,"column":23}},"11":{"start":{"line":40,"column":4},"end":{"line":40,"column":37}},"12":{"start":{"line":41,"column":4},"end":{"line":41,"column":17}},"13":{"start":{"line":42,"column":4},"end":{"line":44,"column":7}},"14":{"start":{"line":43,"column":8},"end":{"line":43,"column":68}},"15":{"start":{"line":46,"column":4},"end":{"line":46,"column":34}},"16":{"start":{"line":48,"column":4},"end":{"line":50,"column":5}},"17":{"start":{"line":49,"column":8},"end":{"line":49,"column":23}},"18":{"start":{"line":52,"column":4},"end":{"line":52,"column":17}},"19":{"start":{"line":64,"column":0},"end":{"line":78,"column":1}},"20":{"start":{"line":65,"column":4},"end":{"line":65,"column":38}},"21":{"start":{"line":67,"column":4},"end":{"line":67,"column":65}},"22":{"start":{"line":68,"column":4},"end":{"line":68,"column":34}},"23":{"start":{"line":70,"column":4},"end":{"line":70,"column":20}},"24":{"start":{"line":71,"column":4},"end":{"line":71,"column":57}},"25":{"start":{"line":72,"column":4},"end":{"line":72,"column":27}},"26":{"start":{"line":73,"column":4},"end":{"line":76,"column":6}},"27":{"start":{"line":77,"column":4},"end":{"line":77,"column":51}},"28":{"start":{"line":79,"column":0},"end":{"line":79,"column":33}},"29":{"start":{"line":84,"column":0},"end":{"line":111,"column":2}},"30":{"start":{"line":89,"column":8},"end":{"line":89,"column":16}},"31":{"start":{"line":90,"column":8},"end":{"line":90,"column":41}},"32":{"start":{"line":92,"column":8},"end":{"line":106,"column":9}},"33":{"start":{"line":93,"column":12},"end":{"line":97,"column":15}},"34":{"start":{"line":98,"column":12},"end":{"line":98,"column":47}},"35":{"start":{"line":100,"column":12},"end":{"line":105,"column":15}},"36":{"start":{"line":108,"column":8},"end":{"line":108,"column":21}},"37":{"start":{"line":115,"column":0},"end":{"line":115,"column":43}},"38":{"start":{"line":117,"column":0},"end":{"line":153,"column":3}},"39":{"start":{"line":118,"column":4},"end":{"line":120,"column":5}},"40":{"start":{"line":119,"column":8},"end":{"line":119,"column":15}},"41":{"start":{"line":122,"column":4},"end":{"line":122,"column":37}},"42":{"start":{"line":124,"column":4},"end":{"line":147,"column":6}},"43":{"start":{"line":125,"column":8},"end":{"line":125,"column":22}},"44":{"start":{"line":126,"column":8},"end":{"line":128,"column":10}},"45":{"start":{"line":130,"column":8},"end":{"line":142,"column":9}},"46":{"start":{"line":131,"column":12},"end":{"line":131,"column":31}},"47":{"start":{"line":132,"column":12},"end":{"line":132,"column":51}},"48":{"start":{"line":133,"column":15},"end":{"line":142,"column":9}},"49":{"start":{"line":134,"column":12},"end":{"line":134,"column":35}},"50":{"start":{"line":135,"column":12},"end":{"line":135,"column":37}},"51":{"start":{"line":136,"column":12},"end":{"line":136,"column":55}},"52":{"start":{"line":137,"column":12},"end":{"line":137,"column":41}},"53":{"start":{"line":138,"column":12},"end":{"line":138,"column":55}},"54":{"start":{"line":140,"column":12},"end":{"line":140,"column":51}},"55":{"start":{"line":141,"column":12},"end":{"line":141,"column":22}},"56":{"start":{"line":144,"column":8},"end":{"line":144,"column":43}},"57":{"start":{"line":145,"column":8},"end":{"line":145,"column":27}},"58":{"start":{"line":146,"column":8},"end":{"line":146,"column":36}},"59":{"start":{"line":148,"column":4},"end":{"line":148,"column":51}},"60":{"start":{"line":150,"column":4},"end":{"line":152,"column":17}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":35,"column":4}},{"start":{"line":35,"column":4},"end":{"line":35,"column":4}}]},"2":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":4},"end":{"line":48,"column":4}},{"start":{"line":48,"column":4},"end":{"line":48,"column":4}}]},"3":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":29},"end":{"line":67,"column":51}},{"start":{"line":67,"column":55},"end":{"line":67,"column":64}}]},"4":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":25},"end":{"line":71,"column":43}},{"start":{"line":71,"column":47},"end":{"line":71,"column":50}}]},"5":{"line":73,"type":"binary-expr","locations":[{"start":{"line":73,"column":16},"end":{"line":73,"column":28}},{"start":{"line":73,"column":32},"end":{"line":76,"column":5}}]},"6":{"line":75,"type":"binary-expr","locations":[{"start":{"line":75,"column":17},"end":{"line":75,"column":32}},{"start":{"line":75,"column":36},"end":{"line":75,"column":48}}]},"7":{"line":77,"type":"binary-expr","locations":[{"start":{"line":77,"column":19},"end":{"line":77,"column":34}},{"start":{"line":77,"column":38},"end":{"line":77,"column":50}}]},"8":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":8},"end":{"line":92,"column":8}},{"start":{"line":92,"column":8},"end":{"line":92,"column":8}}]},"9":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":118,"column":4}},{"start":{"line":118,"column":4},"end":{"line":118,"column":4}}]},"10":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":8},"end":{"line":130,"column":8}},{"start":{"line":130,"column":8},"end":{"line":130,"column":8}}]},"11":{"line":130,"type":"binary-expr","locations":[{"start":{"line":130,"column":12},"end":{"line":130,"column":17}},{"start":{"line":130,"column":21},"end":{"line":130,"column":43}}]},"12":{"line":133,"type":"if","locations":[{"start":{"line":133,"column":15},"end":{"line":133,"column":15}},{"start":{"line":133,"column":15},"end":{"line":133,"column":15}}]},"13":{"line":138,"type":"binary-expr","locations":[{"start":{"line":138,"column":30},"end":{"line":138,"column":46}},{"start":{"line":138,"column":50},"end":{"line":138,"column":54}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","// Because we are constructing error objects dynamically, we use an anonymous","// function as the 'base constructor' then use arguments.callee to fill that in.","// strict mode disallows agruments.callee, disable both of these rules.","","/* eslint-disable strict, no-caller */","","var http = require('http');","var util = require('util');","","var assert = require('assert-plus');","var WError = require('verror').WError;","","","///--- Globals","","var slice = Function.prototype.call.bind(Array.prototype.slice);","","","///--- Helpers","","/**"," * used to programatically create http error code names, using the underlying"," * status codes names exposed via the http module."," * @private"," * @function codeToErrorName"," * @param    {Number} code the http error code to dynamically create"," * @returns  {String}"," */","function codeToErrorName(code) {","    code = parseInt(code, 10);","    var status = http.STATUS_CODES[code];","","    if (!status) {","        return (false);","    }","","","    var pieces = status.split(/\\s+/);","    var str = '';","    pieces.forEach(function (s) {","        str += s.charAt(0).toUpperCase() + s.slice(1).toLowerCase();","    });","","    str = str.replace(/\\W+/g, '');","","    if (!/\\w+Error$/.test(str)) {","        str += 'Error';","    }","","    return (str);","}","","","///--- Error Base class","","/**"," * HttpError class. inherits from WError."," * @public"," * @class"," * @param {Object} options an options object"," */","function HttpError(options) {","    assert.object(options, 'options');","","    options.constructorOpt = options.constructorOpt || HttpError;","    WError.apply(this, arguments);","","    var self = this;","    var code = parseInt((options.statusCode || 500), 10);","    this.statusCode = code;","    this.body = options.body || {","        code: codeToErrorName(code),","        message: options.message || self.message","    };","    this.message = options.message || self.message;","}","util.inherits(HttpError, WError);","","","///--- Exports","","module.exports = {","","    HttpError: HttpError,","","    codeToHttpError: function codeToHttpError(code, message, body) {","        var err;","        var name = codeToErrorName(code);","","        if (!name) {","            err = new HttpError({","                statusCode: code,","                message: message,","                body: body","            });","            err.name = 'Http' + code + 'Error';","        } else {","            err = new module.exports[name]({","                body: body,","                message: message,","                constructorOpt: codeToHttpError,","                statusCode: code","            });","        }","","        return (err);","    }","","};","","","// Export all the 4xx and 5xx HTTP Status codes as Errors","var codes = Object.keys(http.STATUS_CODES);","","codes.forEach(function (code) {","    if (code < 400) {","        return;","    }","","    var name = codeToErrorName(code);","","    module.exports[name] = function (cause, message) {","        var index = 1;","        var opts = {","            statusCode: code","        };","","        if (cause && cause instanceof Error) {","            opts.cause = cause;","            opts.constructorOpt = arguments.callee;","        } else if (typeof (cause) === 'object') {","            opts.body = cause.body;","            opts.cause = cause.cause;","            opts.constructorOpt = cause.constructorOpt;","            opts.message = cause.message;","            opts.statusCode = cause.statusCode || code;","        } else {","            opts.constructorOpt = arguments.callee;","            index = 0;","        }","","        var args = slice(arguments, index);","        args.unshift(opts);","        HttpError.apply(this, args);","    };","    util.inherits(module.exports[name], HttpError);","","    module.exports[name].displayName =","        module.exports[name].prototype.name =","            name;","});",""],"l":{"9":1,"10":1,"12":1,"13":1,"18":1,"31":1,"32":41,"33":41,"35":41,"36":0,"40":41,"41":41,"42":41,"43":96,"46":41,"48":41,"49":40,"52":41,"64":1,"65":0,"67":0,"68":0,"70":0,"71":0,"72":0,"73":0,"77":0,"79":1,"84":1,"89":0,"90":0,"92":0,"93":0,"98":0,"100":0,"108":0,"115":1,"117":1,"118":62,"119":21,"122":41,"124":41,"125":0,"126":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"140":0,"141":0,"144":0,"145":0,"146":0,"148":41,"150":41}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/errors/rest_error.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/errors/rest_error.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1,"16":1,"17":15,"18":15,"19":15,"20":15,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":15,"36":15},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[15,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":15,"3":0},"fnMap":{"1":{"name":"RestError","line":43,"loc":{"start":{"line":43,"column":0},"end":{"line":43,"column":28}}},"2":{"name":"(anonymous_2)","line":65,"loc":{"start":{"line":65,"column":27},"end":{"line":65,"column":40}}},"3":{"name":"(anonymous_3)","line":72,"loc":{"start":{"line":72,"column":27},"end":{"line":72,"column":53}}}},"statementMap":{"1":{"start":{"line":9,"column":0},"end":{"line":9,"column":27}},"2":{"start":{"line":11,"column":0},"end":{"line":11,"column":36}},"3":{"start":{"line":13,"column":0},"end":{"line":13,"column":41}},"4":{"start":{"line":18,"column":0},"end":{"line":18,"column":64}},"5":{"start":{"line":20,"column":0},"end":{"line":20,"column":37}},"6":{"start":{"line":22,"column":0},"end":{"line":38,"column":2}},"7":{"start":{"line":43,"column":0},"end":{"line":55,"column":1}},"8":{"start":{"line":44,"column":4},"end":{"line":44,"column":38}},"9":{"start":{"line":46,"column":4},"end":{"line":46,"column":65}},"10":{"start":{"line":47,"column":4},"end":{"line":47,"column":37}},"11":{"start":{"line":49,"column":4},"end":{"line":49,"column":20}},"12":{"start":{"line":50,"column":4},"end":{"line":50,"column":48}},"13":{"start":{"line":51,"column":4},"end":{"line":54,"column":6}},"14":{"start":{"line":56,"column":0},"end":{"line":56,"column":36}},"15":{"start":{"line":61,"column":0},"end":{"line":63,"column":2}},"16":{"start":{"line":65,"column":0},"end":{"line":100,"column":3}},"17":{"start":{"line":66,"column":4},"end":{"line":66,"column":17}},"18":{"start":{"line":68,"column":4},"end":{"line":70,"column":5}},"19":{"start":{"line":69,"column":8},"end":{"line":69,"column":24}},"20":{"start":{"line":72,"column":4},"end":{"line":95,"column":6}},"21":{"start":{"line":73,"column":8},"end":{"line":73,"column":22}},"22":{"start":{"line":74,"column":8},"end":{"line":77,"column":10}},"23":{"start":{"line":79,"column":8},"end":{"line":79,"column":47}},"24":{"start":{"line":81,"column":8},"end":{"line":90,"column":9}},"25":{"start":{"line":82,"column":12},"end":{"line":82,"column":31}},"26":{"start":{"line":83,"column":15},"end":{"line":90,"column":9}},"27":{"start":{"line":84,"column":12},"end":{"line":84,"column":35}},"28":{"start":{"line":85,"column":12},"end":{"line":85,"column":37}},"29":{"start":{"line":86,"column":12},"end":{"line":86,"column":41}},"30":{"start":{"line":87,"column":12},"end":{"line":87,"column":59}},"31":{"start":{"line":89,"column":12},"end":{"line":89,"column":22}},"32":{"start":{"line":92,"column":8},"end":{"line":92,"column":43}},"33":{"start":{"line":93,"column":8},"end":{"line":93,"column":27}},"34":{"start":{"line":94,"column":8},"end":{"line":94,"column":36}},"35":{"start":{"line":96,"column":4},"end":{"line":96,"column":51}},"36":{"start":{"line":97,"column":4},"end":{"line":99,"column":17}}},"branchMap":{"1":{"line":46,"type":"binary-expr","locations":[{"start":{"line":46,"column":29},"end":{"line":46,"column":51}},{"start":{"line":46,"column":55},"end":{"line":46,"column":64}}]},"2":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":20},"end":{"line":50,"column":36}},{"start":{"line":50,"column":40},"end":{"line":50,"column":47}}]},"3":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":16},"end":{"line":51,"column":28}},{"start":{"line":51,"column":32},"end":{"line":54,"column":5}}]},"4":{"line":53,"type":"binary-expr","locations":[{"start":{"line":53,"column":17},"end":{"line":53,"column":32}},{"start":{"line":53,"column":36},"end":{"line":53,"column":48}}]},"5":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":4},"end":{"line":68,"column":4}},{"start":{"line":68,"column":4},"end":{"line":68,"column":4}}]},"6":{"line":75,"type":"cond-expr","locations":[{"start":{"line":75,"column":42},"end":{"line":75,"column":57}},{"start":{"line":75,"column":60},"end":{"line":75,"column":61}}]},"7":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":8},"end":{"line":81,"column":8}},{"start":{"line":81,"column":8},"end":{"line":81,"column":8}}]},"8":{"line":81,"type":"binary-expr","locations":[{"start":{"line":81,"column":12},"end":{"line":81,"column":17}},{"start":{"line":81,"column":21},"end":{"line":81,"column":43}}]},"9":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":15},"end":{"line":83,"column":15}},{"start":{"line":83,"column":15},"end":{"line":83,"column":15}}]},"10":{"line":87,"type":"binary-expr","locations":[{"start":{"line":87,"column":30},"end":{"line":87,"column":46}},{"start":{"line":87,"column":50},"end":{"line":87,"column":58}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","// Because we are constructing error objects dynamically, we use an anonymous","// function as the 'base constructor' then use arguments.callee to fill that in.","// strict mode disallows agruments.callee, disable both of these rules.","","/* eslint-disable strict, no-caller */","","var util = require('util');","","var assert = require('assert-plus');","","var httpErrors = require('./http_error');","","","///--- Globals","","var slice = Function.prototype.call.bind(Array.prototype.slice);","","var HttpError = httpErrors.HttpError;","","var CODES = {","    BadDigest: 400,","    BadMethod: 405,","    Internal: 500, // Don't have InternalErrorError","    InvalidArgument: 409,","    InvalidContent: 400,","    InvalidCredentials: 401,","    InvalidHeader: 400,","    InvalidVersion: 400,","    MissingParameter: 409,","    NotAuthorized: 403,","    PreconditionFailed: 412,","    RequestExpired: 400,","    RequestThrottled: 429,","    ResourceNotFound: 404,","    WrongAccept: 406","};","","","///--- API","","function RestError(options) {","    assert.object(options, 'options');","","    options.constructorOpt = options.constructorOpt || RestError;","    HttpError.apply(this, arguments);","","    var self = this;","    this.restCode = options.restCode || 'Error';","    this.body = options.body || {","        code: self.restCode,","        message: options.message || self.message","    };","}","util.inherits(RestError, HttpError);","","","///--- Exports","","module.exports = {","    RestError: RestError","};","","Object.keys(CODES).forEach(function (k) {","    var name = k;","","    if (!/\\w+Error$/.test(name)) {","        name += 'Error';","    }","","    module.exports[name] = function (cause, message) {","        var index = 1;","        var opts = {","            restCode: (k === 'Internal' ? 'InternalError' : k),","            statusCode: CODES[k]","        };","","        opts.constructorOpt = arguments.callee;","","        if (cause && cause instanceof Error) {","            opts.cause = cause;","        } else if (typeof (cause) === 'object') {","            opts.body = cause.body;","            opts.cause = cause.cause;","            opts.message = cause.message;","            opts.statusCode = cause.statusCode || CODES[k];","        } else {","            index = 0;","        }","","        var args = slice(arguments, index);","        args.unshift(opts);","        RestError.apply(this, args);","    };","    util.inherits(module.exports[name], RestError);","    module.exports[name].displayName =","        module.exports[name].prototype.name =","            name;","});",""],"l":{"9":1,"11":1,"13":1,"18":1,"20":1,"22":1,"43":1,"44":0,"46":0,"47":0,"49":0,"50":0,"51":0,"56":1,"61":1,"65":1,"66":15,"68":15,"69":15,"72":15,"73":0,"74":0,"79":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"89":0,"92":0,"93":0,"94":0,"96":15,"97":15}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/http_date.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/http_date.js","s":{"1":1,"2":0,"3":0,"4":0},"b":{"1":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"httpDate","line":13,"loc":{"start":{"line":13,"column":17},"end":{"line":13,"column":40}}}},"statementMap":{"1":{"start":{"line":13,"column":0},"end":{"line":19,"column":2}},"2":{"start":{"line":14,"column":4},"end":{"line":16,"column":5}},"3":{"start":{"line":15,"column":8},"end":{"line":15,"column":25}},"4":{"start":{"line":18,"column":4},"end":{"line":18,"column":31}}},"branchMap":{"1":{"line":14,"type":"if","locations":[{"start":{"line":14,"column":4},"end":{"line":14,"column":4}},{"start":{"line":14,"column":4},"end":{"line":14,"column":4}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","/**"," * takes an instance of a date object, formats it UTC"," *     e.g., Wed, 17 Jun 2015 01:30:26 GMT"," * @public"," * @function httpDate"," * @param    {Object} now a date object"," * @returns  {String}     formatted dated object"," */","module.exports = function httpDate(now) {","    if (!now) {","        now = new Date();","    }","","    return (now.toUTCString());","};",""],"l":{"13":1,"14":0,"15":0,"18":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":7,"column":0},"end":{"line":12,"column":2}}},"branchMap":{},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","///--- Exports","","module.exports = {","    'application/javascript; q=0.1': require('./jsonp'),","    'application/json; q=0.4': require('./json'),","    'text/plain; q=0.3': require('./text'),","    'application/octet-stream; q=0.2': require('./binary')","};",""],"l":{"7":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/jsonp.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/jsonp.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"formatJSONP","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":41}}}},"statementMap":{"1":{"start":{"line":17,"column":0},"end":{"line":49,"column":1}},"2":{"start":{"line":18,"column":4},"end":{"line":21,"column":5}},"3":{"start":{"line":19,"column":8},"end":{"line":19,"column":43}},"4":{"start":{"line":20,"column":8},"end":{"line":20,"column":22}},"5":{"start":{"line":23,"column":4},"end":{"line":31,"column":5}},"6":{"start":{"line":24,"column":8},"end":{"line":30,"column":9}},"7":{"start":{"line":25,"column":12},"end":{"line":25,"column":29}},"8":{"start":{"line":27,"column":12},"end":{"line":29,"column":14}},"9":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"10":{"start":{"line":34,"column":8},"end":{"line":34,"column":39}},"11":{"start":{"line":37,"column":4},"end":{"line":37,"column":52}},"12":{"start":{"line":38,"column":4},"end":{"line":38,"column":13}},"13":{"start":{"line":40,"column":4},"end":{"line":45,"column":5}},"14":{"start":{"line":41,"column":8},"end":{"line":42,"column":56}},"15":{"start":{"line":44,"column":8},"end":{"line":44,"column":36}},"16":{"start":{"line":47,"column":4},"end":{"line":47,"column":61}},"17":{"start":{"line":48,"column":4},"end":{"line":48,"column":26}},"18":{"start":{"line":51,"column":0},"end":{"line":51,"column":29}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]},"2":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":4},"end":{"line":23,"column":4}},{"start":{"line":23,"column":4},"end":{"line":23,"column":4}}]},"3":{"line":24,"type":"if","locations":[{"start":{"line":24,"column":8},"end":{"line":24,"column":8}},{"start":{"line":24,"column":8},"end":{"line":24,"column":8}}]},"4":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":13},"end":{"line":24,"column":26}},{"start":{"line":24,"column":30},"end":{"line":24,"column":43}},{"start":{"line":24,"column":48},"end":{"line":24,"column":57}}]},"5":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"6":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":14},"end":{"line":37,"column":32}},{"start":{"line":37,"column":36},"end":{"line":37,"column":51}}]},"7":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","///--- Exports","","/**"," * JSONP formatter. like JSON, but with a callback invocation."," * @public"," * @function formatJSONP"," * @param    {Object} req  the request object"," * @param    {Object} res  the response object"," * @param    {Object} body response body"," * @param    {Function} cb cb"," * @returns  {String}"," */","function formatJSONP(req, res, body, cb) {","    if (!body) {","        res.setHeader('Content-Length', 0);","        return (null);","    }","","    if (body instanceof Error) {","        if ((body.restCode || body.httpCode) && body.body) {","            body = body.body;","        } else {","            body = {","                message: body.message","            };","        }","    }","","    if (Buffer.isBuffer(body)) {","        body = body.toString('base64');","    }","","    var _cb = req.query.callback || req.query.jsonp;","    var data;","","    if (_cb) {","        data = 'typeof ' + _cb + ' === \\'function\\' && ' +","                _cb + '(' + JSON.stringify(body) + ');';","    } else {","        data = JSON.stringify(body);","    }","","    res.setHeader('Content-Length', Buffer.byteLength(data));","    return cb(null, data);","}","","module.exports = formatJSONP;",""],"l":{"17":1,"18":0,"19":0,"20":0,"23":0,"24":0,"25":0,"27":0,"33":0,"34":0,"37":0,"38":0,"40":0,"41":0,"44":0,"47":0,"48":0,"51":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/json.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/json.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"formatJSON","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":40}}}},"statementMap":{"1":{"start":{"line":17,"column":0},"end":{"line":38,"column":1}},"2":{"start":{"line":18,"column":4},"end":{"line":32,"column":5}},"3":{"start":{"line":21,"column":8},"end":{"line":21,"column":48}},"4":{"start":{"line":23,"column":8},"end":{"line":29,"column":9}},"5":{"start":{"line":24,"column":12},"end":{"line":24,"column":29}},"6":{"start":{"line":26,"column":12},"end":{"line":28,"column":14}},"7":{"start":{"line":30,"column":11},"end":{"line":32,"column":5}},"8":{"start":{"line":31,"column":8},"end":{"line":31,"column":39}},"9":{"start":{"line":34,"column":4},"end":{"line":34,"column":36}},"10":{"start":{"line":35,"column":4},"end":{"line":35,"column":61}},"11":{"start":{"line":37,"column":4},"end":{"line":37,"column":26}},"12":{"start":{"line":40,"column":0},"end":{"line":40,"column":28}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]},"2":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":25},"end":{"line":21,"column":40}},{"start":{"line":21,"column":44},"end":{"line":21,"column":47}}]},"3":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":23,"column":8}},{"start":{"line":23,"column":8},"end":{"line":23,"column":8}}]},"4":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":11},"end":{"line":30,"column":11}},{"start":{"line":30,"column":11},"end":{"line":30,"column":11}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","///--- Exports","","/**"," * JSON formatter."," * @public"," * @function formatJSON"," * @param    {Object} req  the request object"," * @param    {Object} res  the response object"," * @param    {Object} body response body"," * @param    {Function} cb cb"," * @returns  {String}"," */","function formatJSON(req, res, body, cb) {","    if (body instanceof Error) {","        // snoop for RestError or HttpError, but don't rely on","        // instanceof","        res.statusCode = body.statusCode || 500;","","        if (body.body) {","            body = body.body;","        } else {","            body = {","                message: body.message","            };","        }","    } else if (Buffer.isBuffer(body)) {","        body = body.toString('base64');","    }","","    var data = JSON.stringify(body);","    res.setHeader('Content-Length', Buffer.byteLength(data));","","    return cb(null, data);","}","","module.exports = formatJSON;",""],"l":{"17":1,"18":0,"21":0,"23":0,"24":0,"26":0,"30":0,"31":0,"34":0,"35":0,"37":0,"40":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/text.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/text.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"formatText","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":40}}}},"statementMap":{"1":{"start":{"line":17,"column":0},"end":{"line":29,"column":1}},"2":{"start":{"line":18,"column":4},"end":{"line":25,"column":5}},"3":{"start":{"line":19,"column":8},"end":{"line":19,"column":48}},"4":{"start":{"line":20,"column":8},"end":{"line":20,"column":28}},"5":{"start":{"line":21,"column":11},"end":{"line":25,"column":5}},"6":{"start":{"line":22,"column":8},"end":{"line":22,"column":36}},"7":{"start":{"line":24,"column":8},"end":{"line":24,"column":31}},"8":{"start":{"line":27,"column":4},"end":{"line":27,"column":61}},"9":{"start":{"line":28,"column":4},"end":{"line":28,"column":26}},"10":{"start":{"line":31,"column":0},"end":{"line":31,"column":28}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]},"2":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":25},"end":{"line":19,"column":40}},{"start":{"line":19,"column":44},"end":{"line":19,"column":47}}]},"3":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":11},"end":{"line":21,"column":11}},{"start":{"line":21,"column":11},"end":{"line":21,"column":11}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","///--- Exports","","/**"," * JSONP formatter. like JSON, but with a callback invocation."," * @public"," * @function formatJSONP"," * @param    {Object} req  the request object"," * @param    {Object} res  the response object"," * @param    {Object} body response body"," * @param    {Function} cb cb"," * @returns  {String}"," */","function formatText(req, res, body, cb) {","    if (body instanceof Error) {","        res.statusCode = body.statusCode || 500;","        body = body.message;","    } else if (typeof (body) === 'object') {","        body = JSON.stringify(body);","    } else {","        body = body.toString();","    }","","    res.setHeader('Content-Length', Buffer.byteLength(body));","    return cb(null, body);","}","","module.exports = formatText;",""],"l":{"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"24":0,"27":0,"28":0,"31":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/binary.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/formatters/binary.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0},"fnMap":{"1":{"name":"formatBinary","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":42}}}},"statementMap":{"1":{"start":{"line":17,"column":0},"end":{"line":28,"column":1}},"2":{"start":{"line":18,"column":4},"end":{"line":20,"column":5}},"3":{"start":{"line":19,"column":8},"end":{"line":19,"column":48}},"4":{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},"5":{"start":{"line":23,"column":8},"end":{"line":23,"column":43}},"6":{"start":{"line":26,"column":4},"end":{"line":26,"column":49}},"7":{"start":{"line":27,"column":4},"end":{"line":27,"column":26}},"8":{"start":{"line":30,"column":0},"end":{"line":30,"column":30}}},"branchMap":{"1":{"line":18,"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":18,"column":4}},{"start":{"line":18,"column":4},"end":{"line":18,"column":4}}]},"2":{"line":19,"type":"binary-expr","locations":[{"start":{"line":19,"column":25},"end":{"line":19,"column":40}},{"start":{"line":19,"column":44},"end":{"line":19,"column":47}}]},"3":{"line":22,"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":22,"column":4}},{"start":{"line":22,"column":4},"end":{"line":22,"column":4}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","///--- Exports","","/**"," * binary formatter."," * @public"," * @function formatBinary"," * @param    {Object} req  the request object"," * @param    {Object} res  the response object"," * @param    {Object} body response body"," * @param    {Function} cb cb"," * @returns  {Buffer}"," */","function formatBinary(req, res, body, cb) {","    if (body instanceof Error) {","        res.statusCode = body.statusCode || 500;","    }","","    if (!Buffer.isBuffer(body)) {","        body = new Buffer(body.toString());","    }","","    res.setHeader('Content-Length', body.length);","    return cb(null, body);","}","","module.exports = formatBinary;",""],"l":{"17":1,"18":0,"19":0,"22":0,"23":0,"26":0,"27":0,"30":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/index.js","s":{"1":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":7,"column":0},"end":{"line":33,"column":2}}},"branchMap":{},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","///--- Exports","","module.exports = {","    acceptParser: require('./accept'),","    auditLogger: require('./audit'),","    authorizationParser: require('./authorization'),","    bodyParser: require('./body_parser'),","    conditionalRequest: require('./conditional_request'),","    CORS: require('./cors'),","    dateParser: require('./date'),","    jsonp: require('./jsonp'),","    urlEncodedBodyParser: require('./form_body_parser'),","    requestLogger: require('./bunyan'),","    gzipResponse: require('./gzip'),","    fullResponse: require('./full_response'),","    jsonBodyParser: require('./json_body_parser'),","    multipartBodyParser: require('./multipart_body_parser'),","    queryParser: require('./query'),","    requestExpiry: require('./request_expiry'),","    sanitizePath: require('./pre/pre_path'),","    serveStatic: require('./static'),","    throttle: require('./throttle'),","","    pre: {","        pause: require('./pre/pause'),","        sanitizePath: require('./pre/pre_path'),","        userAgentConnection: require('./pre/user_agent')","    }","};",""],"l":{"7":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/accept.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/accept.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"acceptParser","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":34}}},"2":{"name":"(anonymous_2)","line":30,"loc":{"start":{"line":30,"column":35},"end":{"line":30,"column":48}}},"3":{"name":"(anonymous_3)","line":32,"loc":{"start":{"line":32,"column":11},"end":{"line":32,"column":24}}},"4":{"name":"(anonymous_4)","line":34,"loc":{"start":{"line":34,"column":18},"end":{"line":34,"column":31}}},"5":{"name":"parseAccept","line":40,"loc":{"start":{"line":40,"column":4},"end":{"line":40,"column":41}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":65}},"4":{"start":{"line":24,"column":0},"end":{"line":51,"column":1}},"5":{"start":{"line":25,"column":4},"end":{"line":27,"column":5}},"6":{"start":{"line":26,"column":8},"end":{"line":26,"column":34}},"7":{"start":{"line":28,"column":4},"end":{"line":28,"column":51}},"8":{"start":{"line":30,"column":4},"end":{"line":36,"column":11}},"9":{"start":{"line":31,"column":8},"end":{"line":31,"column":19}},"10":{"start":{"line":33,"column":12},"end":{"line":33,"column":66}},"11":{"start":{"line":35,"column":12},"end":{"line":35,"column":23}},"12":{"start":{"line":38,"column":4},"end":{"line":38,"column":75}},"13":{"start":{"line":40,"column":4},"end":{"line":48,"column":5}},"14":{"start":{"line":41,"column":8},"end":{"line":44,"column":9}},"15":{"start":{"line":42,"column":12},"end":{"line":42,"column":19}},"16":{"start":{"line":43,"column":12},"end":{"line":43,"column":19}},"17":{"start":{"line":46,"column":8},"end":{"line":46,"column":20}},"18":{"start":{"line":47,"column":8},"end":{"line":47,"column":20}},"19":{"start":{"line":50,"column":4},"end":{"line":50,"column":25}},"20":{"start":{"line":53,"column":0},"end":{"line":53,"column":30}}},"branchMap":{"1":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":4}},{"start":{"line":25,"column":4},"end":{"line":25,"column":4}}]},"2":{"line":33,"type":"cond-expr","locations":[{"start":{"line":33,"column":46},"end":{"line":33,"column":60}},{"start":{"line":33,"column":63},"end":{"line":33,"column":64}}]},"3":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":8},"end":{"line":41,"column":8}},{"start":{"line":41,"column":8},"end":{"line":41,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","var mime = require('mime');","","var NotAcceptableError = require('../errors').NotAcceptableError;","","","/**"," * Returns a plugin that will check the client's Accept header can be handled"," * by this server."," *"," * Note you can get the set of types allowed from a restify server by doing"," * `server.acceptable`."," *"," * @public"," * @function acceptParser"," * @throws   {NotAcceptableError}"," * @param    {String}    acceptable array of accept types."," * @returns  {Function}             restify handler."," */","function acceptParser(acceptable) {","    if (!Array.isArray(acceptable)) {","        acceptable = [acceptable];","    }","    assert.arrayOfString(acceptable, 'acceptable');","","    acceptable = acceptable.filter(function (a) {","        return (a);","    }).map(function (a) {","            return ((a.indexOf('/') === -1) ? mime.lookup(a) : a);","        }).filter(function (a) {","            return (a);","        });","","    var e = new NotAcceptableError('Server accepts: ' + acceptable.join());","","    function parseAccept(req, res, next) {","        if (req.accepts(acceptable)) {","            next();","            return;","        }","","        res.json(e);","        next(false);","    }","","    return (parseAccept);","}","","module.exports = acceptParser;",""],"l":{"5":1,"6":1,"8":1,"24":1,"25":0,"26":0,"28":0,"30":0,"31":0,"33":0,"35":0,"38":0,"40":1,"41":0,"42":0,"43":0,"46":0,"47":0,"50":0,"53":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/audit.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/audit.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"auditLogger","line":26,"loc":{"start":{"line":26,"column":0},"end":{"line":26,"column":30}}},"2":{"name":"auditRequestSerializer","line":39,"loc":{"start":{"line":39,"column":17},"end":{"line":39,"column":54}}},"3":{"name":"(anonymous_3)","line":45,"loc":{"start":{"line":45,"column":43},"end":{"line":45,"column":59}}},"4":{"name":"auditResponseSerializer","line":66,"loc":{"start":{"line":66,"column":17},"end":{"line":66,"column":55}}},"5":{"name":"audit","line":92,"loc":{"start":{"line":92,"column":4},"end":{"line":92,"column":41}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":31}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":47}},"4":{"start":{"line":26,"column":0},"end":{"line":117,"column":1}},"5":{"start":{"line":27,"column":4},"end":{"line":27,"column":38}},"6":{"start":{"line":28,"column":4},"end":{"line":28,"column":46}},"7":{"start":{"line":29,"column":4},"end":{"line":29,"column":50}},"8":{"start":{"line":31,"column":4},"end":{"line":33,"column":5}},"9":{"start":{"line":32,"column":8},"end":{"line":32,"column":52}},"10":{"start":{"line":35,"column":4},"end":{"line":90,"column":7}},"11":{"start":{"line":40,"column":16},"end":{"line":42,"column":17}},"12":{"start":{"line":41,"column":20},"end":{"line":41,"column":35}},"13":{"start":{"line":44,"column":16},"end":{"line":44,"column":32}},"14":{"start":{"line":45,"column":16},"end":{"line":50,"column":19}},"15":{"start":{"line":46,"column":20},"end":{"line":46,"column":38}},"16":{"start":{"line":47,"column":20},"end":{"line":48,"column":39}},"17":{"start":{"line":49,"column":20},"end":{"line":49,"column":43}},"18":{"start":{"line":51,"column":16},"end":{"line":64,"column":19}},"19":{"start":{"line":67,"column":16},"end":{"line":69,"column":17}},"20":{"start":{"line":68,"column":20},"end":{"line":68,"column":35}},"21":{"start":{"line":72,"column":16},"end":{"line":72,"column":25}},"22":{"start":{"line":74,"column":16},"end":{"line":80,"column":17}},"23":{"start":{"line":75,"column":20},"end":{"line":79,"column":21}},"24":{"start":{"line":76,"column":24},"end":{"line":76,"column":46}},"25":{"start":{"line":78,"column":24},"end":{"line":78,"column":41}},"26":{"start":{"line":82,"column":16},"end":{"line":87,"column":19}},"27":{"start":{"line":92,"column":4},"end":{"line":114,"column":5}},"28":{"start":{"line":93,"column":8},"end":{"line":93,"column":47}},"29":{"start":{"line":95,"column":8},"end":{"line":97,"column":9}},"30":{"start":{"line":96,"column":12},"end":{"line":96,"column":45}},"31":{"start":{"line":99,"column":8},"end":{"line":109,"column":10}},"32":{"start":{"line":111,"column":8},"end":{"line":111,"column":53}},"33":{"start":{"line":113,"column":8},"end":{"line":113,"column":22}},"34":{"start":{"line":116,"column":4},"end":{"line":116,"column":19}},"35":{"start":{"line":122,"column":0},"end":{"line":122,"column":29}}},"branchMap":{"1":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":4}},{"start":{"line":31,"column":4},"end":{"line":31,"column":4}}]},"2":{"line":31,"type":"binary-expr","locations":[{"start":{"line":31,"column":8},"end":{"line":31,"column":31}},{"start":{"line":31,"column":35},"end":{"line":31,"column":62}}]},"3":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":16},"end":{"line":40,"column":16}},{"start":{"line":40,"column":16},"end":{"line":40,"column":16}}]},"4":{"line":45,"type":"binary-expr","locations":[{"start":{"line":45,"column":17},"end":{"line":45,"column":27}},{"start":{"line":45,"column":31},"end":{"line":45,"column":33}}]},"5":{"line":53,"type":"cond-expr","locations":[{"start":{"line":54,"column":28},"end":{"line":54,"column":39}},{"start":{"line":54,"column":42},"end":{"line":54,"column":51}}]},"6":{"line":61,"type":"cond-expr","locations":[{"start":{"line":62,"column":24},"end":{"line":62,"column":32}},{"start":{"line":62,"column":35},"end":{"line":62,"column":44}}]},"7":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":16},"end":{"line":67,"column":16}},{"start":{"line":67,"column":16},"end":{"line":67,"column":16}}]},"8":{"line":74,"type":"if","locations":[{"start":{"line":74,"column":16},"end":{"line":74,"column":16}},{"start":{"line":74,"column":16},"end":{"line":74,"column":16}}]},"9":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":20},"end":{"line":75,"column":20}},{"start":{"line":75,"column":20},"end":{"line":75,"column":20}}]},"10":{"line":85,"type":"binary-expr","locations":[{"start":{"line":85,"column":29},"end":{"line":85,"column":41}},{"start":{"line":85,"column":45},"end":{"line":85,"column":50}}]},"11":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":8},"end":{"line":95,"column":8}},{"start":{"line":95,"column":8},"end":{"line":95,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","var bunyan = require('bunyan');","","var HttpError = require('../errors').HttpError;","","","///--- API","","/**"," * Returns a Bunyan audit logger suitable to be used in a server.on('after')"," * event.  I.e.:"," *"," * server.on('after', restify.auditLogger({ log: myAuditStream }));"," *"," * This logs at the INFO level."," *"," * @public"," * @function auditLogger"," * @param   {Object}   options at least a bunyan logger (log)."," * @returns {Function}         to be used in server.after."," */","function auditLogger(options) {","    assert.object(options, 'options');","    assert.object(options.log, 'options.log');","    var errSerializer = bunyan.stdSerializers.err;","","    if (options.log.serializers && options.log.serializers.err) {","        errSerializer = options.log.serializers.err;","    }","","    var log = options.log.child({","        audit: true,","        serializers: {","            err: errSerializer,","            req: function auditRequestSerializer(req) {","                if (!req) {","                    return (false);","                }","","                var timers = {};","                (req.timers || []).forEach(function (time) {","                    var t = time.time;","                    var _t = Math.floor((1000000 * t[0]) +","                        (t[1] / 1000));","                    timers[time.name] = _t;","                });","                return ({","                    // account for native and queryParser plugin usage","                    query: (typeof req.query === 'function') ?","                            req.query() : req.query,","                    method: req.method,","                    url: req.url,","                    headers: req.headers,","                    httpVersion: req.httpVersion,","                    trailers: req.trailers,","                    version: req.version(),","                    body: options.body === true ?","                        req.body : undefined,","                    timers: timers","                });","            },","            res: function auditResponseSerializer(res) {","                if (!res) {","                    return (false);","                }","","","                var body;","","                if (options.body === true) {","                    if (res._body instanceof HttpError) {","                        body = res._body.body;","                    } else {","                        body = res._body;","                    }","                }","","                return ({","                    statusCode: res.statusCode,","                    headers: res._headers,","                    trailer: res._trailer || false,","                    body: body","                });","            }","        }","    });","","    function audit(req, res, route, err) {","        var latency = res.get('Response-Time');","","        if (typeof (latency) !== 'number') {","            latency = Date.now() - req._time;","        }","","        var obj = {","            remoteAddress: req.connection.remoteAddress,","            remotePort: req.connection.remotePort,","            req_id: req.getId(),","            req: req,","            res: res,","            err: err,","            latency: latency,","            secure: req.secure,","            _audit: true","        };","","        log.info(obj, 'handled: %d', res.statusCode);","","        return (true);","    }","","    return (audit);","}","","","///-- Exports","","module.exports = auditLogger;",""],"l":{"5":1,"6":1,"8":1,"26":1,"27":0,"28":0,"29":0,"31":0,"32":0,"35":0,"40":0,"41":0,"44":0,"45":0,"46":0,"47":0,"49":0,"51":0,"67":0,"68":0,"72":0,"74":0,"75":0,"76":0,"78":0,"82":0,"92":1,"93":0,"95":0,"96":0,"99":0,"111":0,"113":0,"116":0,"122":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/authorization.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/authorization.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"parseBasic","line":29,"loc":{"start":{"line":29,"column":0},"end":{"line":29,"column":28}}},"2":{"name":"parseSignature","line":69,"loc":{"start":{"line":69,"column":0},"end":{"line":69,"column":42}}},"3":{"name":"authorizationParser","line":104,"loc":{"start":{"line":104,"column":0},"end":{"line":104,"column":38}}},"4":{"name":"parseAuthorization","line":106,"loc":{"start":{"line":106,"column":4},"end":{"line":106,"column":48}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":46}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":34}},"3":{"start":{"line":12,"column":0},"end":{"line":12,"column":51}},"4":{"start":{"line":14,"column":0},"end":{"line":24,"column":2}},"5":{"start":{"line":29,"column":0},"end":{"line":66,"column":1}},"6":{"start":{"line":30,"column":4},"end":{"line":30,"column":16}},"7":{"start":{"line":31,"column":4},"end":{"line":31,"column":14}},"8":{"start":{"line":32,"column":4},"end":{"line":32,"column":15}},"9":{"start":{"line":34,"column":4},"end":{"line":34,"column":62}},"10":{"start":{"line":36,"column":4},"end":{"line":38,"column":5}},"11":{"start":{"line":37,"column":8},"end":{"line":37,"column":69}},"12":{"start":{"line":40,"column":4},"end":{"line":40,"column":33}},"13":{"start":{"line":42,"column":4},"end":{"line":46,"column":5}},"14":{"start":{"line":43,"column":8},"end":{"line":43,"column":27}},"15":{"start":{"line":45,"column":8},"end":{"line":45,"column":69}},"16":{"start":{"line":48,"column":4},"end":{"line":50,"column":5}},"17":{"start":{"line":49,"column":8},"end":{"line":49,"column":69}},"18":{"start":{"line":53,"column":4},"end":{"line":55,"column":5}},"19":{"start":{"line":54,"column":8},"end":{"line":54,"column":25}},"20":{"start":{"line":58,"column":4},"end":{"line":60,"column":5}},"21":{"start":{"line":59,"column":8},"end":{"line":59,"column":25}},"22":{"start":{"line":62,"column":4},"end":{"line":65,"column":7}},"23":{"start":{"line":69,"column":0},"end":{"line":79,"column":1}},"24":{"start":{"line":70,"column":4},"end":{"line":70,"column":28}},"25":{"start":{"line":71,"column":4},"end":{"line":71,"column":44}},"26":{"start":{"line":73,"column":4},"end":{"line":78,"column":5}},"27":{"start":{"line":74,"column":8},"end":{"line":74,"column":62}},"28":{"start":{"line":76,"column":8},"end":{"line":77,"column":23}},"29":{"start":{"line":104,"column":0},"end":{"line":150,"column":1}},"30":{"start":{"line":106,"column":4},"end":{"line":147,"column":5}},"31":{"start":{"line":107,"column":8},"end":{"line":107,"column":31}},"32":{"start":{"line":108,"column":8},"end":{"line":108,"column":35}},"33":{"start":{"line":110,"column":8},"end":{"line":112,"column":9}},"34":{"start":{"line":111,"column":12},"end":{"line":111,"column":28}},"35":{"start":{"line":114,"column":8},"end":{"line":114,"column":61}},"36":{"start":{"line":116,"column":8},"end":{"line":120,"column":9}},"37":{"start":{"line":117,"column":12},"end":{"line":118,"column":31}},"38":{"start":{"line":119,"column":12},"end":{"line":119,"column":29}},"39":{"start":{"line":122,"column":8},"end":{"line":122,"column":45}},"40":{"start":{"line":123,"column":8},"end":{"line":123,"column":50}},"41":{"start":{"line":125,"column":8},"end":{"line":144,"column":9}},"42":{"start":{"line":126,"column":12},"end":{"line":141,"column":13}},"43":{"start":{"line":128,"column":20},"end":{"line":128,"column":68}},"44":{"start":{"line":129,"column":20},"end":{"line":129,"column":68}},"45":{"start":{"line":130,"column":20},"end":{"line":130,"column":26}},"46":{"start":{"line":133,"column":20},"end":{"line":134,"column":53}},"47":{"start":{"line":135,"column":20},"end":{"line":136,"column":58}},"48":{"start":{"line":137,"column":20},"end":{"line":137,"column":26}},"49":{"start":{"line":140,"column":20},"end":{"line":140,"column":26}},"50":{"start":{"line":143,"column":12},"end":{"line":143,"column":30}},"51":{"start":{"line":146,"column":8},"end":{"line":146,"column":24}},"52":{"start":{"line":149,"column":4},"end":{"line":149,"column":32}},"53":{"start":{"line":152,"column":0},"end":{"line":152,"column":37}}},"branchMap":{"1":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":4},"end":{"line":36,"column":4}},{"start":{"line":36,"column":4},"end":{"line":36,"column":4}}]},"2":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":4},"end":{"line":42,"column":4}},{"start":{"line":42,"column":4},"end":{"line":42,"column":4}}]},"3":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":4},"end":{"line":48,"column":4}},{"start":{"line":48,"column":4},"end":{"line":48,"column":4}}]},"4":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":8},"end":{"line":48,"column":15}},{"start":{"line":48,"column":19},"end":{"line":48,"column":50}}]},"5":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":4},"end":{"line":53,"column":4}},{"start":{"line":53,"column":4},"end":{"line":53,"column":4}}]},"6":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":58,"column":4}},{"start":{"line":58,"column":4},"end":{"line":58,"column":4}}]},"7":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":14},"end":{"line":70,"column":21}},{"start":{"line":70,"column":25},"end":{"line":70,"column":27}}]},"8":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":8}},{"start":{"line":110,"column":8},"end":{"line":110,"column":8}}]},"9":{"line":116,"type":"if","locations":[{"start":{"line":116,"column":8},"end":{"line":116,"column":8}},{"start":{"line":116,"column":8},"end":{"line":116,"column":8}}]},"10":{"line":116,"type":"binary-expr","locations":[{"start":{"line":116,"column":12},"end":{"line":116,"column":19}},{"start":{"line":116,"column":23},"end":{"line":116,"column":42}}]},"11":{"line":126,"type":"switch","locations":[{"start":{"line":127,"column":16},"end":{"line":130,"column":26}},{"start":{"line":132,"column":16},"end":{"line":137,"column":26}},{"start":{"line":139,"column":16},"end":{"line":140,"column":26}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var httpSignature = require('http-signature');","","var errors = require('../errors');","","","///--- Globals","","var InvalidHeaderError = errors.InvalidHeaderError;","","var OPTIONS = {","    algorithms: [","        'rsa-sha1',","        'rsa-sha256',","        'rsa-sha512',","        'dsa-sha1',","        'hmac-sha1',","        'hmac-sha256',","        'hmac-sha512'","    ]","};","","","///--- Helpers","","function parseBasic(string) {","    var decoded;","    var index;","    var pieces;","","    decoded = (new Buffer(string, 'base64')).toString('utf8');","","    if (!decoded) {","        throw new InvalidHeaderError('Authorization header invalid');","    }","","    index = decoded.indexOf(':');","","    if (index === -1) {","        pieces = [decoded];","    } else {","        pieces = [decoded.slice(0, index), decoded.slice(index + 1)];","    }","","    if (!pieces || typeof (pieces[0]) !== 'string') {","        throw new InvalidHeaderError('Authorization header invalid');","    }","","    // Allows for usernameless authentication","    if (!pieces[0]) {","        pieces[0] = null;","    }","","    // Allows for passwordless authentication","    if (!pieces[1]) {","        pieces[1] = null;","    }","","    return ({","        username: pieces[0],","        password: pieces[1]","    });","}","","","function parseSignature(request, options) {","    options = options || {};","    options.algorithms = OPTIONS.algorithms;","","    try {","        return (httpSignature.parseRequest(request, options));","    } catch (e) {","        throw new InvalidHeaderError('Authorization header invalid: ' +","            e.message);","    }","}","","","/**"," * Returns a plugin that will parse the client's Authorization header."," *"," * Subsequent handlers will see `req.authorization`, which looks like:"," *"," * {"," *   scheme: <Basic|Signature|...>,"," *   credentials: <Undecoded value of header>,"," *   basic: {"," *     username: $user"," *     password: $password"," *   }"," * }"," *"," * `req.username` will also be set, and defaults to 'anonymous'."," *"," * @public"," * @function authorizationParser"," * @throws   {InvalidArgumentError}"," * @param    {Object} options an options object"," * @returns  {Function}"," */","function authorizationParser(options) {","","    function parseAuthorization(req, res, next) {","        req.authorization = {};","        req.username = 'anonymous';","","        if (!req.headers.authorization) {","            return (next());","        }","","        var pieces = req.headers.authorization.split(' ', 2);","","        if (!pieces || pieces.length !== 2) {","            var e = new InvalidHeaderError('BasicAuth content ' +","                'is invalid.');","            return (next(e));","        }","","        req.authorization.scheme = pieces[0];","        req.authorization.credentials = pieces[1];","","        try {","            switch (pieces[0].toLowerCase()) {","                case 'basic':","                    req.authorization.basic = parseBasic(pieces[1]);","                    req.username = req.authorization.basic.username;","                    break;","","                case 'signature':","                    req.authorization.signature =","                        parseSignature(req, options);","                    req.username =","                        req.authorization.signature.keyId;","                    break;","","                default:","                    break;","            }","        } catch (e2) {","            return (next(e2));","        }","","        return (next());","    }","","    return (parseAuthorization);","}","","module.exports = authorizationParser;",""],"l":{"5":1,"7":1,"12":1,"14":1,"29":1,"30":0,"31":0,"32":0,"34":0,"36":0,"37":0,"40":0,"42":0,"43":0,"45":0,"48":0,"49":0,"53":0,"54":0,"58":0,"59":0,"62":0,"69":1,"70":0,"71":0,"73":0,"74":0,"76":0,"104":1,"106":1,"107":0,"108":0,"110":0,"111":0,"114":0,"116":0,"117":0,"119":0,"122":0,"123":0,"125":0,"126":0,"128":0,"129":0,"130":0,"133":0,"135":0,"137":0,"140":0,"143":0,"146":0,"149":0,"152":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/body_parser.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/body_parser.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0,0,0,0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"bodyParser","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":29}}},"2":{"name":"parseBody","line":42,"loc":{"start":{"line":42,"column":4},"end":{"line":42,"column":39}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":34}},"3":{"start":{"line":9,"column":0},"end":{"line":9,"column":42}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":47}},"5":{"start":{"line":11,"column":0},"end":{"line":11,"column":47}},"6":{"start":{"line":12,"column":0},"end":{"line":12,"column":57}},"7":{"start":{"line":13,"column":0},"end":{"line":13,"column":65}},"8":{"start":{"line":18,"column":0},"end":{"line":18,"column":65}},"9":{"start":{"line":31,"column":0},"end":{"line":99,"column":1}},"10":{"start":{"line":32,"column":4},"end":{"line":32,"column":46}},"11":{"start":{"line":33,"column":4},"end":{"line":33,"column":28}},"12":{"start":{"line":34,"column":4},"end":{"line":34,"column":30}},"13":{"start":{"line":36,"column":4},"end":{"line":36,"column":35}},"14":{"start":{"line":37,"column":4},"end":{"line":37,"column":40}},"15":{"start":{"line":38,"column":4},"end":{"line":38,"column":40}},"16":{"start":{"line":39,"column":4},"end":{"line":39,"column":50}},"17":{"start":{"line":40,"column":4},"end":{"line":40,"column":54}},"18":{"start":{"line":42,"column":4},"end":{"line":96,"column":5}},"19":{"start":{"line":45,"column":8},"end":{"line":48,"column":9}},"20":{"start":{"line":46,"column":12},"end":{"line":46,"column":19}},"21":{"start":{"line":47,"column":12},"end":{"line":47,"column":19}},"22":{"start":{"line":50,"column":8},"end":{"line":55,"column":9}},"23":{"start":{"line":51,"column":12},"end":{"line":54,"column":13}},"24":{"start":{"line":52,"column":16},"end":{"line":52,"column":23}},"25":{"start":{"line":53,"column":16},"end":{"line":53,"column":23}},"26":{"start":{"line":57,"column":8},"end":{"line":60,"column":9}},"27":{"start":{"line":58,"column":12},"end":{"line":58,"column":19}},"28":{"start":{"line":59,"column":12},"end":{"line":59,"column":19}},"29":{"start":{"line":62,"column":8},"end":{"line":62,"column":19}},"30":{"start":{"line":63,"column":8},"end":{"line":63,"column":51}},"31":{"start":{"line":65,"column":8},"end":{"line":87,"column":9}},"32":{"start":{"line":67,"column":16},"end":{"line":67,"column":38}},"33":{"start":{"line":68,"column":16},"end":{"line":68,"column":22}},"34":{"start":{"line":70,"column":16},"end":{"line":70,"column":38}},"35":{"start":{"line":71,"column":16},"end":{"line":71,"column":22}},"36":{"start":{"line":73,"column":16},"end":{"line":73,"column":40}},"37":{"start":{"line":74,"column":16},"end":{"line":74,"column":22}},"38":{"start":{"line":76,"column":16},"end":{"line":76,"column":42}},"39":{"start":{"line":77,"column":16},"end":{"line":77,"column":22}},"40":{"start":{"line":79,"column":16},"end":{"line":79,"column":42}},"41":{"start":{"line":80,"column":16},"end":{"line":80,"column":22}},"42":{"start":{"line":82,"column":16},"end":{"line":82,"column":42}},"43":{"start":{"line":83,"column":16},"end":{"line":83,"column":22}},"44":{"start":{"line":86,"column":16},"end":{"line":86,"column":22}},"45":{"start":{"line":89,"column":8},"end":{"line":95,"column":9}},"46":{"start":{"line":90,"column":12},"end":{"line":90,"column":35}},"47":{"start":{"line":91,"column":15},"end":{"line":95,"column":9}},"48":{"start":{"line":92,"column":12},"end":{"line":92,"column":54}},"49":{"start":{"line":94,"column":12},"end":{"line":94,"column":19}},"50":{"start":{"line":98,"column":4},"end":{"line":98,"column":31}},"51":{"start":{"line":101,"column":0},"end":{"line":101,"column":28}}},"branchMap":{"1":{"line":33,"type":"binary-expr","locations":[{"start":{"line":33,"column":14},"end":{"line":33,"column":21}},{"start":{"line":33,"column":25},"end":{"line":33,"column":27}}]},"2":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":8},"end":{"line":45,"column":8}},{"start":{"line":45,"column":8},"end":{"line":45,"column":8}}]},"3":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":8},"end":{"line":50,"column":8}},{"start":{"line":50,"column":8},"end":{"line":50,"column":8}}]},"4":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":12},"end":{"line":51,"column":12}},{"start":{"line":51,"column":12},"end":{"line":51,"column":12}}]},"5":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":57,"column":8}},{"start":{"line":57,"column":8},"end":{"line":57,"column":8}}]},"6":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":12},"end":{"line":57,"column":37}},{"start":{"line":57,"column":41},"end":{"line":57,"column":57}}]},"7":{"line":65,"type":"switch","locations":[{"start":{"line":66,"column":12},"end":{"line":68,"column":22}},{"start":{"line":69,"column":12},"end":{"line":71,"column":22}},{"start":{"line":72,"column":12},"end":{"line":74,"column":22}},{"start":{"line":75,"column":12},"end":{"line":77,"column":22}},{"start":{"line":78,"column":12},"end":{"line":80,"column":22}},{"start":{"line":81,"column":12},"end":{"line":83,"column":22}},{"start":{"line":85,"column":12},"end":{"line":86,"column":22}}]},"8":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":8},"end":{"line":89,"column":8}},{"start":{"line":89,"column":8},"end":{"line":89,"column":8}}]},"9":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":15},"end":{"line":91,"column":15}},{"start":{"line":91,"column":15},"end":{"line":91,"column":15}}]},"10":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":19},"end":{"line":91,"column":26}},{"start":{"line":91,"column":30},"end":{"line":91,"column":51}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","","var errors = require('../errors');","","var bodyReader = require('./body_reader');","var jsonParser = require('./json_body_parser');","var formParser = require('./form_body_parser');","var multipartParser = require('./multipart_body_parser');","var fieldedTextParser = require('./fielded_text_body_parser.js');","","","///--- Globals","","var UnsupportedMediaTypeError = errors.UnsupportedMediaTypeError;","","","///--- API","","/**"," * parse the body of an incoming request."," * @public"," * @function bodyParser"," * @throws   {UnsupportedMediaTypeError}"," * @param    {Object} options an option object"," * @returns  {Array}"," */","function bodyParser(options) {","    assert.optionalObject(options, 'options');","    options = options || {};","    options.bodyReader = true;","","    var read = bodyReader(options);","    var parseForm = formParser(options);","    var parseJson = jsonParser(options);","    var parseMultipart = multipartParser(options);","    var parseFieldedText = fieldedTextParser(options);","","    function parseBody(req, res, next) {","        // Allow use of 'requestBodyOnGet' flag to allow for merging of","        // the request body of a GET request into req.params","        if (req.method === 'HEAD') {","            next();","            return;","        }","","        if (req.method === 'GET') {","            if (!options.requestBodyOnGet) {","                next();","                return;","            }","        }","","        if (req.contentLength() === 0 && !req.isChunked()) {","            next();","            return;","        }","","        var parser;","        var type = req.contentType().toLowerCase();","","        switch (type) {","            case 'application/json':","                parser = parseJson[0];","                break;","            case 'application/x-www-form-urlencoded':","                parser = parseForm[0];","                break;","            case 'multipart/form-data':","                parser = parseMultipart;","                break;","            case 'text/tsv':","                parser = parseFieldedText;","                break;","            case 'text/tab-separated-values':","                parser = parseFieldedText;","                break;","            case 'text/csv':","                parser = parseFieldedText;","                break;","","            default:","                break;","        }","","        if (parser) {","            parser(req, res, next);","        } else if (options && options.rejectUnknown) {","            next(new UnsupportedMediaTypeError(type));","        } else {","            next();","        }","    }","","    return ([read, parseBody]);","}","","module.exports = bodyParser;",""],"l":{"5":1,"7":1,"9":1,"10":1,"11":1,"12":1,"13":1,"18":1,"31":1,"32":0,"33":0,"34":0,"36":0,"37":0,"38":0,"39":0,"40":0,"42":1,"45":0,"46":0,"47":0,"50":0,"51":0,"52":0,"53":0,"57":0,"58":0,"59":0,"62":0,"63":0,"65":0,"67":0,"68":0,"70":0,"71":0,"73":0,"74":0,"76":0,"77":0,"79":0,"80":0,"82":0,"83":0,"86":0,"89":0,"90":0,"91":0,"92":0,"94":0,"98":0,"101":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/body_reader.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/body_reader.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":0,"23":0,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":1},"b":{"1":[0,0],"2":[0,0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"fnMap":{"1":{"name":"createBodyWriter","line":24,"loc":{"start":{"line":24,"column":0},"end":{"line":24,"column":31}}},"2":{"name":"(anonymous_2)","line":40,"loc":{"start":{"line":40,"column":15},"end":{"line":40,"column":32}}},"3":{"name":"(anonymous_3)","line":43,"loc":{"start":{"line":43,"column":13},"end":{"line":43,"column":25}}},"4":{"name":"bodyReader","line":64,"loc":{"start":{"line":64,"column":0},"end":{"line":64,"column":29}}},"5":{"name":"readBody","line":70,"loc":{"start":{"line":70,"column":4},"end":{"line":70,"column":38}}},"6":{"name":"done","line":89,"loc":{"start":{"line":89,"column":8},"end":{"line":89,"column":24}}},"7":{"name":"onRequestData","line":133,"loc":{"start":{"line":133,"column":23},"end":{"line":133,"column":53}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":31}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":34}},"5":{"start":{"line":15,"column":0},"end":{"line":15,"column":43}},"6":{"start":{"line":16,"column":0},"end":{"line":16,"column":67}},"7":{"start":{"line":17,"column":0},"end":{"line":17,"column":55}},"8":{"start":{"line":19,"column":0},"end":{"line":19,"column":56}},"9":{"start":{"line":24,"column":0},"end":{"line":51,"column":1}},"10":{"start":{"line":25,"column":4},"end":{"line":25,"column":21}},"11":{"start":{"line":27,"column":4},"end":{"line":27,"column":40}},"12":{"start":{"line":28,"column":4},"end":{"line":28,"column":23}},"13":{"start":{"line":30,"column":4},"end":{"line":36,"column":5}},"14":{"start":{"line":35,"column":8},"end":{"line":35,"column":22}},"15":{"start":{"line":38,"column":4},"end":{"line":38,"column":29}},"16":{"start":{"line":39,"column":4},"end":{"line":50,"column":6}},"17":{"start":{"line":41,"column":12},"end":{"line":41,"column":32}},"18":{"start":{"line":44,"column":12},"end":{"line":44,"column":46}},"19":{"start":{"line":46,"column":12},"end":{"line":48,"column":13}},"20":{"start":{"line":47,"column":16},"end":{"line":47,"column":53}},"21":{"start":{"line":64,"column":0},"end":{"line":158,"column":1}},"22":{"start":{"line":65,"column":4},"end":{"line":65,"column":28}},"23":{"start":{"line":66,"column":4},"end":{"line":66,"column":38}},"24":{"start":{"line":68,"column":4},"end":{"line":68,"column":47}},"25":{"start":{"line":70,"column":4},"end":{"line":155,"column":5}},"26":{"start":{"line":71,"column":8},"end":{"line":76,"column":9}},"27":{"start":{"line":74,"column":12},"end":{"line":74,"column":19}},"28":{"start":{"line":75,"column":12},"end":{"line":75,"column":19}},"29":{"start":{"line":77,"column":8},"end":{"line":77,"column":47}},"30":{"start":{"line":79,"column":8},"end":{"line":79,"column":30}},"31":{"start":{"line":80,"column":8},"end":{"line":80,"column":19}},"32":{"start":{"line":81,"column":8},"end":{"line":81,"column":15}},"33":{"start":{"line":82,"column":8},"end":{"line":82,"column":17}},"34":{"start":{"line":83,"column":8},"end":{"line":83,"column":16}},"35":{"start":{"line":85,"column":8},"end":{"line":87,"column":9}},"36":{"start":{"line":86,"column":12},"end":{"line":86,"column":44}},"37":{"start":{"line":89,"column":8},"end":{"line":122,"column":9}},"38":{"start":{"line":90,"column":12},"end":{"line":90,"column":29}},"39":{"start":{"line":91,"column":12},"end":{"line":91,"column":29}},"40":{"start":{"line":93,"column":12},"end":{"line":108,"column":13}},"41":{"start":{"line":94,"column":16},"end":{"line":95,"column":32}},"42":{"start":{"line":100,"column":16},"end":{"line":104,"column":17}},"43":{"start":{"line":101,"column":20},"end":{"line":101,"column":65}},"44":{"start":{"line":103,"column":20},"end":{"line":103,"column":71}},"45":{"start":{"line":106,"column":16},"end":{"line":106,"column":35}},"46":{"start":{"line":107,"column":16},"end":{"line":107,"column":23}},"47":{"start":{"line":110,"column":12},"end":{"line":113,"column":13}},"48":{"start":{"line":111,"column":16},"end":{"line":111,"column":23}},"49":{"start":{"line":112,"column":16},"end":{"line":112,"column":23}},"50":{"start":{"line":115,"column":12},"end":{"line":119,"column":13}},"51":{"start":{"line":116,"column":16},"end":{"line":116,"column":72}},"52":{"start":{"line":117,"column":16},"end":{"line":117,"column":35}},"53":{"start":{"line":118,"column":16},"end":{"line":118,"column":23}},"54":{"start":{"line":121,"column":12},"end":{"line":121,"column":19}},"55":{"start":{"line":124,"column":8},"end":{"line":131,"column":9}},"56":{"start":{"line":125,"column":12},"end":{"line":125,"column":37}},"57":{"start":{"line":126,"column":12},"end":{"line":126,"column":44}},"58":{"start":{"line":127,"column":12},"end":{"line":127,"column":33}},"59":{"start":{"line":128,"column":12},"end":{"line":128,"column":45}},"60":{"start":{"line":130,"column":12},"end":{"line":130,"column":34}},"61":{"start":{"line":133,"column":8},"end":{"line":151,"column":11}},"62":{"start":{"line":134,"column":12},"end":{"line":140,"column":13}},"63":{"start":{"line":135,"column":16},"end":{"line":135,"column":46}},"64":{"start":{"line":137,"column":16},"end":{"line":139,"column":17}},"65":{"start":{"line":138,"column":20},"end":{"line":138,"column":27}},"66":{"start":{"line":142,"column":12},"end":{"line":144,"column":13}},"67":{"start":{"line":143,"column":16},"end":{"line":143,"column":45}},"68":{"start":{"line":146,"column":12},"end":{"line":150,"column":13}},"69":{"start":{"line":147,"column":16},"end":{"line":147,"column":32}},"70":{"start":{"line":149,"column":16},"end":{"line":149,"column":40}},"71":{"start":{"line":153,"column":8},"end":{"line":153,"column":32}},"72":{"start":{"line":154,"column":8},"end":{"line":154,"column":21}},"73":{"start":{"line":157,"column":4},"end":{"line":157,"column":22}},"74":{"start":{"line":160,"column":0},"end":{"line":160,"column":28}}},"branchMap":{"1":{"line":30,"type":"if","locations":[{"start":{"line":30,"column":4},"end":{"line":30,"column":4}},{"start":{"line":30,"column":4},"end":{"line":30,"column":4}}]},"2":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":8},"end":{"line":30,"column":20}},{"start":{"line":31,"column":8},"end":{"line":31,"column":42}},{"start":{"line":32,"column":8},"end":{"line":32,"column":59}},{"start":{"line":33,"column":8},"end":{"line":33,"column":45}},{"start":{"line":34,"column":8},"end":{"line":34,"column":44}}]},"3":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":12},"end":{"line":46,"column":12}},{"start":{"line":46,"column":12},"end":{"line":46,"column":12}}]},"4":{"line":65,"type":"binary-expr","locations":[{"start":{"line":65,"column":14},"end":{"line":65,"column":21}},{"start":{"line":65,"column":25},"end":{"line":65,"column":27}}]},"5":{"line":68,"type":"binary-expr","locations":[{"start":{"line":68,"column":22},"end":{"line":68,"column":41}},{"start":{"line":68,"column":45},"end":{"line":68,"column":46}}]},"6":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":8},"end":{"line":71,"column":8}},{"start":{"line":71,"column":8},"end":{"line":71,"column":8}}]},"7":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":13},"end":{"line":71,"column":41}},{"start":{"line":71,"column":45},"end":{"line":71,"column":61}},{"start":{"line":72,"column":12},"end":{"line":72,"column":55}},{"start":{"line":73,"column":12},"end":{"line":73,"column":60}}]},"8":{"line":85,"type":"if","locations":[{"start":{"line":85,"column":8},"end":{"line":85,"column":8}},{"start":{"line":85,"column":8},"end":{"line":85,"column":8}}]},"9":{"line":93,"type":"if","locations":[{"start":{"line":93,"column":12},"end":{"line":93,"column":12}},{"start":{"line":93,"column":12},"end":{"line":93,"column":12}}]},"10":{"line":93,"type":"binary-expr","locations":[{"start":{"line":93,"column":16},"end":{"line":93,"column":27}},{"start":{"line":93,"column":31},"end":{"line":93,"column":58}}]},"11":{"line":100,"type":"if","locations":[{"start":{"line":100,"column":16},"end":{"line":100,"column":16}},{"start":{"line":100,"column":16},"end":{"line":100,"column":16}}]},"12":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":12},"end":{"line":110,"column":12}},{"start":{"line":110,"column":12},"end":{"line":110,"column":12}}]},"13":{"line":115,"type":"if","locations":[{"start":{"line":115,"column":12},"end":{"line":115,"column":12}},{"start":{"line":115,"column":12},"end":{"line":115,"column":12}}]},"14":{"line":115,"type":"binary-expr","locations":[{"start":{"line":115,"column":16},"end":{"line":115,"column":20}},{"start":{"line":115,"column":24},"end":{"line":115,"column":64}}]},"15":{"line":124,"type":"if","locations":[{"start":{"line":124,"column":8},"end":{"line":124,"column":8}},{"start":{"line":124,"column":8},"end":{"line":124,"column":8}}]},"16":{"line":134,"type":"if","locations":[{"start":{"line":134,"column":12},"end":{"line":134,"column":12}},{"start":{"line":134,"column":12},"end":{"line":134,"column":12}}]},"17":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":16},"end":{"line":137,"column":16}},{"start":{"line":137,"column":16},"end":{"line":137,"column":16}}]},"18":{"line":142,"type":"if","locations":[{"start":{"line":142,"column":12},"end":{"line":142,"column":12}},{"start":{"line":142,"column":12},"end":{"line":142,"column":12}}]},"19":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":12},"end":{"line":146,"column":12}},{"start":{"line":146,"column":12},"end":{"line":146,"column":12}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var crypto = require('crypto');","var zlib = require('zlib');","","var assert = require('assert-plus');","","var errors = require('../errors');","","","///--- Globals","","var BadDigestError = errors.BadDigestError;","var RequestEntityTooLargeError = errors.RequestEntityTooLargeError;","var PayloadTooLargeError = errors.PayloadTooLargeError;","","var MD5_MSG = 'Content-MD5 \\'%s\\' didn\\'t match \\'%s\\'';","","","///--- Helpers","","function createBodyWriter(req) {","    var buffers = [];","","    var contentType = req.contentType();","    var isText = false;","","    if (!contentType ||","        contentType === 'application/json' ||","        contentType === 'application/x-www-form-urlencoded' ||","        contentType === 'multipart/form-data' ||","        contentType.substr(0, 5) === 'text/') {","        isText = true;","    }","","    req.body = new Buffer(0);","    return {","        write: function (chunk) {","            buffers.push(chunk);","        },","        end: function () {","            req.body = Buffer.concat(buffers);","","            if (isText) {","                req.body = req.body.toString('utf8');","            }","        }","    };","}","","","///--- API","","/**"," * reads the body of the request."," * @public"," * @function bodyReader"," * @throws   {BadDigestError | PayloadTooLargeError}"," * @param    {Object} options an options object"," * @returns  {Function}"," */","function bodyReader(options) {","    options = options || {};","    assert.object(options, 'options');","","    var maxBodySize = options.maxBodySize || 0;","","    function readBody(req, res, next) {","        if ((req.getContentLength() === 0 && !req.isChunked()) ||","            req.contentType() === 'multipart/form-data' ||","            req.contentType() === 'application/octet-stream') {","            next();","            return;","        }","        var bodyWriter = createBodyWriter(req);","","        var bytesReceived = 0;","        var digest;","        var gz;","        var hash;","        var md5;","","        if ((md5 = req.headers['content-md5'])) {","            hash = crypto.createHash('md5');","        }","","        function done() {","            var errorMessage;","            bodyWriter.end();","","            if (maxBodySize && bytesReceived > maxBodySize) {","                var msg = 'Request body size exceeds ' +","                    maxBodySize;","","                // Between Node 0.12 and 4 http status code messages changed","                // RequestEntityTooLarge was changed to PayloadTooLarge","                // this check is to maintain backwards compatibility","                if (PayloadTooLargeError !== undefined) {","                    errorMessage = new PayloadTooLargeError(msg);","                } else {","                    errorMessage = new RequestEntityTooLargeError(msg);","                }","","                next(errorMessage);","                return;","            }","","            if (!req.body.length) {","                next();","                return;","            }","","            if (hash && md5 !== (digest = hash.digest('base64'))) {","                errorMessage = new BadDigestError(MD5_MSG, md5, digest);","                next(errorMessage);","                return;","            }","","            next();","        }","","        if (req.headers['content-encoding'] === 'gzip') {","            gz = zlib.createGunzip();","            gz.on('data', bodyWriter.write);","            gz.once('end', done);","            req.once('end', gz.end.bind(gz));","        } else {","            req.once('end', done);","        }","","        req.on('data', function onRequestData(chunk) {","            if (maxBodySize) {","                bytesReceived += chunk.length;","","                if (bytesReceived > maxBodySize) {","                    return;","                }","            }","","            if (hash) {","                hash.update(chunk, 'binary');","            }","","            if (gz) {","                gz.write(chunk);","            } else {","                bodyWriter.write(chunk);","            }","        });","","        req.once('error', next);","        req.resume();","    }","","    return (readBody);","}","","module.exports = bodyReader;",""],"l":{"5":1,"6":1,"8":1,"10":1,"15":1,"16":1,"17":1,"19":1,"24":1,"25":0,"27":0,"28":0,"30":0,"35":0,"38":0,"39":0,"41":0,"44":0,"46":0,"47":0,"64":1,"65":0,"66":0,"68":0,"70":1,"71":0,"74":0,"75":0,"77":0,"79":0,"80":0,"81":0,"82":0,"83":0,"85":0,"86":0,"89":1,"90":0,"91":0,"93":0,"94":0,"100":0,"101":0,"103":0,"106":0,"107":0,"110":0,"111":0,"112":0,"115":0,"116":0,"117":0,"118":0,"121":0,"124":0,"125":0,"126":0,"127":0,"128":0,"130":0,"133":0,"134":0,"135":0,"137":0,"138":0,"142":0,"143":0,"146":0,"147":0,"149":0,"153":0,"154":0,"157":0,"160":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/json_body_parser.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/json_body_parser.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"jsonBodyParser","line":21,"loc":{"start":{"line":21,"column":0},"end":{"line":21,"column":33}}},"2":{"name":"parseJson","line":27,"loc":{"start":{"line":27,"column":4},"end":{"line":27,"column":39}}},"3":{"name":"(anonymous_3)","line":47,"loc":{"start":{"line":47,"column":44},"end":{"line":47,"column":57}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":42}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":34}},"4":{"start":{"line":21,"column":0},"end":{"line":75,"column":1}},"5":{"start":{"line":22,"column":4},"end":{"line":22,"column":46}},"6":{"start":{"line":23,"column":4},"end":{"line":23,"column":28}},"7":{"start":{"line":25,"column":4},"end":{"line":25,"column":42}},"8":{"start":{"line":27,"column":4},"end":{"line":66,"column":5}},"9":{"start":{"line":28,"column":8},"end":{"line":31,"column":9}},"10":{"start":{"line":29,"column":12},"end":{"line":29,"column":19}},"11":{"start":{"line":30,"column":12},"end":{"line":30,"column":19}},"12":{"start":{"line":33,"column":8},"end":{"line":33,"column":19}},"13":{"start":{"line":35,"column":8},"end":{"line":41,"column":9}},"14":{"start":{"line":36,"column":12},"end":{"line":36,"column":59}},"15":{"start":{"line":38,"column":12},"end":{"line":39,"column":28}},"16":{"start":{"line":40,"column":12},"end":{"line":40,"column":19}},"17":{"start":{"line":43,"column":8},"end":{"line":61,"column":9}},"18":{"start":{"line":44,"column":12},"end":{"line":58,"column":13}},"19":{"start":{"line":45,"column":16},"end":{"line":45,"column":36}},"20":{"start":{"line":46,"column":19},"end":{"line":58,"column":13}},"21":{"start":{"line":47,"column":16},"end":{"line":55,"column":19}},"22":{"start":{"line":48,"column":20},"end":{"line":48,"column":42}},"23":{"start":{"line":50,"column":20},"end":{"line":52,"column":21}},"24":{"start":{"line":51,"column":24},"end":{"line":51,"column":39}},"25":{"start":{"line":53,"column":20},"end":{"line":53,"column":46}},"26":{"start":{"line":54,"column":20},"end":{"line":54,"column":34}},"27":{"start":{"line":57,"column":16},"end":{"line":57,"column":50}},"28":{"start":{"line":60,"column":12},"end":{"line":60,"column":33}},"29":{"start":{"line":63,"column":8},"end":{"line":63,"column":26}},"30":{"start":{"line":65,"column":8},"end":{"line":65,"column":15}},"31":{"start":{"line":68,"column":4},"end":{"line":68,"column":19}},"32":{"start":{"line":70,"column":4},"end":{"line":72,"column":5}},"33":{"start":{"line":71,"column":8},"end":{"line":71,"column":40}},"34":{"start":{"line":73,"column":4},"end":{"line":73,"column":26}},"35":{"start":{"line":74,"column":4},"end":{"line":74,"column":19}},"36":{"start":{"line":77,"column":0},"end":{"line":77,"column":32}}},"branchMap":{"1":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":14},"end":{"line":23,"column":21}},{"start":{"line":23,"column":25},"end":{"line":23,"column":27}}]},"2":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":28,"column":8}},{"start":{"line":28,"column":8},"end":{"line":28,"column":8}}]},"3":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":12},"end":{"line":28,"column":55}},{"start":{"line":28,"column":59},"end":{"line":28,"column":68}}]},"4":{"line":43,"type":"if","locations":[{"start":{"line":43,"column":8},"end":{"line":43,"column":8}},{"start":{"line":43,"column":8},"end":{"line":43,"column":8}}]},"5":{"line":44,"type":"if","locations":[{"start":{"line":44,"column":12},"end":{"line":44,"column":12}},{"start":{"line":44,"column":12},"end":{"line":44,"column":12}}]},"6":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":19},"end":{"line":46,"column":19}},{"start":{"line":46,"column":19},"end":{"line":46,"column":19}}]},"7":{"line":46,"type":"binary-expr","locations":[{"start":{"line":46,"column":23},"end":{"line":46,"column":51}},{"start":{"line":46,"column":55},"end":{"line":46,"column":70}}]},"8":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":20},"end":{"line":50,"column":20}},{"start":{"line":50,"column":20},"end":{"line":50,"column":20}}]},"9":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":24},"end":{"line":50,"column":25}},{"start":{"line":50,"column":29},"end":{"line":50,"column":38}}]},"10":{"line":57,"type":"binary-expr","locations":[{"start":{"line":57,"column":29},"end":{"line":57,"column":35}},{"start":{"line":57,"column":39},"end":{"line":57,"column":49}}]},"11":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":4},"end":{"line":70,"column":4}},{"start":{"line":70,"column":4},"end":{"line":70,"column":4}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","","var bodyReader = require('./body_reader');","var errors = require('../errors');","","","///--- API","","/**"," * parses json body from the request."," * @public"," * @function jsonBodyParser"," * @param    {Object}               options an options object"," * @throws   {InvalidContentError}          on bad input"," * @returns  {Function}"," */","function jsonBodyParser(options) {","    assert.optionalObject(options, 'options');","    options = options || {};","","    var override = options.overrideParams;","","    function parseJson(req, res, next) {","        if (req.getContentType() !== 'application/json' || !req.body) {","            next();","            return;","        }","","        var params;","","        try {","            params = JSON.parse(req.body, options.reviver);","        } catch (e) {","            next(new errors.InvalidContentError('Invalid JSON: ' +","                e.message));","            return;","        }","","        if (options.mapParams !== false) {","            if (Array.isArray(params)) {","                req.params = params;","            } else if (typeof (params) === 'object' && params !== null) {","                Object.keys(params).forEach(function (k) {","                    var p = req.params[k];","","                    if (p && !override) {","                        return (false);","                    }","                    req.params[k] = params[k];","                    return (true);","                });","            } else {","                req.params = params || req.params;","            }","        } else {","            req._body = req.body;","        }","","        req.body = params;","","        next();","    }","","    var chain = [];","","    if (!options.bodyReader) {","        chain.push(bodyReader(options));","    }","    chain.push(parseJson);","    return (chain);","}","","module.exports = jsonBodyParser;",""],"l":{"5":1,"7":1,"8":1,"21":1,"22":0,"23":0,"25":0,"27":1,"28":0,"29":0,"30":0,"33":0,"35":0,"36":0,"38":0,"40":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"50":0,"51":0,"53":0,"54":0,"57":0,"60":0,"63":0,"65":0,"68":0,"70":0,"71":0,"73":0,"74":0,"77":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/form_body_parser.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/form_body_parser.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"urlEncodedBodyParser","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":39}}},"2":{"name":"parseUrlEncodedBody","line":37,"loc":{"start":{"line":37,"column":4},"end":{"line":37,"column":49}}},"3":{"name":"(anonymous_3)","line":48,"loc":{"start":{"line":48,"column":29},"end":{"line":48,"column":42}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":32}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":42}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":34}},"5":{"start":{"line":14,"column":0},"end":{"line":14,"column":52}},"6":{"start":{"line":31,"column":0},"end":{"line":78,"column":1}},"7":{"start":{"line":32,"column":4},"end":{"line":32,"column":28}},"8":{"start":{"line":33,"column":4},"end":{"line":33,"column":38}},"9":{"start":{"line":35,"column":4},"end":{"line":35,"column":42}},"10":{"start":{"line":37,"column":4},"end":{"line":69,"column":5}},"11":{"start":{"line":38,"column":8},"end":{"line":41,"column":9}},"12":{"start":{"line":39,"column":12},"end":{"line":39,"column":19}},"13":{"start":{"line":40,"column":12},"end":{"line":40,"column":19}},"14":{"start":{"line":43,"column":8},"end":{"line":65,"column":9}},"15":{"start":{"line":44,"column":12},"end":{"line":44,"column":53}},"16":{"start":{"line":46,"column":12},"end":{"line":61,"column":13}},"17":{"start":{"line":47,"column":16},"end":{"line":47,"column":47}},"18":{"start":{"line":48,"column":16},"end":{"line":57,"column":19}},"19":{"start":{"line":49,"column":20},"end":{"line":49,"column":42}},"20":{"start":{"line":51,"column":20},"end":{"line":53,"column":21}},"21":{"start":{"line":52,"column":24},"end":{"line":52,"column":39}},"22":{"start":{"line":55,"column":20},"end":{"line":55,"column":46}},"23":{"start":{"line":56,"column":20},"end":{"line":56,"column":34}},"24":{"start":{"line":59,"column":16},"end":{"line":59,"column":37}},"25":{"start":{"line":60,"column":16},"end":{"line":60,"column":34}},"26":{"start":{"line":63,"column":12},"end":{"line":63,"column":60}},"27":{"start":{"line":64,"column":12},"end":{"line":64,"column":19}},"28":{"start":{"line":67,"column":8},"end":{"line":67,"column":56}},"29":{"start":{"line":68,"column":8},"end":{"line":68,"column":15}},"30":{"start":{"line":71,"column":4},"end":{"line":71,"column":19}},"31":{"start":{"line":73,"column":4},"end":{"line":75,"column":5}},"32":{"start":{"line":74,"column":8},"end":{"line":74,"column":40}},"33":{"start":{"line":76,"column":4},"end":{"line":76,"column":36}},"34":{"start":{"line":77,"column":4},"end":{"line":77,"column":19}},"35":{"start":{"line":80,"column":0},"end":{"line":80,"column":38}}},"branchMap":{"1":{"line":32,"type":"binary-expr","locations":[{"start":{"line":32,"column":14},"end":{"line":32,"column":21}},{"start":{"line":32,"column":25},"end":{"line":32,"column":27}}]},"2":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":8},"end":{"line":38,"column":8}},{"start":{"line":38,"column":8},"end":{"line":38,"column":8}}]},"3":{"line":38,"type":"binary-expr","locations":[{"start":{"line":38,"column":12},"end":{"line":38,"column":46}},{"start":{"line":38,"column":50},"end":{"line":38,"column":59}}]},"4":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":12},"end":{"line":46,"column":12}},{"start":{"line":46,"column":12},"end":{"line":46,"column":12}}]},"5":{"line":51,"type":"if","locations":[{"start":{"line":51,"column":20},"end":{"line":51,"column":20}},{"start":{"line":51,"column":20},"end":{"line":51,"column":20}}]},"6":{"line":51,"type":"binary-expr","locations":[{"start":{"line":51,"column":24},"end":{"line":51,"column":25}},{"start":{"line":51,"column":29},"end":{"line":51,"column":38}}]},"7":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":4},"end":{"line":73,"column":4}},{"start":{"line":73,"column":4},"end":{"line":73,"column":4}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","var querystring = require('qs');","","var bodyReader = require('./body_reader');","var errors = require('../errors');","","","///--- Globals","","var MIME_TYPE = 'application/x-www-form-urlencoded';","","","///--- API","","/**"," * Returns a plugin that will parse the HTTP request body IFF the"," * contentType is application/x-www-form-urlencoded."," *"," * If req.params already contains a given key, that key is skipped and an"," * error is logged."," *"," * @public"," * @function urlEncodedBodyParser"," * @param   {Object}    options an option sobject"," * @returns {Function}"," */","function urlEncodedBodyParser(options) {","    options = options || {};","    assert.object(options, 'options');","","    var override = options.overrideParams;","","    function parseUrlEncodedBody(req, res, next) {","        if (req.getContentType() !== MIME_TYPE || !req.body) {","            next();","            return;","        }","","        try {","            var params = querystring.parse(req.body);","","            if (options.mapParams !== false) {","                var keys = Object.keys(params);","                keys.forEach(function (k) {","                    var p = req.params[k];","","                    if (p && !override) {","                        return (false);","                    }","","                    req.params[k] = params[k];","                    return (true);","                });","            } else {","                req._body = req.body;","                req.body = params;","            }","        } catch (e) {","            next(new errors.InvalidContentError(e.message));","            return;","        }","","        req.log.trace('req.params now: %j', req.params);","        next();","    }","","    var chain = [];","","    if (!options.bodyReader) {","        chain.push(bodyReader(options));","    }","    chain.push(parseUrlEncodedBody);","    return (chain);","}","","module.exports = urlEncodedBodyParser;",""],"l":{"5":1,"6":1,"8":1,"9":1,"14":1,"31":1,"32":0,"33":0,"35":0,"37":1,"38":0,"39":0,"40":0,"43":0,"44":0,"46":0,"47":0,"48":0,"49":0,"51":0,"52":0,"55":0,"56":0,"59":0,"60":0,"63":0,"64":0,"67":0,"68":0,"71":0,"73":0,"74":0,"76":0,"77":0,"80":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/multipart_body_parser.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/multipart_body_parser.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"multipartBodyParser","line":30,"loc":{"start":{"line":30,"column":0},"end":{"line":30,"column":38}}},"2":{"name":"parseMultipartBody","line":49,"loc":{"start":{"line":49,"column":4},"end":{"line":49,"column":48}}},"3":{"name":"onPart","line":76,"loc":{"start":{"line":76,"column":22},"end":{"line":76,"column":44}}},"4":{"name":"(anonymous_4)","line":86,"loc":{"start":{"line":86,"column":24},"end":{"line":86,"column":54}}},"5":{"name":"(anonymous_5)","line":95,"loc":{"start":{"line":95,"column":44},"end":{"line":95,"column":57}}},"6":{"name":"(anonymous_6)","line":105,"loc":{"start":{"line":105,"column":40},"end":{"line":105,"column":52}}},"7":{"name":"(anonymous_7)","line":110,"loc":{"start":{"line":110,"column":47},"end":{"line":110,"column":60}}},"8":{"name":"(anonymous_8)","line":115,"loc":{"start":{"line":115,"column":51},"end":{"line":115,"column":71}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":23}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":39}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":27}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":31}},"6":{"start":{"line":12,"column":0},"end":{"line":12,"column":34}},"7":{"start":{"line":30,"column":0},"end":{"line":147,"column":1}},"8":{"start":{"line":31,"column":4},"end":{"line":33,"column":5}},"9":{"start":{"line":32,"column":8},"end":{"line":32,"column":21}},"10":{"start":{"line":34,"column":4},"end":{"line":34,"column":38}},"11":{"start":{"line":35,"column":4},"end":{"line":35,"column":74}},"12":{"start":{"line":36,"column":4},"end":{"line":36,"column":64}},"13":{"start":{"line":37,"column":4},"end":{"line":37,"column":74}},"14":{"start":{"line":38,"column":4},"end":{"line":38,"column":66}},"15":{"start":{"line":39,"column":4},"end":{"line":39,"column":74}},"16":{"start":{"line":40,"column":4},"end":{"line":40,"column":56}},"17":{"start":{"line":41,"column":4},"end":{"line":42,"column":56}},"18":{"start":{"line":43,"column":4},"end":{"line":43,"column":78}},"19":{"start":{"line":44,"column":4},"end":{"line":44,"column":64}},"20":{"start":{"line":45,"column":4},"end":{"line":45,"column":62}},"21":{"start":{"line":47,"column":4},"end":{"line":47,"column":42}},"22":{"start":{"line":49,"column":4},"end":{"line":144,"column":5}},"23":{"start":{"line":50,"column":8},"end":{"line":50,"column":26}},"24":{"start":{"line":52,"column":8},"end":{"line":55,"column":9}},"25":{"start":{"line":54,"column":12},"end":{"line":54,"column":28}},"26":{"start":{"line":57,"column":8},"end":{"line":57,"column":49}},"27":{"start":{"line":61,"column":8},"end":{"line":61,"column":52}},"28":{"start":{"line":62,"column":8},"end":{"line":62,"column":68}},"29":{"start":{"line":64,"column":8},"end":{"line":66,"column":9}},"30":{"start":{"line":65,"column":12},"end":{"line":65,"column":47}},"31":{"start":{"line":68,"column":8},"end":{"line":70,"column":9}},"32":{"start":{"line":69,"column":12},"end":{"line":69,"column":55}},"33":{"start":{"line":72,"column":8},"end":{"line":74,"column":9}},"34":{"start":{"line":73,"column":12},"end":{"line":73,"column":37}},"35":{"start":{"line":76,"column":8},"end":{"line":84,"column":10}},"36":{"start":{"line":77,"column":12},"end":{"line":83,"column":13}},"37":{"start":{"line":78,"column":16},"end":{"line":78,"column":56}},"38":{"start":{"line":79,"column":19},"end":{"line":83,"column":13}},"39":{"start":{"line":80,"column":16},"end":{"line":80,"column":52}},"40":{"start":{"line":82,"column":16},"end":{"line":82,"column":38}},"41":{"start":{"line":86,"column":8},"end":{"line":141,"column":11}},"42":{"start":{"line":87,"column":12},"end":{"line":89,"column":13}},"43":{"start":{"line":88,"column":16},"end":{"line":88,"column":71}},"44":{"start":{"line":91,"column":12},"end":{"line":91,"column":30}},"45":{"start":{"line":92,"column":12},"end":{"line":92,"column":30}},"46":{"start":{"line":94,"column":12},"end":{"line":139,"column":13}},"47":{"start":{"line":95,"column":16},"end":{"line":101,"column":19}},"48":{"start":{"line":96,"column":20},"end":{"line":98,"column":21}},"49":{"start":{"line":97,"column":24},"end":{"line":97,"column":31}},"50":{"start":{"line":100,"column":20},"end":{"line":100,"column":46}},"51":{"start":{"line":103,"column":16},"end":{"line":136,"column":17}},"52":{"start":{"line":104,"column":20},"end":{"line":104,"column":51}},"53":{"start":{"line":105,"column":20},"end":{"line":107,"column":23}},"54":{"start":{"line":106,"column":24},"end":{"line":106,"column":38}},"55":{"start":{"line":109,"column":20},"end":{"line":109,"column":40}},"56":{"start":{"line":110,"column":20},"end":{"line":132,"column":23}},"57":{"start":{"line":111,"column":24},"end":{"line":113,"column":25}},"58":{"start":{"line":112,"column":28},"end":{"line":112,"column":35}},"59":{"start":{"line":114,"column":24},"end":{"line":114,"column":48}},"60":{"start":{"line":115,"column":24},"end":{"line":131,"column":27}},"61":{"start":{"line":116,"column":28},"end":{"line":116,"column":51}},"62":{"start":{"line":125,"column":28},"end":{"line":128,"column":29}},"63":{"start":{"line":126,"column":32},"end":{"line":127,"column":69}},"64":{"start":{"line":129,"column":28},"end":{"line":129,"column":49}},"65":{"start":{"line":130,"column":28},"end":{"line":130,"column":42}},"66":{"start":{"line":133,"column":20},"end":{"line":133,"column":39}},"67":{"start":{"line":135,"column":20},"end":{"line":135,"column":34}},"68":{"start":{"line":138,"column":16},"end":{"line":138,"column":30}},"69":{"start":{"line":143,"column":8},"end":{"line":143,"column":23}},"70":{"start":{"line":146,"column":4},"end":{"line":146,"column":32}},"71":{"start":{"line":149,"column":0},"end":{"line":149,"column":37}}},"branchMap":{"1":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":4}},{"start":{"line":31,"column":4},"end":{"line":31,"column":4}}]},"2":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":8},"end":{"line":52,"column":8}},{"start":{"line":52,"column":8},"end":{"line":52,"column":8}}]},"3":{"line":52,"type":"binary-expr","locations":[{"start":{"line":52,"column":12},"end":{"line":52,"column":58}},{"start":{"line":53,"column":13},"end":{"line":53,"column":41}},{"start":{"line":53,"column":45},"end":{"line":53,"column":61}}]},"4":{"line":61,"type":"binary-expr","locations":[{"start":{"line":61,"column":25},"end":{"line":61,"column":42}},{"start":{"line":61,"column":46},"end":{"line":61,"column":51}}]},"5":{"line":62,"type":"cond-expr","locations":[{"start":{"line":62,"column":55},"end":{"line":62,"column":59}},{"start":{"line":62,"column":62},"end":{"line":62,"column":67}}]},"6":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":8},"end":{"line":64,"column":8}},{"start":{"line":64,"column":8},"end":{"line":64,"column":8}}]},"7":{"line":68,"type":"if","locations":[{"start":{"line":68,"column":8},"end":{"line":68,"column":8}},{"start":{"line":68,"column":8},"end":{"line":68,"column":8}}]},"8":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":8},"end":{"line":72,"column":8}},{"start":{"line":72,"column":8},"end":{"line":72,"column":8}}]},"9":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":12},"end":{"line":77,"column":12}},{"start":{"line":77,"column":12},"end":{"line":77,"column":12}}]},"10":{"line":77,"type":"binary-expr","locations":[{"start":{"line":77,"column":16},"end":{"line":77,"column":29}},{"start":{"line":77,"column":33},"end":{"line":77,"column":61}}]},"11":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":19},"end":{"line":79,"column":19}},{"start":{"line":79,"column":19},"end":{"line":79,"column":19}}]},"12":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":23},"end":{"line":79,"column":37}},{"start":{"line":79,"column":41},"end":{"line":79,"column":65}}]},"13":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":12},"end":{"line":87,"column":12}},{"start":{"line":87,"column":12},"end":{"line":87,"column":12}}]},"14":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":12},"end":{"line":94,"column":12}},{"start":{"line":94,"column":12},"end":{"line":94,"column":12}}]},"15":{"line":96,"type":"if","locations":[{"start":{"line":96,"column":20},"end":{"line":96,"column":20}},{"start":{"line":96,"column":20},"end":{"line":96,"column":20}}]},"16":{"line":96,"type":"binary-expr","locations":[{"start":{"line":96,"column":24},"end":{"line":96,"column":37}},{"start":{"line":96,"column":41},"end":{"line":96,"column":50}}]},"17":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":16},"end":{"line":103,"column":16}},{"start":{"line":103,"column":16},"end":{"line":103,"column":16}}]},"18":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":24},"end":{"line":111,"column":24}},{"start":{"line":111,"column":24},"end":{"line":111,"column":24}}]},"19":{"line":111,"type":"binary-expr","locations":[{"start":{"line":111,"column":28},"end":{"line":111,"column":41}},{"start":{"line":111,"column":45},"end":{"line":111,"column":54}}]},"20":{"line":125,"type":"if","locations":[{"start":{"line":125,"column":28},"end":{"line":125,"column":28}},{"start":{"line":125,"column":28},"end":{"line":125,"column":28}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var fs = require('fs');","","var assert = require('assert-plus');","var formidable = require('formidable');","var once = require('once');","var vasync = require('vasync');","","var errors = require('../errors');","","","","///--- API","","/**"," * Returns a plugin that will parse the HTTP request body IFF the"," * contentType is multipart/form-data"," *"," * If req.params already contains a given key, that key is skipped and an"," * error is logged."," * @public"," * @function multipartBodyParser"," * @param    {Object}          options an options object"," * @throws   {BadRequestError}"," * @returns  {Function}"," */","function multipartBodyParser(options) {","    if (!options) {","        options = {};","    }","    assert.object(options, 'options');","    assert.optionalBool(options.overrideParams, 'options.overrideParams');","    assert.optionalBool(options.multiples, 'options.multiples');","    assert.optionalBool(options.keepExtensions, 'options.keepExtensions');","    assert.optionalString(options.uploadDir, 'options.uploadDir');","    assert.optionalNumber(options.maxFieldsSize, 'options.maxFieldsSize');","    assert.optionalString(options.hash, 'options.hash');","    assert.optionalFunc(options.multipartFileHandler,","                        'options.multipartFileHandler');","    assert.optionalFunc(options.multipartHandler, 'options.multipartHandler');","    assert.optionalBool(options.mapParams, 'options.mapParams');","    assert.optionalBool(options.mapFiles, 'options.mapFiles');","","    var override = options.overrideParams;","","    function parseMultipartBody(req, res, next) {","        next = once(next);","","        if (req.getContentType() !== 'multipart/form-data' ||","            (req.getContentLength() === 0 && !req.isChunked())) {","            return (next());","        }","","        var form = new formidable.IncomingForm();","","        // enable multiple files on a single upload field","        // (html5 multiple attribute)","        form.multiples = options.multiples || false;","        form.keepExtensions = options.keepExtensions ? true : false;","","        if (options.uploadDir) {","            form.uploadDir = options.uploadDir;","        }","","        if (options.maxFieldsSize) {","            form.maxFieldsSize = options.maxFieldsSize;","        }","","        if (options.hash) {","            form.hash = options.hash;","        }","","        form.onPart = function onPart(part) {","            if (part.filename && options.multipartFileHandler) {","                options.multipartFileHandler(part, req);","            } else if (!part.filename && options.multipartHandler) {","                options.multipartHandler(part, req);","            } else {","                form.handlePart(part);","            }","        };","","        form.parse(req, function (err, fields, files) {","            if (err) {","                return (next(new errors.BadRequestError(err.message)));","            }","","            req.body = fields;","            req.files = files;","","            if (options.mapParams !== false) {","                Object.keys(fields).forEach(function (k) {","                    if (req.params[k] && !override) {","                        return;","                    }","","                    req.params[k] = fields[k];","                });","","                if (options.mapFiles) {","                    var barrier = vasync.barrier();","                    barrier.on('drain', function () {","                        return next();","                    });","","                    barrier.start('fs');","                    Object.keys(files).forEach(function (f) {","                        if (req.params[f] && !override) {","                            return;","                        }","                        barrier.start('fs' + f);","                        fs.readFile(files[f].path, function (ex, data) {","                            barrier.done('fs' + f);","                            /*","                             * We want to stop the request here, if there's an","                             * error trying to read the file from disk.","                             * Ideally we'd like to stop the other oustanding","                             * file reads too, but there's no way to cancel in","                             * flight fs reads.  So we just return an error, and","                             * be grudgingly let the other file reads finish.","                             */","                            if (ex) {","                                return next(new errors.InternalError(ex,","                                         'unable to read file' + f));","                            }","                            req.params[f] = data;","                            return (true);","                        });","                    });","                    barrier.done('fs');","                } else {","                    return next();","                }","            } else {","                return next();","            }","","        });","","        return (false);","    }","","    return (parseMultipartBody);","}","","module.exports = multipartBodyParser;",""],"l":{"5":1,"7":1,"8":1,"9":1,"10":1,"12":1,"30":1,"31":0,"32":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"43":0,"44":0,"45":0,"47":0,"49":1,"50":0,"52":0,"54":0,"57":0,"61":0,"62":0,"64":0,"65":0,"68":0,"69":0,"72":0,"73":0,"76":0,"77":0,"78":0,"79":0,"80":0,"82":0,"86":0,"87":0,"88":0,"91":0,"92":0,"94":0,"95":0,"96":0,"97":0,"100":0,"103":0,"104":0,"105":0,"106":0,"109":0,"110":0,"111":0,"112":0,"114":0,"115":0,"116":0,"125":0,"126":0,"129":0,"130":0,"133":0,"135":0,"138":0,"143":0,"146":0,"149":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/fielded_text_body_parser.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/fielded_text_body_parser.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"fieldedTextParser","line":20,"loc":{"start":{"line":20,"column":0},"end":{"line":20,"column":36}}},"2":{"name":"parseFieldedText","line":25,"loc":{"start":{"line":25,"column":4},"end":{"line":25,"column":46}}},"3":{"name":"(anonymous_3)","line":56,"loc":{"start":{"line":56,"column":43},"end":{"line":56,"column":70}}},"4":{"name":"(anonymous_4)","line":62,"loc":{"start":{"line":62,"column":31},"end":{"line":62,"column":53}}}},"statementMap":{"1":{"start":{"line":7,"column":0},"end":{"line":7,"column":25}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}},"3":{"start":{"line":20,"column":0},"end":{"line":73,"column":1}},"4":{"start":{"line":22,"column":4},"end":{"line":22,"column":46}},"5":{"start":{"line":23,"column":4},"end":{"line":23,"column":28}},"6":{"start":{"line":25,"column":4},"end":{"line":69,"column":5}},"7":{"start":{"line":27,"column":8},"end":{"line":27,"column":47}},"8":{"start":{"line":29,"column":8},"end":{"line":34,"column":9}},"9":{"start":{"line":32,"column":12},"end":{"line":32,"column":19}},"10":{"start":{"line":33,"column":12},"end":{"line":33,"column":19}},"11":{"start":{"line":37,"column":8},"end":{"line":37,"column":60}},"12":{"start":{"line":38,"column":8},"end":{"line":38,"column":54}},"13":{"start":{"line":39,"column":8},"end":{"line":39,"column":52}},"14":{"start":{"line":40,"column":8},"end":{"line":40,"column":56}},"15":{"start":{"line":43,"column":8},"end":{"line":43,"column":66}},"16":{"start":{"line":44,"column":8},"end":{"line":44,"column":58}},"17":{"start":{"line":45,"column":8},"end":{"line":45,"column":48}},"18":{"start":{"line":46,"column":8},"end":{"line":46,"column":44}},"19":{"start":{"line":47,"column":8},"end":{"line":47,"column":51}},"20":{"start":{"line":49,"column":8},"end":{"line":54,"column":10}},"21":{"start":{"line":56,"column":8},"end":{"line":67,"column":11}},"22":{"start":{"line":57,"column":12},"end":{"line":59,"column":13}},"23":{"start":{"line":58,"column":16},"end":{"line":58,"column":35}},"24":{"start":{"line":62,"column":12},"end":{"line":64,"column":15}},"25":{"start":{"line":63,"column":16},"end":{"line":63,"column":34}},"26":{"start":{"line":65,"column":12},"end":{"line":65,"column":34}},"27":{"start":{"line":66,"column":12},"end":{"line":66,"column":28}},"28":{"start":{"line":71,"column":4},"end":{"line":71,"column":30}},"29":{"start":{"line":75,"column":0},"end":{"line":75,"column":35}}},"branchMap":{"1":{"line":23,"type":"binary-expr","locations":[{"start":{"line":23,"column":14},"end":{"line":23,"column":21}},{"start":{"line":23,"column":25},"end":{"line":23,"column":27}}]},"2":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":8},"end":{"line":29,"column":8}},{"start":{"line":29,"column":8},"end":{"line":29,"column":8}}]},"3":{"line":29,"type":"binary-expr","locations":[{"start":{"line":29,"column":12},"end":{"line":29,"column":38}},{"start":{"line":30,"column":12},"end":{"line":30,"column":38}},{"start":{"line":31,"column":12},"end":{"line":31,"column":55}},{"start":{"line":31,"column":59},"end":{"line":31,"column":68}}]},"4":{"line":43,"type":"cond-expr","locations":[{"start":{"line":43,"column":55},"end":{"line":43,"column":59}},{"start":{"line":43,"column":62},"end":{"line":43,"column":65}}]},"5":{"line":44,"type":"cond-expr","locations":[{"start":{"line":44,"column":35},"end":{"line":44,"column":45}},{"start":{"line":44,"column":48},"end":{"line":44,"column":57}}]},"6":{"line":45,"type":"cond-expr","locations":[{"start":{"line":45,"column":33},"end":{"line":45,"column":40}},{"start":{"line":45,"column":43},"end":{"line":45,"column":47}}]},"7":{"line":46,"type":"cond-expr","locations":[{"start":{"line":46,"column":31},"end":{"line":46,"column":37}},{"start":{"line":46,"column":40},"end":{"line":46,"column":43}}]},"8":{"line":47,"type":"cond-expr","locations":[{"start":{"line":47,"column":35},"end":{"line":47,"column":43}},{"start":{"line":47,"column":46},"end":{"line":47,"column":50}}]},"9":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":12},"end":{"line":57,"column":12}},{"start":{"line":57,"column":12},"end":{"line":57,"column":12}}]}},"code":["/**"," * Dependencies"," */","","'use strict';","","var csv = require('csv');","var assert = require('assert-plus');","","///--- API","","/**"," * Returns a plugin that will parse the HTTP request body if the"," * contentType is `text/csv` or `text/tsv`"," * @public"," * @function fieldedTextParser"," * @param    {Object}    options an options object"," * @returns  {Function}"," */","function fieldedTextParser(options) {","","    assert.optionalObject(options, 'options');","    options = options || {};","","    function parseFieldedText(req, res, next) {","","        var contentType = req.getContentType();","","        if (contentType !== 'text/csv' &&","            contentType !== 'text/tsv' &&","            contentType !== 'text/tab-separated-values' || !req.body) {","            next();","            return;","        }","","","        var hDelimiter = req.headers['x-content-delimiter'];","        var hEscape = req.headers['x-content-escape'];","        var hQuote = req.headers['x-content-quote'];","        var hColumns = req.headers['x-content-columns'];","","","        var delimiter = (contentType === 'text/tsv') ? '\\t' : ',';","        delimiter = (hDelimiter) ? hDelimiter : delimiter;","        var escape = (hEscape) ? hEscape : '\\\\';","        var quote = (hQuote) ? hQuote : '\"';","        var columns = (hColumns) ? hColumns : true;","","        var parserOptions = {","            delimiter: delimiter,","            quote: quote,","            escape: escape,","            columns: columns","        };","","        csv.parse(req.body, parserOptions, function (err, parsedBody) {","            if (err) {","                return (next(err));","            }","","            // Add an \"index\" property to every row","            parsedBody.forEach(function (row, index) {","                row.index = index;","            });","            req.body = parsedBody;","            return (next());","        });","","    }","","    return (parseFieldedText);","","}","","module.exports = fieldedTextParser;",""],"l":{"7":1,"8":1,"20":1,"22":0,"23":0,"25":1,"27":0,"29":0,"32":0,"33":0,"37":0,"38":0,"39":0,"40":0,"43":0,"44":0,"45":0,"46":0,"47":0,"49":0,"56":0,"57":0,"58":0,"62":0,"63":0,"65":0,"66":0,"71":0,"75":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/conditional_request.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/conditional_request.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":1,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":1,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":1,"86":0,"87":0,"88":1},"b":{"1":[0,0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0,0],"18":[0,0],"19":[0,0,0],"20":[0,0],"21":[0,0],"22":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"checkIfMatch","line":22,"loc":{"start":{"line":22,"column":0},"end":{"line":22,"column":38}}},"2":{"name":"checkIfNoneMatch","line":59,"loc":{"start":{"line":59,"column":0},"end":{"line":59,"column":42}}},"3":{"name":"checkIfModified","line":102,"loc":{"start":{"line":102,"column":0},"end":{"line":102,"column":41}}},"4":{"name":"checkIfUnmodified","line":151,"loc":{"start":{"line":151,"column":0},"end":{"line":151,"column":43}}},"5":{"name":"conditionalRequest","line":188,"loc":{"start":{"line":188,"column":0},"end":{"line":188,"column":30}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":34}},"2":{"start":{"line":10,"column":0},"end":{"line":10,"column":45}},"3":{"start":{"line":11,"column":0},"end":{"line":11,"column":61}},"4":{"start":{"line":13,"column":0},"end":{"line":13,"column":64}},"5":{"start":{"line":14,"column":0},"end":{"line":14,"column":66}},"6":{"start":{"line":15,"column":0},"end":{"line":15,"column":76}},"7":{"start":{"line":16,"column":0},"end":{"line":16,"column":80}},"8":{"start":{"line":22,"column":0},"end":{"line":56,"column":1}},"9":{"start":{"line":23,"column":4},"end":{"line":23,"column":20}},"10":{"start":{"line":24,"column":4},"end":{"line":24,"column":12}},"11":{"start":{"line":25,"column":4},"end":{"line":25,"column":55}},"12":{"start":{"line":26,"column":4},"end":{"line":26,"column":16}},"13":{"start":{"line":27,"column":4},"end":{"line":27,"column":24}},"14":{"start":{"line":29,"column":4},"end":{"line":53,"column":5}},"15":{"start":{"line":31,"column":8},"end":{"line":31,"column":47}},"16":{"start":{"line":33,"column":8},"end":{"line":45,"column":9}},"17":{"start":{"line":34,"column":12},"end":{"line":34,"column":33}},"18":{"start":{"line":38,"column":12},"end":{"line":38,"column":42}},"19":{"start":{"line":39,"column":12},"end":{"line":39,"column":49}},"20":{"start":{"line":41,"column":12},"end":{"line":44,"column":13}},"21":{"start":{"line":42,"column":16},"end":{"line":42,"column":31}},"22":{"start":{"line":43,"column":16},"end":{"line":43,"column":22}},"23":{"start":{"line":47,"column":8},"end":{"line":52,"column":9}},"24":{"start":{"line":48,"column":12},"end":{"line":50,"column":22}},"25":{"start":{"line":51,"column":12},"end":{"line":51,"column":31}},"26":{"start":{"line":55,"column":4},"end":{"line":55,"column":20}},"27":{"start":{"line":59,"column":0},"end":{"line":99,"column":1}},"28":{"start":{"line":60,"column":4},"end":{"line":60,"column":20}},"29":{"start":{"line":61,"column":4},"end":{"line":61,"column":12}},"30":{"start":{"line":62,"column":4},"end":{"line":62,"column":55}},"31":{"start":{"line":63,"column":4},"end":{"line":63,"column":20}},"32":{"start":{"line":64,"column":4},"end":{"line":64,"column":24}},"33":{"start":{"line":66,"column":4},"end":{"line":96,"column":5}},"34":{"start":{"line":68,"column":8},"end":{"line":68,"column":51}},"35":{"start":{"line":70,"column":8},"end":{"line":81,"column":9}},"36":{"start":{"line":71,"column":12},"end":{"line":71,"column":33}},"37":{"start":{"line":74,"column":12},"end":{"line":74,"column":42}},"38":{"start":{"line":75,"column":12},"end":{"line":75,"column":49}},"39":{"start":{"line":77,"column":12},"end":{"line":80,"column":13}},"40":{"start":{"line":78,"column":16},"end":{"line":78,"column":31}},"41":{"start":{"line":79,"column":16},"end":{"line":79,"column":22}},"42":{"start":{"line":83,"column":8},"end":{"line":85,"column":9}},"43":{"start":{"line":84,"column":12},"end":{"line":84,"column":28}},"44":{"start":{"line":87,"column":8},"end":{"line":92,"column":9}},"45":{"start":{"line":88,"column":12},"end":{"line":90,"column":22}},"46":{"start":{"line":91,"column":12},"end":{"line":91,"column":31}},"47":{"start":{"line":94,"column":8},"end":{"line":94,"column":22}},"48":{"start":{"line":95,"column":8},"end":{"line":95,"column":29}},"49":{"start":{"line":98,"column":4},"end":{"line":98,"column":20}},"50":{"start":{"line":102,"column":0},"end":{"line":148,"column":1}},"51":{"start":{"line":103,"column":4},"end":{"line":103,"column":13}},"52":{"start":{"line":104,"column":4},"end":{"line":104,"column":12}},"53":{"start":{"line":105,"column":4},"end":{"line":105,"column":48}},"54":{"start":{"line":106,"column":4},"end":{"line":106,"column":63}},"55":{"start":{"line":108,"column":4},"end":{"line":111,"column":5}},"56":{"start":{"line":109,"column":8},"end":{"line":109,"column":15}},"57":{"start":{"line":110,"column":8},"end":{"line":110,"column":15}},"58":{"start":{"line":113,"column":4},"end":{"line":139,"column":5}},"59":{"start":{"line":122,"column":8},"end":{"line":135,"column":9}},"60":{"start":{"line":123,"column":12},"end":{"line":134,"column":13}},"61":{"start":{"line":126,"column":20},"end":{"line":126,"column":31}},"62":{"start":{"line":127,"column":20},"end":{"line":127,"column":26}},"63":{"start":{"line":130,"column":20},"end":{"line":132,"column":31}},"64":{"start":{"line":133,"column":20},"end":{"line":133,"column":26}},"65":{"start":{"line":137,"column":8},"end":{"line":137,"column":45}},"66":{"start":{"line":138,"column":8},"end":{"line":138,"column":15}},"67":{"start":{"line":141,"column":4},"end":{"line":145,"column":5}},"68":{"start":{"line":142,"column":8},"end":{"line":142,"column":23}},"69":{"start":{"line":143,"column":8},"end":{"line":143,"column":20}},"70":{"start":{"line":144,"column":8},"end":{"line":144,"column":15}},"71":{"start":{"line":147,"column":4},"end":{"line":147,"column":14}},"72":{"start":{"line":151,"column":0},"end":{"line":173,"column":1}},"73":{"start":{"line":152,"column":4},"end":{"line":152,"column":12}},"74":{"start":{"line":153,"column":4},"end":{"line":153,"column":51}},"75":{"start":{"line":154,"column":4},"end":{"line":154,"column":63}},"76":{"start":{"line":156,"column":4},"end":{"line":159,"column":5}},"77":{"start":{"line":157,"column":8},"end":{"line":157,"column":15}},"78":{"start":{"line":158,"column":8},"end":{"line":158,"column":15}},"79":{"start":{"line":161,"column":4},"end":{"line":170,"column":5}},"80":{"start":{"line":162,"column":8},"end":{"line":166,"column":9}},"81":{"start":{"line":163,"column":12},"end":{"line":165,"column":23}},"82":{"start":{"line":168,"column":8},"end":{"line":168,"column":45}},"83":{"start":{"line":169,"column":8},"end":{"line":169,"column":15}},"84":{"start":{"line":172,"column":4},"end":{"line":172,"column":14}},"85":{"start":{"line":188,"column":0},"end":{"line":196,"column":1}},"86":{"start":{"line":189,"column":4},"end":{"line":194,"column":6}},"87":{"start":{"line":195,"column":4},"end":{"line":195,"column":19}},"88":{"start":{"line":198,"column":0},"end":{"line":198,"column":36}}},"branchMap":{"1":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":15},"end":{"line":25,"column":23}},{"start":{"line":25,"column":27},"end":{"line":25,"column":48}},{"start":{"line":25,"column":52},"end":{"line":25,"column":54}}]},"2":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":4},"end":{"line":29,"column":4}},{"start":{"line":29,"column":4},"end":{"line":29,"column":4}}]},"3":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":12},"end":{"line":41,"column":12}},{"start":{"line":41,"column":12},"end":{"line":41,"column":12}}]},"4":{"line":41,"type":"binary-expr","locations":[{"start":{"line":41,"column":16},"end":{"line":41,"column":27}},{"start":{"line":41,"column":31},"end":{"line":41,"column":43}}]},"5":{"line":47,"type":"if","locations":[{"start":{"line":47,"column":8},"end":{"line":47,"column":8}},{"start":{"line":47,"column":8},"end":{"line":47,"column":8}}]},"6":{"line":62,"type":"binary-expr","locations":[{"start":{"line":62,"column":15},"end":{"line":62,"column":23}},{"start":{"line":62,"column":27},"end":{"line":62,"column":48}},{"start":{"line":62,"column":52},"end":{"line":62,"column":54}}]},"7":{"line":66,"type":"if","locations":[{"start":{"line":66,"column":4},"end":{"line":66,"column":4}},{"start":{"line":66,"column":4},"end":{"line":66,"column":4}}]},"8":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":12},"end":{"line":77,"column":12}},{"start":{"line":77,"column":12},"end":{"line":77,"column":12}}]},"9":{"line":77,"type":"binary-expr","locations":[{"start":{"line":77,"column":16},"end":{"line":77,"column":27}},{"start":{"line":77,"column":31},"end":{"line":77,"column":43}}]},"10":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":8},"end":{"line":83,"column":8}},{"start":{"line":83,"column":8},"end":{"line":83,"column":8}}]},"11":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":8},"end":{"line":87,"column":8}},{"start":{"line":87,"column":8},"end":{"line":87,"column":8}}]},"12":{"line":87,"type":"binary-expr","locations":[{"start":{"line":87,"column":12},"end":{"line":87,"column":32}},{"start":{"line":87,"column":36},"end":{"line":87,"column":57}}]},"13":{"line":106,"type":"binary-expr","locations":[{"start":{"line":106,"column":16},"end":{"line":106,"column":25}},{"start":{"line":106,"column":29},"end":{"line":106,"column":56}},{"start":{"line":106,"column":60},"end":{"line":106,"column":62}}]},"14":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":108,"column":4}},{"start":{"line":108,"column":4},"end":{"line":108,"column":4}}]},"15":{"line":108,"type":"binary-expr","locations":[{"start":{"line":108,"column":8},"end":{"line":108,"column":14}},{"start":{"line":108,"column":18},"end":{"line":108,"column":24}}]},"16":{"line":122,"type":"if","locations":[{"start":{"line":122,"column":8},"end":{"line":122,"column":8}},{"start":{"line":122,"column":8},"end":{"line":122,"column":8}}]},"17":{"line":123,"type":"switch","locations":[{"start":{"line":124,"column":16},"end":{"line":124,"column":27}},{"start":{"line":125,"column":16},"end":{"line":127,"column":26}},{"start":{"line":129,"column":16},"end":{"line":133,"column":26}}]},"18":{"line":141,"type":"if","locations":[{"start":{"line":141,"column":4},"end":{"line":141,"column":4}},{"start":{"line":141,"column":4},"end":{"line":141,"column":4}}]},"19":{"line":154,"type":"binary-expr","locations":[{"start":{"line":154,"column":16},"end":{"line":154,"column":25}},{"start":{"line":154,"column":29},"end":{"line":154,"column":56}},{"start":{"line":154,"column":60},"end":{"line":154,"column":62}}]},"20":{"line":156,"type":"if","locations":[{"start":{"line":156,"column":4},"end":{"line":156,"column":4}},{"start":{"line":156,"column":4},"end":{"line":156,"column":4}}]},"21":{"line":156,"type":"binary-expr","locations":[{"start":{"line":156,"column":8},"end":{"line":156,"column":14}},{"start":{"line":156,"column":18},"end":{"line":156,"column":24}}]},"22":{"line":162,"type":"if","locations":[{"start":{"line":162,"column":8},"end":{"line":162,"column":8}},{"start":{"line":162,"column":8},"end":{"line":162,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var errors = require('../errors');","","","///--- Globals","","var BadRequestError = errors.BadRequestError;","var PreconditionFailedError = errors.PreconditionFailedError;","","var IF_MATCH_FAIL = 'if-match \\'%s\\' didn\\'t match etag \\'%s\\'';","var IF_NO_MATCH_FAIL = 'if-none-match \\'%s\\' matched etag \\'%s\\'';","var IF_MOD_FAIL = 'object was modified at \\'%s\\'; if-modified-since \\'%s\\'';","var IF_UNMOD_FAIL = 'object was modified at \\'%s\\'; if-unmodified-since \\'%s\\'';","","","///--- API","// Reference RFC2616 section 14 for an explanation of what this all does.","","function checkIfMatch(req, res, next) {","    var clientETags;","    var cur;","    var etag = res.etag || res.getHeader('etag') || '';","    var ifMatch;","    var matched = false;","","    if ((ifMatch = req.headers['if-match'])) {","","        clientETags = ifMatch.split(/\\s*,\\s*/);","","        for (var i = 0; i < clientETags.length; i++) {","            cur = clientETags[i];","","            // only strong comparison","","            cur = cur.replace(/^W\\//, '');","            cur = cur.replace(/^\"(\\w*)\"$/, '$1');","","            if (cur === '*' || cur === etag) {","                matched = true;","                break;","            }","        }","","        if (!matched) {","            var err = new PreconditionFailedError(IF_MATCH_FAIL,","                ifMatch,","                etag);","            return (next(err));","        }","    }","","    return (next());","}","","","function checkIfNoneMatch(req, res, next) {","    var clientETags;","    var cur;","    var etag = res.etag || res.getHeader('etag') || '';","    var ifNoneMatch;","    var matched = false;","","    if ((ifNoneMatch = req.headers['if-none-match'])) {","","        clientETags = ifNoneMatch.split(/\\s*,\\s*/);","","        for (var i = 0; i < clientETags.length; i++) {","            cur = clientETags[i];","","            // ignore weak validation","            cur = cur.replace(/^W\\//, '');","            cur = cur.replace(/^\"(\\w*)\"$/, '$1');","","            if (cur === '*' || cur === etag) {","                matched = true;","                break;","            }","        }","","        if (!matched) {","            return (next());","        }","","        if (req.method !== 'GET' && req.method !== 'HEAD') {","            var err = new PreconditionFailedError(IF_NO_MATCH_FAIL,","                ifNoneMatch,","                etag);","            return (next(err));","        }","","        res.send(304);","        return (next(false));","    }","","    return (next());","}","","","function checkIfModified(req, res, next) {","    var code;","    var err;","    var ctime = req.header('if-modified-since');","    var mtime = res.mtime || res.header('Last-Modified') || '';","","    if (!mtime || !ctime) {","        next();","        return;","    }","","    try {","        //","        // TODO handle Range header modifications","        //","        // Note: this is not technically correct as per 2616 -","        // 2616 only specifies semantics for GET requests, not","        // any other method - but using if-modified-since with a","        // PUT or DELETE seems like returning 412 is sane","        //","        if (Date.parse(mtime) <= Date.parse(ctime)) {","            switch (req.method) {","                case 'GET':","                case 'HEAD':","                    code = 304;","                    break;","","                default:","                    err = new PreconditionFailedError(IF_MOD_FAIL,","                        mtime,","                        ctime);","                    break;","            }","        }","    } catch (e) {","        next(new BadRequestError(e.message));","        return;","    }","","    if (code !== undefined) {","        res.send(code);","        next(false);","        return;","    }","","    next(err);","}","","","function checkIfUnmodified(req, res, next) {","    var err;","    var ctime = req.headers['if-unmodified-since'];","    var mtime = res.mtime || res.header('Last-Modified') || '';","","    if (!mtime || !ctime) {","        next();","        return;","    }","","    try {","        if (Date.parse(mtime) > Date.parse(ctime)) {","            err = new PreconditionFailedError(IF_UNMOD_FAIL,","                mtime,","                ctime);","        }","    } catch (e) {","        next(new BadRequestError(e.message));","        return;","    }","","    next(err);","}","","","///--- Exports","","/**"," * Returns a set of plugins that will compare an already set ETag header with"," * the client's If-Match and If-None-Match header, and an already set"," * Last-Modified header with the client's If-Modified-Since and"," * If-Unmodified-Since header."," * @public"," * @throws {BadRequestError | PreconditionFailedError}"," * @function conditionalRequest"," * @returns  {Array}"," */","function conditionalRequest() {","    var chain = [","        checkIfMatch,","        checkIfNoneMatch,","        checkIfModified,","        checkIfUnmodified","    ];","    return (chain);","}","","module.exports = conditionalRequest;",""],"l":{"5":1,"10":1,"11":1,"13":1,"14":1,"15":1,"16":1,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"29":0,"31":0,"33":0,"34":0,"38":0,"39":0,"41":0,"42":0,"43":0,"47":0,"48":0,"51":0,"55":0,"59":1,"60":0,"61":0,"62":0,"63":0,"64":0,"66":0,"68":0,"70":0,"71":0,"74":0,"75":0,"77":0,"78":0,"79":0,"83":0,"84":0,"87":0,"88":0,"91":0,"94":0,"95":0,"98":0,"102":1,"103":0,"104":0,"105":0,"106":0,"108":0,"109":0,"110":0,"113":0,"122":0,"123":0,"126":0,"127":0,"130":0,"133":0,"137":0,"138":0,"141":0,"142":0,"143":0,"144":0,"147":0,"151":1,"152":0,"153":0,"154":0,"156":0,"157":0,"158":0,"161":0,"162":0,"163":0,"168":0,"169":0,"172":0,"188":1,"189":0,"195":0,"198":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/cors.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/cors.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":0,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"matchOrigin","line":38,"loc":{"start":{"line":38,"column":0},"end":{"line":38,"column":35}}},"2":{"name":"belongs","line":41,"loc":{"start":{"line":41,"column":4},"end":{"line":41,"column":24}}},"3":{"name":"cors","line":80,"loc":{"start":{"line":80,"column":0},"end":{"line":80,"column":20}}},"4":{"name":"(anonymous_4)","line":93,"loc":{"start":{"line":93,"column":27},"end":{"line":93,"column":40}}},"5":{"name":"restifyCORSSimple","line":100,"loc":{"start":{"line":100,"column":4},"end":{"line":100,"column":47}}},"6":{"name":"corsOnHeader","line":108,"loc":{"start":{"line":108,"column":8},"end":{"line":108,"column":32}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":10,"column":0},"end":{"line":18,"column":2}},"3":{"start":{"line":20,"column":0},"end":{"line":28,"column":2}},"4":{"start":{"line":31,"column":0},"end":{"line":31,"column":52}},"5":{"start":{"line":32,"column":0},"end":{"line":32,"column":56}},"6":{"start":{"line":33,"column":0},"end":{"line":33,"column":56}},"7":{"start":{"line":38,"column":0},"end":{"line":51,"column":1}},"8":{"start":{"line":39,"column":4},"end":{"line":39,"column":36}},"9":{"start":{"line":41,"column":4},"end":{"line":48,"column":5}},"10":{"start":{"line":42,"column":8},"end":{"line":45,"column":9}},"11":{"start":{"line":43,"column":12},"end":{"line":43,"column":23}},"12":{"start":{"line":44,"column":12},"end":{"line":44,"column":26}},"13":{"start":{"line":47,"column":8},"end":{"line":47,"column":23}},"14":{"start":{"line":50,"column":4},"end":{"line":50,"column":64}},"15":{"start":{"line":80,"column":0},"end":{"line":126,"column":1}},"16":{"start":{"line":81,"column":4},"end":{"line":81,"column":43}},"17":{"start":{"line":82,"column":4},"end":{"line":82,"column":22}},"18":{"start":{"line":83,"column":4},"end":{"line":83,"column":66}},"19":{"start":{"line":84,"column":4},"end":{"line":84,"column":65}},"20":{"start":{"line":85,"column":4},"end":{"line":85,"column":66}},"21":{"start":{"line":87,"column":4},"end":{"line":87,"column":40}},"22":{"start":{"line":88,"column":4},"end":{"line":88,"column":41}},"23":{"start":{"line":90,"column":4},"end":{"line":90,"column":48}},"24":{"start":{"line":91,"column":4},"end":{"line":91,"column":40}},"25":{"start":{"line":93,"column":4},"end":{"line":97,"column":7}},"26":{"start":{"line":94,"column":8},"end":{"line":96,"column":9}},"27":{"start":{"line":95,"column":12},"end":{"line":95,"column":28}},"28":{"start":{"line":100,"column":4},"end":{"line":123,"column":5}},"29":{"start":{"line":101,"column":8},"end":{"line":101,"column":19}},"30":{"start":{"line":103,"column":8},"end":{"line":106,"column":9}},"31":{"start":{"line":104,"column":12},"end":{"line":104,"column":19}},"32":{"start":{"line":105,"column":12},"end":{"line":105,"column":19}},"33":{"start":{"line":108,"column":8},"end":{"line":119,"column":9}},"34":{"start":{"line":109,"column":12},"end":{"line":109,"column":40}},"35":{"start":{"line":111,"column":12},"end":{"line":116,"column":13}},"36":{"start":{"line":112,"column":16},"end":{"line":112,"column":55}},"37":{"start":{"line":113,"column":16},"end":{"line":113,"column":54}},"38":{"start":{"line":115,"column":16},"end":{"line":115,"column":55}},"39":{"start":{"line":118,"column":12},"end":{"line":118,"column":65}},"40":{"start":{"line":121,"column":8},"end":{"line":121,"column":41}},"41":{"start":{"line":122,"column":8},"end":{"line":122,"column":15}},"42":{"start":{"line":125,"column":4},"end":{"line":125,"column":31}},"43":{"start":{"line":131,"column":0},"end":{"line":131,"column":22}},"44":{"start":{"line":134,"column":0},"end":{"line":134,"column":35}},"45":{"start":{"line":135,"column":0},"end":{"line":135,"column":37}},"46":{"start":{"line":136,"column":0},"end":{"line":136,"column":25}},"47":{"start":{"line":137,"column":0},"end":{"line":137,"column":18}},"48":{"start":{"line":138,"column":0},"end":{"line":138,"column":31}}},"branchMap":{"1":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":8},"end":{"line":42,"column":8}},{"start":{"line":42,"column":8},"end":{"line":42,"column":8}}]},"2":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":12},"end":{"line":42,"column":24}},{"start":{"line":42,"column":28},"end":{"line":42,"column":37}}]},"3":{"line":50,"type":"cond-expr","locations":[{"start":{"line":50,"column":48},"end":{"line":50,"column":54}},{"start":{"line":50,"column":57},"end":{"line":50,"column":62}}]},"4":{"line":50,"type":"binary-expr","locations":[{"start":{"line":50,"column":13},"end":{"line":50,"column":19}},{"start":{"line":50,"column":23},"end":{"line":50,"column":44}}]},"5":{"line":82,"type":"binary-expr","locations":[{"start":{"line":82,"column":11},"end":{"line":82,"column":15}},{"start":{"line":82,"column":19},"end":{"line":82,"column":21}}]},"6":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":19},"end":{"line":88,"column":31}},{"start":{"line":88,"column":35},"end":{"line":88,"column":40}}]},"7":{"line":90,"type":"binary-expr","locations":[{"start":{"line":90,"column":19},"end":{"line":90,"column":31}},{"start":{"line":90,"column":35},"end":{"line":90,"column":37}}]},"8":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":18},"end":{"line":91,"column":30}},{"start":{"line":91,"column":34},"end":{"line":91,"column":39}}]},"9":{"line":94,"type":"if","locations":[{"start":{"line":94,"column":8},"end":{"line":94,"column":8}},{"start":{"line":94,"column":8},"end":{"line":94,"column":8}}]},"10":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":8},"end":{"line":103,"column":8}},{"start":{"line":103,"column":8},"end":{"line":103,"column":8}}]},"11":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":12},"end":{"line":111,"column":12}},{"start":{"line":111,"column":12},"end":{"line":111,"column":12}}]}},"code":["// Copyright 2013 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","","","///--- Globals","","var ALLOW_HEADERS = [","    'accept',","    'accept-version',","    'content-type',","    'request-id',","    'origin',","    'x-api-version',","    'x-request-id'","];","","var EXPOSE_HEADERS = [","    'api-version',","    'content-length',","    'content-md5',","    'content-type',","    'date',","    'request-id',","    'response-time'","];","","// Normal","var AC_ALLOW_ORIGIN = 'Access-Control-Allow-Origin';","var AC_ALLOW_CREDS = 'Access-Control-Allow-Credentials';","var AC_EXPOSE_HEADERS = 'Access-Control-Expose-Headers';","","","///--- Internal Functions","","function matchOrigin(req, origins) {","    var origin = req.headers.origin;","","    function belongs(o) {","        if (origin === o || o === '*') {","            origin = o;","            return (true);","        }","","        return (false);","    }","","    return ((origin && origins.some(belongs)) ? origin : false);","}","","","///--- API","","/**"," * From http://www.w3.org/TR/cors/#resource-processing-model"," *"," * If \"simple\" request (paraphrased):"," *"," * 1. If the Origin header is not set, or if the value of Origin is not a"," *    case-sensitive match to any values listed in `opts.origins`, do not"," *    send any CORS headers"," *"," * 2. If the resource supports credentials add a single"," *    'Access-Control-Allow-Credentials' header with the value as \"true\", and"," *    ensure 'AC-Allow-Origin' is not '*', but is the request header value,"," *    otherwise add a single Access-Control-Allow-Origin header, with either the"," *    value of the Origin header or the string \"*\" as value"," *"," * 3. Add Access-Control-Expose-Headers as appropriate"," *"," * Pre-flight requests are handled by the router internally"," *"," * @public"," * @function cors"," * @param    {Object}   opts an options object"," * @returns  {Function}"," */","function cors(opts) {","    assert.optionalObject(opts, 'options');","    opts = opts || {};","    assert.optionalArrayOfString(opts.origins, 'options.origins');","    assert.optionalBool(opts.credentials, 'options.credentials');","    assert.optionalArrayOfString(opts.headers, 'options.headers');","","    cors.credentials = opts.credentials;","    cors.origins = opts.origins || ['*'];","","    var headers = (opts.headers || []).slice(0);","    var origins = opts.origins || ['*'];","","    EXPOSE_HEADERS.forEach(function (h) {","        if (headers.indexOf(h) === -1) {","            headers.push(h);","        }","    });","","    // Handler for simple requests","    function restifyCORSSimple(req, res, next) {","        var origin;","","        if (!(origin = matchOrigin(req, origins))) {","            next();","            return;","        }","","        function corsOnHeader() {","            origin = req.headers.origin;","","            if (opts.credentials) {","                res.setHeader(AC_ALLOW_ORIGIN, origin);","                res.setHeader(AC_ALLOW_CREDS, 'true');","            } else {","                res.setHeader(AC_ALLOW_ORIGIN, origin);","            }","","            res.setHeader(AC_EXPOSE_HEADERS, headers.join(', '));","        }","","        res.once('header', corsOnHeader);","        next();","    }","","    return (restifyCORSSimple);","}","","","///--- Exports","","module.exports = cors;","","// All of these are needed for the pre-flight code over in lib/router.js","cors.ALLOW_HEADERS = ALLOW_HEADERS;","cors.EXPOSE_HEADERS = EXPOSE_HEADERS;","cors.credentials = false;","cors.origins = [];","cors.matchOrigin = matchOrigin;",""],"l":{"5":1,"10":1,"20":1,"31":1,"32":1,"33":1,"38":1,"39":0,"41":1,"42":0,"43":0,"44":0,"47":0,"50":0,"80":1,"81":0,"82":0,"83":0,"84":0,"85":0,"87":0,"88":0,"90":0,"91":0,"93":0,"94":0,"95":0,"100":1,"101":0,"103":0,"104":0,"105":0,"108":1,"109":0,"111":0,"112":0,"113":0,"115":0,"118":0,"121":0,"122":0,"125":0,"131":1,"134":1,"135":1,"136":1,"137":1,"138":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/date.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/date.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"dateParser","line":32,"loc":{"start":{"line":32,"column":0},"end":{"line":32,"column":31}}},"2":{"name":"parseDate","line":40,"loc":{"start":{"line":40,"column":4},"end":{"line":40,"column":39}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":34}},"3":{"start":{"line":12,"column":0},"end":{"line":12,"column":51}},"4":{"start":{"line":13,"column":0},"end":{"line":13,"column":53}},"5":{"start":{"line":15,"column":0},"end":{"line":15,"column":39}},"6":{"start":{"line":16,"column":0},"end":{"line":16,"column":42}},"7":{"start":{"line":32,"column":0},"end":{"line":80,"column":1}},"8":{"start":{"line":33,"column":4},"end":{"line":35,"column":5}},"9":{"start":{"line":34,"column":8},"end":{"line":34,"column":24}},"10":{"start":{"line":36,"column":4},"end":{"line":36,"column":42}},"11":{"start":{"line":38,"column":4},"end":{"line":38,"column":33}},"12":{"start":{"line":40,"column":4},"end":{"line":77,"column":5}},"13":{"start":{"line":41,"column":8},"end":{"line":43,"column":9}},"14":{"start":{"line":42,"column":12},"end":{"line":42,"column":28}},"15":{"start":{"line":45,"column":8},"end":{"line":45,"column":14}},"16":{"start":{"line":46,"column":8},"end":{"line":46,"column":36}},"17":{"start":{"line":47,"column":8},"end":{"line":47,"column":26}},"18":{"start":{"line":49,"column":8},"end":{"line":74,"column":9}},"19":{"start":{"line":50,"column":12},"end":{"line":50,"column":33}},"20":{"start":{"line":51,"column":12},"end":{"line":51,"column":48}},"21":{"start":{"line":53,"column":12},"end":{"line":59,"column":13}},"22":{"start":{"line":54,"column":16},"end":{"line":58,"column":42}},"23":{"start":{"line":61,"column":12},"end":{"line":64,"column":13}},"24":{"start":{"line":62,"column":16},"end":{"line":62,"column":59}},"25":{"start":{"line":63,"column":16},"end":{"line":63,"column":33}},"26":{"start":{"line":68,"column":12},"end":{"line":70,"column":44}},"27":{"start":{"line":72,"column":12},"end":{"line":72,"column":54}},"28":{"start":{"line":73,"column":12},"end":{"line":73,"column":29}},"29":{"start":{"line":76,"column":8},"end":{"line":76,"column":24}},"30":{"start":{"line":79,"column":4},"end":{"line":79,"column":23}},"31":{"start":{"line":82,"column":0},"end":{"line":82,"column":28}}},"branchMap":{"1":{"line":33,"type":"if","locations":[{"start":{"line":33,"column":4},"end":{"line":33,"column":4}},{"start":{"line":33,"column":4},"end":{"line":33,"column":4}}]},"2":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":8},"end":{"line":41,"column":8}},{"start":{"line":41,"column":8},"end":{"line":41,"column":8}}]},"3":{"line":53,"type":"if","locations":[{"start":{"line":53,"column":12},"end":{"line":53,"column":12}},{"start":{"line":53,"column":12},"end":{"line":53,"column":12}}]},"4":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":12},"end":{"line":61,"column":12}},{"start":{"line":61,"column":12},"end":{"line":61,"column":12}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","","var errors = require('../errors');","","","///--- Globals","","var InvalidHeaderError = errors.InvalidHeaderError;","var RequestExpiredError = errors.RequestExpiredError;","","var BAD_MSG = 'Date header is invalid';","var OLD_MSG = 'Date header %s is too old';","","","///--- API","","/**"," * Returns a plugin that will parse the Date header (if present) and check for"," * an \"expired\" request, where expired means the request originated at a time"," * before ($now - $clockSkew). The default clockSkew allowance is 5m (thanks"," * Kerberos!)"," * @public"," * @function dateParser"," * @throws   {RequestExpiredError | InvalidHeaderError}"," * @param    {Number}    clockSkew optional age of time (in seconds)."," * @returns  {Function}            restify handler."," */","function dateParser(clockSkew) {","    if (!clockSkew) {","        clockSkew = 300;","    }","    assert.number(clockSkew, 'clockSkew');","","    clockSkew = clockSkew * 1000;","","    function parseDate(req, res, next) {","        if (!req.headers.date) {","            return (next());","        }","","        var e;","        var date = req.headers.date;","        var log = req.log;","","        try {","            var now = Date.now();","            var sent = new Date(date).getTime();","","            if (log.trace()) {","                log.trace({","                    allowedSkew: clockSkew,","                    now: now,","                    sent: sent","                }, 'Checking clock skew');","            }","","            if ((now - sent) > clockSkew) {","                e = new RequestExpiredError(OLD_MSG, date);","                return (next(e));","            }","","","        } catch (err) {","            log.trace({","                err: err","            }, 'Bad Date header: %s', date);","","            e = new InvalidHeaderError(BAD_MSG, date);","            return (next(e));","        }","","        return (next());","    }","","    return (parseDate);","}","","module.exports = dateParser;",""],"l":{"5":1,"7":1,"12":1,"13":1,"15":1,"16":1,"32":1,"33":0,"34":0,"36":0,"38":0,"40":1,"41":0,"42":0,"45":0,"46":0,"47":0,"49":0,"50":0,"51":0,"53":0,"54":0,"61":0,"62":0,"63":0,"68":0,"72":0,"73":0,"76":0,"79":0,"82":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/jsonp.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/jsonp.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"jsonp","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":17}}},"2":{"name":"_jsonp","line":17,"loc":{"start":{"line":17,"column":4},"end":{"line":17,"column":36}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":23}},"2":{"start":{"line":16,"column":0},"end":{"line":33,"column":1}},"3":{"start":{"line":17,"column":4},"end":{"line":30,"column":5}},"4":{"start":{"line":18,"column":8},"end":{"line":18,"column":31}},"5":{"start":{"line":21,"column":8},"end":{"line":23,"column":9}},"6":{"start":{"line":22,"column":12},"end":{"line":22,"column":36}},"7":{"start":{"line":25,"column":8},"end":{"line":27,"column":9}},"8":{"start":{"line":26,"column":12},"end":{"line":26,"column":68}},"9":{"start":{"line":29,"column":8},"end":{"line":29,"column":15}},"10":{"start":{"line":32,"column":4},"end":{"line":32,"column":20}},"11":{"start":{"line":36,"column":0},"end":{"line":36,"column":23}}},"branchMap":{"1":{"line":21,"type":"if","locations":[{"start":{"line":21,"column":8},"end":{"line":21,"column":8}},{"start":{"line":21,"column":8},"end":{"line":21,"column":8}}]},"2":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":8}},{"start":{"line":25,"column":8},"end":{"line":25,"column":8}}]},"3":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":12},"end":{"line":25,"column":30}},{"start":{"line":25,"column":34},"end":{"line":25,"column":49}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var qs = require('qs');","","","///--- API","","/**"," * parses the jsonp callback out of the request."," * @public"," * @function jsonp"," * @returns  {Function}"," */","function jsonp() {","    function _jsonp(req, res, next) {","        var q = req.getQuery();","","        // If the query plugin wasn't used, we need to hack it in now","        if (typeof (q) === 'string') {","            req.query = qs.parse(q);","        }","","        if (req.query.callback || req.query.jsonp) {","            res.setHeader('Content-Type', 'application/javascript');","        }","","        next();","    }","","    return (_jsonp);","}","","","module.exports = jsonp;",""],"l":{"5":1,"16":1,"17":1,"18":0,"21":0,"22":0,"25":0,"26":0,"29":0,"32":0,"36":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/bunyan.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/bunyan.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"requestLogger","line":19,"loc":{"start":{"line":19,"column":0},"end":{"line":19,"column":32}}},"2":{"name":"bunyan","line":37,"loc":{"start":{"line":37,"column":11},"end":{"line":37,"column":43}}},"3":{"name":"(anonymous_3)","line":46,"loc":{"start":{"line":46,"column":30},"end":{"line":46,"column":43}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":50}},"3":{"start":{"line":19,"column":0},"end":{"line":60,"column":1}},"4":{"start":{"line":20,"column":4},"end":{"line":20,"column":35}},"5":{"start":{"line":21,"column":4},"end":{"line":21,"column":28}},"6":{"start":{"line":23,"column":4},"end":{"line":23,"column":14}},"7":{"start":{"line":25,"column":4},"end":{"line":29,"column":5}},"8":{"start":{"line":26,"column":8},"end":{"line":26,"column":48}},"9":{"start":{"line":28,"column":8},"end":{"line":28,"column":19}},"10":{"start":{"line":31,"column":4},"end":{"line":33,"column":5}},"11":{"start":{"line":32,"column":8},"end":{"line":32,"column":48}},"12":{"start":{"line":35,"column":4},"end":{"line":35,"column":46}},"13":{"start":{"line":37,"column":4},"end":{"line":59,"column":6}},"14":{"start":{"line":38,"column":8},"end":{"line":41,"column":9}},"15":{"start":{"line":39,"column":12},"end":{"line":39,"column":19}},"16":{"start":{"line":40,"column":12},"end":{"line":40,"column":19}},"17":{"start":{"line":43,"column":8},"end":{"line":43,"column":41}},"18":{"start":{"line":45,"column":8},"end":{"line":45,"column":35}},"19":{"start":{"line":46,"column":8},"end":{"line":51,"column":11}},"20":{"start":{"line":48,"column":12},"end":{"line":50,"column":13}},"21":{"start":{"line":49,"column":16},"end":{"line":49,"column":42}},"22":{"start":{"line":52,"column":8},"end":{"line":52,"column":69}},"23":{"start":{"line":54,"column":8},"end":{"line":56,"column":9}},"24":{"start":{"line":55,"column":12},"end":{"line":55,"column":32}},"25":{"start":{"line":58,"column":8},"end":{"line":58,"column":15}},"26":{"start":{"line":65,"column":0},"end":{"line":65,"column":31}}},"branchMap":{"1":{"line":21,"type":"binary-expr","locations":[{"start":{"line":21,"column":14},"end":{"line":21,"column":21}},{"start":{"line":21,"column":25},"end":{"line":21,"column":27}}]},"2":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":25,"column":4}},{"start":{"line":25,"column":4},"end":{"line":25,"column":4}}]},"3":{"line":31,"type":"if","locations":[{"start":{"line":31,"column":4},"end":{"line":31,"column":4}},{"start":{"line":31,"column":4},"end":{"line":31,"column":4}}]},"4":{"line":35,"type":"binary-expr","locations":[{"start":{"line":35,"column":24},"end":{"line":35,"column":39}},{"start":{"line":35,"column":43},"end":{"line":35,"column":45}}]},"5":{"line":38,"type":"if","locations":[{"start":{"line":38,"column":8},"end":{"line":38,"column":8}},{"start":{"line":38,"column":8},"end":{"line":38,"column":8}}]},"6":{"line":38,"type":"binary-expr","locations":[{"start":{"line":38,"column":12},"end":{"line":38,"column":20}},{"start":{"line":38,"column":24},"end":{"line":38,"column":36}}]},"7":{"line":43,"type":"binary-expr","locations":[{"start":{"line":43,"column":18},"end":{"line":43,"column":25}},{"start":{"line":43,"column":29},"end":{"line":43,"column":40}}]},"8":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":12},"end":{"line":48,"column":12}},{"start":{"line":48,"column":12},"end":{"line":48,"column":12}}]},"9":{"line":52,"type":"cond-expr","locations":[{"start":{"line":52,"column":55},"end":{"line":52,"column":60}},{"start":{"line":52,"column":63},"end":{"line":52,"column":67}}]},"10":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":8},"end":{"line":54,"column":8}},{"start":{"line":54,"column":8},"end":{"line":54,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","","var shallowCopy = require('../utils').shallowCopy;","","","///--- API","","/**"," * attaches bunyan logger to the request."," * @public"," * @function requestLogger"," * @param    {Object}   options an options object"," * @returns  {Function}"," */","function requestLogger(options) {","    assert.optionalObject(options);","    options = options || {};","","    var props;","","    if (options.properties) {","        props = shallowCopy(options.properties);","    } else {","        props = {};","    }","","    if (options.serializers) {","        props.serializers = options.serializers;","    }","","    var headersToCopy = options.headers || [];","","    return function bunyan(req, res, next) {","        if (!req.log && !options.log) {","            next();","            return;","        }","","        var log = req.log || options.log;","","        props.req_id = req.getId();","        headersToCopy.forEach(function (k) {","","            if (req.headers[k]) {","                props[k] = req.headers[k];","            }","        });","        req.log = log.child(props, props.serializers ? false : true);","","        if (props.req_id) {","            delete props.req_id;","        }","","        next();","    };","}","","","///--- Exports","","module.exports = requestLogger;",""],"l":{"5":1,"7":1,"19":1,"20":0,"21":0,"23":0,"25":0,"26":0,"28":0,"31":0,"32":0,"35":0,"37":0,"38":0,"39":0,"40":0,"43":0,"45":0,"46":0,"48":0,"49":0,"52":0,"54":0,"55":0,"58":0,"65":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/gzip.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/gzip.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":1,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1},"b":{"1":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"_writeHead","line":10,"loc":{"start":{"line":10,"column":0},"end":{"line":10,"column":38}}},"2":{"name":"gzipResponse","line":25,"loc":{"start":{"line":25,"column":0},"end":{"line":25,"column":28}}},"3":{"name":"gzip","line":28,"loc":{"start":{"line":28,"column":4},"end":{"line":28,"column":34}}},"4":{"name":"_handledGzip","line":43,"loc":{"start":{"line":43,"column":26},"end":{"line":43,"column":50}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":27}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}},"3":{"start":{"line":10,"column":0},"end":{"line":13,"column":1}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":40}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":75}},"6":{"start":{"line":25,"column":0},"end":{"line":58,"column":1}},"7":{"start":{"line":26,"column":4},"end":{"line":26,"column":43}},"8":{"start":{"line":28,"column":4},"end":{"line":55,"column":5}},"9":{"start":{"line":29,"column":8},"end":{"line":32,"column":9}},"10":{"start":{"line":30,"column":12},"end":{"line":30,"column":19}},"11":{"start":{"line":31,"column":12},"end":{"line":31,"column":19}},"12":{"start":{"line":34,"column":8},"end":{"line":34,"column":39}},"13":{"start":{"line":36,"column":8},"end":{"line":36,"column":43}},"14":{"start":{"line":37,"column":8},"end":{"line":37,"column":42}},"15":{"start":{"line":38,"column":8},"end":{"line":38,"column":52}},"16":{"start":{"line":40,"column":8},"end":{"line":40,"column":34}},"17":{"start":{"line":41,"column":8},"end":{"line":41,"column":30}},"18":{"start":{"line":42,"column":8},"end":{"line":42,"column":42}},"19":{"start":{"line":43,"column":8},"end":{"line":47,"column":10}},"20":{"start":{"line":44,"column":12},"end":{"line":44,"column":34}},"21":{"start":{"line":45,"column":12},"end":{"line":45,"column":30}},"22":{"start":{"line":46,"column":12},"end":{"line":46,"column":42}},"23":{"start":{"line":49,"column":8},"end":{"line":49,"column":38}},"24":{"start":{"line":50,"column":8},"end":{"line":50,"column":34}},"25":{"start":{"line":52,"column":8},"end":{"line":52,"column":60}},"26":{"start":{"line":53,"column":8},"end":{"line":53,"column":50}},"27":{"start":{"line":54,"column":8},"end":{"line":54,"column":15}},"28":{"start":{"line":57,"column":4},"end":{"line":57,"column":18}},"29":{"start":{"line":63,"column":0},"end":{"line":63,"column":30}}},"branchMap":{"1":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":8},"end":{"line":29,"column":8}},{"start":{"line":29,"column":8},"end":{"line":29,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var zlib = require('zlib');","","var assert = require('assert-plus');","","","function _writeHead(originalFunction) {","    this.removeHeader('Content-Length');","    originalFunction.apply(this, Array.prototype.slice.call(arguments, 1));","}","","///--- API","","/**"," * gzips the response."," * https://github.com/restify/node-restify/issues/284"," * @public"," * @function gzipResponse"," * @param   {Object}   opts an options object"," * @returns {Function}"," */","function gzipResponse(opts) {","    assert.optionalObject(opts, 'options');","","    function gzip(req, res, next) {","        if (!req.acceptsEncoding('gzip')) {","            next();","            return;","        }","","        var gz = zlib.createGzip(opts);","","        gz.on('data', res.write.bind(res));","        gz.once('end', res.end.bind(res));","        gz.on('drain', res.emit.bind(res, 'drain'));","","        var origWrite = res.write;","        var origEnd = res.end;","        var origWriteHead = res.writeHead;","        res.handledGzip = function _handledGzip() {","            res.write = origWrite;","            res.end = origEnd;","            res.writeHead = origWriteHead;","        };","","        res.write = gz.write.bind(gz);","        res.end = gz.end.bind(gz);","","        res.writeHead = _writeHead.bind(res, res.writeHead);","        res.setHeader('Content-Encoding', 'gzip');","        next();","    }","","    return (gzip);","}","","","///--- Exports","","module.exports = gzipResponse;",""],"l":{"5":1,"7":1,"10":1,"11":0,"12":0,"25":1,"26":0,"28":1,"29":0,"30":0,"31":0,"34":0,"36":0,"37":0,"38":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"49":0,"50":0,"52":0,"53":0,"54":0,"57":0,"63":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/full_response.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/full_response.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":1,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"setHeaders","line":32,"loc":{"start":{"line":32,"column":0},"end":{"line":32,"column":30}}},"2":{"name":"fullResponse","line":101,"loc":{"start":{"line":101,"column":0},"end":{"line":101,"column":24}}},"3":{"name":"restifyResponseHeaders","line":102,"loc":{"start":{"line":102,"column":4},"end":{"line":102,"column":52}}},"4":{"name":"(anonymous_4)","line":103,"loc":{"start":{"line":103,"column":27},"end":{"line":103,"column":39}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":31}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":39}},"3":{"start":{"line":12,"column":0},"end":{"line":21,"column":13}},"4":{"start":{"line":23,"column":0},"end":{"line":27,"column":13}},"5":{"start":{"line":32,"column":0},"end":{"line":91,"column":1}},"6":{"start":{"line":33,"column":4},"end":{"line":33,"column":13}},"7":{"start":{"line":34,"column":4},"end":{"line":34,"column":25}},"8":{"start":{"line":35,"column":4},"end":{"line":35,"column":16}},"9":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"10":{"start":{"line":38,"column":8},"end":{"line":38,"column":58}},"11":{"start":{"line":41,"column":4},"end":{"line":43,"column":5}},"12":{"start":{"line":42,"column":8},"end":{"line":42,"column":69}},"13":{"start":{"line":45,"column":4},"end":{"line":50,"column":5}},"14":{"start":{"line":46,"column":8},"end":{"line":49,"column":9}},"15":{"start":{"line":47,"column":12},"end":{"line":47,"column":45}},"16":{"start":{"line":48,"column":12},"end":{"line":48,"column":67}},"17":{"start":{"line":52,"column":4},"end":{"line":54,"column":5}},"18":{"start":{"line":53,"column":8},"end":{"line":53,"column":71}},"19":{"start":{"line":56,"column":4},"end":{"line":59,"column":5}},"20":{"start":{"line":57,"column":8},"end":{"line":58,"column":56}},"21":{"start":{"line":61,"column":4},"end":{"line":65,"column":5}},"22":{"start":{"line":62,"column":8},"end":{"line":62,"column":40}},"23":{"start":{"line":63,"column":8},"end":{"line":63,"column":31}},"24":{"start":{"line":64,"column":8},"end":{"line":64,"column":60}},"25":{"start":{"line":67,"column":4},"end":{"line":69,"column":5}},"26":{"start":{"line":68,"column":8},"end":{"line":68,"column":45}},"27":{"start":{"line":71,"column":4},"end":{"line":73,"column":5}},"28":{"start":{"line":72,"column":8},"end":{"line":72,"column":40}},"29":{"start":{"line":75,"column":4},"end":{"line":77,"column":5}},"30":{"start":{"line":76,"column":8},"end":{"line":76,"column":48}},"31":{"start":{"line":79,"column":4},"end":{"line":81,"column":5}},"32":{"start":{"line":80,"column":8},"end":{"line":80,"column":50}},"33":{"start":{"line":83,"column":4},"end":{"line":85,"column":5}},"34":{"start":{"line":84,"column":8},"end":{"line":84,"column":49}},"35":{"start":{"line":87,"column":4},"end":{"line":89,"column":5}},"36":{"start":{"line":88,"column":8},"end":{"line":88,"column":66}},"37":{"start":{"line":101,"column":0},"end":{"line":120,"column":1}},"38":{"start":{"line":102,"column":4},"end":{"line":117,"column":5}},"39":{"start":{"line":103,"column":8},"end":{"line":114,"column":11}},"40":{"start":{"line":106,"column":12},"end":{"line":108,"column":13}},"41":{"start":{"line":107,"column":16},"end":{"line":107,"column":57}},"42":{"start":{"line":110,"column":12},"end":{"line":110,"column":57}},"43":{"start":{"line":113,"column":12},"end":{"line":113,"column":42}},"44":{"start":{"line":116,"column":8},"end":{"line":116,"column":24}},"45":{"start":{"line":119,"column":4},"end":{"line":119,"column":36}},"46":{"start":{"line":125,"column":0},"end":{"line":125,"column":30}}},"branchMap":{"1":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"2":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":41,"column":4}},{"start":{"line":41,"column":4},"end":{"line":41,"column":4}}]},"3":{"line":45,"type":"if","locations":[{"start":{"line":45,"column":4},"end":{"line":45,"column":4}},{"start":{"line":45,"column":4},"end":{"line":45,"column":4}}]},"4":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":8},"end":{"line":46,"column":8}},{"start":{"line":46,"column":8},"end":{"line":46,"column":8}}]},"5":{"line":46,"type":"binary-expr","locations":[{"start":{"line":46,"column":12},"end":{"line":46,"column":23}},{"start":{"line":46,"column":27},"end":{"line":46,"column":49}}]},"6":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"7":{"line":56,"type":"if","locations":[{"start":{"line":56,"column":4},"end":{"line":56,"column":4}},{"start":{"line":56,"column":4},"end":{"line":56,"column":4}}]},"8":{"line":58,"type":"cond-expr","locations":[{"start":{"line":58,"column":32},"end":{"line":58,"column":44}},{"start":{"line":58,"column":47},"end":{"line":58,"column":54}}]},"9":{"line":61,"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":61,"column":4}},{"start":{"line":61,"column":4},"end":{"line":61,"column":4}}]},"10":{"line":61,"type":"binary-expr","locations":[{"start":{"line":61,"column":8},"end":{"line":61,"column":17}},{"start":{"line":61,"column":21},"end":{"line":61,"column":50}}]},"11":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":67,"column":4}},{"start":{"line":67,"column":4},"end":{"line":67,"column":4}}]},"12":{"line":71,"type":"if","locations":[{"start":{"line":71,"column":4},"end":{"line":71,"column":4}},{"start":{"line":71,"column":4},"end":{"line":71,"column":4}}]},"13":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":8},"end":{"line":71,"column":16}},{"start":{"line":71,"column":20},"end":{"line":71,"column":42}}]},"14":{"line":75,"type":"if","locations":[{"start":{"line":75,"column":4},"end":{"line":75,"column":4}},{"start":{"line":75,"column":4},"end":{"line":75,"column":4}}]},"15":{"line":79,"type":"if","locations":[{"start":{"line":79,"column":4},"end":{"line":79,"column":4}},{"start":{"line":79,"column":4},"end":{"line":79,"column":4}}]},"16":{"line":79,"type":"binary-expr","locations":[{"start":{"line":79,"column":8},"end":{"line":79,"column":19}},{"start":{"line":79,"column":23},"end":{"line":79,"column":52}}]},"17":{"line":83,"type":"if","locations":[{"start":{"line":83,"column":4},"end":{"line":83,"column":4}},{"start":{"line":83,"column":4},"end":{"line":83,"column":4}}]},"18":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":4},"end":{"line":87,"column":4}},{"start":{"line":87,"column":4},"end":{"line":87,"column":4}}]},"19":{"line":106,"type":"if","locations":[{"start":{"line":106,"column":12},"end":{"line":106,"column":12}},{"start":{"line":106,"column":12},"end":{"line":106,"column":12}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var crypto = require('crypto');","","var httpDate = require('../http_date');","","","///--- Globals","","var ALLOW_HEADERS = [","    'Accept',","    'Accept-Version',","    'Content-Length',","    'Content-MD5',","    'Content-Type',","    'Date',","    'Api-Version',","    'Response-Time'","].join(', ');","","var EXPOSE_HEADERS = [","    'Api-Version',","    'Request-Id',","    'Response-Time'","].join(', ');","","","///--- API","","function setHeaders(req, res) {","    var hash;","    var now = new Date();","    var methods;","","    if (!res.getHeader('Access-Control-Allow-Origin')) {","        res.setHeader('Access-Control-Allow-Origin', '*');","    }","","    if (!res.getHeader('Access-Control-Allow-Headers')) {","        res.setHeader('Access-Control-Allow-Headers', ALLOW_HEADERS);","    }","","    if (!res.getHeader('Access-Control-Allow-Methods')) {","        if (res.methods && res.methods.length > 0) {","            methods = res.methods.join(', ');","            res.setHeader('Access-Control-Allow-Methods', methods);","        }","    }","","    if (!res.getHeader('Access-Control-Expose-Headers')) {","        res.setHeader('Access-Control-Expose-Headers', EXPOSE_HEADERS);","    }","","    if (!res.getHeader('Connection')) {","        res.setHeader('Connection',","            req.isKeepAlive() ? 'Keep-Alive' : 'close');","    }","","    if (res._data && !res.getHeader('Content-MD5')) {","        hash = crypto.createHash('md5');","        hash.update(res._data);","        res.setHeader('Content-MD5', hash.digest('base64'));","    }","","    if (!res.getHeader('Date')) {","        res.setHeader('Date', httpDate(now));","    }","","    if (res.etag && !res.getHeader('Etag')) {","        res.setHeader('Etag', res.etag);","    }","","    if (!res.getHeader('Server')) {","        res.setHeader('Server', res.serverName);","    }","","    if (res.version && !res.getHeader('Api-Version')) {","        res.setHeader('Api-Version', res.version);","    }","","    if (!res.getHeader('Request-Id')) {","        res.setHeader('Request-Id', req.getId());","    }","","    if (!res.getHeader('Response-Time')) {","        res.setHeader('Response-Time', now.getTime() - req._time);","    }","","}","","","/**"," * handles disappeared CORS headers."," * https://github.com/restify/node-restify/issues/284"," * @public"," * @function fullResponse"," * @returns  {Function}"," */","function fullResponse() {","    function restifyResponseHeaders(req, res, next) {","        res.once('header', function () {","","            // Restify 1.0 compatibility","            if (res.defaultResponseFormatters) {","                res.defaultResponseFormatters(res._data);","            }","","            res.emit('beforeSend', res._data, res._body);","","            // end backwards-compatibility","            return (setHeaders(req, res));","        });","","        return (next());","    }","","    return (restifyResponseHeaders);","}","","","///--- Exports","","module.exports = fullResponse;",""],"l":{"5":1,"7":1,"12":1,"23":1,"32":1,"33":0,"34":0,"35":0,"37":0,"38":0,"41":0,"42":0,"45":0,"46":0,"47":0,"48":0,"52":0,"53":0,"56":0,"57":0,"61":0,"62":0,"63":0,"64":0,"67":0,"68":0,"71":0,"72":0,"75":0,"76":0,"79":0,"80":0,"83":0,"84":0,"87":0,"88":0,"101":1,"102":1,"103":0,"106":0,"107":0,"110":0,"113":0,"116":0,"119":0,"125":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/query.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/query.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"queryParser","line":36,"loc":{"start":{"line":36,"column":0},"end":{"line":36,"column":30}}},"2":{"name":"(anonymous_2)","line":54,"loc":{"start":{"line":54,"column":44},"end":{"line":54,"column":57}}},"3":{"name":"parseQueryString","line":62,"loc":{"start":{"line":62,"column":4},"end":{"line":62,"column":46}}},"4":{"name":"(anonymous_4)","line":71,"loc":{"start":{"line":71,"column":43},"end":{"line":71,"column":56}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":23}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":36}},"3":{"start":{"line":8,"column":0},"end":{"line":24,"column":2}},"4":{"start":{"line":36,"column":0},"end":{"line":85,"column":1}},"5":{"start":{"line":37,"column":4},"end":{"line":39,"column":5}},"6":{"start":{"line":38,"column":8},"end":{"line":38,"column":21}},"7":{"start":{"line":40,"column":4},"end":{"line":40,"column":38}},"8":{"start":{"line":50,"column":4},"end":{"line":53,"column":6}},"9":{"start":{"line":54,"column":4},"end":{"line":60,"column":7}},"10":{"start":{"line":55,"column":8},"end":{"line":55,"column":45}},"11":{"start":{"line":57,"column":8},"end":{"line":59,"column":9}},"12":{"start":{"line":58,"column":12},"end":{"line":58,"column":38}},"13":{"start":{"line":62,"column":4},"end":{"line":82,"column":5}},"14":{"start":{"line":63,"column":8},"end":{"line":66,"column":9}},"15":{"start":{"line":64,"column":12},"end":{"line":64,"column":27}},"16":{"start":{"line":65,"column":12},"end":{"line":65,"column":28}},"17":{"start":{"line":68,"column":8},"end":{"line":68,"column":56}},"18":{"start":{"line":70,"column":8},"end":{"line":79,"column":9}},"19":{"start":{"line":71,"column":12},"end":{"line":78,"column":15}},"20":{"start":{"line":72,"column":16},"end":{"line":74,"column":17}},"21":{"start":{"line":73,"column":20},"end":{"line":73,"column":35}},"22":{"start":{"line":76,"column":16},"end":{"line":76,"column":45}},"23":{"start":{"line":77,"column":16},"end":{"line":77,"column":30}},"24":{"start":{"line":81,"column":8},"end":{"line":81,"column":24}},"25":{"start":{"line":84,"column":4},"end":{"line":84,"column":30}},"26":{"start":{"line":87,"column":0},"end":{"line":87,"column":29}}},"branchMap":{"1":{"line":37,"type":"if","locations":[{"start":{"line":37,"column":4},"end":{"line":37,"column":4}},{"start":{"line":37,"column":4},"end":{"line":37,"column":4}}]},"2":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":57,"column":8}},{"start":{"line":57,"column":8},"end":{"line":57,"column":8}}]},"3":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":8},"end":{"line":63,"column":8}},{"start":{"line":63,"column":8},"end":{"line":63,"column":8}}]},"4":{"line":70,"type":"if","locations":[{"start":{"line":70,"column":8},"end":{"line":70,"column":8}},{"start":{"line":70,"column":8},"end":{"line":70,"column":8}}]},"5":{"line":72,"type":"if","locations":[{"start":{"line":72,"column":16},"end":{"line":72,"column":16}},{"start":{"line":72,"column":16},"end":{"line":72,"column":16}}]},"6":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":20},"end":{"line":72,"column":33}},{"start":{"line":72,"column":37},"end":{"line":72,"column":60}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var qs = require('qs');","var assert = require('assert-plus');","","var EXPOSED_QS_OPTIONS = {","    allowDots: assert.optionalBool,","    arrayLimit: assert.optionalNumber,","    depth: assert.optionalNumber,","    parameterLimit: assert.optionalNumber,","    parseArrays: assert.optionalBool,","    plainObjects: assert.optionalBool,","    strictNullHandling: assert.optionalBool","","    /*","     * Exclusions (`qs.parse` options that restify does NOT expose):","     * - `allowPrototypes`: It is strongly suggested against in qs docs.","     * - `decoder`","     * - `delimiter`: For query string parsing we shouldn't support anything","     *   but the default '&'.","     */","};","","/**"," * Returns a plugin that will parse the query string, and merge the results"," * into req.query."," *"," * Unless options.mapParams is false, they will also be mapped into req.params."," * @public"," * @function queryParser"," * @param    {Object}   options an options object"," * @returns  {Function}"," */","function queryParser(options) {","    if (!options) {","        options = {};","    }","    assert.object(options, 'options');","","    /*","     * Releases of restify 4.x up to 4.1.1 used qs@3 which effectively defaulted","     * to `plainObjects=true` and `allowDots=true`. To maintain backward","     * compatibility for the restify 4.x stream while using the latest qs","     * version, we need to maintain those defaults. Note that restify-plugins","     * changes back to the pre-restify-4.x behaviour. See test/query.test.js","     * for more details.","     */","    var qsOptions = {","        plainObjects: true,","        allowDots: true","    };","    Object.keys(EXPOSED_QS_OPTIONS).forEach(function (k) {","        EXPOSED_QS_OPTIONS[k](options[k], k); // assert type of this option","","        if (options.hasOwnProperty(k)) {","            qsOptions[k] = options[k];","        }","    });","","    function parseQueryString(req, res, next) {","        if (!req.getQuery()) {","            req.query = {};","            return (next());","        }","","        req.query = qs.parse(req.getQuery(), qsOptions);","","        if (options.mapParams !== false) {","            Object.keys(req.query).forEach(function (k) {","                if (req.params[k] && !options.overrideParams) {","                    return (false);","                }","","                req.params[k] = req.query[k];","                return (true);","            });","        }","","        return (next());","    }","","    return (parseQueryString);","}","","module.exports = queryParser;",""],"l":{"5":1,"6":1,"8":1,"36":1,"37":0,"38":0,"40":0,"50":0,"54":0,"55":0,"57":0,"58":0,"62":1,"63":0,"64":0,"65":0,"68":0,"70":0,"71":0,"72":0,"73":0,"76":0,"77":0,"81":0,"84":0,"87":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/request_expiry.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/request_expiry.js","s":{"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"requestExpiry","line":17,"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":32}}},"2":{"name":"(anonymous_2)","line":22,"loc":{"start":{"line":22,"column":11},"end":{"line":22,"column":37}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":3,"column":36}},"2":{"start":{"line":4,"column":0},"end":{"line":4,"column":69}},"3":{"start":{"line":17,"column":0},"end":{"line":37,"column":1}},"4":{"start":{"line":18,"column":4},"end":{"line":18,"column":38}},"5":{"start":{"line":19,"column":4},"end":{"line":19,"column":52}},"6":{"start":{"line":20,"column":4},"end":{"line":20,"column":35}},"7":{"start":{"line":22,"column":4},"end":{"line":36,"column":6}},"8":{"start":{"line":23,"column":8},"end":{"line":23,"column":44}},"9":{"start":{"line":25,"column":8},"end":{"line":32,"column":9}},"10":{"start":{"line":26,"column":12},"end":{"line":26,"column":44}},"11":{"start":{"line":29,"column":12},"end":{"line":31,"column":13}},"12":{"start":{"line":30,"column":16},"end":{"line":30,"column":76}},"13":{"start":{"line":35,"column":8},"end":{"line":35,"column":22}},"14":{"start":{"line":39,"column":0},"end":{"line":39,"column":31}}},"branchMap":{"1":{"line":25,"type":"if","locations":[{"start":{"line":25,"column":8},"end":{"line":25,"column":8}},{"start":{"line":25,"column":8},"end":{"line":25,"column":8}}]},"2":{"line":29,"type":"if","locations":[{"start":{"line":29,"column":12},"end":{"line":29,"column":12}},{"start":{"line":29,"column":12},"end":{"line":29,"column":12}}]}},"code":["'use strict';","","var assert = require('assert-plus');","var GatewayTimeoutError = require('./../errors').GatewayTimeoutError;","","/**"," * A request expiry will use the headers to tell if the"," * incoming request has expired or not.  The header is"," * expected to be in absolute time since the epoch."," * @public"," * @function requestExpiry"," * @param    {Object} options        an options object"," * @param    {String} options.header The header key to be used for"," *                                   the expiry time of each request."," * @returns  {Function}"," */","function requestExpiry(options) {","    assert.object(options, 'options');","    assert.string(options.header, 'options.header');","    var headerKey = options.header;","","    return function (req, res, next) {","        var expiry = req.headers[headerKey];","","        if (expiry) {","            var expiryTime = Number(expiry);","","            // The request has expired","            if (Date.now() > expiryTime) {","                return next(new GatewayTimeoutError('Request has expired'));","            }","        }","","        // Happy case","        return next();","    };","}","","module.exports = requestExpiry;",""],"l":{"3":1,"4":1,"17":1,"18":0,"19":0,"20":0,"22":0,"23":0,"25":0,"26":0,"29":0,"30":0,"35":0,"39":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/pre/pre_path.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/pre/pre_path.js","s":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":0,"15":1,"16":0,"17":0,"18":0,"19":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0,0,0],"4":[0,0]},"f":{"1":0,"2":0,"3":0},"fnMap":{"1":{"name":"strip","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":21}}},"2":{"name":"sanitizePath","line":44,"loc":{"start":{"line":44,"column":0},"end":{"line":44,"column":31}}},"3":{"name":"_sanitizePath","line":47,"loc":{"start":{"line":47,"column":4},"end":{"line":47,"column":43}}}},"statementMap":{"1":{"start":{"line":15,"column":0},"end":{"line":35,"column":1}},"2":{"start":{"line":16,"column":4},"end":{"line":16,"column":12}},"3":{"start":{"line":17,"column":4},"end":{"line":17,"column":13}},"4":{"start":{"line":18,"column":4},"end":{"line":18,"column":17}},"5":{"start":{"line":20,"column":4},"end":{"line":32,"column":5}},"6":{"start":{"line":21,"column":8},"end":{"line":21,"column":29}},"7":{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},"8":{"start":{"line":24,"column":12},"end":{"line":24,"column":38}},"9":{"start":{"line":27,"column":8},"end":{"line":29,"column":9}},"10":{"start":{"line":28,"column":12},"end":{"line":28,"column":21}},"11":{"start":{"line":31,"column":8},"end":{"line":31,"column":19}},"12":{"start":{"line":34,"column":4},"end":{"line":34,"column":17}},"13":{"start":{"line":44,"column":0},"end":{"line":53,"column":1}},"14":{"start":{"line":45,"column":4},"end":{"line":45,"column":28}},"15":{"start":{"line":47,"column":4},"end":{"line":50,"column":5}},"16":{"start":{"line":48,"column":8},"end":{"line":48,"column":33}},"17":{"start":{"line":49,"column":8},"end":{"line":49,"column":15}},"18":{"start":{"line":52,"column":4},"end":{"line":52,"column":27}},"19":{"start":{"line":58,"column":0},"end":{"line":58,"column":30}}},"branchMap":{"1":{"line":23,"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":23,"column":8}},{"start":{"line":23,"column":8},"end":{"line":23,"column":8}}]},"2":{"line":27,"type":"if","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":8}},{"start":{"line":27,"column":8},"end":{"line":27,"column":8}}]},"3":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":12},"end":{"line":27,"column":23}},{"start":{"line":27,"column":28},"end":{"line":27,"column":40}},{"start":{"line":27,"column":45},"end":{"line":27,"column":57}},{"start":{"line":27,"column":61},"end":{"line":27,"column":66}}]},"4":{"line":45,"type":"binary-expr","locations":[{"start":{"line":45,"column":14},"end":{"line":45,"column":21}},{"start":{"line":45,"column":25},"end":{"line":45,"column":27}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","///--- Helpers","","","/**"," * Cleans up sloppy URLs on the request object, like /foo////bar/// to /foo/bar."," * @private"," * @function strip"," * @param    {Object} path a url path to clean up"," * @returns  {String}"," */","function strip(path) {","    var cur;","    var next;","    var str = '';","","    for (var i = 0; i < path.length; i++) {","        cur = path.charAt(i);","","        if (i !== path.length - 1) {","            next = path.charAt(i + 1);","        }","","        if (cur === '/' && (next === '/' || (next === '?' && i > 0))) {","            continue;","        }","","        str += cur;","    }","","    return (str);","}","","","/**"," * @public"," * @function sanitizePath"," * @param    {Object}   options an options object"," * @returns  {Function}"," */","function sanitizePath(options) {","    options = options || {};","","    function _sanitizePath(req, res, next) {","        req.url = strip(req.url);","        next();","    }","","    return (_sanitizePath);","}","","","///--- Exports","","module.exports = sanitizePath;","",""],"l":{"15":1,"16":0,"17":0,"18":0,"20":0,"21":0,"23":0,"24":0,"27":0,"28":0,"31":0,"34":0,"44":1,"45":0,"47":1,"48":0,"49":0,"52":0,"58":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/static.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/static.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"serveStatic","line":33,"loc":{"start":{"line":33,"column":0},"end":{"line":33,"column":27}}},"2":{"name":"serveFileFromStats","line":45,"loc":{"start":{"line":45,"column":4},"end":{"line":45,"column":74}}},"3":{"name":"(anonymous_3)","line":61,"loc":{"start":{"line":61,"column":29},"end":{"line":61,"column":43}}},"4":{"name":"(anonymous_4)","line":78,"loc":{"start":{"line":78,"column":32},"end":{"line":78,"column":44}}},"5":{"name":"serveNormal","line":84,"loc":{"start":{"line":84,"column":4},"end":{"line":84,"column":47}}},"6":{"name":"(anonymous_6)","line":85,"loc":{"start":{"line":85,"column":22},"end":{"line":85,"column":44}}},"7":{"name":"(anonymous_7)","line":89,"loc":{"start":{"line":89,"column":30},"end":{"line":89,"column":58}}},"8":{"name":"serve","line":110,"loc":{"start":{"line":110,"column":4},"end":{"line":110,"column":35}}},"9":{"name":"(anonymous_9)","line":138,"loc":{"start":{"line":138,"column":34},"end":{"line":138,"column":56}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":23}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":50}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":36}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":34}},"7":{"start":{"line":16,"column":0},"end":{"line":16,"column":57}},"8":{"start":{"line":17,"column":0},"end":{"line":17,"column":51}},"9":{"start":{"line":18,"column":0},"end":{"line":18,"column":57}},"10":{"start":{"line":33,"column":0},"end":{"line":159,"column":1}},"11":{"start":{"line":34,"column":4},"end":{"line":34,"column":22}},"12":{"start":{"line":35,"column":4},"end":{"line":35,"column":35}},"13":{"start":{"line":36,"column":4},"end":{"line":36,"column":55}},"14":{"start":{"line":37,"column":4},"end":{"line":37,"column":57}},"15":{"start":{"line":38,"column":4},"end":{"line":38,"column":55}},"16":{"start":{"line":39,"column":4},"end":{"line":39,"column":59}},"17":{"start":{"line":40,"column":4},"end":{"line":40,"column":53}},"18":{"start":{"line":42,"column":4},"end":{"line":42,"column":63}},"19":{"start":{"line":43,"column":4},"end":{"line":43,"column":52}},"20":{"start":{"line":45,"column":4},"end":{"line":82,"column":5}},"21":{"start":{"line":46,"column":8},"end":{"line":53,"column":9}},"22":{"start":{"line":47,"column":12},"end":{"line":48,"column":29}},"23":{"start":{"line":49,"column":12},"end":{"line":49,"column":19}},"24":{"start":{"line":50,"column":15},"end":{"line":53,"column":9}},"25":{"start":{"line":51,"column":12},"end":{"line":51,"column":77}},"26":{"start":{"line":52,"column":12},"end":{"line":52,"column":19}},"27":{"start":{"line":55,"column":8},"end":{"line":57,"column":9}},"28":{"start":{"line":56,"column":12},"end":{"line":56,"column":30}},"29":{"start":{"line":59,"column":8},"end":{"line":59,"column":72}},"30":{"start":{"line":60,"column":8},"end":{"line":60,"column":68}},"31":{"start":{"line":61,"column":8},"end":{"line":81,"column":11}},"32":{"start":{"line":62,"column":12},"end":{"line":62,"column":40}},"33":{"start":{"line":63,"column":12},"end":{"line":63,"column":50}},"34":{"start":{"line":64,"column":12},"end":{"line":64,"column":55}},"35":{"start":{"line":65,"column":12},"end":{"line":65,"column":50}},"36":{"start":{"line":67,"column":12},"end":{"line":71,"column":13}},"37":{"start":{"line":68,"column":16},"end":{"line":69,"column":48}},"38":{"start":{"line":70,"column":16},"end":{"line":70,"column":52}},"39":{"start":{"line":73,"column":12},"end":{"line":75,"column":13}},"40":{"start":{"line":74,"column":16},"end":{"line":74,"column":56}},"41":{"start":{"line":76,"column":12},"end":{"line":76,"column":31}},"42":{"start":{"line":77,"column":12},"end":{"line":77,"column":30}},"43":{"start":{"line":78,"column":12},"end":{"line":80,"column":15}},"44":{"start":{"line":79,"column":16},"end":{"line":79,"column":28}},"45":{"start":{"line":84,"column":4},"end":{"line":108,"column":5}},"46":{"start":{"line":85,"column":8},"end":{"line":107,"column":11}},"47":{"start":{"line":86,"column":12},"end":{"line":106,"column":13}},"48":{"start":{"line":88,"column":16},"end":{"line":88,"column":53}},"49":{"start":{"line":89,"column":16},"end":{"line":97,"column":19}},"50":{"start":{"line":90,"column":20},"end":{"line":96,"column":30}},"51":{"start":{"line":99,"column":16},"end":{"line":105,"column":26}},"52":{"start":{"line":110,"column":4},"end":{"line":156,"column":5}},"53":{"start":{"line":111,"column":8},"end":{"line":111,"column":17}},"54":{"start":{"line":113,"column":8},"end":{"line":120,"column":9}},"55":{"start":{"line":115,"column":12},"end":{"line":116,"column":47}},"56":{"start":{"line":118,"column":12},"end":{"line":119,"column":48}},"57":{"start":{"line":122,"column":8},"end":{"line":125,"column":9}},"58":{"start":{"line":123,"column":12},"end":{"line":123,"column":56}},"59":{"start":{"line":124,"column":12},"end":{"line":124,"column":19}},"60":{"start":{"line":127,"column":8},"end":{"line":130,"column":9}},"61":{"start":{"line":128,"column":12},"end":{"line":128,"column":53}},"62":{"start":{"line":129,"column":12},"end":{"line":129,"column":19}},"63":{"start":{"line":132,"column":8},"end":{"line":135,"column":9}},"64":{"start":{"line":133,"column":12},"end":{"line":133,"column":53}},"65":{"start":{"line":134,"column":12},"end":{"line":134,"column":19}},"66":{"start":{"line":137,"column":8},"end":{"line":154,"column":9}},"67":{"start":{"line":138,"column":12},"end":{"line":151,"column":15}},"68":{"start":{"line":139,"column":16},"end":{"line":150,"column":17}},"69":{"start":{"line":140,"column":20},"end":{"line":140,"column":62}},"70":{"start":{"line":141,"column":20},"end":{"line":147,"column":30}},"71":{"start":{"line":149,"column":20},"end":{"line":149,"column":54}},"72":{"start":{"line":153,"column":12},"end":{"line":153,"column":46}},"73":{"start":{"line":158,"column":4},"end":{"line":158,"column":19}},"74":{"start":{"line":161,"column":0},"end":{"line":161,"column":29}}},"branchMap":{"1":{"line":34,"type":"binary-expr","locations":[{"start":{"line":34,"column":11},"end":{"line":34,"column":15}},{"start":{"line":34,"column":19},"end":{"line":34,"column":21}}]},"2":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":8},"end":{"line":46,"column":8}},{"start":{"line":46,"column":8},"end":{"line":46,"column":8}}]},"3":{"line":50,"type":"if","locations":[{"start":{"line":50,"column":15},"end":{"line":50,"column":15}},{"start":{"line":50,"column":15},"end":{"line":50,"column":15}}]},"4":{"line":55,"type":"if","locations":[{"start":{"line":55,"column":8},"end":{"line":55,"column":8}},{"start":{"line":55,"column":8},"end":{"line":55,"column":8}}]},"5":{"line":55,"type":"binary-expr","locations":[{"start":{"line":55,"column":12},"end":{"line":55,"column":27}},{"start":{"line":55,"column":31},"end":{"line":55,"column":37}}]},"6":{"line":59,"type":"cond-expr","locations":[{"start":{"line":59,"column":59},"end":{"line":59,"column":64}},{"start":{"line":59,"column":67},"end":{"line":59,"column":69}}]},"7":{"line":60,"type":"cond-expr","locations":[{"start":{"line":60,"column":49},"end":{"line":60,"column":53}},{"start":{"line":60,"column":56},"end":{"line":60,"column":67}}]},"8":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":12},"end":{"line":67,"column":12}},{"start":{"line":67,"column":12},"end":{"line":67,"column":12}}]},"9":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":12},"end":{"line":73,"column":12}},{"start":{"line":73,"column":12},"end":{"line":73,"column":12}}]},"10":{"line":86,"type":"if","locations":[{"start":{"line":86,"column":12},"end":{"line":86,"column":12}},{"start":{"line":86,"column":12},"end":{"line":86,"column":12}}]},"11":{"line":86,"type":"binary-expr","locations":[{"start":{"line":86,"column":16},"end":{"line":86,"column":20}},{"start":{"line":86,"column":24},"end":{"line":86,"column":43}},{"start":{"line":86,"column":47},"end":{"line":86,"column":59}}]},"12":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":8},"end":{"line":113,"column":8}},{"start":{"line":113,"column":8},"end":{"line":113,"column":8}}]},"13":{"line":122,"type":"if","locations":[{"start":{"line":122,"column":8},"end":{"line":122,"column":8}},{"start":{"line":122,"column":8},"end":{"line":122,"column":8}}]},"14":{"line":122,"type":"binary-expr","locations":[{"start":{"line":122,"column":12},"end":{"line":122,"column":32}},{"start":{"line":122,"column":36},"end":{"line":122,"column":57}}]},"15":{"line":127,"type":"if","locations":[{"start":{"line":127,"column":8},"end":{"line":127,"column":8}},{"start":{"line":127,"column":8},"end":{"line":127,"column":8}}]},"16":{"line":132,"type":"if","locations":[{"start":{"line":132,"column":8},"end":{"line":132,"column":8}},{"start":{"line":132,"column":8},"end":{"line":132,"column":8}}]},"17":{"line":132,"type":"binary-expr","locations":[{"start":{"line":132,"column":12},"end":{"line":132,"column":22}},{"start":{"line":132,"column":26},"end":{"line":132,"column":48}}]},"18":{"line":137,"type":"if","locations":[{"start":{"line":137,"column":8},"end":{"line":137,"column":8}},{"start":{"line":137,"column":8},"end":{"line":137,"column":8}}]},"19":{"line":137,"type":"binary-expr","locations":[{"start":{"line":137,"column":12},"end":{"line":137,"column":21}},{"start":{"line":137,"column":25},"end":{"line":137,"column":52}}]},"20":{"line":139,"type":"if","locations":[{"start":{"line":139,"column":16},"end":{"line":139,"column":16}},{"start":{"line":139,"column":16},"end":{"line":139,"column":16}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var fs = require('fs');","var path = require('path');","var escapeRE = require('escape-regexp-component');","","var assert = require('assert-plus');","var mime = require('mime');","var errors = require('../errors');","","","///--- Globals","","var MethodNotAllowedError = errors.MethodNotAllowedError;","var NotAuthorizedError = errors.NotAuthorizedError;","var ResourceNotFoundError = errors.ResourceNotFoundError;","","","///--- Functions","","/**"," * serves static files."," * @public"," * @function serveStatic"," * @param    {Object} opts an options object"," * @throws   {MethodNotAllowedError |"," *            NotAuthorizedError |"," *            ResourceNotFoundError}"," * @returns  {Function}"," */","function serveStatic(opts) {","    opts = opts || {};","    assert.object(opts, 'options');","    assert.string(opts.directory, 'options.directory');","    assert.optionalNumber(opts.maxAge, 'options.maxAge');","    assert.optionalObject(opts.match, 'options.match');","    assert.optionalString(opts.charSet, 'options.charSet');","    assert.optionalString(opts.file, 'options.file');","","    var p = path.normalize(opts.directory).replace(/\\\\/g, '/');","    var re = new RegExp('^' + escapeRE(p) + '/?.*');","","    function serveFileFromStats(file, err, stats, isGzip, req, res, next) {","        if (err) {","            next(new ResourceNotFoundError(err,","                req.path()));","            return;","        } else if (!stats.isFile()) {","            next(new ResourceNotFoundError('%s does not exist', req.path()));","            return;","        }","","        if (res.handledGzip && isGzip) {","            res.handledGzip();","        }","","        var fstream = fs.createReadStream(file + (isGzip ? '.gz' : ''));","        var maxAge = opts.maxAge === undefined ? 3600 : opts.maxAge;","        fstream.once('open', function (fd) {","            res.cache({maxAge: maxAge});","            res.set('Content-Length', stats.size);","            res.set('Content-Type', mime.lookup(file));","            res.set('Last-Modified', stats.mtime);","","            if (opts.charSet) {","                var type = res.getHeader('Content-Type') +","                    '; charset=' + opts.charSet;","                res.setHeader('Content-Type', type);","            }","","            if (opts.etag) {","                res.set('ETag', opts.etag(stats, opts));","            }","            res.writeHead(200);","            fstream.pipe(res);","            fstream.once('end', function () {","                next(false);","            });","        });","    }","","    function serveNormal(file, req, res, next) {","        fs.stat(file, function (err, stats) {","            if (!err && stats.isDirectory() && opts.default) {","                // Serve an index.html page or similar","                file = path.join(file, opts.default);","                fs.stat(file, function (dirErr, dirStats) {","                    serveFileFromStats(file,","                        dirErr,","                        dirStats,","                        false,","                        req,","                        res,","                        next);","                });","            } else {","                serveFileFromStats(file,","                    err,","                    stats,","                    false,","                    req,","                    res,","                    next);","            }","        });","    }","","    function serve(req, res, next) {","        var file;","","        if (opts.file) {","            //serves a direct file","            file = path.join(opts.directory,","                decodeURIComponent(opts.file));","        } else {","            file = path.join(opts.directory,","                decodeURIComponent(req.path()));","        }","","        if (req.method !== 'GET' && req.method !== 'HEAD') {","            next(new MethodNotAllowedError(req.method));","            return;","        }","","        if (!re.test(file.replace(/\\\\/g, '/'))) {","            next(new NotAuthorizedError(req.path()));","            return;","        }","","        if (opts.match && !opts.match.test(file)) {","            next(new NotAuthorizedError(req.path()));","            return;","        }","","        if (opts.gzip && req.acceptsEncoding('gzip')) {","            fs.stat(file + '.gz', function (err, stats) {","                if (!err) {","                    res.setHeader('Content-Encoding', 'gzip');","                    serveFileFromStats(file,","                        err,","                        stats,","                        true,","                        req,","                        res,","                        next);","                } else {","                    serveNormal(file, req, res, next);","                }","            });","        } else {","            serveNormal(file, req, res, next);","        }","","    }","","    return (serve);","}","","module.exports = serveStatic;",""],"l":{"5":1,"6":1,"7":1,"9":1,"10":1,"11":1,"16":1,"17":1,"18":1,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"42":0,"43":0,"45":1,"46":0,"47":0,"49":0,"50":0,"51":0,"52":0,"55":0,"56":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"67":0,"68":0,"70":0,"73":0,"74":0,"76":0,"77":0,"78":0,"79":0,"84":1,"85":0,"86":0,"88":0,"89":0,"90":0,"99":0,"110":1,"111":0,"113":0,"115":0,"118":0,"122":0,"123":0,"124":0,"127":0,"128":0,"129":0,"132":0,"133":0,"134":0,"137":0,"138":0,"139":0,"140":0,"141":0,"149":0,"153":0,"158":0,"161":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/throttle.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/throttle.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":1,"40":0,"41":1,"42":0,"43":1,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":1,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0,0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"xor","line":22,"loc":{"start":{"line":22,"column":0},"end":{"line":22,"column":15}}},"2":{"name":"TokenBucket","line":60,"loc":{"start":{"line":60,"column":0},"end":{"line":60,"column":30}}},"3":{"name":"consume","line":81,"loc":{"start":{"line":81,"column":32},"end":{"line":81,"column":57}}},"4":{"name":"_fill","line":104,"loc":{"start":{"line":104,"column":30},"end":{"line":104,"column":47}}},"5":{"name":"TokenTable","line":131,"loc":{"start":{"line":131,"column":0},"end":{"line":131,"column":29}}},"6":{"name":"put","line":146,"loc":{"start":{"line":146,"column":27},"end":{"line":146,"column":52}}},"7":{"name":"get","line":158,"loc":{"start":{"line":158,"column":27},"end":{"line":158,"column":45}}},"8":{"name":"throttle","line":220,"loc":{"start":{"line":220,"column":0},"end":{"line":220,"column":27}}},"9":{"name":"rateLimit","line":232,"loc":{"start":{"line":232,"column":4},"end":{"line":232,"column":39}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":37}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":31}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":34}},"5":{"start":{"line":15,"column":0},"end":{"line":15,"column":55}},"6":{"start":{"line":17,"column":0},"end":{"line":17,"column":63}},"7":{"start":{"line":22,"column":0},"end":{"line":33,"column":1}},"8":{"start":{"line":23,"column":4},"end":{"line":23,"column":18}},"9":{"start":{"line":25,"column":4},"end":{"line":31,"column":5}},"10":{"start":{"line":26,"column":8},"end":{"line":30,"column":9}},"11":{"start":{"line":27,"column":12},"end":{"line":27,"column":21}},"12":{"start":{"line":28,"column":15},"end":{"line":30,"column":9}},"13":{"start":{"line":29,"column":12},"end":{"line":29,"column":27}},"14":{"start":{"line":32,"column":4},"end":{"line":32,"column":15}},"15":{"start":{"line":60,"column":0},"end":{"line":68,"column":1}},"16":{"start":{"line":61,"column":4},"end":{"line":61,"column":38}},"17":{"start":{"line":62,"column":4},"end":{"line":62,"column":56}},"18":{"start":{"line":63,"column":4},"end":{"line":63,"column":56}},"19":{"start":{"line":65,"column":4},"end":{"line":65,"column":51}},"20":{"start":{"line":66,"column":4},"end":{"line":66,"column":37}},"21":{"start":{"line":67,"column":4},"end":{"line":67,"column":27}},"22":{"start":{"line":81,"column":0},"end":{"line":88,"column":2}},"23":{"start":{"line":82,"column":4},"end":{"line":85,"column":5}},"24":{"start":{"line":83,"column":8},"end":{"line":83,"column":30}},"25":{"start":{"line":84,"column":8},"end":{"line":84,"column":22}},"26":{"start":{"line":87,"column":4},"end":{"line":87,"column":19}},"27":{"start":{"line":104,"column":0},"end":{"line":119,"column":2}},"28":{"start":{"line":105,"column":4},"end":{"line":105,"column":25}},"29":{"start":{"line":108,"column":4},"end":{"line":110,"column":5}},"30":{"start":{"line":109,"column":8},"end":{"line":109,"column":31}},"31":{"start":{"line":112,"column":4},"end":{"line":115,"column":5}},"32":{"start":{"line":113,"column":8},"end":{"line":113,"column":63}},"33":{"start":{"line":114,"column":8},"end":{"line":114,"column":67}},"34":{"start":{"line":116,"column":4},"end":{"line":116,"column":20}},"35":{"start":{"line":118,"column":4},"end":{"line":118,"column":25}},"36":{"start":{"line":131,"column":0},"end":{"line":135,"column":1}},"37":{"start":{"line":132,"column":4},"end":{"line":132,"column":38}},"38":{"start":{"line":134,"column":4},"end":{"line":134,"column":48}},"39":{"start":{"line":146,"column":0},"end":{"line":148,"column":2}},"40":{"start":{"line":147,"column":4},"end":{"line":147,"column":31}},"41":{"start":{"line":158,"column":0},"end":{"line":160,"column":2}},"42":{"start":{"line":159,"column":4},"end":{"line":159,"column":33}},"43":{"start":{"line":220,"column":0},"end":{"line":298,"column":1}},"44":{"start":{"line":221,"column":4},"end":{"line":221,"column":38}},"45":{"start":{"line":222,"column":4},"end":{"line":222,"column":50}},"46":{"start":{"line":223,"column":4},"end":{"line":223,"column":48}},"47":{"start":{"line":225,"column":4},"end":{"line":227,"column":5}},"48":{"start":{"line":226,"column":8},"end":{"line":226,"column":49}},"49":{"start":{"line":229,"column":4},"end":{"line":230,"column":48}},"50":{"start":{"line":232,"column":4},"end":{"line":295,"column":5}},"51":{"start":{"line":233,"column":8},"end":{"line":233,"column":17}},"52":{"start":{"line":234,"column":8},"end":{"line":234,"column":34}},"53":{"start":{"line":235,"column":8},"end":{"line":235,"column":32}},"54":{"start":{"line":237,"column":8},"end":{"line":247,"column":9}},"55":{"start":{"line":238,"column":12},"end":{"line":238,"column":48}},"56":{"start":{"line":239,"column":15},"end":{"line":247,"column":9}},"57":{"start":{"line":240,"column":12},"end":{"line":240,"column":50}},"58":{"start":{"line":241,"column":15},"end":{"line":247,"column":9}},"59":{"start":{"line":242,"column":12},"end":{"line":242,"column":32}},"60":{"start":{"line":244,"column":12},"end":{"line":245,"column":50}},"61":{"start":{"line":246,"column":12},"end":{"line":246,"column":28}},"62":{"start":{"line":251,"column":8},"end":{"line":253,"column":9}},"63":{"start":{"line":252,"column":12},"end":{"line":252,"column":28}},"64":{"start":{"line":256,"column":8},"end":{"line":263,"column":9}},"65":{"start":{"line":261,"column":12},"end":{"line":261,"column":50}},"66":{"start":{"line":262,"column":12},"end":{"line":262,"column":48}},"67":{"start":{"line":265,"column":8},"end":{"line":267,"column":9}},"68":{"start":{"line":266,"column":12},"end":{"line":266,"column":28}},"69":{"start":{"line":269,"column":8},"end":{"line":269,"column":37}},"70":{"start":{"line":271,"column":8},"end":{"line":277,"column":9}},"71":{"start":{"line":272,"column":12},"end":{"line":275,"column":15}},"72":{"start":{"line":276,"column":12},"end":{"line":276,"column":36}},"73":{"start":{"line":279,"column":8},"end":{"line":280,"column":33}},"74":{"start":{"line":282,"column":8},"end":{"line":292,"column":9}},"75":{"start":{"line":283,"column":12},"end":{"line":288,"column":29}},"76":{"start":{"line":290,"column":12},"end":{"line":290,"column":45}},"77":{"start":{"line":291,"column":12},"end":{"line":291,"column":57}},"78":{"start":{"line":294,"column":8},"end":{"line":294,"column":24}},"79":{"start":{"line":297,"column":4},"end":{"line":297,"column":23}},"80":{"start":{"line":300,"column":0},"end":{"line":300,"column":26}}},"branchMap":{"1":{"line":26,"type":"if","locations":[{"start":{"line":26,"column":8},"end":{"line":26,"column":8}},{"start":{"line":26,"column":8},"end":{"line":26,"column":8}}]},"2":{"line":26,"type":"binary-expr","locations":[{"start":{"line":26,"column":12},"end":{"line":26,"column":24}},{"start":{"line":26,"column":28},"end":{"line":26,"column":30}}]},"3":{"line":28,"type":"if","locations":[{"start":{"line":28,"column":15},"end":{"line":28,"column":15}},{"start":{"line":28,"column":15},"end":{"line":28,"column":15}}]},"4":{"line":28,"type":"binary-expr","locations":[{"start":{"line":28,"column":19},"end":{"line":28,"column":31}},{"start":{"line":28,"column":35},"end":{"line":28,"column":36}}]},"5":{"line":82,"type":"if","locations":[{"start":{"line":82,"column":4},"end":{"line":82,"column":4}},{"start":{"line":82,"column":4},"end":{"line":82,"column":4}}]},"6":{"line":108,"type":"if","locations":[{"start":{"line":108,"column":4},"end":{"line":108,"column":4}},{"start":{"line":108,"column":4},"end":{"line":108,"column":4}}]},"7":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":4},"end":{"line":112,"column":4}},{"start":{"line":112,"column":4},"end":{"line":112,"column":4}}]},"8":{"line":134,"type":"binary-expr","locations":[{"start":{"line":134,"column":25},"end":{"line":134,"column":37}},{"start":{"line":134,"column":41},"end":{"line":134,"column":46}}]},"9":{"line":225,"type":"if","locations":[{"start":{"line":225,"column":4},"end":{"line":225,"column":4}},{"start":{"line":225,"column":4},"end":{"line":225,"column":4}}]},"10":{"line":229,"type":"binary-expr","locations":[{"start":{"line":229,"column":16},"end":{"line":229,"column":35}},{"start":{"line":230,"column":8},"end":{"line":230,"column":47}}]},"11":{"line":237,"type":"if","locations":[{"start":{"line":237,"column":8},"end":{"line":237,"column":8}},{"start":{"line":237,"column":8},"end":{"line":237,"column":8}}]},"12":{"line":239,"type":"if","locations":[{"start":{"line":239,"column":15},"end":{"line":239,"column":15}},{"start":{"line":239,"column":15},"end":{"line":239,"column":15}}]},"13":{"line":241,"type":"if","locations":[{"start":{"line":241,"column":15},"end":{"line":241,"column":15}},{"start":{"line":241,"column":15},"end":{"line":241,"column":15}}]},"14":{"line":251,"type":"if","locations":[{"start":{"line":251,"column":8},"end":{"line":251,"column":8}},{"start":{"line":251,"column":8},"end":{"line":251,"column":8}}]},"15":{"line":256,"type":"if","locations":[{"start":{"line":256,"column":8},"end":{"line":256,"column":8}},{"start":{"line":256,"column":8},"end":{"line":256,"column":8}}]},"16":{"line":256,"type":"binary-expr","locations":[{"start":{"line":256,"column":12},"end":{"line":256,"column":29}},{"start":{"line":257,"column":12},"end":{"line":257,"column":35}},{"start":{"line":258,"column":12},"end":{"line":258,"column":55}},{"start":{"line":259,"column":12},"end":{"line":259,"column":54}}]},"17":{"line":265,"type":"if","locations":[{"start":{"line":265,"column":8},"end":{"line":265,"column":8}},{"start":{"line":265,"column":8},"end":{"line":265,"column":8}}]},"18":{"line":265,"type":"binary-expr","locations":[{"start":{"line":265,"column":12},"end":{"line":265,"column":17}},{"start":{"line":265,"column":21},"end":{"line":265,"column":27}}]},"19":{"line":271,"type":"if","locations":[{"start":{"line":271,"column":8},"end":{"line":271,"column":8}},{"start":{"line":271,"column":8},"end":{"line":271,"column":8}}]},"20":{"line":282,"type":"if","locations":[{"start":{"line":282,"column":8},"end":{"line":282,"column":8}},{"start":{"line":282,"column":8},"end":{"line":282,"column":8}}]},"21":{"line":284,"type":"binary-expr","locations":[{"start":{"line":284,"column":25},"end":{"line":284,"column":53}},{"start":{"line":284,"column":57},"end":{"line":284,"column":60}}]},"22":{"line":287,"type":"binary-expr","locations":[{"start":{"line":287,"column":22},"end":{"line":287,"column":34}},{"start":{"line":287,"column":38},"end":{"line":287,"column":41}}]}},"code":["// Copyright 2012 Mark Cavage <mcavage@gmail.com> All rights reserved.","","'use strict';","","var sprintf = require('util').format;","","var assert = require('assert-plus');","var LRU = require('lru-cache');","","var errors = require('../errors');","","","///--- Globals","","var TooManyRequestsError = errors.TooManyRequestsError;","","var MESSAGE = 'You have exceeded your request rate of %s r/s.';","","","///--- Helpers","","function xor() {","    var x = false;","","    for (var i = 0; i < arguments.length; i++) {","        if (arguments[i] && !x) {","            x = true;","        } else if (arguments[i] && x) {","            return (false);","        }","    }","    return (x);","}","","","///--- Internal Class (TokenBucket)","","/**"," * An implementation of the Token Bucket algorithm."," *"," * Basically, in network throttling, there are two \"mainstream\""," * algorithms for throttling requests, Token Bucket and Leaky Bucket."," * For restify, I went with Token Bucket.  For a good description of the"," * algorithm, see: http://en.wikipedia.org/wiki/Token_bucket"," *"," * In the options object, you pass in the total tokens and the fill rate."," * Practically speaking, this means \"allow `fill rate` requests/second,"," * with bursts up to `total tokens`\".  Note that the bucket is initialized"," * to full."," *"," * Also, in googling, I came across a concise python implementation, so this"," * is just a port of that. Thanks http://code.activestate.com/recipes/511490 !"," *"," * @private"," * @class"," * @param {Object} options contains the parameters:"," *                   - {Number} capacity the maximum burst."," *                   - {Number} fillRate the rate to refill tokens."," */","function TokenBucket(options) {","    assert.object(options, 'options');","    assert.number(options.capacity, 'options.capacity');","    assert.number(options.fillRate, 'options.fillRate');","","    this.tokens = this.capacity = options.capacity;","    this.fillRate = options.fillRate;","    this.time = Date.now();","}","","","/**"," * Consume N tokens from the bucket."," *"," * If there is not capacity, the tokens are not pulled from the bucket."," *"," * @private"," * @function consume"," * @param    {Number}  tokens the number of tokens to pull out."," * @returns  {Boolean}        true if capacity, false otherwise."," */","TokenBucket.prototype.consume = function consume(tokens) {","    if (tokens <= this._fill()) {","        this.tokens -= tokens;","        return (true);","    }","","    return (false);","};","","","/**"," * Fills the bucket with more tokens."," *"," * Rather than do some whacky setTimeout() deal, we just approximate refilling"," * the bucket by tracking elapsed time from the last time we touched the bucket."," *"," * Simply, we set the bucket size to min(totalTokens,"," *                                       current + (fillRate * elapsed time))."," *"," * @private"," * @function _fill"," * @returns  {Number} the current number of tokens in the bucket."," */","TokenBucket.prototype._fill = function _fill() {","    var now = Date.now();","","    // reset account for clock drift (like DST)","    if (now < this.time) {","        this.time = now - 1000;","    }","","    if (this.tokens < this.capacity) {","        var delta = this.fillRate * ((now - this.time) / 1000);","        this.tokens = Math.min(this.capacity, this.tokens + delta);","    }","    this.time = now;","","    return (this.tokens);","};","","","///--- Internal Class (TokenTable)","/**"," * Just a wrapper over LRU that supports put/get to store token -> bucket"," * mappings."," * @private"," * @class"," * @param {Object} options      an options object"," * @param {Number} options.size size of the LRU"," */","function TokenTable(options) {","    assert.object(options, 'options');","","    this.table = new LRU(options.size || 10000);","}","","","/**"," * puts a value in the token table"," * @private"," * @function put"," * @param {String}      key   a name"," * @param {TokenBucket} value a TokenBucket"," * @returns {undefined}"," */","TokenTable.prototype.put = function put(key, value) {","    this.table.set(key, value);","};","","","/**"," * puts a value in the token table"," * @private"," * @function get"," * @param {String} key a key"," * @returns {TokenBucket}"," */","TokenTable.prototype.get = function get(key) {","    return (this.table.get(key));","};","","","///--- Exported API","","/**"," * Creates an API rate limiter that can be plugged into the standard"," * restify request handling pipeline."," *"," * This throttle gives you three options on which to throttle:"," * username, IP address and 'X-Forwarded-For'. IP/XFF is a /32 match,"," * so keep that in mind if using it.  Username takes the user specified"," * on req.username (which gets automagically set for supported Authorization"," * types; otherwise set it yourself with a filter that runs before this)."," *"," * In both cases, you can set a `burst` and a `rate` (in requests/seconds),"," * as an integer/float.  Those really translate to the `TokenBucket`"," * algorithm, so read up on that (or see the comments above...)."," *"," * In either case, the top level options burst/rate set a blanket throttling"," * rate, and then you can pass in an `overrides` object with rates for"," * specific users/IPs.  You should use overrides sparingly, as we make a new"," * TokenBucket to track each."," *"," * On the `options` object ip and username are treated as an XOR."," *"," * An example options object with overrides:"," *"," *  {"," *    burst: 10,  // Max 10 concurrent requests (if tokens)"," *    rate: 0.5,  // Steady state: 1 request / 2 seconds"," *    ip: true,   // throttle per IP"," *    overrides: {"," *      '192.168.1.1': {"," *        burst: 0,"," *        rate: 0    // unlimited"," *    }"," *  }"," *"," * @public"," * @function throttle"," * @throws   {TooManyRequestsError}"," * @param    {Object}    options required options with:"," *                   - {Number} burst (required)."," *                   - {Number} rate (required)."," *                   - {Boolean} ip (optional)."," *                   - {Boolean} username (optional)."," *                   - {Boolean} xff (optional)."," *                   - {Object} overrides (optional)."," *                   - {Object} tokensTable: a storage engine this plugin will"," *                              use to store throttling keys -> bucket mappings."," *                              If you don't specify this, the default is to"," *                              use an in-memory O(1) LRU, with 10k distinct"," *                              keys.  Any implementation just needs to support"," *                              put/get."," *                   - {Number} maxKeys: If using the default implementation,"," *                              you can specify how large you want the table to"," *                              be.  Default is 10000."," * @returns  {Function}"," */","function throttle(options) {","    assert.object(options, 'options');","    assert.number(options.burst, 'options.burst');","    assert.number(options.rate, 'options.rate');","","    if (!xor(options.ip, options.xff, options.username)) {","        throw new Error('(ip ^ username ^ xff)');","    }","","    var table = options.tokensTable ||","        new TokenTable({size: options.maxKeys});","","    function rateLimit(req, res, next) {","        var attr;","        var burst = options.burst;","        var rate = options.rate;","","        if (options.ip) {","            attr = req.connection.remoteAddress;","        } else if (options.xff) {","            attr = req.headers['x-forwarded-for'];","        } else if (options.username) {","            attr = req.username;","        } else {","            req.log.warn({config: options},","                'Invalid throttle configuration');","            return (next());","        }","","        // Before bothering with overrides, see if this request","        // even matches","        if (!attr) {","            return (next());","        }","","        // Check the overrides","        if (options.overrides &&","            options.overrides[attr] &&","            options.overrides[attr].burst !== undefined &&","            options.overrides[attr].rate !== undefined) {","","            burst = options.overrides[attr].burst;","            rate = options.overrides[attr].rate;","        }","","        if (!rate || !burst) {","            return (next());","        }","","        var bucket = table.get(attr);","","        if (!bucket) {","            bucket = new TokenBucket({","                capacity: burst,","                fillRate: rate","            });","            table.put(attr, bucket);","        }","","        req.log.trace('Throttle(%s): num_tokens= %d',","            attr, bucket.tokens);","","        if (!bucket.consume(1)) {","            req.log.info({","                address: req.connection.remoteAddress || '?',","                method: req.method,","                url: req.url,","                user: req.username || '?'","            }, 'Throttling');","","            var msg = sprintf(MESSAGE, rate);","            return (next(new TooManyRequestsError(msg)));","        }","","        return (next());","    }","","    return (rateLimit);","}","","module.exports = throttle;",""],"l":{"5":1,"7":1,"8":1,"10":1,"15":1,"17":1,"22":1,"23":0,"25":0,"26":0,"27":0,"28":0,"29":0,"32":0,"60":1,"61":0,"62":0,"63":0,"65":0,"66":0,"67":0,"81":1,"82":0,"83":0,"84":0,"87":0,"104":1,"105":0,"108":0,"109":0,"112":0,"113":0,"114":0,"116":0,"118":0,"131":1,"132":0,"134":0,"146":1,"147":0,"158":1,"159":0,"220":1,"221":0,"222":0,"223":0,"225":0,"226":0,"229":0,"232":1,"233":0,"234":0,"235":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"244":0,"246":0,"251":0,"252":0,"256":0,"261":0,"262":0,"265":0,"266":0,"269":0,"271":0,"272":0,"276":0,"279":0,"282":0,"283":0,"290":0,"291":0,"294":0,"297":0,"300":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/pre/pause.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/pre/pause.js","s":{"1":1,"2":1,"3":0,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":0,"27":0,"28":0},"b":{"1":[0,0],"2":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"fnMap":{"1":{"name":"pauseStream","line":18,"loc":{"start":{"line":18,"column":0},"end":{"line":18,"column":29}}},"2":{"name":"_buffer","line":19,"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":28}}},"3":{"name":"_catchEnd","line":23,"loc":{"start":{"line":23,"column":4},"end":{"line":23,"column":30}}},"4":{"name":"_rstfy_resume","line":35,"loc":{"start":{"line":35,"column":20},"end":{"line":35,"column":45}}},"5":{"name":"pause","line":58,"loc":{"start":{"line":58,"column":17},"end":{"line":58,"column":34}}},"6":{"name":"prePause","line":60,"loc":{"start":{"line":60,"column":4},"end":{"line":60,"column":38}}}},"statementMap":{"1":{"start":{"line":18,"column":0},"end":{"line":53,"column":1}},"2":{"start":{"line":19,"column":4},"end":{"line":21,"column":5}},"3":{"start":{"line":20,"column":8},"end":{"line":20,"column":38}},"4":{"start":{"line":23,"column":4},"end":{"line":25,"column":5}},"5":{"start":{"line":24,"column":8},"end":{"line":24,"column":36}},"6":{"start":{"line":27,"column":4},"end":{"line":27,"column":33}},"7":{"start":{"line":28,"column":4},"end":{"line":28,"column":33}},"8":{"start":{"line":29,"column":4},"end":{"line":29,"column":27}},"9":{"start":{"line":30,"column":4},"end":{"line":30,"column":31}},"10":{"start":{"line":31,"column":4},"end":{"line":31,"column":34}},"11":{"start":{"line":32,"column":4},"end":{"line":32,"column":19}},"12":{"start":{"line":34,"column":4},"end":{"line":34,"column":35}},"13":{"start":{"line":35,"column":4},"end":{"line":52,"column":6}},"14":{"start":{"line":36,"column":8},"end":{"line":38,"column":9}},"15":{"start":{"line":37,"column":12},"end":{"line":37,"column":19}},"16":{"start":{"line":40,"column":8},"end":{"line":40,"column":47}},"17":{"start":{"line":41,"column":8},"end":{"line":41,"column":48}},"18":{"start":{"line":43,"column":8},"end":{"line":43,"column":68}},"19":{"start":{"line":44,"column":8},"end":{"line":44,"column":37}},"20":{"start":{"line":46,"column":8},"end":{"line":46,"column":25}},"21":{"start":{"line":47,"column":8},"end":{"line":47,"column":39}},"22":{"start":{"line":49,"column":8},"end":{"line":51,"column":9}},"23":{"start":{"line":50,"column":12},"end":{"line":50,"column":31}},"24":{"start":{"line":58,"column":0},"end":{"line":66,"column":2}},"25":{"start":{"line":60,"column":4},"end":{"line":63,"column":5}},"26":{"start":{"line":61,"column":8},"end":{"line":61,"column":25}},"27":{"start":{"line":62,"column":8},"end":{"line":62,"column":15}},"28":{"start":{"line":65,"column":4},"end":{"line":65,"column":22}}},"branchMap":{"1":{"line":36,"type":"if","locations":[{"start":{"line":36,"column":8},"end":{"line":36,"column":8}},{"start":{"line":36,"column":8},"end":{"line":36,"column":8}}]},"2":{"line":49,"type":"if","locations":[{"start":{"line":49,"column":8},"end":{"line":49,"column":8}},{"start":{"line":49,"column":8},"end":{"line":49,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","///--- Helpers","","/**"," * this pre handler fixes issues with node hanging when an asyncHandler is"," * used prior to bodyParser."," * https://github.com/restify/node-restify/issues/287"," * https://github.com/restify/node-restify/issues/409"," * https://github.com/restify/node-restify/wiki/1.4-to-2.0-Migration-Tips"," * @public"," * @function pauseStream"," * @param    {Stream} stream the stream to pause"," * @returns  {undefined}"," */","function pauseStream(stream) {","    function _buffer(chunk) {","        stream.__buffered.push(chunk);","    }","","    function _catchEnd(chunk) {","        stream.__rstfy_ended = true;","    }","","    stream.__rstfy_ended = false;","    stream.__rstfy_paused = true;","    stream.__buffered = [];","    stream.on('data', _buffer);","    stream.once('end', _catchEnd);","    stream.pause();","","    stream._resume = stream.resume;","    stream.resume = function _rstfy_resume() {","        if (!stream.__rstfy_paused) {","            return;","        }","","        stream.removeListener('data', _buffer);","        stream.removeListener('end', _catchEnd);","","        stream.__buffered.forEach(stream.emit.bind(stream, 'data'));","        stream.__buffered.length = 0;","","        stream._resume();","        stream.resume = stream._resume;","","        if (stream.__rstfy_ended) {","            stream.emit('end');","        }","    };","}","","","///--- Exports","","module.exports = function pause() {","","    function prePause(req, res, next) {","        pauseStream(req);","        next();","    }","","    return (prePause);","};",""],"l":{"18":1,"19":1,"20":0,"23":1,"24":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"34":0,"35":0,"36":0,"37":0,"40":0,"41":0,"43":0,"44":0,"46":0,"47":0,"49":0,"50":0,"58":1,"60":1,"61":0,"62":0,"65":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/pre/user_agent.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/plugins/pre/user_agent.js","s":{"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"f":{"1":0,"2":0},"fnMap":{"1":{"name":"userAgentConnection","line":28,"loc":{"start":{"line":28,"column":0},"end":{"line":28,"column":35}}},"2":{"name":"handleUserAgent","line":39,"loc":{"start":{"line":39,"column":4},"end":{"line":39,"column":45}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":36}},"2":{"start":{"line":28,"column":0},"end":{"line":55,"column":1}},"3":{"start":{"line":29,"column":4},"end":{"line":29,"column":43}},"4":{"start":{"line":30,"column":4},"end":{"line":30,"column":22}},"5":{"start":{"line":31,"column":4},"end":{"line":31,"column":75}},"6":{"start":{"line":33,"column":4},"end":{"line":33,"column":34}},"7":{"start":{"line":35,"column":4},"end":{"line":37,"column":5}},"8":{"start":{"line":36,"column":8},"end":{"line":36,"column":23}},"9":{"start":{"line":39,"column":4},"end":{"line":52,"column":5}},"10":{"start":{"line":40,"column":8},"end":{"line":40,"column":43}},"11":{"start":{"line":42,"column":8},"end":{"line":44,"column":9}},"12":{"start":{"line":43,"column":12},"end":{"line":43,"column":49}},"13":{"start":{"line":46,"column":8},"end":{"line":49,"column":9}},"14":{"start":{"line":47,"column":12},"end":{"line":48,"column":62}},"15":{"start":{"line":51,"column":8},"end":{"line":51,"column":15}},"16":{"start":{"line":54,"column":4},"end":{"line":54,"column":29}},"17":{"start":{"line":57,"column":0},"end":{"line":57,"column":37}}},"branchMap":{"1":{"line":30,"type":"binary-expr","locations":[{"start":{"line":30,"column":11},"end":{"line":30,"column":15}},{"start":{"line":30,"column":19},"end":{"line":30,"column":21}}]},"2":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":35,"column":4}},{"start":{"line":35,"column":4},"end":{"line":35,"column":4}}]},"3":{"line":42,"type":"if","locations":[{"start":{"line":42,"column":8},"end":{"line":42,"column":8}},{"start":{"line":42,"column":8},"end":{"line":42,"column":8}}]},"4":{"line":42,"type":"binary-expr","locations":[{"start":{"line":42,"column":12},"end":{"line":42,"column":14}},{"start":{"line":42,"column":18},"end":{"line":42,"column":29}}]},"5":{"line":46,"type":"if","locations":[{"start":{"line":46,"column":8},"end":{"line":46,"column":8}},{"start":{"line":46,"column":8},"end":{"line":46,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var assert = require('assert-plus');","","","///--- API","","/**"," * This basically exists for curl.  curl on HEAD requests usually"," * just sits there and hangs, unless you explicitly set"," * Connection:close.  And in general, you probably want to set"," * Connection: close to curl anyway."," *"," * Also, because curl spits out an annoying message to stderr about"," * remaining bytes if content-length is set, this plugin also drops"," * the content-length header (some user agents handle it and want it,"," * curl does not)."," *"," * To be slightly more generic, the options block takes a user"," * agent regexp, however."," * @public"," * @function userAgentConnection"," * @param    {Object}   opts an options object"," * @returns  {Function}"," */","function userAgentConnection(opts) {","    assert.optionalObject(opts, 'options');","    opts = opts || {};","    assert.optionalObject(opts.userAgentRegExp, 'options.userAgentRegExp');","","    var re = opts.userAgentRegExp;","","    if (!re) {","        re = /^curl.+/;","    }","","    function handleUserAgent(req, res, next) {","        var ua = req.headers['user-agent'];","","        if (ua && re.test(ua)) {","            res.setHeader('Connection', 'close');","        }","","        if (req.method === 'HEAD') {","            res.once('header',","                res.removeHeader.bind(res, 'content-length'));","        }","","        next();","    }","","    return (handleUserAgent);","}","","module.exports = userAgentConnection;",""],"l":{"5":1,"28":1,"29":0,"30":0,"31":0,"33":0,"35":0,"36":0,"39":1,"40":0,"42":0,"43":0,"46":0,"47":0,"51":0,"54":0,"57":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/clients/index.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/clients/index.js","s":{"1":1,"2":1,"3":1,"4":1},"b":{},"f":{},"fnMap":{},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":42}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":42}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":46}},"4":{"start":{"line":12,"column":0},"end":{"line":16,"column":2}}},"branchMap":{},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var HttpClient = require('./http_client');","var JsonClient = require('./json_client');","var StringClient = require('./string_client');","","","///--- Exports","","module.exports = {","    HttpClient: HttpClient,","    JsonClient: JsonClient,","    StringClient: StringClient","};",""],"l":{"5":1,"6":1,"7":1,"12":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/clients/http_client.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/clients/http_client.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":0,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1,"45":0,"46":0,"47":1,"48":0,"49":0,"50":0,"51":0,"52":1,"53":1,"54":0,"55":0,"56":0,"57":0,"58":1,"59":1,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":1,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":1,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":1,"244":1,"245":1,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":1,"256":0,"257":0,"258":1,"259":0,"260":0,"261":1,"262":0,"263":0,"264":1,"265":0,"266":0,"267":1,"268":0,"269":0,"270":1,"271":0,"272":0,"273":1,"274":0,"275":0,"276":1,"277":0,"278":0,"279":0,"280":0,"281":0,"282":1,"283":0,"284":0,"285":0,"286":0,"287":0,"288":0,"289":0,"290":1,"291":0,"292":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":0,"301":0,"302":0,"303":0,"304":0,"305":1,"306":0,"307":0,"308":0,"309":0,"310":0,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"321":0,"322":0,"323":0,"324":0,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"331":0,"332":0,"333":0},"b":{"1":[0,1],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0,0],"6":[0,0,0],"7":[0,0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0],"78":[0,0],"79":[0,0],"80":[0,0],"81":[0,0],"82":[0,0],"83":[0,0],"84":[0,0],"85":[0,0],"86":[0,0],"87":[0,0],"88":[0,0],"89":[0,0],"90":[0,0],"91":[0,0],"92":[0,0],"93":[0,0],"94":[0,0,0],"95":[0,0],"96":[0,0],"97":[0,0],"98":[0,0],"99":[0,0],"100":[0,0,0],"101":[0,0],"102":[0,0],"103":[0,0],"104":[0,0],"105":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},"fnMap":{"1":{"name":"cloneRetryOptions","line":56,"loc":{"start":{"line":56,"column":0},"end":{"line":56,"column":46}}},"2":{"name":"defaultUserAgent","line":77,"loc":{"start":{"line":77,"column":0},"end":{"line":77,"column":28}}},"3":{"name":"ConnectTimeoutError","line":88,"loc":{"start":{"line":88,"column":0},"end":{"line":88,"column":33}}},"4":{"name":"RequestTimeoutError","line":98,"loc":{"start":{"line":98,"column":0},"end":{"line":98,"column":33}}},"5":{"name":"rawRequest","line":108,"loc":{"start":{"line":108,"column":0},"end":{"line":108,"column":30}}},"6":{"name":"connectTimeout","line":127,"loc":{"start":{"line":127,"column":37},"end":{"line":127,"column":63}}},"7":{"name":"(anonymous_7)","line":135,"loc":{"start":{"line":135,"column":54},"end":{"line":135,"column":66}}},"8":{"name":"(anonymous_8)","line":142,"loc":{"start":{"line":142,"column":48},"end":{"line":142,"column":60}}},"9":{"name":"_emit_result","line":151,"loc":{"start":{"line":151,"column":27},"end":{"line":151,"column":67}}},"10":{"name":"onResponse","line":155,"loc":{"start":{"line":155,"column":30},"end":{"line":155,"column":55}}},"11":{"name":"(anonymous_11)","line":159,"loc":{"start":{"line":159,"column":53},"end":{"line":159,"column":65}}},"12":{"name":"onError","line":178,"loc":{"start":{"line":178,"column":20},"end":{"line":178,"column":42}}},"13":{"name":"(anonymous_13)","line":179,"loc":{"start":{"line":179,"column":50},"end":{"line":179,"column":62}}},"14":{"name":"(anonymous_14)","line":189,"loc":{"start":{"line":189,"column":29},"end":{"line":189,"column":41}}},"15":{"name":"onUpgrade","line":195,"loc":{"start":{"line":195,"column":24},"end":{"line":195,"column":63}}},"16":{"name":"(anonymous_16)","line":198,"loc":{"start":{"line":198,"column":53},"end":{"line":198,"column":65}}},"17":{"name":"onSocket","line":216,"loc":{"start":{"line":216,"column":23},"end":{"line":216,"column":49}}},"18":{"name":"onConnect","line":229,"loc":{"start":{"line":229,"column":32},"end":{"line":229,"column":53}}},"19":{"name":"requestTimeout","line":238,"loc":{"start":{"line":238,"column":42},"end":{"line":238,"column":68}}},"20":{"name":"(anonymous_20)","line":242,"loc":{"start":{"line":242,"column":62},"end":{"line":242,"column":74}}},"21":{"name":"(anonymous_21)","line":250,"loc":{"start":{"line":250,"column":41},"end":{"line":250,"column":53}}},"22":{"name":"isProxyForURL","line":272,"loc":{"start":{"line":272,"column":0},"end":{"line":272,"column":32}}},"23":{"name":"HttpClient","line":324,"loc":{"start":{"line":324,"column":0},"end":{"line":324,"column":29}}},"24":{"name":"close","line":466,"loc":{"start":{"line":466,"column":29},"end":{"line":466,"column":46}}},"25":{"name":"(anonymous_25)","line":468,"loc":{"start":{"line":468,"column":41},"end":{"line":468,"column":54}}},"26":{"name":"(anonymous_26)","line":470,"loc":{"start":{"line":470,"column":31},"end":{"line":470,"column":44}}},"27":{"name":"(anonymous_27)","line":477,"loc":{"start":{"line":477,"column":41},"end":{"line":477,"column":54}}},"28":{"name":"(anonymous_28)","line":478,"loc":{"start":{"line":478,"column":27},"end":{"line":478,"column":40}}},"29":{"name":"del","line":485,"loc":{"start":{"line":485,"column":27},"end":{"line":485,"column":59}}},"30":{"name":"get","line":492,"loc":{"start":{"line":492,"column":27},"end":{"line":492,"column":59}}},"31":{"name":"head","line":499,"loc":{"start":{"line":499,"column":28},"end":{"line":499,"column":61}}},"32":{"name":"http_options","line":505,"loc":{"start":{"line":505,"column":28},"end":{"line":505,"column":69}}},"33":{"name":"post","line":512,"loc":{"start":{"line":512,"column":28},"end":{"line":512,"column":61}}},"34":{"name":"put","line":519,"loc":{"start":{"line":519,"column":27},"end":{"line":519,"column":59}}},"35":{"name":"patch","line":526,"loc":{"start":{"line":526,"column":29},"end":{"line":526,"column":63}}},"36":{"name":"read","line":534,"loc":{"start":{"line":534,"column":28},"end":{"line":534,"column":61}}},"37":{"name":"readRequestCallback","line":535,"loc":{"start":{"line":535,"column":34},"end":{"line":535,"column":73}}},"38":{"name":"basicAuth","line":546,"loc":{"start":{"line":546,"column":33},"end":{"line":546,"column":72}}},"39":{"name":"request","line":562,"loc":{"start":{"line":562,"column":31},"end":{"line":562,"column":58}}},"40":{"name":"(anonymous_40)","line":589,"loc":{"start":{"line":589,"column":32},"end":{"line":589,"column":59}}},"41":{"name":"(anonymous_41)","line":631,"loc":{"start":{"line":631,"column":34},"end":{"line":631,"column":47}}},"42":{"name":"(anonymous_42)","line":637,"loc":{"start":{"line":637,"column":38},"end":{"line":637,"column":51}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":50}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":23}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":29}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":23}},"6":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":41}},"8":{"start":{"line":12,"column":0},"end":{"line":12,"column":25}},"9":{"start":{"line":13,"column":0},"end":{"line":13,"column":27}},"10":{"start":{"line":15,"column":0},"end":{"line":15,"column":36}},"11":{"start":{"line":16,"column":0},"end":{"line":16,"column":33}},"12":{"start":{"line":17,"column":0},"end":{"line":17,"column":27}},"13":{"start":{"line":18,"column":0},"end":{"line":18,"column":27}},"14":{"start":{"line":19,"column":0},"end":{"line":19,"column":42}},"15":{"start":{"line":21,"column":0},"end":{"line":21,"column":34}},"16":{"start":{"line":22,"column":0},"end":{"line":22,"column":34}},"17":{"start":{"line":23,"column":0},"end":{"line":23,"column":41}},"18":{"start":{"line":26,"column":0},"end":{"line":26,"column":31}},"19":{"start":{"line":27,"column":0},"end":{"line":27,"column":34}},"20":{"start":{"line":28,"column":0},"end":{"line":28,"column":64}},"21":{"start":{"line":29,"column":0},"end":{"line":29,"column":19}},"22":{"start":{"line":30,"column":0},"end":{"line":30,"column":25}},"23":{"start":{"line":31,"column":0},"end":{"line":31,"column":49}},"24":{"start":{"line":32,"column":0},"end":{"line":32,"column":51}},"25":{"start":{"line":34,"column":0},"end":{"line":46,"column":1}},"26":{"start":{"line":35,"column":4},"end":{"line":35,"column":49}},"27":{"start":{"line":36,"column":4},"end":{"line":36,"column":49}},"28":{"start":{"line":38,"column":4},"end":{"line":38,"column":32}},"29":{"start":{"line":39,"column":4},"end":{"line":39,"column":39}},"30":{"start":{"line":44,"column":4},"end":{"line":44,"column":52}},"31":{"start":{"line":45,"column":4},"end":{"line":45,"column":54}},"32":{"start":{"line":51,"column":0},"end":{"line":51,"column":109}},"33":{"start":{"line":56,"column":0},"end":{"line":74,"column":1}},"34":{"start":{"line":57,"column":4},"end":{"line":59,"column":5}},"35":{"start":{"line":58,"column":8},"end":{"line":58,"column":23}},"36":{"start":{"line":61,"column":4},"end":{"line":61,"column":52}},"37":{"start":{"line":62,"column":4},"end":{"line":62,"column":26}},"38":{"start":{"line":63,"column":4},"end":{"line":63,"column":68}},"39":{"start":{"line":64,"column":4},"end":{"line":64,"column":68}},"40":{"start":{"line":65,"column":4},"end":{"line":65,"column":62}},"41":{"start":{"line":66,"column":4},"end":{"line":66,"column":48}},"42":{"start":{"line":67,"column":4},"end":{"line":67,"column":30}},"43":{"start":{"line":69,"column":4},"end":{"line":73,"column":7}},"44":{"start":{"line":77,"column":0},"end":{"line":85,"column":1}},"45":{"start":{"line":78,"column":4},"end":{"line":82,"column":40}},"46":{"start":{"line":84,"column":4},"end":{"line":84,"column":16}},"47":{"start":{"line":88,"column":0},"end":{"line":95,"column":1}},"48":{"start":{"line":89,"column":4},"end":{"line":91,"column":5}},"49":{"start":{"line":90,"column":8},"end":{"line":90,"column":59}},"50":{"start":{"line":93,"column":4},"end":{"line":93,"column":56}},"51":{"start":{"line":94,"column":4},"end":{"line":94,"column":38}},"52":{"start":{"line":96,"column":0},"end":{"line":96,"column":42}},"53":{"start":{"line":98,"column":0},"end":{"line":105,"column":1}},"54":{"start":{"line":99,"column":4},"end":{"line":101,"column":5}},"55":{"start":{"line":100,"column":8},"end":{"line":100,"column":59}},"56":{"start":{"line":103,"column":4},"end":{"line":103,"column":56}},"57":{"start":{"line":104,"column":4},"end":{"line":104,"column":38}},"58":{"start":{"line":106,"column":0},"end":{"line":106,"column":42}},"59":{"start":{"line":108,"column":0},"end":{"line":268,"column":1}},"60":{"start":{"line":109,"column":4},"end":{"line":109,"column":35}},"61":{"start":{"line":110,"column":4},"end":{"line":110,"column":43}},"62":{"start":{"line":111,"column":4},"end":{"line":111,"column":32}},"63":{"start":{"line":113,"column":4},"end":{"line":113,"column":18}},"64":{"start":{"line":115,"column":4},"end":{"line":115,"column":29}},"65":{"start":{"line":116,"column":4},"end":{"line":116,"column":23}},"66":{"start":{"line":117,"column":4},"end":{"line":117,"column":58}},"67":{"start":{"line":118,"column":4},"end":{"line":118,"column":24}},"68":{"start":{"line":119,"column":4},"end":{"line":119,"column":21}},"69":{"start":{"line":120,"column":4},"end":{"line":120,"column":12}},"70":{"start":{"line":122,"column":4},"end":{"line":124,"column":5}},"71":{"start":{"line":123,"column":8},"end":{"line":123,"column":27}},"72":{"start":{"line":126,"column":4},"end":{"line":140,"column":5}},"73":{"start":{"line":127,"column":8},"end":{"line":139,"column":32}},"74":{"start":{"line":128,"column":12},"end":{"line":128,"column":35}},"75":{"start":{"line":130,"column":12},"end":{"line":132,"column":13}},"76":{"start":{"line":131,"column":16},"end":{"line":131,"column":28}},"77":{"start":{"line":134,"column":12},"end":{"line":134,"column":67}},"78":{"start":{"line":135,"column":12},"end":{"line":137,"column":15}},"79":{"start":{"line":136,"column":16},"end":{"line":136,"column":46}},"80":{"start":{"line":138,"column":12},"end":{"line":138,"column":25}},"81":{"start":{"line":142,"column":4},"end":{"line":149,"column":7}},"82":{"start":{"line":143,"column":8},"end":{"line":148,"column":11}},"83":{"start":{"line":151,"column":4},"end":{"line":153,"column":7}},"84":{"start":{"line":152,"column":8},"end":{"line":152,"column":40}},"85":{"start":{"line":155,"column":4},"end":{"line":175,"column":7}},"86":{"start":{"line":156,"column":8},"end":{"line":156,"column":38}},"87":{"start":{"line":157,"column":8},"end":{"line":157,"column":35}},"88":{"start":{"line":159,"column":8},"end":{"line":161,"column":11}},"89":{"start":{"line":160,"column":12},"end":{"line":160,"column":57}},"90":{"start":{"line":162,"column":8},"end":{"line":162,"column":58}},"91":{"start":{"line":164,"column":8},"end":{"line":164,"column":22}},"92":{"start":{"line":166,"column":8},"end":{"line":166,"column":16}},"93":{"start":{"line":168,"column":8},"end":{"line":170,"column":9}},"94":{"start":{"line":169,"column":12},"end":{"line":169,"column":57}},"95":{"start":{"line":172,"column":8},"end":{"line":172,"column":41}},"96":{"start":{"line":174,"column":8},"end":{"line":174,"column":45}},"97":{"start":{"line":176,"column":4},"end":{"line":176,"column":18}},"98":{"start":{"line":178,"column":4},"end":{"line":193,"column":7}},"99":{"start":{"line":179,"column":8},"end":{"line":181,"column":11}},"100":{"start":{"line":180,"column":12},"end":{"line":180,"column":50}},"101":{"start":{"line":182,"column":8},"end":{"line":182,"column":48}},"102":{"start":{"line":183,"column":8},"end":{"line":183,"column":38}},"103":{"start":{"line":184,"column":8},"end":{"line":184,"column":35}},"104":{"start":{"line":186,"column":8},"end":{"line":186,"column":21}},"105":{"start":{"line":188,"column":8},"end":{"line":192,"column":9}},"106":{"start":{"line":189,"column":12},"end":{"line":191,"column":15}},"107":{"start":{"line":190,"column":16},"end":{"line":190,"column":44}},"108":{"start":{"line":195,"column":4},"end":{"line":214,"column":7}},"109":{"start":{"line":196,"column":8},"end":{"line":196,"column":38}},"110":{"start":{"line":197,"column":8},"end":{"line":197,"column":35}},"111":{"start":{"line":198,"column":8},"end":{"line":200,"column":11}},"112":{"start":{"line":199,"column":12},"end":{"line":199,"column":57}},"113":{"start":{"line":201,"column":8},"end":{"line":201,"column":66}},"114":{"start":{"line":203,"column":8},"end":{"line":203,"column":22}},"115":{"start":{"line":205,"column":8},"end":{"line":205,"column":16}},"116":{"start":{"line":207,"column":8},"end":{"line":209,"column":9}},"117":{"start":{"line":208,"column":12},"end":{"line":208,"column":57}},"118":{"start":{"line":211,"column":8},"end":{"line":211,"column":40}},"119":{"start":{"line":212,"column":8},"end":{"line":212,"column":41}},"120":{"start":{"line":213,"column":8},"end":{"line":213,"column":69}},"121":{"start":{"line":216,"column":4},"end":{"line":259,"column":7}},"122":{"start":{"line":217,"column":8},"end":{"line":217,"column":29}},"123":{"start":{"line":219,"column":8},"end":{"line":221,"column":9}},"124":{"start":{"line":220,"column":12},"end":{"line":220,"column":36}},"125":{"start":{"line":223,"column":8},"end":{"line":227,"column":9}},"126":{"start":{"line":224,"column":12},"end":{"line":224,"column":42}},"127":{"start":{"line":225,"column":12},"end":{"line":225,"column":26}},"128":{"start":{"line":226,"column":12},"end":{"line":226,"column":19}},"129":{"start":{"line":229,"column":8},"end":{"line":258,"column":11}},"130":{"start":{"line":230,"column":12},"end":{"line":230,"column":42}},"131":{"start":{"line":232,"column":12},"end":{"line":235,"column":13}},"132":{"start":{"line":233,"column":16},"end":{"line":233,"column":43}},"133":{"start":{"line":234,"column":16},"end":{"line":234,"column":42}},"134":{"start":{"line":237,"column":12},"end":{"line":255,"column":13}},"135":{"start":{"line":238,"column":16},"end":{"line":254,"column":40}},"136":{"start":{"line":239,"column":20},"end":{"line":239,"column":40}},"137":{"start":{"line":241,"column":20},"end":{"line":241,"column":75}},"138":{"start":{"line":242,"column":20},"end":{"line":244,"column":23}},"139":{"start":{"line":243,"column":24},"end":{"line":243,"column":54}},"140":{"start":{"line":246,"column":20},"end":{"line":246,"column":33}},"141":{"start":{"line":248,"column":20},"end":{"line":253,"column":21}},"142":{"start":{"line":249,"column":24},"end":{"line":249,"column":36}},"143":{"start":{"line":250,"column":24},"end":{"line":252,"column":27}},"144":{"start":{"line":251,"column":28},"end":{"line":251,"column":58}},"145":{"start":{"line":257,"column":12},"end":{"line":257,"column":26}},"146":{"start":{"line":261,"column":4},"end":{"line":263,"column":5}},"147":{"start":{"line":262,"column":8},"end":{"line":262,"column":30}},"148":{"start":{"line":265,"column":4},"end":{"line":267,"column":5}},"149":{"start":{"line":266,"column":8},"end":{"line":266,"column":54}},"150":{"start":{"line":272,"column":0},"end":{"line":321,"column":1}},"151":{"start":{"line":273,"column":4},"end":{"line":273,"column":71}},"152":{"start":{"line":276,"column":4},"end":{"line":278,"column":5}},"153":{"start":{"line":277,"column":8},"end":{"line":277,"column":22}},"154":{"start":{"line":281,"column":4},"end":{"line":319,"column":5}},"155":{"start":{"line":282,"column":8},"end":{"line":283,"column":50}},"156":{"start":{"line":287,"column":8},"end":{"line":287,"column":71}},"157":{"start":{"line":288,"column":8},"end":{"line":288,"column":41}},"158":{"start":{"line":290,"column":8},"end":{"line":318,"column":9}},"159":{"start":{"line":291,"column":12},"end":{"line":291,"column":62}},"160":{"start":{"line":294,"column":12},"end":{"line":317,"column":13}},"161":{"start":{"line":295,"column":16},"end":{"line":295,"column":61}},"162":{"start":{"line":297,"column":16},"end":{"line":297,"column":71}},"163":{"start":{"line":298,"column":16},"end":{"line":298,"column":50}},"164":{"start":{"line":299,"column":16},"end":{"line":300,"column":67}},"165":{"start":{"line":303,"column":16},"end":{"line":307,"column":17}},"166":{"start":{"line":306,"column":20},"end":{"line":306,"column":34}},"167":{"start":{"line":310,"column":16},"end":{"line":310,"column":63}},"168":{"start":{"line":311,"column":16},"end":{"line":311,"column":64}},"169":{"start":{"line":313,"column":16},"end":{"line":316,"column":17}},"170":{"start":{"line":315,"column":20},"end":{"line":315,"column":34}},"171":{"start":{"line":320,"column":4},"end":{"line":320,"column":18}},"172":{"start":{"line":324,"column":0},"end":{"line":460,"column":1}},"173":{"start":{"line":325,"column":4},"end":{"line":325,"column":38}},"174":{"start":{"line":326,"column":4},"end":{"line":326,"column":62}},"175":{"start":{"line":327,"column":4},"end":{"line":327,"column":46}},"176":{"start":{"line":328,"column":4},"end":{"line":328,"column":68}},"177":{"start":{"line":329,"column":4},"end":{"line":329,"column":68}},"178":{"start":{"line":330,"column":4},"end":{"line":330,"column":54}},"179":{"start":{"line":332,"column":4},"end":{"line":332,"column":28}},"180":{"start":{"line":334,"column":4},"end":{"line":334,"column":20}},"181":{"start":{"line":336,"column":4},"end":{"line":336,"column":31}},"182":{"start":{"line":337,"column":4},"end":{"line":337,"column":25}},"183":{"start":{"line":338,"column":4},"end":{"line":338,"column":29}},"184":{"start":{"line":339,"column":4},"end":{"line":339,"column":35}},"185":{"start":{"line":340,"column":4},"end":{"line":340,"column":58}},"186":{"start":{"line":341,"column":4},"end":{"line":341,"column":58}},"187":{"start":{"line":342,"column":4},"end":{"line":342,"column":41}},"188":{"start":{"line":343,"column":4},"end":{"line":343,"column":27}},"189":{"start":{"line":345,"column":4},"end":{"line":349,"column":5}},"190":{"start":{"line":348,"column":8},"end":{"line":348,"column":69}},"191":{"start":{"line":350,"column":4},"end":{"line":350,"column":27}},"192":{"start":{"line":351,"column":4},"end":{"line":351,"column":45}},"193":{"start":{"line":352,"column":4},"end":{"line":352,"column":41}},"194":{"start":{"line":353,"column":4},"end":{"line":353,"column":27}},"195":{"start":{"line":355,"column":4},"end":{"line":359,"column":5}},"196":{"start":{"line":356,"column":8},"end":{"line":356,"column":61}},"197":{"start":{"line":358,"column":8},"end":{"line":358,"column":39}},"198":{"start":{"line":361,"column":4},"end":{"line":361,"column":50}},"199":{"start":{"line":362,"column":4},"end":{"line":362,"column":52}},"200":{"start":{"line":363,"column":4},"end":{"line":363,"column":50}},"201":{"start":{"line":364,"column":4},"end":{"line":364,"column":57}},"202":{"start":{"line":366,"column":4},"end":{"line":374,"column":5}},"203":{"start":{"line":367,"column":8},"end":{"line":367,"column":56}},"204":{"start":{"line":368,"column":11},"end":{"line":374,"column":5}},"205":{"start":{"line":369,"column":8},"end":{"line":369,"column":55}},"206":{"start":{"line":370,"column":11},"end":{"line":374,"column":5}},"207":{"start":{"line":371,"column":8},"end":{"line":371,"column":35}},"208":{"start":{"line":373,"column":8},"end":{"line":373,"column":27}},"209":{"start":{"line":376,"column":4},"end":{"line":378,"column":5}},"210":{"start":{"line":377,"column":8},"end":{"line":377,"column":27}},"211":{"start":{"line":380,"column":4},"end":{"line":386,"column":5}},"212":{"start":{"line":381,"column":8},"end":{"line":383,"column":9}},"213":{"start":{"line":382,"column":12},"end":{"line":382,"column":57}},"214":{"start":{"line":385,"column":8},"end":{"line":385,"column":45}},"215":{"start":{"line":388,"column":4},"end":{"line":394,"column":5}},"216":{"start":{"line":389,"column":8},"end":{"line":391,"column":9}},"217":{"start":{"line":390,"column":12},"end":{"line":390,"column":60}},"218":{"start":{"line":393,"column":8},"end":{"line":393,"column":59}},"219":{"start":{"line":396,"column":4},"end":{"line":399,"column":5}},"220":{"start":{"line":397,"column":8},"end":{"line":398,"column":31}},"221":{"start":{"line":401,"column":4},"end":{"line":403,"column":5}},"222":{"start":{"line":402,"column":8},"end":{"line":402,"column":57}},"223":{"start":{"line":405,"column":4},"end":{"line":459,"column":5}},"224":{"start":{"line":406,"column":8},"end":{"line":406,"column":18}},"225":{"start":{"line":407,"column":8},"end":{"line":407,"column":23}},"226":{"start":{"line":409,"column":8},"end":{"line":429,"column":9}},"227":{"start":{"line":410,"column":12},"end":{"line":422,"column":13}},"228":{"start":{"line":411,"column":16},"end":{"line":415,"column":17}},"229":{"start":{"line":412,"column":20},"end":{"line":412,"column":55}},"230":{"start":{"line":414,"column":20},"end":{"line":414,"column":54}},"231":{"start":{"line":417,"column":16},"end":{"line":421,"column":17}},"232":{"start":{"line":418,"column":20},"end":{"line":418,"column":54}},"233":{"start":{"line":420,"column":20},"end":{"line":420,"column":53}},"234":{"start":{"line":423,"column":15},"end":{"line":429,"column":9}},"235":{"start":{"line":424,"column":12},"end":{"line":424,"column":41}},"236":{"start":{"line":425,"column":12},"end":{"line":425,"column":41}},"237":{"start":{"line":427,"column":12},"end":{"line":427,"column":35}},"238":{"start":{"line":428,"column":12},"end":{"line":428,"column":40}},"239":{"start":{"line":431,"column":8},"end":{"line":458,"column":9}},"240":{"start":{"line":432,"column":12},"end":{"line":436,"column":15}},"241":{"start":{"line":438,"column":12},"end":{"line":456,"column":15}},"242":{"start":{"line":457,"column":12},"end":{"line":457,"column":36}},"243":{"start":{"line":461,"column":0},"end":{"line":461,"column":40}},"244":{"start":{"line":463,"column":0},"end":{"line":463,"column":28}},"245":{"start":{"line":466,"column":0},"end":{"line":482,"column":2}},"246":{"start":{"line":467,"column":4},"end":{"line":467,"column":37}},"247":{"start":{"line":468,"column":4},"end":{"line":474,"column":7}},"248":{"start":{"line":469,"column":8},"end":{"line":473,"column":9}},"249":{"start":{"line":470,"column":12},"end":{"line":472,"column":15}},"250":{"start":{"line":471,"column":16},"end":{"line":471,"column":24}},"251":{"start":{"line":476,"column":4},"end":{"line":476,"column":63}},"252":{"start":{"line":477,"column":4},"end":{"line":481,"column":7}},"253":{"start":{"line":478,"column":8},"end":{"line":480,"column":11}},"254":{"start":{"line":479,"column":12},"end":{"line":479,"column":20}},"255":{"start":{"line":485,"column":0},"end":{"line":489,"column":2}},"256":{"start":{"line":486,"column":4},"end":{"line":486,"column":48}},"257":{"start":{"line":488,"column":4},"end":{"line":488,"column":39}},"258":{"start":{"line":492,"column":0},"end":{"line":496,"column":2}},"259":{"start":{"line":493,"column":4},"end":{"line":493,"column":45}},"260":{"start":{"line":495,"column":4},"end":{"line":495,"column":39}},"261":{"start":{"line":499,"column":0},"end":{"line":503,"column":2}},"262":{"start":{"line":500,"column":4},"end":{"line":500,"column":46}},"263":{"start":{"line":502,"column":4},"end":{"line":502,"column":39}},"264":{"start":{"line":505,"column":0},"end":{"line":509,"column":2}},"265":{"start":{"line":506,"column":4},"end":{"line":506,"column":50}},"266":{"start":{"line":508,"column":4},"end":{"line":508,"column":40}},"267":{"start":{"line":512,"column":0},"end":{"line":516,"column":2}},"268":{"start":{"line":513,"column":4},"end":{"line":513,"column":46}},"269":{"start":{"line":515,"column":4},"end":{"line":515,"column":42}},"270":{"start":{"line":519,"column":0},"end":{"line":523,"column":2}},"271":{"start":{"line":520,"column":4},"end":{"line":520,"column":45}},"272":{"start":{"line":522,"column":4},"end":{"line":522,"column":42}},"273":{"start":{"line":526,"column":0},"end":{"line":531,"column":2}},"274":{"start":{"line":527,"column":4},"end":{"line":527,"column":47}},"275":{"start":{"line":530,"column":4},"end":{"line":530,"column":42}},"276":{"start":{"line":534,"column":0},"end":{"line":543,"column":2}},"277":{"start":{"line":535,"column":4},"end":{"line":541,"column":7}},"278":{"start":{"line":536,"column":8},"end":{"line":538,"column":9}},"279":{"start":{"line":537,"column":12},"end":{"line":537,"column":22}},"280":{"start":{"line":540,"column":8},"end":{"line":540,"column":36}},"281":{"start":{"line":542,"column":4},"end":{"line":542,"column":15}},"282":{"start":{"line":546,"column":0},"end":{"line":559,"column":2}},"283":{"start":{"line":547,"column":4},"end":{"line":556,"column":5}},"284":{"start":{"line":548,"column":8},"end":{"line":548,"column":42}},"285":{"start":{"line":550,"column":8},"end":{"line":550,"column":44}},"286":{"start":{"line":551,"column":8},"end":{"line":551,"column":44}},"287":{"start":{"line":553,"column":8},"end":{"line":553,"column":67}},"288":{"start":{"line":554,"column":8},"end":{"line":555,"column":38}},"289":{"start":{"line":558,"column":4},"end":{"line":558,"column":18}},"290":{"start":{"line":562,"column":0},"end":{"line":586,"column":2}},"291":{"start":{"line":563,"column":4},"end":{"line":563,"column":35}},"292":{"start":{"line":564,"column":4},"end":{"line":564,"column":32}},"293":{"start":{"line":566,"column":4},"end":{"line":566,"column":18}},"294":{"start":{"line":568,"column":4},"end":{"line":571,"column":5}},"295":{"start":{"line":569,"column":8},"end":{"line":569,"column":29}},"296":{"start":{"line":570,"column":8},"end":{"line":570,"column":15}},"297":{"start":{"line":573,"column":4},"end":{"line":573,"column":13}},"298":{"start":{"line":574,"column":4},"end":{"line":574,"column":46}},"299":{"start":{"line":576,"column":4},"end":{"line":576,"column":40}},"300":{"start":{"line":577,"column":4},"end":{"line":577,"column":46}},"301":{"start":{"line":578,"column":4},"end":{"line":581,"column":8}},"302":{"start":{"line":582,"column":4},"end":{"line":582,"column":34}},"303":{"start":{"line":583,"column":4},"end":{"line":583,"column":56}},"304":{"start":{"line":585,"column":4},"end":{"line":585,"column":17}},"305":{"start":{"line":589,"column":0},"end":{"line":666,"column":2}},"306":{"start":{"line":590,"column":4},"end":{"line":592,"column":5}},"307":{"start":{"line":591,"column":8},"end":{"line":591,"column":36}},"308":{"start":{"line":594,"column":4},"end":{"line":594,"column":20}},"309":{"start":{"line":595,"column":4},"end":{"line":613,"column":6}},"310":{"start":{"line":615,"column":4},"end":{"line":617,"column":5}},"311":{"start":{"line":616,"column":8},"end":{"line":616,"column":32}},"312":{"start":{"line":621,"column":4},"end":{"line":625,"column":5}},"313":{"start":{"line":624,"column":8},"end":{"line":624,"column":64}},"314":{"start":{"line":627,"column":4},"end":{"line":629,"column":5}},"315":{"start":{"line":628,"column":8},"end":{"line":628,"column":42}},"316":{"start":{"line":631,"column":4},"end":{"line":635,"column":7}},"317":{"start":{"line":632,"column":8},"end":{"line":634,"column":9}},"318":{"start":{"line":633,"column":12},"end":{"line":633,"column":34}},"319":{"start":{"line":637,"column":4},"end":{"line":641,"column":7}},"320":{"start":{"line":638,"column":8},"end":{"line":640,"column":9}},"321":{"start":{"line":639,"column":12},"end":{"line":639,"column":46}},"322":{"start":{"line":643,"column":4},"end":{"line":645,"column":5}},"323":{"start":{"line":644,"column":8},"end":{"line":644,"column":53}},"324":{"start":{"line":647,"column":4},"end":{"line":663,"column":5}},"325":{"start":{"line":648,"column":8},"end":{"line":650,"column":9}},"326":{"start":{"line":649,"column":12},"end":{"line":649,"column":48}},"327":{"start":{"line":652,"column":8},"end":{"line":654,"column":9}},"328":{"start":{"line":653,"column":12},"end":{"line":653,"column":47}},"329":{"start":{"line":656,"column":8},"end":{"line":658,"column":9}},"330":{"start":{"line":657,"column":12},"end":{"line":657,"column":50}},"331":{"start":{"line":660,"column":8},"end":{"line":662,"column":9}},"332":{"start":{"line":661,"column":12},"end":{"line":661,"column":53}},"333":{"start":{"line":665,"column":4},"end":{"line":665,"column":18}}},"branchMap":{"1":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":0},"end":{"line":34,"column":0}},{"start":{"line":34,"column":0},"end":{"line":34,"column":0}}]},"2":{"line":57,"type":"if","locations":[{"start":{"line":57,"column":4},"end":{"line":57,"column":4}},{"start":{"line":57,"column":4},"end":{"line":57,"column":4}}]},"3":{"line":62,"type":"binary-expr","locations":[{"start":{"line":62,"column":12},"end":{"line":62,"column":19}},{"start":{"line":62,"column":23},"end":{"line":62,"column":25}}]},"4":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":15},"end":{"line":67,"column":23}},{"start":{"line":67,"column":27},"end":{"line":67,"column":29}}]},"5":{"line":70,"type":"binary-expr","locations":[{"start":{"line":70,"column":20},"end":{"line":70,"column":32}},{"start":{"line":70,"column":36},"end":{"line":70,"column":55}},{"start":{"line":70,"column":59},"end":{"line":70,"column":63}}]},"6":{"line":71,"type":"binary-expr","locations":[{"start":{"line":71,"column":20},"end":{"line":71,"column":32}},{"start":{"line":71,"column":36},"end":{"line":71,"column":55}},{"start":{"line":71,"column":59},"end":{"line":71,"column":67}}]},"7":{"line":72,"type":"binary-expr","locations":[{"start":{"line":72,"column":17},"end":{"line":72,"column":26}},{"start":{"line":72,"column":30},"end":{"line":72,"column":46}},{"start":{"line":72,"column":50},"end":{"line":72,"column":51}}]},"8":{"line":89,"type":"if","locations":[{"start":{"line":89,"column":4},"end":{"line":89,"column":4}},{"start":{"line":89,"column":4},"end":{"line":89,"column":4}}]},"9":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":4},"end":{"line":99,"column":4}},{"start":{"line":99,"column":4},"end":{"line":99,"column":4}}]},"10":{"line":117,"type":"cond-expr","locations":[{"start":{"line":117,"column":45},"end":{"line":117,"column":50}},{"start":{"line":117,"column":53},"end":{"line":117,"column":57}}]},"11":{"line":122,"type":"if","locations":[{"start":{"line":122,"column":4},"end":{"line":122,"column":4}},{"start":{"line":122,"column":4},"end":{"line":122,"column":4}}]},"12":{"line":122,"type":"binary-expr","locations":[{"start":{"line":122,"column":8},"end":{"line":122,"column":17}},{"start":{"line":122,"column":21},"end":{"line":122,"column":29}}]},"13":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":4},"end":{"line":126,"column":4}},{"start":{"line":126,"column":4},"end":{"line":126,"column":4}}]},"14":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":12},"end":{"line":130,"column":12}},{"start":{"line":130,"column":12},"end":{"line":130,"column":12}}]},"15":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":8},"end":{"line":168,"column":8}},{"start":{"line":168,"column":8},"end":{"line":168,"column":8}}]},"16":{"line":174,"type":"binary-expr","locations":[{"start":{"line":174,"column":21},"end":{"line":174,"column":24}},{"start":{"line":174,"column":28},"end":{"line":174,"column":32}}]},"17":{"line":180,"type":"binary-expr","locations":[{"start":{"line":180,"column":26},"end":{"line":180,"column":29}},{"start":{"line":180,"column":33},"end":{"line":180,"column":35}}]},"18":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":8},"end":{"line":188,"column":8}},{"start":{"line":188,"column":8},"end":{"line":188,"column":8}}]},"19":{"line":207,"type":"if","locations":[{"start":{"line":207,"column":8},"end":{"line":207,"column":8}},{"start":{"line":207,"column":8},"end":{"line":207,"column":8}}]},"20":{"line":213,"type":"binary-expr","locations":[{"start":{"line":213,"column":35},"end":{"line":213,"column":38}},{"start":{"line":213,"column":42},"end":{"line":213,"column":46}}]},"21":{"line":219,"type":"if","locations":[{"start":{"line":219,"column":8},"end":{"line":219,"column":8}},{"start":{"line":219,"column":8},"end":{"line":219,"column":8}}]},"22":{"line":219,"type":"binary-expr","locations":[{"start":{"line":219,"column":12},"end":{"line":219,"column":38}},{"start":{"line":219,"column":42},"end":{"line":219,"column":55}}]},"23":{"line":223,"type":"if","locations":[{"start":{"line":223,"column":8},"end":{"line":223,"column":8}},{"start":{"line":223,"column":8},"end":{"line":223,"column":8}}]},"24":{"line":223,"type":"binary-expr","locations":[{"start":{"line":223,"column":12},"end":{"line":223,"column":28}},{"start":{"line":223,"column":32},"end":{"line":223,"column":52}}]},"25":{"line":232,"type":"if","locations":[{"start":{"line":232,"column":12},"end":{"line":232,"column":12}},{"start":{"line":232,"column":12},"end":{"line":232,"column":12}}]},"26":{"line":237,"type":"if","locations":[{"start":{"line":237,"column":12},"end":{"line":237,"column":12}},{"start":{"line":237,"column":12},"end":{"line":237,"column":12}}]},"27":{"line":248,"type":"if","locations":[{"start":{"line":248,"column":20},"end":{"line":248,"column":20}},{"start":{"line":248,"column":20},"end":{"line":248,"column":20}}]},"28":{"line":261,"type":"if","locations":[{"start":{"line":261,"column":4},"end":{"line":261,"column":4}},{"start":{"line":261,"column":4},"end":{"line":261,"column":4}}]},"29":{"line":265,"type":"if","locations":[{"start":{"line":265,"column":4},"end":{"line":265,"column":4}},{"start":{"line":265,"column":4},"end":{"line":265,"column":4}}]},"30":{"line":273,"type":"binary-expr","locations":[{"start":{"line":273,"column":18},"end":{"line":273,"column":38}},{"start":{"line":273,"column":42},"end":{"line":273,"column":62}},{"start":{"line":273,"column":66},"end":{"line":273,"column":70}}]},"31":{"line":276,"type":"if","locations":[{"start":{"line":276,"column":4},"end":{"line":276,"column":4}},{"start":{"line":276,"column":4},"end":{"line":276,"column":4}}]},"32":{"line":281,"type":"if","locations":[{"start":{"line":281,"column":4},"end":{"line":281,"column":4}},{"start":{"line":281,"column":4},"end":{"line":281,"column":4}}]},"33":{"line":294,"type":"if","locations":[{"start":{"line":294,"column":12},"end":{"line":294,"column":12}},{"start":{"line":294,"column":12},"end":{"line":294,"column":12}}]},"34":{"line":299,"type":"binary-expr","locations":[{"start":{"line":299,"column":23},"end":{"line":299,"column":35}},{"start":{"line":300,"column":21},"end":{"line":300,"column":65}}]},"35":{"line":300,"type":"cond-expr","locations":[{"start":{"line":300,"column":53},"end":{"line":300,"column":58}},{"start":{"line":300,"column":61},"end":{"line":300,"column":65}}]},"36":{"line":303,"type":"if","locations":[{"start":{"line":303,"column":16},"end":{"line":303,"column":16}},{"start":{"line":303,"column":16},"end":{"line":303,"column":16}}]},"37":{"line":303,"type":"binary-expr","locations":[{"start":{"line":303,"column":20},"end":{"line":303,"column":40}},{"start":{"line":304,"column":20},"end":{"line":305,"column":56}}]},"38":{"line":313,"type":"if","locations":[{"start":{"line":313,"column":16},"end":{"line":313,"column":16}},{"start":{"line":313,"column":16},"end":{"line":313,"column":16}}]},"39":{"line":313,"type":"binary-expr","locations":[{"start":{"line":313,"column":20},"end":{"line":313,"column":36}},{"start":{"line":314,"column":20},"end":{"line":314,"column":72}}]},"40":{"line":340,"type":"binary-expr","locations":[{"start":{"line":340,"column":26},"end":{"line":340,"column":48}},{"start":{"line":340,"column":52},"end":{"line":340,"column":57}}]},"41":{"line":341,"type":"binary-expr","locations":[{"start":{"line":341,"column":26},"end":{"line":341,"column":48}},{"start":{"line":341,"column":52},"end":{"line":341,"column":57}}]},"42":{"line":342,"type":"binary-expr","locations":[{"start":{"line":342,"column":19},"end":{"line":342,"column":34}},{"start":{"line":342,"column":38},"end":{"line":342,"column":40}}]},"43":{"line":345,"type":"if","locations":[{"start":{"line":345,"column":4},"end":{"line":345,"column":4}},{"start":{"line":345,"column":4},"end":{"line":345,"column":4}}]},"44":{"line":351,"type":"binary-expr","locations":[{"start":{"line":351,"column":16},"end":{"line":351,"column":28}},{"start":{"line":351,"column":32},"end":{"line":351,"column":44}}]},"45":{"line":355,"type":"if","locations":[{"start":{"line":355,"column":4},"end":{"line":355,"column":4}},{"start":{"line":355,"column":4},"end":{"line":355,"column":4}}]},"46":{"line":362,"type":"binary-expr","locations":[{"start":{"line":362,"column":23},"end":{"line":362,"column":42}},{"start":{"line":362,"column":46},"end":{"line":362,"column":51}}]},"47":{"line":363,"type":"binary-expr","locations":[{"start":{"line":363,"column":22},"end":{"line":363,"column":40}},{"start":{"line":363,"column":44},"end":{"line":363,"column":49}}]},"48":{"line":364,"type":"cond-expr","locations":[{"start":{"line":364,"column":29},"end":{"line":364,"column":51}},{"start":{"line":364,"column":54},"end":{"line":364,"column":56}}]},"49":{"line":366,"type":"if","locations":[{"start":{"line":366,"column":4},"end":{"line":366,"column":4}},{"start":{"line":366,"column":4},"end":{"line":366,"column":4}}]},"50":{"line":368,"type":"if","locations":[{"start":{"line":368,"column":11},"end":{"line":368,"column":11}},{"start":{"line":368,"column":11},"end":{"line":368,"column":11}}]},"51":{"line":370,"type":"if","locations":[{"start":{"line":370,"column":11},"end":{"line":370,"column":11}},{"start":{"line":370,"column":11},"end":{"line":370,"column":11}}]},"52":{"line":376,"type":"if","locations":[{"start":{"line":376,"column":4},"end":{"line":376,"column":4}},{"start":{"line":376,"column":4},"end":{"line":376,"column":4}}]},"53":{"line":376,"type":"binary-expr","locations":[{"start":{"line":376,"column":8},"end":{"line":376,"column":18}},{"start":{"line":376,"column":22},"end":{"line":376,"column":46}}]},"54":{"line":380,"type":"if","locations":[{"start":{"line":380,"column":4},"end":{"line":380,"column":4}},{"start":{"line":380,"column":4},"end":{"line":380,"column":4}}]},"55":{"line":381,"type":"if","locations":[{"start":{"line":381,"column":8},"end":{"line":381,"column":8}},{"start":{"line":381,"column":8},"end":{"line":381,"column":8}}]},"56":{"line":388,"type":"if","locations":[{"start":{"line":388,"column":4},"end":{"line":388,"column":4}},{"start":{"line":388,"column":4},"end":{"line":388,"column":4}}]},"57":{"line":389,"type":"if","locations":[{"start":{"line":389,"column":8},"end":{"line":389,"column":8}},{"start":{"line":389,"column":8},"end":{"line":389,"column":8}}]},"58":{"line":396,"type":"if","locations":[{"start":{"line":396,"column":4},"end":{"line":396,"column":4}},{"start":{"line":396,"column":4},"end":{"line":396,"column":4}}]},"59":{"line":397,"type":"binary-expr","locations":[{"start":{"line":397,"column":37},"end":{"line":397,"column":54}},{"start":{"line":398,"column":12},"end":{"line":398,"column":30}}]},"60":{"line":401,"type":"if","locations":[{"start":{"line":401,"column":4},"end":{"line":401,"column":4}},{"start":{"line":401,"column":4},"end":{"line":401,"column":4}}]},"61":{"line":405,"type":"if","locations":[{"start":{"line":405,"column":4},"end":{"line":405,"column":4}},{"start":{"line":405,"column":4},"end":{"line":405,"column":4}}]},"62":{"line":409,"type":"if","locations":[{"start":{"line":409,"column":8},"end":{"line":409,"column":8}},{"start":{"line":409,"column":8},"end":{"line":409,"column":8}}]},"63":{"line":410,"type":"if","locations":[{"start":{"line":410,"column":12},"end":{"line":410,"column":12}},{"start":{"line":410,"column":12},"end":{"line":410,"column":12}}]},"64":{"line":411,"type":"if","locations":[{"start":{"line":411,"column":16},"end":{"line":411,"column":16}},{"start":{"line":411,"column":16},"end":{"line":411,"column":16}}]},"65":{"line":417,"type":"if","locations":[{"start":{"line":417,"column":16},"end":{"line":417,"column":16}},{"start":{"line":417,"column":16},"end":{"line":417,"column":16}}]},"66":{"line":423,"type":"if","locations":[{"start":{"line":423,"column":15},"end":{"line":423,"column":15}},{"start":{"line":423,"column":15},"end":{"line":423,"column":15}}]},"67":{"line":431,"type":"if","locations":[{"start":{"line":431,"column":8},"end":{"line":431,"column":8}},{"start":{"line":431,"column":8},"end":{"line":431,"column":8}}]},"68":{"line":468,"type":"binary-expr","locations":[{"start":{"line":468,"column":17},"end":{"line":468,"column":24}},{"start":{"line":468,"column":28},"end":{"line":468,"column":30}}]},"69":{"line":469,"type":"if","locations":[{"start":{"line":469,"column":8},"end":{"line":469,"column":8}},{"start":{"line":469,"column":8},"end":{"line":469,"column":8}}]},"70":{"line":476,"type":"binary-expr","locations":[{"start":{"line":476,"column":14},"end":{"line":476,"column":36}},{"start":{"line":476,"column":40},"end":{"line":476,"column":62}}]},"71":{"line":477,"type":"binary-expr","locations":[{"start":{"line":477,"column":17},"end":{"line":477,"column":24}},{"start":{"line":477,"column":28},"end":{"line":477,"column":30}}]},"72":{"line":536,"type":"if","locations":[{"start":{"line":536,"column":8},"end":{"line":536,"column":8}},{"start":{"line":536,"column":8},"end":{"line":536,"column":8}}]},"73":{"line":547,"type":"if","locations":[{"start":{"line":547,"column":4},"end":{"line":547,"column":4}},{"start":{"line":547,"column":4},"end":{"line":547,"column":4}}]},"74":{"line":568,"type":"if","locations":[{"start":{"line":568,"column":4},"end":{"line":568,"column":4}},{"start":{"line":568,"column":4},"end":{"line":568,"column":4}}]},"75":{"line":590,"type":"if","locations":[{"start":{"line":590,"column":4},"end":{"line":590,"column":4}},{"start":{"line":590,"column":4},"end":{"line":590,"column":4}}]},"76":{"line":596,"type":"cond-expr","locations":[{"start":{"line":596,"column":45},"end":{"line":596,"column":58}},{"start":{"line":596,"column":61},"end":{"line":596,"column":71}}]},"77":{"line":597,"type":"binary-expr","locations":[{"start":{"line":597,"column":12},"end":{"line":597,"column":22}},{"start":{"line":597,"column":26},"end":{"line":597,"column":33}}]},"78":{"line":598,"type":"binary-expr","locations":[{"start":{"line":598,"column":14},"end":{"line":598,"column":26}},{"start":{"line":598,"column":30},"end":{"line":598,"column":39}}]},"79":{"line":599,"type":"binary-expr","locations":[{"start":{"line":599,"column":17},"end":{"line":599,"column":32}},{"start":{"line":599,"column":36},"end":{"line":599,"column":48}}]},"80":{"line":600,"type":"binary-expr","locations":[{"start":{"line":600,"column":24},"end":{"line":600,"column":46}},{"start":{"line":600,"column":50},"end":{"line":600,"column":69}}]},"81":{"line":601,"type":"binary-expr","locations":[{"start":{"line":601,"column":24},"end":{"line":601,"column":46}},{"start":{"line":601,"column":50},"end":{"line":601,"column":69}}]},"82":{"line":602,"type":"binary-expr","locations":[{"start":{"line":602,"column":17},"end":{"line":602,"column":32}},{"start":{"line":602,"column":36},"end":{"line":602,"column":38}}]},"83":{"line":603,"type":"binary-expr","locations":[{"start":{"line":603,"column":13},"end":{"line":603,"column":24}},{"start":{"line":603,"column":28},"end":{"line":603,"column":36}}]},"84":{"line":604,"type":"binary-expr","locations":[{"start":{"line":604,"column":13},"end":{"line":604,"column":24}},{"start":{"line":604,"column":28},"end":{"line":604,"column":36}}]},"85":{"line":606,"type":"binary-expr","locations":[{"start":{"line":606,"column":20},"end":{"line":606,"column":38}},{"start":{"line":606,"column":42},"end":{"line":606,"column":57}}]},"86":{"line":607,"type":"binary-expr","locations":[{"start":{"line":607,"column":14},"end":{"line":607,"column":26}},{"start":{"line":607,"column":30},"end":{"line":607,"column":39}}]},"87":{"line":608,"type":"binary-expr","locations":[{"start":{"line":608,"column":13},"end":{"line":608,"column":24}},{"start":{"line":608,"column":28},"end":{"line":608,"column":36}}]},"88":{"line":609,"type":"binary-expr","locations":[{"start":{"line":609,"column":28},"end":{"line":609,"column":54}},{"start":{"line":610,"column":12},"end":{"line":610,"column":35}}]},"89":{"line":611,"type":"cond-expr","locations":[{"start":{"line":611,"column":41},"end":{"line":611,"column":54}},{"start":{"line":611,"column":57},"end":{"line":611,"column":62}}]},"90":{"line":612,"type":"binary-expr","locations":[{"start":{"line":612,"column":21},"end":{"line":612,"column":40}},{"start":{"line":612,"column":44},"end":{"line":612,"column":60}}]},"91":{"line":615,"type":"if","locations":[{"start":{"line":615,"column":4},"end":{"line":615,"column":4}},{"start":{"line":615,"column":4},"end":{"line":615,"column":4}}]},"92":{"line":615,"type":"binary-expr","locations":[{"start":{"line":615,"column":8},"end":{"line":615,"column":19}},{"start":{"line":615,"column":23},"end":{"line":615,"column":43}}]},"93":{"line":621,"type":"if","locations":[{"start":{"line":621,"column":4},"end":{"line":621,"column":4}},{"start":{"line":621,"column":4},"end":{"line":621,"column":4}}]},"94":{"line":621,"type":"binary-expr","locations":[{"start":{"line":621,"column":8},"end":{"line":621,"column":21}},{"start":{"line":622,"column":8},"end":{"line":622,"column":41}},{"start":{"line":623,"column":8},"end":{"line":623,"column":37}}]},"95":{"line":627,"type":"if","locations":[{"start":{"line":627,"column":4},"end":{"line":627,"column":4}},{"start":{"line":627,"column":4},"end":{"line":627,"column":4}}]},"96":{"line":632,"type":"if","locations":[{"start":{"line":632,"column":8},"end":{"line":632,"column":8}},{"start":{"line":632,"column":8},"end":{"line":632,"column":8}}]},"97":{"line":638,"type":"if","locations":[{"start":{"line":638,"column":8},"end":{"line":638,"column":8}},{"start":{"line":638,"column":8},"end":{"line":638,"column":8}}]},"98":{"line":643,"type":"if","locations":[{"start":{"line":643,"column":4},"end":{"line":643,"column":4}},{"start":{"line":643,"column":4},"end":{"line":643,"column":4}}]},"99":{"line":647,"type":"if","locations":[{"start":{"line":647,"column":4},"end":{"line":647,"column":4}},{"start":{"line":647,"column":4},"end":{"line":647,"column":4}}]},"100":{"line":647,"type":"binary-expr","locations":[{"start":{"line":647,"column":8},"end":{"line":647,"column":24}},{"start":{"line":647,"column":28},"end":{"line":647,"column":45}},{"start":{"line":647,"column":49},"end":{"line":647,"column":68}}]},"101":{"line":648,"type":"if","locations":[{"start":{"line":648,"column":8},"end":{"line":648,"column":8}},{"start":{"line":648,"column":8},"end":{"line":648,"column":8}}]},"102":{"line":652,"type":"if","locations":[{"start":{"line":652,"column":8},"end":{"line":652,"column":8}},{"start":{"line":652,"column":8},"end":{"line":652,"column":8}}]},"103":{"line":656,"type":"if","locations":[{"start":{"line":656,"column":8},"end":{"line":656,"column":8}},{"start":{"line":656,"column":8},"end":{"line":656,"column":8}}]},"104":{"line":656,"type":"binary-expr","locations":[{"start":{"line":656,"column":12},"end":{"line":656,"column":42}},{"start":{"line":656,"column":46},"end":{"line":656,"column":65}}]},"105":{"line":660,"type":"if","locations":[{"start":{"line":660,"column":8},"end":{"line":660,"column":8}},{"start":{"line":660,"column":8},"end":{"line":660,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var EventEmitter = require('events').EventEmitter;","var fs = require('fs');","var http = require('http');","var https = require('https');","var os = require('os');","var path = require('path');","var querystring = require('querystring');","var url = require('url');","var util = require('util');","","var assert = require('assert-plus');","var backoff = require('backoff');","var mime = require('mime');","var once = require('once');","var tunnelAgent = require('tunnel-agent');","","var dtrace = require('../dtrace');","var errors = require('../errors');","var bunyan = require('../bunyan_helper');","","// Use native KeepAlive in Node as of 0.11.6","var semver = require('semver');","var nodeVersion = process.version;","var nativeKeepAlive = semver.satisfies(nodeVersion, '>=0.11.6');","var KeepAliveAgent;","var KeepAliveAgentSecure;","var httpMaxSockets = http.globalAgent.maxSockets;","var httpsMaxSockets = https.globalAgent.maxSockets;","","if (!nativeKeepAlive) {","    KeepAliveAgent = require('keep-alive-agent');","    KeepAliveAgentSecure = KeepAliveAgent.Secure;","} else {","    KeepAliveAgent = http.Agent;","    KeepAliveAgentSecure = https.Agent;","","    // maxSockets defaults to Infinity, but that doesn't","    // lend itself well to KeepAlive, since sockets will","    // never be reused.","    httpMaxSockets = Math.min(httpMaxSockets, 1024);","    httpsMaxSockets = Math.min(httpsMaxSockets, 1024);","}","","///--- Globals","","// jscs:disable maximumLineLength","var VERSION = JSON.parse(fs.readFileSync(path.normalize(__dirname + '/../../package.json'), 'utf8')).version;","// jscs:enable maximumLineLength","","///--- Helpers","","function cloneRetryOptions(options, defaults) {","    if (options === false) {","        return (false);","    }","","    assert.optionalObject(options, 'options.retry');","    var r = options || {};","    assert.optionalNumber(r.minTimeout, 'options.retry.minTimeout');","    assert.optionalNumber(r.maxTimeout, 'options.retry.maxTimeout');","    assert.optionalNumber(r.retries, 'options.retry.retries');","    assert.optionalObject(defaults, 'defaults');","    defaults = defaults || {};","","    return ({","        minTimeout: r.minTimeout || defaults.minTimeout || 1000,","        maxTimeout: r.maxTimeout || defaults.maxTimeout || Infinity,","        retries: r.retries || defaults.retries || 4","    });","}","","","function defaultUserAgent() {","    var UA = 'restify/' + VERSION +","        ' (' + os.arch() + '-' + os.platform() + '; ' +","        'v8/' + process.versions.v8 + '; ' +","        'OpenSSL/' + process.versions.openssl + ') ' +","        'node/' + process.versions.node;","","    return (UA);","}","","","function ConnectTimeoutError(ms) {","    if (Error.captureStackTrace) {","        Error.captureStackTrace(this, ConnectTimeoutError);","    }","","    this.message = 'connect timeout after ' + ms + 'ms';","    this.name = 'ConnectTimeoutError';","}","util.inherits(ConnectTimeoutError, Error);","","function RequestTimeoutError(ms) {","    if (Error.captureStackTrace) {","        Error.captureStackTrace(this, RequestTimeoutError);","    }","","    this.message = 'request timeout after ' + ms + 'ms';","    this.name = 'RequestTimeoutError';","}","util.inherits(RequestTimeoutError, Error);","","function rawRequest(opts, cb) {","    assert.object(opts, 'options');","    assert.object(opts.log, 'options.log');","    assert.func(cb, 'callback');","","    cb = once(cb);","","    var id = dtrace.nextId();","    var log = opts.log;","    var proto = opts.protocol === 'https:' ? https : http;","    var connectionTimer;","    var requestTimer;","    var req;","","    if (opts.cert && opts.key) {","        opts.agent = false;","    }","","    if (opts.connectTimeout) {","        connectionTimer = setTimeout(function connectTimeout() {","            connectionTimer = null;","","            if (req) {","                req.abort();","            }","","            var err = new ConnectTimeoutError(opts.connectTimeout);","            dtrace._rstfy_probes['client-error'].fire(function () {","                return ([id, err.toString()]);","            });","            cb(err, req);","        }, opts.connectTimeout);","    }","","    dtrace._rstfy_probes['client-request'].fire(function () {","        return ([","            opts.method,","            opts.path,","            opts.headers,","            id","        ]);","    });","","    var emit_result = once(function _emit_result(_err, _req, _res) {","        _req.emit('result', _err, _res);","    });","","    req = proto.request(opts, function onResponse(res) {","        clearTimeout(connectionTimer);","        clearTimeout(requestTimer);","","        dtrace._rstfy_probes['client-response'].fire(function () {","            return ([ id, res.statusCode, res.headers ]);","        });","        log.trace({client_res: res}, 'Response received');","","        res.log = log;","","        var err;","","        if (res.statusCode >= 400) {","            err = errors.codeToHttpError(res.statusCode);","        }","","        req.removeAllListeners('socket');","","        emit_result((err || null), req, res);","    });","    req.log = log;","","    req.on('error', function onError(err) {","        dtrace._rstfy_probes['client-error'].fire(function () {","            return ([id, (err || {}).toString()]);","        });","        log.trace({err: err}, 'Request failed');","        clearTimeout(connectionTimer);","        clearTimeout(requestTimer);","","        cb(err, req);","","        if (req) {","            process.nextTick(function () {","                emit_result(err, req, null);","            });","        }","    });","","    req.once('upgrade', function onUpgrade(res, socket, _head) {","        clearTimeout(connectionTimer);","        clearTimeout(requestTimer);","        dtrace._rstfy_probes['client-response'].fire(function () {","            return ([ id, res.statusCode, res.headers ]);","        });","        log.trace({client_res: res}, 'upgrade response received');","","        res.log = log;","","        var err;","","        if (res.statusCode >= 400) {","            err = errors.codeToHttpError(res.statusCode);","        }","","        req.removeAllListeners('error');","        req.removeAllListeners('socket');","        req.emit('upgradeResult', (err || null), res, socket, _head);","    });","","    req.once('socket', function onSocket(socket) {","        var _socket = socket;","","        if (opts.protocol === 'https:' && socket.socket) {","            _socket = socket.socket;","        }","","        if (_socket.writable && !_socket._connecting) {","            clearTimeout(connectionTimer);","            cb(null, req);","            return;","        }","","        _socket.once('connect', function onConnect() {","            clearTimeout(connectionTimer);","","            if (opts._keep_alive) {","                _socket.setKeepAlive(true);","                socket.setKeepAlive(true);","            }","","            if (opts.requestTimeout) {","                requestTimer = setTimeout(function requestTimeout() {","                    requestTimer = null;","","                    var err = new RequestTimeoutError(opts.requestTimeout);","                    dtrace._rstfy_probes['client-error'].fire(function () {","                        return ([id, err.toString()]);","                    });","","                    cb(err, req);","","                    if (req) {","                        req.abort();","                        process.nextTick(function () {","                            req.emit('result', err, null);","                        });","                    }","                }, opts.requestTimeout);","            }","","            cb(null, req);","        });","    });","","    if (opts.signRequest) {","        opts.signRequest(req);","    }","","    if (log.trace()) {","        log.trace({client_req: opts}, 'request sent');","    }","} // end `rawRequest`","","","//  Check if url is excluded by the no_proxy environment variable","function isProxyForURL(address) {","    var noProxy = process.env.NO_PROXY || process.env.no_proxy || null;","","    // wildcard","    if (noProxy === '*') {","        return (null);","    }","","    // otherwise, parse the noProxy value to see if it applies to the URL","    if (noProxy !== null) {","        var noProxyItem, hostname, port, noProxyItemParts,","            noProxyHost, noProxyPort, noProxyList;","","        // canonicalize the hostname","        /* JSSTYLED */","        hostname = address.hostname.replace(/^\\.*/, '.').toLowerCase();","        noProxyList = noProxy.split(',');","","        for (var i = 0, len = noProxyList.length; i < len; i++) {","            noProxyItem = noProxyList[i].trim().toLowerCase();","","            // no_proxy can be granular at the port level","            if (noProxyItem.indexOf(':') > -1) {","                noProxyItemParts = noProxyItem.split(':', 2);","                /* JSSTYLED */","                noProxyHost = noProxyItemParts[0].replace(/^\\.*/, '.');","                noProxyPort = noProxyItemParts[1];","                port = address.port ||","                    (address.protocol === 'https:' ? '443' : '80');","","                // match - ports are same and host ends with no_proxy entry.","                if (port === noProxyPort &&","                    hostname.indexOf(noProxyHost) ===","                    hostname.length - noProxyHost.length) {","                    return (null);","                }","            } else {","                /* JSSTYLED */","                noProxyItem = noProxyItem.replace(/^\\.*/, '.');","                var isMatchedAt = hostname.indexOf(noProxyItem);","","                if (isMatchedAt > -1 &&","                    isMatchedAt === hostname.length - noProxyItem.length) {","                    return (null);","                }","            }","        }","    }","    return (true);","}","///--- API","","function HttpClient(options) {","    assert.object(options, 'options');","    assert.optionalObject(options.headers, 'options.headers');","    assert.object(options.log, 'options.log');","    assert.optionalFunc(options.signRequest, 'options.signRequest');","    assert.optionalString(options.socketPath, 'options.socketPath');","    assert.optionalString(options.url, 'options.url');","","    EventEmitter.call(this);","","    var self = this;","","    this.agent = options.agent;","    this.ca = options.ca;","    this.cert = options.cert;","    this.ciphers = options.ciphers;","    this.connectTimeout = options.connectTimeout || false;","    this.requestTimeout = options.requestTimeout || false;","    this.headers = options.headers || {};","    this.log = options.log;","","    if (!this.log.serializers) {","        // Ensure logger has a reasonable serializer for `client_res`","        // and `client_req` logged in this module.","        this.log = this.log.child({serializers: bunyan.serializers});","    }","    this.key = options.key;","    this.name = options.name || 'HttpClient';","    this.passphrase = options.passphrase;","    this.pfx = options.pfx;","","    if (options.rejectUnauthorized !== undefined) {","        this.rejectUnauthorized = options.rejectUnauthorized;","    } else {","        this.rejectUnauthorized = true;","    }","","    this.retry = cloneRetryOptions(options.retry);","    this.signRequest = options.signRequest || false;","    this.socketPath = options.socketPath || false;","    this.url = options.url ? url.parse(options.url) : {};","","    if (process.env.https_proxy) {","        this.proxy = url.parse(process.env.https_proxy);","    } else if (process.env.http_proxy) {","        this.proxy = url.parse(process.env.http_proxy);","    } else if (options.proxy) {","        this.proxy = options.proxy;","    } else {","        this.proxy = false;","    }","","    if (this.proxy && !isProxyForURL(self.url)) {","        this.proxy = false;","    }","","    if (options.accept) {","        if (options.accept.indexOf('/') === -1) {","            options.accept = mime.lookup(options.accept);","        }","","        this.headers.accept = options.accept;","    }","","    if (options.contentType) {","        if (options.contentType.indexOf('/') === -1) {","            options.type = mime.lookup(options.contentType);","        }","","        this.headers['content-type'] = options.contentType;","    }","","    if (options.userAgent !== false) {","        this.headers['user-agent'] = options.userAgent ||","            defaultUserAgent();","    }","","    if (options.version) {","        this.headers['accept-version'] = options.version;","    }","","    if (this.agent === undefined) {","        var Agent;","        var maxSockets;","","        if (this.proxy) {","            if (this.url.protocol === 'https:') {","                if (this.proxy.protocol === 'https:') {","                    Agent = tunnelAgent.httpsOverHttps;","                } else {","                    Agent = tunnelAgent.httpsOverHttp;","                }","            } else {","                if (this.proxy.protocol === 'https:') {","                    Agent = tunnelAgent.httpOverHttps;","                } else {","                    Agent = tunnelAgent.httpOverHttp;","                }","            }","        } else if (this.url.protocol === 'https:') {","            Agent = KeepAliveAgentSecure;","            maxSockets = httpsMaxSockets;","        } else {","            Agent = KeepAliveAgent;","            maxSockets = httpMaxSockets;","        }","","        if (this.proxy) {","            this.agent = new Agent({","                proxy: self.proxy,","                rejectUnauthorized: self.rejectUnauthorized,","                ca: self.ca","            });","        } else {","            this.agent = new Agent({","                cert: self.cert,","                ca: self.ca,","                ciphers: self.ciphers,","                key: self.key,","                maxSockets: maxSockets,","","                // require('keep-alive-agent')","                maxKeepAliveRequests: 0,","                maxKeepAliveTime: 0,","","                // native keepalive","                keepAliveMsecs: 1000,","                keepAlive: true,","","                passphrase: self.passphrase,","                pfx: self.pfx,","                rejectUnauthorized: self.rejectUnauthorized","            });","            this._keep_alive = true;","        }","    }","}","util.inherits(HttpClient, EventEmitter);","","module.exports = HttpClient;","","","HttpClient.prototype.close = function close() {","    var sockets = this.agent.sockets;","    Object.keys((sockets || {})).forEach(function (k) {","        if (Array.isArray(sockets[k])) {","            sockets[k].forEach(function (s) {","                s.end();","            });","        }","    });","","    sockets = this.agent.idleSockets || this.agent.freeSockets;","    Object.keys((sockets || {})).forEach(function (k) {","        sockets[k].forEach(function (s) {","            s.end();","        });","    });","};","","","HttpClient.prototype.del = function del(options, callback) {","    var opts = this._options('DELETE', options);","","    return (this.read(opts, callback));","};","","","HttpClient.prototype.get = function get(options, callback) {","    var opts = this._options('GET', options);","","    return (this.read(opts, callback));","};","","","HttpClient.prototype.head = function head(options, callback) {","    var opts = this._options('HEAD', options);","","    return (this.read(opts, callback));","};","","HttpClient.prototype.opts = function http_options(options, callback) {","    var _opts = this._options('OPTIONS', options);","","    return (this.read(_opts, callback));","};","","","HttpClient.prototype.post = function post(options, callback) {","    var opts = this._options('POST', options);","","    return (this.request(opts, callback));","};","","","HttpClient.prototype.put = function put(options, callback) {","    var opts = this._options('PUT', options);","","    return (this.request(opts, callback));","};","","","HttpClient.prototype.patch = function patch(options, callback) {","    var opts = this._options('PATCH', options);","","","    return (this.request(opts, callback));","};","","","HttpClient.prototype.read = function read(options, callback) {","    var r = this.request(options, function readRequestCallback(err, req) {","        if (!err) {","            req.end();","        }","","        return (callback(err, req));","    });","    return (r);","};","","","HttpClient.prototype.basicAuth = function basicAuth(username, password) {","    if (username === false) {","        delete this.headers.authorization;","    } else {","        assert.string(username, 'username');","        assert.string(password, 'password');","","        var buffer = new Buffer(username + ':' + password, 'utf8');","        this.headers.authorization = 'Basic ' +","            buffer.toString('base64');","    }","","    return (this);","};","","","HttpClient.prototype.request = function request(opts, cb) {","    assert.object(opts, 'options');","    assert.func(cb, 'callback');","","    cb = once(cb);","","    if (opts.retry === false) {","        rawRequest(opts, cb);","        return;","    }","","    var call;","    var retry = cloneRetryOptions(opts.retry);","","    opts._keep_alive = this._keep_alive;","    call = backoff.call(rawRequest, opts, cb);","    call.setStrategy(new backoff.ExponentialStrategy({","        initialDelay: retry.minTimeout,","        maxDelay: retry.maxTimeout","    }));","    call.failAfter(retry.retries);","    call.on('backoff', this.emit.bind(this, 'attempt'));","","    call.start();","};","","","HttpClient.prototype._options = function (method, options) {","    if (typeof (options) !== 'object') {","        options = { path: options };","    }","","    var self = this;","    var opts = {","        agent: options.agent !== undefined ? options.agent : self.agent,","        ca: options.ca || self.ca,","        cert: options.cert || self.cert,","        ciphers: options.ciphers || self.ciphers,","        connectTimeout: options.connectTimeout || self.connectTimeout,","        requestTimeout: options.requestTimeout || self.requestTimeout,","        headers: options.headers || {},","        key: options.key || self.key,","        log: options.log || self.log,","        method: method,","        passphrase: options.passphrase || self.passphrase,","        path: options.path || self.path,","        pfx: options.pfx || self.pfx,","        rejectUnauthorized: options.rejectUnauthorized ||","            self.rejectUnauthorized,","        retry: options.retry !== false ? options.retry : false,","        signRequest: options.signRequest || self.signRequest","    };","","    if (!opts.retry && opts.retry !== false) {","        opts.retry = self.retry;","    }","","","    // Backwards compatibility with restify < 1.0","    if (options.query &&","        Object.keys(options.query).length &&","        opts.path.indexOf('?') === -1) {","        opts.path += '?' + querystring.stringify(options.query);","    }","","    if (this.socketPath) {","        opts.socketPath = this.socketPath;","    }","","    Object.keys(this.url).forEach(function (k) {","        if (!opts[k]) {","            opts[k] = self.url[k];","        }","    });","","    Object.keys(self.headers).forEach(function (k) {","        if (!opts.headers[k]) {","            opts.headers[k] = self.headers[k];","        }","    });","","    if (!opts.headers.date) {","        opts.headers.date = new Date().toUTCString();","    }","","    if (method === 'GET' || method === 'HEAD' || method === 'DELETE') {","        if (opts.headers['content-type']) {","            delete opts.headers['content-type'];","        }","","        if (opts.headers['content-md5']) {","            delete opts.headers['content-md5'];","        }","","        if (opts.headers['content-length'] && method !== 'DELETE') {","            delete opts.headers['content-length'];","        }","","        if (opts.headers['transfer-encoding']) {","            delete opts.headers['transfer-encoding'];","        }","    }","","    return (opts);","};","","// vim: set ts=4 sts=4 sw=4 et:",""],"l":{"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"15":1,"16":1,"17":1,"18":1,"19":1,"21":1,"22":1,"23":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"34":1,"35":0,"36":0,"38":1,"39":1,"44":1,"45":1,"51":1,"56":1,"57":0,"58":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"69":0,"77":1,"78":0,"84":0,"88":1,"89":0,"90":0,"93":0,"94":0,"96":1,"98":1,"99":0,"100":0,"103":0,"104":0,"106":1,"108":1,"109":0,"110":0,"111":0,"113":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"122":0,"123":0,"126":0,"127":0,"128":0,"130":0,"131":0,"134":0,"135":0,"136":0,"138":0,"142":0,"143":0,"151":0,"152":0,"155":0,"156":0,"157":0,"159":0,"160":0,"162":0,"164":0,"166":0,"168":0,"169":0,"172":0,"174":0,"176":0,"178":0,"179":0,"180":0,"182":0,"183":0,"184":0,"186":0,"188":0,"189":0,"190":0,"195":0,"196":0,"197":0,"198":0,"199":0,"201":0,"203":0,"205":0,"207":0,"208":0,"211":0,"212":0,"213":0,"216":0,"217":0,"219":0,"220":0,"223":0,"224":0,"225":0,"226":0,"229":0,"230":0,"232":0,"233":0,"234":0,"237":0,"238":0,"239":0,"241":0,"242":0,"243":0,"246":0,"248":0,"249":0,"250":0,"251":0,"257":0,"261":0,"262":0,"265":0,"266":0,"272":1,"273":0,"276":0,"277":0,"281":0,"282":0,"287":0,"288":0,"290":0,"291":0,"294":0,"295":0,"297":0,"298":0,"299":0,"303":0,"306":0,"310":0,"311":0,"313":0,"315":0,"320":0,"324":1,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"332":0,"334":0,"336":0,"337":0,"338":0,"339":0,"340":0,"341":0,"342":0,"343":0,"345":0,"348":0,"350":0,"351":0,"352":0,"353":0,"355":0,"356":0,"358":0,"361":0,"362":0,"363":0,"364":0,"366":0,"367":0,"368":0,"369":0,"370":0,"371":0,"373":0,"376":0,"377":0,"380":0,"381":0,"382":0,"385":0,"388":0,"389":0,"390":0,"393":0,"396":0,"397":0,"401":0,"402":0,"405":0,"406":0,"407":0,"409":0,"410":0,"411":0,"412":0,"414":0,"417":0,"418":0,"420":0,"423":0,"424":0,"425":0,"427":0,"428":0,"431":0,"432":0,"438":0,"457":0,"461":1,"463":1,"466":1,"467":0,"468":0,"469":0,"470":0,"471":0,"476":0,"477":0,"478":0,"479":0,"485":1,"486":0,"488":0,"492":1,"493":0,"495":0,"499":1,"500":0,"502":0,"505":1,"506":0,"508":0,"512":1,"513":0,"515":0,"519":1,"520":0,"522":0,"526":1,"527":0,"530":0,"534":1,"535":0,"536":0,"537":0,"540":0,"542":0,"546":1,"547":0,"548":0,"550":0,"551":0,"553":0,"554":0,"558":0,"562":1,"563":0,"564":0,"566":0,"568":0,"569":0,"570":0,"573":0,"574":0,"576":0,"577":0,"578":0,"582":0,"583":0,"585":0,"589":1,"590":0,"591":0,"594":0,"595":0,"615":0,"616":0,"621":0,"624":0,"627":0,"628":0,"631":0,"632":0,"633":0,"637":0,"638":0,"639":0,"643":0,"644":0,"647":0,"648":0,"649":0,"652":0,"653":0,"656":0,"657":0,"660":0,"661":0,"665":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/dtrace.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/dtrace.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":0,"12":0,"13":1,"14":1,"15":7,"16":7,"17":7,"18":7,"19":1,"20":1,"21":0,"22":0,"23":0,"24":1},"b":{"1":[1,0],"2":[0,0]},"f":{"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":7,"9":0},"fnMap":{"1":{"name":"exportStaticProvider","line":40,"loc":{"start":{"line":40,"column":18},"end":{"line":40,"column":50}}},"2":{"name":"(anonymous_2)","line":47,"loc":{"start":{"line":47,"column":22},"end":{"line":47,"column":34}}},"3":{"name":"(anonymous_3)","line":49,"loc":{"start":{"line":49,"column":24},"end":{"line":49,"column":36}}},"4":{"name":"(anonymous_4)","line":51,"loc":{"start":{"line":51,"column":26},"end":{"line":51,"column":38}}},"5":{"name":"(anonymous_5)","line":53,"loc":{"start":{"line":53,"column":30},"end":{"line":53,"column":42}}},"6":{"name":"(anonymous_6)","line":58,"loc":{"start":{"line":58,"column":29},"end":{"line":58,"column":41}}},"7":{"name":"(anonymous_7)","line":60,"loc":{"start":{"line":60,"column":25},"end":{"line":60,"column":37}}},"8":{"name":"(anonymous_8)","line":67,"loc":{"start":{"line":67,"column":36},"end":{"line":67,"column":49}}},"9":{"name":"nextId","line":77,"loc":{"start":{"line":77,"column":26},"end":{"line":77,"column":44}}}},"statementMap":{"1":{"start":{"line":8,"column":0},"end":{"line":8,"column":11}},"2":{"start":{"line":9,"column":0},"end":{"line":9,"column":34}},"3":{"start":{"line":11,"column":0},"end":{"line":34,"column":2}},"4":{"start":{"line":35,"column":0},"end":{"line":35,"column":13}},"5":{"start":{"line":40,"column":0},"end":{"line":87,"column":5}},"6":{"start":{"line":41,"column":4},"end":{"line":84,"column":5}},"7":{"start":{"line":42,"column":8},"end":{"line":63,"column":9}},"8":{"start":{"line":43,"column":12},"end":{"line":43,"column":52}},"9":{"start":{"line":44,"column":12},"end":{"line":44,"column":62}},"10":{"start":{"line":46,"column":12},"end":{"line":62,"column":14}},"11":{"start":{"line":52,"column":20},"end":{"line":55,"column":22}},"12":{"start":{"line":56,"column":20},"end":{"line":56,"column":31}},"13":{"start":{"line":65,"column":8},"end":{"line":65,"column":36}},"14":{"start":{"line":67,"column":8},"end":{"line":73,"column":11}},"15":{"start":{"line":68,"column":12},"end":{"line":68,"column":43}},"16":{"start":{"line":69,"column":12},"end":{"line":69,"column":28}},"17":{"start":{"line":71,"column":12},"end":{"line":71,"column":64}},"18":{"start":{"line":72,"column":12},"end":{"line":72,"column":46}},"19":{"start":{"line":75,"column":8},"end":{"line":75,"column":26}},"20":{"start":{"line":77,"column":8},"end":{"line":83,"column":10}},"21":{"start":{"line":78,"column":12},"end":{"line":80,"column":13}},"22":{"start":{"line":79,"column":16},"end":{"line":79,"column":23}},"23":{"start":{"line":82,"column":12},"end":{"line":82,"column":24}},"24":{"start":{"line":86,"column":4},"end":{"line":86,"column":22}}},"branchMap":{"1":{"line":41,"type":"if","locations":[{"start":{"line":41,"column":4},"end":{"line":41,"column":4}},{"start":{"line":41,"column":4},"end":{"line":41,"column":4}}]},"2":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":12},"end":{"line":78,"column":12}},{"start":{"line":78,"column":12},"end":{"line":78,"column":12}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","","///--- Globals","","'use strict';","","var ID = 0;","var MAX_INT = Math.pow(2, 32) - 1;","","var PROBES = {","    // server_name, route_name, id, method, url, headers (json)","    'route-start': ['char *', 'char *', 'int', 'char *', 'char *', 'json'],","","    // server_name, route_name, handler_name, id","    'handler-start': ['char *', 'char *', 'char *', 'int'],","","    // server_name, route_name, handler_name, id","    'handler-done': ['char *', 'char *', 'char *', 'int'],","","    // server_name, route_name, id, statusCode, headers (json)","    'route-done': ['char *', 'char *', 'int', 'int', 'json'],","","","    // Client probes","    // method, url, headers, id","    'client-request': ['char *', 'char *', 'json', 'int'],","","    // id, statusCode, headers","    'client-response': ['int', 'int', 'json'],","","    // id, Error.toString()","    'client-error': ['id', 'char *']","};","var PROVIDER;","","","///--- API","","module.exports = (function exportStaticProvider() {","    if (!PROVIDER) {","        try {","            var dtrace = require('dtrace-provider');","            PROVIDER = dtrace.createDTraceProvider('restify');","        } catch (e) {","            PROVIDER = {","                fire: function () {","                },","                enable: function () {","                },","                addProbe: function () {","                    var p = {","                        fire: function () {","                        }","                    };","                    return (p);","                },","                removeProbe: function () {","                },","                disable: function () {","                }","            };","        }","","        PROVIDER._rstfy_probes = {};","","        Object.keys(PROBES).forEach(function (p) {","            var args = PROBES[p].splice(0);","            args.unshift(p);","","            var probe = PROVIDER.addProbe.apply(PROVIDER, args);","            PROVIDER._rstfy_probes[p] = probe;","        });","","        PROVIDER.enable();","","        PROVIDER.nextId = function nextId() {","            if (++ID >= MAX_INT) {","                ID = 1;","            }","","            return (ID);","        };","    }","","    return (PROVIDER);","}());",""],"l":{"8":1,"9":1,"11":1,"35":1,"40":1,"41":1,"42":1,"43":1,"44":1,"46":0,"52":0,"56":0,"65":1,"67":1,"68":7,"69":7,"71":7,"72":7,"75":1,"77":1,"78":0,"79":0,"82":0,"86":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/bunyan_helper.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/bunyan_helper.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":1,"46":1,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":1,"79":0,"80":1,"81":1,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":1,"90":0,"91":0,"92":0,"93":1,"94":0,"95":1},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"fnMap":{"1":{"name":"appendStream","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":34}}},"2":{"name":"RequestCaptureStream","line":74,"loc":{"start":{"line":74,"column":0},"end":{"line":74,"column":36}}},"3":{"name":"write","line":126,"loc":{"start":{"line":126,"column":39},"end":{"line":126,"column":62}}},"4":{"name":"(anonymous_4)","line":159,"loc":{"start":{"line":159,"column":33},"end":{"line":159,"column":46}}},"5":{"name":"(anonymous_5)","line":175,"loc":{"start":{"line":175,"column":37},"end":{"line":175,"column":50}}},"6":{"name":"toString","line":193,"loc":{"start":{"line":193,"column":42},"end":{"line":193,"column":62}}},"7":{"name":"clientReq","line":220,"loc":{"start":{"line":220,"column":0},"end":{"line":220,"column":24}}},"8":{"name":"clientRes","line":250,"loc":{"start":{"line":250,"column":0},"end":{"line":250,"column":24}}},"9":{"name":"createLogger","line":269,"loc":{"start":{"line":269,"column":0},"end":{"line":269,"column":28}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":38}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":31}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":31}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":32}},"7":{"start":{"line":16,"column":0},"end":{"line":16,"column":26}},"8":{"start":{"line":17,"column":0},"end":{"line":17,"column":31}},"9":{"start":{"line":18,"column":0},"end":{"line":18,"column":66}},"10":{"start":{"line":31,"column":0},"end":{"line":45,"column":1}},"11":{"start":{"line":32,"column":4},"end":{"line":32,"column":45}},"12":{"start":{"line":33,"column":4},"end":{"line":33,"column":31}},"13":{"start":{"line":35,"column":4},"end":{"line":44,"column":5}},"14":{"start":{"line":36,"column":8},"end":{"line":39,"column":11}},"15":{"start":{"line":41,"column":8},"end":{"line":41,"column":49}},"16":{"start":{"line":42,"column":8},"end":{"line":42,"column":49}},"17":{"start":{"line":43,"column":8},"end":{"line":43,"column":24}},"18":{"start":{"line":74,"column":0},"end":{"line":115,"column":1}},"19":{"start":{"line":75,"column":4},"end":{"line":75,"column":35}},"20":{"start":{"line":76,"column":4},"end":{"line":76,"column":57}},"21":{"start":{"line":77,"column":4},"end":{"line":77,"column":66}},"22":{"start":{"line":78,"column":4},"end":{"line":78,"column":55}},"23":{"start":{"line":79,"column":4},"end":{"line":79,"column":65}},"24":{"start":{"line":80,"column":4},"end":{"line":80,"column":71}},"25":{"start":{"line":81,"column":4},"end":{"line":81,"column":65}},"26":{"start":{"line":83,"column":4},"end":{"line":83,"column":20}},"27":{"start":{"line":84,"column":4},"end":{"line":84,"column":22}},"28":{"start":{"line":86,"column":4},"end":{"line":86,"column":76}},"29":{"start":{"line":87,"column":4},"end":{"line":87,"column":40}},"30":{"start":{"line":88,"column":4},"end":{"line":88,"column":52}},"31":{"start":{"line":89,"column":4},"end":{"line":91,"column":7}},"32":{"start":{"line":92,"column":4},"end":{"line":92,"column":40}},"33":{"start":{"line":94,"column":4},"end":{"line":94,"column":22}},"34":{"start":{"line":95,"column":4},"end":{"line":95,"column":21}},"35":{"start":{"line":97,"column":4},"end":{"line":97,"column":22}},"36":{"start":{"line":99,"column":4},"end":{"line":101,"column":5}},"37":{"start":{"line":100,"column":8},"end":{"line":100,"column":48}},"38":{"start":{"line":103,"column":4},"end":{"line":105,"column":5}},"39":{"start":{"line":104,"column":8},"end":{"line":104,"column":68}},"40":{"start":{"line":107,"column":4},"end":{"line":107,"column":35}},"41":{"start":{"line":109,"column":4},"end":{"line":114,"column":5}},"42":{"start":{"line":110,"column":8},"end":{"line":113,"column":9}},"43":{"start":{"line":111,"column":12},"end":{"line":111,"column":42}},"44":{"start":{"line":112,"column":12},"end":{"line":112,"column":18}},"45":{"start":{"line":116,"column":0},"end":{"line":116,"column":44}},"46":{"start":{"line":126,"column":0},"end":{"line":184,"column":2}},"47":{"start":{"line":127,"column":4},"end":{"line":127,"column":49}},"48":{"start":{"line":128,"column":4},"end":{"line":128,"column":13}},"49":{"start":{"line":129,"column":4},"end":{"line":129,"column":20}},"50":{"start":{"line":131,"column":4},"end":{"line":145,"column":5}},"51":{"start":{"line":132,"column":8},"end":{"line":134,"column":9}},"52":{"start":{"line":133,"column":12},"end":{"line":133,"column":29}},"53":{"start":{"line":136,"column":8},"end":{"line":140,"column":9}},"54":{"start":{"line":137,"column":12},"end":{"line":139,"column":16}},"55":{"start":{"line":142,"column":8},"end":{"line":142,"column":41}},"56":{"start":{"line":143,"column":8},"end":{"line":143,"column":32}},"57":{"start":{"line":144,"column":8},"end":{"line":144,"column":42}},"58":{"start":{"line":147,"column":4},"end":{"line":147,"column":37}},"59":{"start":{"line":149,"column":4},"end":{"line":183,"column":5}},"60":{"start":{"line":150,"column":8},"end":{"line":150,"column":22}},"61":{"start":{"line":152,"column":8},"end":{"line":162,"column":9}},"62":{"start":{"line":153,"column":12},"end":{"line":153,"column":32}},"63":{"start":{"line":155,"column":12},"end":{"line":158,"column":13}},"64":{"start":{"line":156,"column":16},"end":{"line":157,"column":48}},"65":{"start":{"line":159,"column":12},"end":{"line":161,"column":15}},"66":{"start":{"line":160,"column":16},"end":{"line":160,"column":48}},"67":{"start":{"line":163,"column":8},"end":{"line":163,"column":32}},"68":{"start":{"line":165,"column":8},"end":{"line":180,"column":9}},"69":{"start":{"line":166,"column":12},"end":{"line":166,"column":66}},"70":{"start":{"line":168,"column":12},"end":{"line":178,"column":13}},"71":{"start":{"line":169,"column":16},"end":{"line":169,"column":43}},"72":{"start":{"line":171,"column":16},"end":{"line":174,"column":17}},"73":{"start":{"line":172,"column":20},"end":{"line":173,"column":52}},"74":{"start":{"line":175,"column":16},"end":{"line":177,"column":19}},"75":{"start":{"line":176,"column":20},"end":{"line":176,"column":52}},"76":{"start":{"line":179,"column":12},"end":{"line":179,"column":43}},"77":{"start":{"line":182,"column":8},"end":{"line":182,"column":27}},"78":{"start":{"line":193,"column":0},"end":{"line":199,"column":2}},"79":{"start":{"line":194,"column":4},"end":{"line":198,"column":29}},"80":{"start":{"line":204,"column":0},"end":{"line":210,"column":2}},"81":{"start":{"line":220,"column":0},"end":{"line":240,"column":1}},"82":{"start":{"line":221,"column":4},"end":{"line":223,"column":5}},"83":{"start":{"line":222,"column":8},"end":{"line":222,"column":21}},"84":{"start":{"line":225,"column":4},"end":{"line":225,"column":13}},"85":{"start":{"line":227,"column":4},"end":{"line":231,"column":5}},"86":{"start":{"line":228,"column":8},"end":{"line":228,"column":38}},"87":{"start":{"line":230,"column":8},"end":{"line":230,"column":21}},"88":{"start":{"line":233,"column":4},"end":{"line":239,"column":7}},"89":{"start":{"line":250,"column":0},"end":{"line":259,"column":1}},"90":{"start":{"line":251,"column":4},"end":{"line":253,"column":5}},"91":{"start":{"line":252,"column":8},"end":{"line":252,"column":21}},"92":{"start":{"line":255,"column":4},"end":{"line":258,"column":7}},"93":{"start":{"line":269,"column":0},"end":{"line":287,"column":1}},"94":{"start":{"line":270,"column":4},"end":{"line":286,"column":8}},"95":{"start":{"line":293,"column":0},"end":{"line":298,"column":2}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":35,"column":4}},{"start":{"line":35,"column":4},"end":{"line":35,"column":4}}]},"2":{"line":86,"type":"cond-expr","locations":[{"start":{"line":86,"column":30},"end":{"line":86,"column":61}},{"start":{"line":86,"column":64},"end":{"line":86,"column":75}}]},"3":{"line":87,"type":"binary-expr","locations":[{"start":{"line":87,"column":17},"end":{"line":87,"column":32}},{"start":{"line":87,"column":36},"end":{"line":87,"column":39}}]},"4":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":25},"end":{"line":88,"column":43}},{"start":{"line":88,"column":47},"end":{"line":88,"column":51}}]},"5":{"line":99,"type":"if","locations":[{"start":{"line":99,"column":4},"end":{"line":99,"column":4}},{"start":{"line":99,"column":4},"end":{"line":99,"column":4}}]},"6":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":4},"end":{"line":103,"column":4}},{"start":{"line":103,"column":4},"end":{"line":103,"column":4}}]},"7":{"line":110,"type":"if","locations":[{"start":{"line":110,"column":8},"end":{"line":110,"column":8}},{"start":{"line":110,"column":8},"end":{"line":110,"column":8}}]},"8":{"line":127,"type":"binary-expr","locations":[{"start":{"line":127,"column":17},"end":{"line":127,"column":30}},{"start":{"line":127,"column":34},"end":{"line":127,"column":48}}]},"9":{"line":131,"type":"if","locations":[{"start":{"line":131,"column":4},"end":{"line":131,"column":4}},{"start":{"line":131,"column":4},"end":{"line":131,"column":4}}]},"10":{"line":132,"type":"if","locations":[{"start":{"line":132,"column":8},"end":{"line":132,"column":8}},{"start":{"line":132,"column":8},"end":{"line":132,"column":8}}]},"11":{"line":136,"type":"if","locations":[{"start":{"line":136,"column":8},"end":{"line":136,"column":8}},{"start":{"line":136,"column":8},"end":{"line":136,"column":8}}]},"12":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":4},"end":{"line":149,"column":4}},{"start":{"line":149,"column":4},"end":{"line":149,"column":4}}]},"13":{"line":155,"type":"if","locations":[{"start":{"line":155,"column":12},"end":{"line":155,"column":12}},{"start":{"line":155,"column":12},"end":{"line":155,"column":12}}]},"14":{"line":160,"type":"cond-expr","locations":[{"start":{"line":160,"column":39},"end":{"line":160,"column":40}},{"start":{"line":160,"column":43},"end":{"line":160,"column":46}}]},"15":{"line":165,"type":"if","locations":[{"start":{"line":165,"column":8},"end":{"line":165,"column":8}},{"start":{"line":165,"column":8},"end":{"line":165,"column":8}}]},"16":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":16},"end":{"line":171,"column":16}},{"start":{"line":171,"column":16},"end":{"line":171,"column":16}}]},"17":{"line":176,"type":"cond-expr","locations":[{"start":{"line":176,"column":43},"end":{"line":176,"column":44}},{"start":{"line":176,"column":47},"end":{"line":176,"column":50}}]},"18":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":4},"end":{"line":221,"column":4}},{"start":{"line":221,"column":4},"end":{"line":221,"column":4}}]},"19":{"line":234,"type":"cond-expr","locations":[{"start":{"line":234,"column":22},"end":{"line":234,"column":32}},{"start":{"line":234,"column":35},"end":{"line":234,"column":40}}]},"20":{"line":235,"type":"cond-expr","locations":[{"start":{"line":235,"column":19},"end":{"line":235,"column":27}},{"start":{"line":235,"column":30},"end":{"line":235,"column":35}}]},"21":{"line":237,"type":"cond-expr","locations":[{"start":{"line":237,"column":20},"end":{"line":237,"column":28}},{"start":{"line":237,"column":31},"end":{"line":237,"column":36}}]},"22":{"line":238,"type":"cond-expr","locations":[{"start":{"line":238,"column":23},"end":{"line":238,"column":34}},{"start":{"line":238,"column":37},"end":{"line":238,"column":42}}]},"23":{"line":251,"type":"if","locations":[{"start":{"line":251,"column":4},"end":{"line":251,"column":4}},{"start":{"line":251,"column":4},"end":{"line":251,"column":4}}]},"24":{"line":251,"type":"binary-expr","locations":[{"start":{"line":251,"column":8},"end":{"line":251,"column":12}},{"start":{"line":251,"column":16},"end":{"line":251,"column":31}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var Stream = require('stream').Stream;","var util = require('util');","","var assert = require('assert-plus');","var bunyan = require('bunyan');","var LRU = require('lru-cache');","var uuid = require('node-uuid');","","","///--- Globals","","var sprintf = util.format;","var DEFAULT_REQ_ID = uuid.v4();","var STR_FMT = '[object %s<level=%d, limit=%d, maxRequestIds=%d>]';","","","///--- Helpers","","/**"," * appends streams"," * @private"," * @function appendStream"," * @param    {Stream}    streams the stream to append to"," * @param    {Stream}    s       the stream to append"," * @returns  {undefined}"," */","function appendStream(streams, s) {","    assert.arrayOfObject(streams, 'streams');","    assert.object(s, 'stream');","","    if (s instanceof Stream) {","        streams.push({","            raw: false,","            stream: s","        });","    } else {","        assert.optionalBool(s.raw, 'stream.raw');","        assert.object(s.stream, 'stream.stream');","        streams.push(s);","    }","}","","","///--- API","/**"," * A Bunyan stream to capture records in a ring buffer and only pass through"," * on a higher-level record. E.g. buffer up all records but only dump when"," * getting a WARN or above."," * @public"," * @class"," * @param {Object} opts                contains the parameters:"," * @param {Object} opts.stream         The stream to which to write when"," *                                     dumping captured records. One of `stream`"," *                                     or `streams` must be specified."," * @param {Array} opts.streams         One of `stream` or `streams` must be"," *                                     specified."," * @param {Number | String} opts.level The level at which to trigger dumping"," *                                     captured records. Defaults to"," *                                     bunyan.WARN."," * @param {Number} opts.maxRecords     Number of records to capture. Default"," *                                     100."," * @param {Number} opts.maxRequestIds  Number of simultaneous request id"," *                                     capturing buckets to maintain. Default"," *                                     1000."," * @param {Boolean} opts.dumpDefault   If true, then dump captured records on"," *                                     the *default* request id when dumping."," *                                     I.e. dump records logged without"," *                                     \"req_id\" field. Default false."," */","function RequestCaptureStream(opts) {","    assert.object(opts, 'options');","    assert.optionalObject(opts.stream, 'options.stream');","    assert.optionalArrayOfObject(opts.streams, 'options.streams');","    assert.optionalNumber(opts.level, 'options.level');","    assert.optionalNumber(opts.maxRecords, 'options.maxRecords');","    assert.optionalNumber(opts.maxRequestIds, 'options.maxRequestIds');","    assert.optionalBool(opts.dumpDefault, 'options.dumpDefault');","","    var self = this;","    Stream.call(this);","","    this.level = opts.level ? bunyan.resolveLevel(opts.level) : bunyan.WARN;","    this.limit = opts.maxRecords || 100;","    this.maxRequestIds = opts.maxRequestIds || 1000;","    this.requestMap = LRU({","        max: self.maxRequestIds","    });","    this.dumpDefault = opts.dumpDefault;","","    this._offset = -1;","    this._rings = [];","","    this.streams = [];","","    if (opts.stream) {","        appendStream(this.streams, opts.stream);","    }","","    if (opts.streams) {","        opts.streams.forEach(appendStream.bind(null, this.streams));","    }","","    this.haveNonRawStreams = false;","","    for (var i = 0; i < this.streams.length; i++) {","        if (!this.streams[i].raw) {","            this.haveNonRawStreams = true;","            break;","        }","    }","}","util.inherits(RequestCaptureStream, Stream);","","","/**"," * write to the stream"," * @public"," * @function write"," * @param    {Object}    record a bunyan log record"," * @returns  {undefined}"," */","RequestCaptureStream.prototype.write = function write(record) {","    var req_id = record.req_id || DEFAULT_REQ_ID;","    var ring;","    var self = this;","","    if (!(ring = this.requestMap.get(req_id))) {","        if (++this._offset > this.maxRequestIds) {","            this._offset = 0;","        }","","        if (this._rings.length <= this._offset) {","            this._rings.push(new bunyan.RingBuffer({","                limit: self.limit","            }));","        }","","        ring = this._rings[this._offset];","        ring.records.length = 0;","        this.requestMap.set(req_id, ring);","    }","","    assert.ok(ring, 'no ring found');","","    if (record.level >= this.level) {","        var i, r, ser;","","        for (i = 0; i < ring.records.length; i++) {","            r = ring.records[i];","","            if (this.haveNonRawStreams) {","                ser = JSON.stringify(r,","                    bunyan.safeCycles()) + '\\n';","            }","            self.streams.forEach(function (s) {","                s.stream.write(s.raw ? r : ser);","            });","        }","        ring.records.length = 0;","","        if (this.dumpDefault) {","            var defaultRing = self.requestMap.get(DEFAULT_REQ_ID);","","            for (i = 0; i < defaultRing.records.length; i++) {","                r = defaultRing.records[i];","","                if (this.haveNonRawStreams) {","                    ser = JSON.stringify(r,","                        bunyan.safeCycles()) + '\\n';","                }","                self.streams.forEach(function (s) {","                    s.stream.write(s.raw ? r : ser);","                });","            }","            defaultRing.records.length = 0;","        }","    } else {","        ring.write(record);","    }","};","","","/**"," * toString() serialization"," * @public"," * @function toString"," * @returns  {String}"," */","RequestCaptureStream.prototype.toString = function toString() {","    return (sprintf(STR_FMT,","        this.constructor.name,","        this.level,","        this.limit,","        this.maxRequestIds));","};","","","///--- Serializers","","var SERIALIZERS = {","    err: bunyan.stdSerializers.err,","    req: bunyan.stdSerializers.req,","    res: bunyan.stdSerializers.res,","    client_req: clientReq,","    client_res: clientRes","};","","","/**"," * a request serializer. returns a stripped down object for logging."," * @private"," * @function clientReq"," * @param    {Object} req the request object"," * @returns  {Object}"," */","function clientReq(req) {","    if (!req) {","        return (req);","    }","","    var host;","","    try {","        host = req.host.split(':')[0];","    } catch (e) {","        host = false;","    }","","    return ({","        method: req ? req.method : false,","        url: req ? req.path : false,","        address: host,","        port: req ? req.port : false,","        headers: req ? req.headers : false","    });","}","","","/**"," * a response serializer. returns a stripped down object for logging."," * @private"," * @function clientRes"," * @param    {Object} res the response object"," * @returns  {Object}"," */","function clientRes(res) {","    if (!res || !res.statusCode) {","        return (res);","    }","","    return ({","        statusCode: res.statusCode,","        headers: res.headers","    });","}","","","/**"," * create a bunyan logger"," * @public"," * @function createLogger"," * @param    {String}     name of the logger"," * @returns  {Object}          bunyan logger"," */","function createLogger(name) {","    return (bunyan.createLogger({","        name: name,","        serializers: SERIALIZERS,","        streams: [","            {","                level: 'warn',","                stream: process.stderr","            },","            {","                level: 'debug',","                type: 'raw',","                stream: new RequestCaptureStream({","                    stream: process.stderr","                })","            }","        ]","    }));","}","","","","///--- Exports","","module.exports = {","    RequestCaptureStream: RequestCaptureStream,","    serializers: SERIALIZERS,","    createLogger: createLogger","","};",""],"l":{"5":1,"6":1,"8":1,"9":1,"10":1,"11":1,"16":1,"17":1,"18":1,"31":1,"32":0,"33":0,"35":0,"36":0,"41":0,"42":0,"43":0,"74":1,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"83":0,"84":0,"86":0,"87":0,"88":0,"89":0,"92":0,"94":0,"95":0,"97":0,"99":0,"100":0,"103":0,"104":0,"107":0,"109":0,"110":0,"111":0,"112":0,"116":1,"126":1,"127":0,"128":0,"129":0,"131":0,"132":0,"133":0,"136":0,"137":0,"142":0,"143":0,"144":0,"147":0,"149":0,"150":0,"152":0,"153":0,"155":0,"156":0,"159":0,"160":0,"163":0,"165":0,"166":0,"168":0,"169":0,"171":0,"172":0,"175":0,"176":0,"179":0,"182":0,"193":1,"194":0,"204":1,"220":1,"221":0,"222":0,"225":0,"227":0,"228":0,"230":0,"233":0,"250":1,"251":0,"252":0,"255":0,"269":1,"270":0,"293":1}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/clients/json_client.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/clients/json_client.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":1,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0],"10":[0,0,0],"11":[0,0],"12":[0,0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0},"fnMap":{"1":{"name":"JsonClient","line":16,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":29}}},"2":{"name":"write","line":32,"loc":{"start":{"line":32,"column":29},"end":{"line":32,"column":69}}},"3":{"name":"parse","line":41,"loc":{"start":{"line":41,"column":29},"end":{"line":41,"column":59}}},"4":{"name":"parseResponse","line":44,"loc":{"start":{"line":44,"column":4},"end":{"line":44,"column":49}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":27}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}},"3":{"start":{"line":9,"column":0},"end":{"line":9,"column":70}},"4":{"start":{"line":10,"column":0},"end":{"line":10,"column":47}},"5":{"start":{"line":11,"column":0},"end":{"line":11,"column":46}},"6":{"start":{"line":16,"column":0},"end":{"line":26,"column":1}},"7":{"start":{"line":17,"column":4},"end":{"line":17,"column":38}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":40}},"9":{"start":{"line":20,"column":4},"end":{"line":20,"column":48}},"10":{"start":{"line":21,"column":4},"end":{"line":21,"column":45}},"11":{"start":{"line":23,"column":4},"end":{"line":23,"column":37}},"12":{"start":{"line":25,"column":4},"end":{"line":25,"column":41}},"13":{"start":{"line":27,"column":0},"end":{"line":27,"column":40}},"14":{"start":{"line":29,"column":0},"end":{"line":29,"column":28}},"15":{"start":{"line":32,"column":0},"end":{"line":38,"column":2}},"16":{"start":{"line":33,"column":4},"end":{"line":33,"column":42}},"17":{"start":{"line":34,"column":4},"end":{"line":34,"column":32}},"18":{"start":{"line":36,"column":4},"end":{"line":36,"column":53}},"19":{"start":{"line":37,"column":4},"end":{"line":37,"column":67}},"20":{"start":{"line":41,"column":0},"end":{"line":95,"column":2}},"21":{"start":{"line":42,"column":4},"end":{"line":42,"column":23}},"22":{"start":{"line":44,"column":4},"end":{"line":92,"column":5}},"23":{"start":{"line":45,"column":8},"end":{"line":45,"column":16}},"24":{"start":{"line":47,"column":8},"end":{"line":55,"column":9}},"25":{"start":{"line":48,"column":12},"end":{"line":50,"column":13}},"26":{"start":{"line":49,"column":16},"end":{"line":49,"column":39}},"27":{"start":{"line":54,"column":12},"end":{"line":54,"column":53}},"28":{"start":{"line":56,"column":8},"end":{"line":56,"column":24}},"29":{"start":{"line":58,"column":8},"end":{"line":85,"column":9}},"30":{"start":{"line":63,"column":12},"end":{"line":84,"column":13}},"31":{"start":{"line":64,"column":16},"end":{"line":66,"column":23}},"32":{"start":{"line":67,"column":16},"end":{"line":69,"column":23}},"33":{"start":{"line":71,"column":16},"end":{"line":75,"column":19}},"34":{"start":{"line":76,"column":16},"end":{"line":76,"column":40}},"35":{"start":{"line":78,"column":16},"end":{"line":80,"column":17}},"36":{"start":{"line":79,"column":20},"end":{"line":79,"column":40}},"37":{"start":{"line":81,"column":19},"end":{"line":84,"column":13}},"38":{"start":{"line":82,"column":16},"end":{"line":83,"column":45}},"39":{"start":{"line":87,"column":8},"end":{"line":89,"column":9}},"40":{"start":{"line":88,"column":12},"end":{"line":88,"column":27}},"41":{"start":{"line":91,"column":8},"end":{"line":91,"column":48}},"42":{"start":{"line":94,"column":4},"end":{"line":94,"column":62}}},"branchMap":{"1":{"line":20,"type":"binary-expr","locations":[{"start":{"line":20,"column":19},"end":{"line":20,"column":31}},{"start":{"line":20,"column":35},"end":{"line":20,"column":47}}]},"2":{"line":36,"type":"cond-expr","locations":[{"start":{"line":36,"column":42},"end":{"line":36,"column":46}},{"start":{"line":36,"column":49},"end":{"line":36,"column":51}}]},"3":{"line":48,"type":"if","locations":[{"start":{"line":48,"column":12},"end":{"line":48,"column":12}},{"start":{"line":48,"column":12},"end":{"line":48,"column":12}}]},"4":{"line":48,"type":"binary-expr","locations":[{"start":{"line":48,"column":16},"end":{"line":48,"column":20}},{"start":{"line":48,"column":24},"end":{"line":48,"column":43}}]},"5":{"line":56,"type":"binary-expr","locations":[{"start":{"line":56,"column":14},"end":{"line":56,"column":17}},{"start":{"line":56,"column":21},"end":{"line":56,"column":23}}]},"6":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":8},"end":{"line":58,"column":8}},{"start":{"line":58,"column":8},"end":{"line":58,"column":8}}]},"7":{"line":58,"type":"binary-expr","locations":[{"start":{"line":58,"column":12},"end":{"line":58,"column":15}},{"start":{"line":58,"column":19},"end":{"line":58,"column":40}}]},"8":{"line":63,"type":"if","locations":[{"start":{"line":63,"column":12},"end":{"line":63,"column":12}},{"start":{"line":63,"column":12},"end":{"line":63,"column":12}}]},"9":{"line":63,"type":"binary-expr","locations":[{"start":{"line":63,"column":16},"end":{"line":63,"column":24}},{"start":{"line":63,"column":29},"end":{"line":63,"column":38}},{"start":{"line":63,"column":42},"end":{"line":63,"column":56}}]},"10":{"line":64,"type":"binary-expr","locations":[{"start":{"line":64,"column":25},"end":{"line":64,"column":33}},{"start":{"line":65,"column":21},"end":{"line":65,"column":52}},{"start":{"line":66,"column":20},"end":{"line":66,"column":22}}]},"11":{"line":65,"type":"cond-expr","locations":[{"start":{"line":65,"column":33},"end":{"line":65,"column":47}},{"start":{"line":65,"column":50},"end":{"line":65,"column":52}}]},"12":{"line":67,"type":"binary-expr","locations":[{"start":{"line":67,"column":25},"end":{"line":67,"column":36}},{"start":{"line":68,"column":21},"end":{"line":68,"column":55}},{"start":{"line":69,"column":20},"end":{"line":69,"column":22}}]},"13":{"line":68,"type":"cond-expr","locations":[{"start":{"line":68,"column":33},"end":{"line":68,"column":50}},{"start":{"line":68,"column":53},"end":{"line":68,"column":55}}]},"14":{"line":78,"type":"if","locations":[{"start":{"line":78,"column":16},"end":{"line":78,"column":16}},{"start":{"line":78,"column":16},"end":{"line":78,"column":16}}]},"15":{"line":81,"type":"if","locations":[{"start":{"line":81,"column":19},"end":{"line":81,"column":19}},{"start":{"line":81,"column":19},"end":{"line":81,"column":19}}]},"16":{"line":83,"type":"binary-expr","locations":[{"start":{"line":83,"column":20},"end":{"line":83,"column":31}},{"start":{"line":83,"column":35},"end":{"line":83,"column":37}}]},"17":{"line":87,"type":"if","locations":[{"start":{"line":87,"column":8},"end":{"line":87,"column":8}},{"start":{"line":87,"column":8},"end":{"line":87,"column":8}}]},"18":{"line":91,"type":"binary-expr","locations":[{"start":{"line":91,"column":18},"end":{"line":91,"column":21}},{"start":{"line":91,"column":25},"end":{"line":91,"column":29}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var util = require('util');","","var assert = require('assert-plus');","","var codeToHttpError = require('../errors/http_error').codeToHttpError;","var RestError = require('../errors').RestError;","var StringClient = require('./string_client');","","","///--- API","","function JsonClient(options) {","    assert.object(options, 'options');","","    options.accept = 'application/json';","    options.name = options.name || 'JsonClient';","    options.contentType = 'application/json';","","    StringClient.call(this, options);","","    this._super = StringClient.prototype;","}","util.inherits(JsonClient, StringClient);","","module.exports = JsonClient;","","","JsonClient.prototype.write = function write(options, body, callback) {","    assert.ok(body !== undefined, 'body');","    assert.object(body, 'body');","","    body = JSON.stringify(body !== null ? body : {});","    return (this._super.write.call(this, options, body, callback));","};","","","JsonClient.prototype.parse = function parse(req, callback) {","    var log = this.log;","","    function parseResponse(err, req2, res, data) {","        var obj;","","        try {","            if (data && !/^\\s*$/.test(data)) {","                obj = JSON.parse(data);","            }","        } catch (e) {","            // Not really sure what else we can do here, besides","            // make the client just keep going.","            log.trace(e, 'Invalid JSON in response');","        }","        obj = obj || {};","","        if (res && res.statusCode >= 400) {","            // Upcast error to a RestError (if we can)","            // Be nice and handle errors like","            // { error: { code: '', message: '' } }","            // in addition to { code: '', message: '' }.","            if (obj.code || (obj.error && obj.error.code)) {","                var _c = obj.code ||","                    (obj.error ? obj.error.code : '') ||","                    '';","                var _m = obj.message ||","                    (obj.error ? obj.error.message : '') ||","                    '';","","                err = new RestError({","                    message: _m,","                    restCode: _c,","                    statusCode: res.statusCode","                });","                err.name = err.restCode;","","                if (!/Error$/.test(err.name)) {","                    err.name += 'Error';","                }","            } else if (!err) {","                err = codeToHttpError(res.statusCode,","                    obj.message || '', data);","            }","        }","","        if (err) {","            err.body = obj;","        }","","        callback((err || null), req2, res, obj);","    }","","    return (this._super.parse.call(this, req, parseResponse));","};",""],"l":{"5":1,"7":1,"9":1,"10":1,"11":1,"16":1,"17":0,"19":0,"20":0,"21":0,"23":0,"25":0,"27":1,"29":1,"32":1,"33":0,"34":0,"36":0,"37":0,"41":1,"42":0,"44":1,"45":0,"47":0,"48":0,"49":0,"54":0,"56":0,"58":0,"63":0,"64":0,"67":0,"71":0,"76":0,"78":0,"79":0,"81":0,"82":0,"87":0,"88":0,"91":0,"94":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/clients/string_client.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/clients/string_client.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":1,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":1,"44":0,"45":0,"46":0,"47":1,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":1,"75":1,"76":0,"77":0,"78":0,"79":0,"80":1,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0,0],"23":[0,0],"24":[0,0],"25":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"fnMap":{"1":{"name":"StringClient","line":20,"loc":{"start":{"line":20,"column":0},"end":{"line":20,"column":31}}},"2":{"name":"post","line":37,"loc":{"start":{"line":37,"column":30},"end":{"line":37,"column":69}}},"3":{"name":"put","line":49,"loc":{"start":{"line":49,"column":29},"end":{"line":49,"column":67}}},"4":{"name":"patch","line":61,"loc":{"start":{"line":61,"column":31},"end":{"line":61,"column":71}}},"5":{"name":"read","line":73,"loc":{"start":{"line":73,"column":30},"end":{"line":73,"column":63}}},"6":{"name":"_parse","line":75,"loc":{"start":{"line":75,"column":26},"end":{"line":75,"column":52}}},"7":{"name":"write","line":87,"loc":{"start":{"line":87,"column":31},"end":{"line":87,"column":71}}},"8":{"name":"_write","line":94,"loc":{"start":{"line":94,"column":4},"end":{"line":94,"column":26}}},"9":{"name":"(anonymous_9)","line":101,"loc":{"start":{"line":101,"column":30},"end":{"line":101,"column":50}}},"10":{"name":"(anonymous_10)","line":121,"loc":{"start":{"line":121,"column":28},"end":{"line":121,"column":49}}},"11":{"name":"parse","line":143,"loc":{"start":{"line":143,"column":31},"end":{"line":143,"column":61}}},"12":{"name":"parseResponse","line":144,"loc":{"start":{"line":144,"column":4},"end":{"line":144,"column":37}}},"13":{"name":"done","line":150,"loc":{"start":{"line":150,"column":8},"end":{"line":150,"column":24}}},"14":{"name":"(anonymous_14)","line":177,"loc":{"start":{"line":177,"column":30},"end":{"line":177,"column":47}}},"15":{"name":"onData","line":187,"loc":{"start":{"line":187,"column":27},"end":{"line":187,"column":50}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":31}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"3":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":32}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"6":{"start":{"line":12,"column":0},"end":{"line":12,"column":42}},"7":{"start":{"line":20,"column":0},"end":{"line":31,"column":1}},"8":{"start":{"line":21,"column":4},"end":{"line":21,"column":38}},"9":{"start":{"line":22,"column":4},"end":{"line":22,"column":56}},"10":{"start":{"line":24,"column":4},"end":{"line":24,"column":52}},"11":{"start":{"line":25,"column":4},"end":{"line":25,"column":50}},"12":{"start":{"line":26,"column":4},"end":{"line":27,"column":67}},"13":{"start":{"line":29,"column":4},"end":{"line":29,"column":35}},"14":{"start":{"line":30,"column":4},"end":{"line":30,"column":29}},"15":{"start":{"line":32,"column":0},"end":{"line":32,"column":40}},"16":{"start":{"line":34,"column":0},"end":{"line":34,"column":30}},"17":{"start":{"line":37,"column":0},"end":{"line":46,"column":2}},"18":{"start":{"line":38,"column":4},"end":{"line":38,"column":46}},"19":{"start":{"line":40,"column":4},"end":{"line":43,"column":5}},"20":{"start":{"line":41,"column":8},"end":{"line":41,"column":24}},"21":{"start":{"line":42,"column":8},"end":{"line":42,"column":20}},"22":{"start":{"line":45,"column":4},"end":{"line":45,"column":46}},"23":{"start":{"line":49,"column":0},"end":{"line":58,"column":2}},"24":{"start":{"line":50,"column":4},"end":{"line":50,"column":45}},"25":{"start":{"line":52,"column":4},"end":{"line":55,"column":5}},"26":{"start":{"line":53,"column":8},"end":{"line":53,"column":24}},"27":{"start":{"line":54,"column":8},"end":{"line":54,"column":20}},"28":{"start":{"line":57,"column":4},"end":{"line":57,"column":46}},"29":{"start":{"line":61,"column":0},"end":{"line":70,"column":2}},"30":{"start":{"line":62,"column":4},"end":{"line":62,"column":47}},"31":{"start":{"line":64,"column":4},"end":{"line":67,"column":5}},"32":{"start":{"line":65,"column":8},"end":{"line":65,"column":24}},"33":{"start":{"line":66,"column":8},"end":{"line":66,"column":20}},"34":{"start":{"line":69,"column":4},"end":{"line":69,"column":46}},"35":{"start":{"line":73,"column":0},"end":{"line":84,"column":2}},"36":{"start":{"line":74,"column":4},"end":{"line":74,"column":20}},"37":{"start":{"line":75,"column":4},"end":{"line":82,"column":7}},"38":{"start":{"line":76,"column":8},"end":{"line":78,"column":9}},"39":{"start":{"line":77,"column":12},"end":{"line":77,"column":40}},"40":{"start":{"line":80,"column":8},"end":{"line":80,"column":54}},"41":{"start":{"line":81,"column":8},"end":{"line":81,"column":27}},"42":{"start":{"line":83,"column":4},"end":{"line":83,"column":18}},"43":{"start":{"line":87,"column":0},"end":{"line":140,"column":2}},"44":{"start":{"line":88,"column":4},"end":{"line":90,"column":5}},"45":{"start":{"line":89,"column":8},"end":{"line":89,"column":34}},"46":{"start":{"line":92,"column":4},"end":{"line":92,"column":20}},"47":{"start":{"line":94,"column":4},"end":{"line":110,"column":5}},"48":{"start":{"line":95,"column":8},"end":{"line":99,"column":9}},"49":{"start":{"line":96,"column":12},"end":{"line":96,"column":48}},"50":{"start":{"line":97,"column":12},"end":{"line":97,"column":38}},"51":{"start":{"line":98,"column":12},"end":{"line":98,"column":67}},"52":{"start":{"line":101,"column":8},"end":{"line":109,"column":11}},"53":{"start":{"line":102,"column":12},"end":{"line":105,"column":13}},"54":{"start":{"line":103,"column":16},"end":{"line":103,"column":35}},"55":{"start":{"line":104,"column":16},"end":{"line":104,"column":23}},"56":{"start":{"line":107,"column":12},"end":{"line":107,"column":58}},"57":{"start":{"line":108,"column":12},"end":{"line":108,"column":26}},"58":{"start":{"line":112,"column":4},"end":{"line":112,"column":44}},"59":{"start":{"line":114,"column":4},"end":{"line":116,"column":5}},"60":{"start":{"line":115,"column":8},"end":{"line":115,"column":52}},"61":{"start":{"line":118,"column":4},"end":{"line":137,"column":5}},"62":{"start":{"line":119,"column":8},"end":{"line":134,"column":9}},"63":{"start":{"line":120,"column":12},"end":{"line":120,"column":57}},"64":{"start":{"line":121,"column":12},"end":{"line":129,"column":15}},"65":{"start":{"line":122,"column":16},"end":{"line":125,"column":17}},"66":{"start":{"line":123,"column":20},"end":{"line":123,"column":40}},"67":{"start":{"line":124,"column":20},"end":{"line":124,"column":27}},"68":{"start":{"line":127,"column":16},"end":{"line":127,"column":64}},"69":{"start":{"line":128,"column":16},"end":{"line":128,"column":29}},"70":{"start":{"line":131,"column":12},"end":{"line":132,"column":40}},"71":{"start":{"line":133,"column":12},"end":{"line":133,"column":25}},"72":{"start":{"line":136,"column":8},"end":{"line":136,"column":17}},"73":{"start":{"line":139,"column":4},"end":{"line":139,"column":18}},"74":{"start":{"line":143,"column":0},"end":{"line":205,"column":2}},"75":{"start":{"line":144,"column":4},"end":{"line":202,"column":5}},"76":{"start":{"line":145,"column":8},"end":{"line":145,"column":22}},"77":{"start":{"line":146,"column":8},"end":{"line":146,"column":15}},"78":{"start":{"line":147,"column":8},"end":{"line":147,"column":17}},"79":{"start":{"line":148,"column":8},"end":{"line":148,"column":16}},"80":{"start":{"line":150,"column":8},"end":{"line":166,"column":9}},"81":{"start":{"line":151,"column":12},"end":{"line":151,"column":54}},"82":{"start":{"line":152,"column":12},"end":{"line":152,"column":28}},"83":{"start":{"line":154,"column":12},"end":{"line":158,"column":13}},"84":{"start":{"line":155,"column":16},"end":{"line":155,"column":45}},"85":{"start":{"line":156,"column":16},"end":{"line":156,"column":40}},"86":{"start":{"line":157,"column":16},"end":{"line":157,"column":23}},"87":{"start":{"line":160,"column":12},"end":{"line":163,"column":13}},"88":{"start":{"line":161,"column":16},"end":{"line":161,"column":32}},"89":{"start":{"line":162,"column":16},"end":{"line":162,"column":35}},"90":{"start":{"line":165,"column":12},"end":{"line":165,"column":42}},"91":{"start":{"line":168,"column":8},"end":{"line":201,"column":9}},"92":{"start":{"line":169,"column":12},"end":{"line":169,"column":45}},"93":{"start":{"line":171,"column":12},"end":{"line":173,"column":13}},"94":{"start":{"line":172,"column":16},"end":{"line":172,"column":48}},"95":{"start":{"line":175,"column":12},"end":{"line":185,"column":13}},"96":{"start":{"line":176,"column":16},"end":{"line":176,"column":41}},"97":{"start":{"line":177,"column":16},"end":{"line":179,"column":19}},"98":{"start":{"line":178,"column":20},"end":{"line":178,"column":51}},"99":{"start":{"line":180,"column":16},"end":{"line":180,"column":37}},"100":{"start":{"line":181,"column":16},"end":{"line":181,"column":49}},"101":{"start":{"line":183,"column":16},"end":{"line":183,"column":40}},"102":{"start":{"line":184,"column":16},"end":{"line":184,"column":38}},"103":{"start":{"line":187,"column":12},"end":{"line":197,"column":15}},"104":{"start":{"line":188,"column":16},"end":{"line":190,"column":17}},"105":{"start":{"line":189,"column":20},"end":{"line":189,"column":39}},"106":{"start":{"line":192,"column":16},"end":{"line":196,"column":17}},"107":{"start":{"line":193,"column":20},"end":{"line":193,"column":36}},"108":{"start":{"line":195,"column":20},"end":{"line":195,"column":34}},"109":{"start":{"line":200,"column":12},"end":{"line":200,"column":43}},"110":{"start":{"line":204,"column":4},"end":{"line":204,"column":27}}},"branchMap":{"1":{"line":24,"type":"binary-expr","locations":[{"start":{"line":24,"column":21},"end":{"line":24,"column":35}},{"start":{"line":24,"column":39},"end":{"line":24,"column":51}}]},"2":{"line":25,"type":"binary-expr","locations":[{"start":{"line":25,"column":19},"end":{"line":25,"column":31}},{"start":{"line":25,"column":35},"end":{"line":25,"column":49}}]},"3":{"line":27,"type":"binary-expr","locations":[{"start":{"line":27,"column":8},"end":{"line":27,"column":27}},{"start":{"line":27,"column":31},"end":{"line":27,"column":66}}]},"4":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]},"5":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"6":{"line":64,"type":"if","locations":[{"start":{"line":64,"column":4},"end":{"line":64,"column":4}},{"start":{"line":64,"column":4},"end":{"line":64,"column":4}}]},"7":{"line":76,"type":"if","locations":[{"start":{"line":76,"column":8},"end":{"line":76,"column":8}},{"start":{"line":76,"column":8},"end":{"line":76,"column":8}}]},"8":{"line":88,"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":88,"column":4}},{"start":{"line":88,"column":4},"end":{"line":88,"column":4}}]},"9":{"line":88,"type":"binary-expr","locations":[{"start":{"line":88,"column":8},"end":{"line":88,"column":21}},{"start":{"line":88,"column":25},"end":{"line":88,"column":51}}]},"10":{"line":95,"type":"if","locations":[{"start":{"line":95,"column":8},"end":{"line":95,"column":8}},{"start":{"line":95,"column":8},"end":{"line":95,"column":8}}]},"11":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":12},"end":{"line":102,"column":12}},{"start":{"line":102,"column":12},"end":{"line":102,"column":12}}]},"12":{"line":112,"type":"binary-expr","locations":[{"start":{"line":112,"column":22},"end":{"line":112,"column":37}},{"start":{"line":112,"column":41},"end":{"line":112,"column":43}}]},"13":{"line":114,"type":"if","locations":[{"start":{"line":114,"column":4},"end":{"line":114,"column":4}},{"start":{"line":114,"column":4},"end":{"line":114,"column":4}}]},"14":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":4},"end":{"line":118,"column":4}},{"start":{"line":118,"column":4},"end":{"line":118,"column":4}}]},"15":{"line":119,"type":"if","locations":[{"start":{"line":119,"column":8},"end":{"line":119,"column":8}},{"start":{"line":119,"column":8},"end":{"line":119,"column":8}}]},"16":{"line":122,"type":"if","locations":[{"start":{"line":122,"column":16},"end":{"line":122,"column":16}},{"start":{"line":122,"column":16},"end":{"line":122,"column":16}}]},"17":{"line":154,"type":"if","locations":[{"start":{"line":154,"column":12},"end":{"line":154,"column":12}},{"start":{"line":154,"column":12},"end":{"line":154,"column":12}}]},"18":{"line":154,"type":"binary-expr","locations":[{"start":{"line":154,"column":16},"end":{"line":154,"column":20}},{"start":{"line":154,"column":24},"end":{"line":154,"column":53}}]},"19":{"line":160,"type":"if","locations":[{"start":{"line":160,"column":12},"end":{"line":160,"column":12}},{"start":{"line":160,"column":12},"end":{"line":160,"column":12}}]},"20":{"line":168,"type":"if","locations":[{"start":{"line":168,"column":8},"end":{"line":168,"column":8}},{"start":{"line":168,"column":8},"end":{"line":168,"column":8}}]},"21":{"line":171,"type":"if","locations":[{"start":{"line":171,"column":12},"end":{"line":171,"column":12}},{"start":{"line":171,"column":12},"end":{"line":171,"column":12}}]},"22":{"line":171,"type":"binary-expr","locations":[{"start":{"line":171,"column":16},"end":{"line":171,"column":19}},{"start":{"line":171,"column":23},"end":{"line":171,"column":44}},{"start":{"line":171,"column":48},"end":{"line":171,"column":70}}]},"23":{"line":175,"type":"if","locations":[{"start":{"line":175,"column":12},"end":{"line":175,"column":12}},{"start":{"line":175,"column":12},"end":{"line":175,"column":12}}]},"24":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":16},"end":{"line":188,"column":16}},{"start":{"line":188,"column":16},"end":{"line":188,"column":16}}]},"25":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":16},"end":{"line":192,"column":16}},{"start":{"line":192,"column":16},"end":{"line":192,"column":16}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var crypto = require('crypto');","var zlib = require('zlib');","","var assert = require('assert-plus');","var qs = require('querystring');","var util = require('util');","","var HttpClient = require('./http_client');","","","///--- Helpers","","","///--- API","","function StringClient(options) {","    assert.object(options, 'options');","    assert.optionalObject(options.gzip, 'options.gzip');","","    options.accept = options.accept || 'text/plain';","    options.name = options.name || 'StringClient';","    options.contentType =","        options.contentType || 'application/x-www-form-urlencoded';","","    HttpClient.call(this, options);","    this.gzip = options.gzip;","}","util.inherits(StringClient, HttpClient);","","module.exports = StringClient;","","","StringClient.prototype.post = function post(options, body, callback) {","    var opts = this._options('POST', options);","","    if (typeof (body) === 'function') {","        callback = body;","        body = null;","    }","","    return (this.write(opts, body, callback));","};","","","StringClient.prototype.put = function put(options, body, callback) {","    var opts = this._options('PUT', options);","","    if (typeof (body) === 'function') {","        callback = body;","        body = null;","    }","","    return (this.write(opts, body, callback));","};","","","StringClient.prototype.patch = function patch(options, body, callback) {","    var opts = this._options('PATCH', options);","","    if (typeof (body) === 'function') {","        callback = body;","        body = null;","    }","","    return (this.write(opts, body, callback));","};","","","StringClient.prototype.read = function read(options, callback) {","    var self = this;","    this.request(options, function _parse(err, req) {","        if (err) {","            return (callback(err, req));","        }","","        req.once('result', self.parse(req, callback));","        return (req.end());","    });","    return (this);","};","","","StringClient.prototype.write = function write(options, body, callback) {","    if (body !== null && typeof (body) !== 'string') {","        body = qs.stringify(body);","    }","","    var self = this;","","    function _write(data) {","        if (data) {","            var hash = crypto.createHash('md5');","            hash.update(data, 'utf8');","            options.headers['content-md5'] = hash.digest('base64');","        }","","        self.request(options, function (err, req) {","            if (err) {","                callback(err, req);","                return;","            }","","            req.once('result', self.parse(req, callback));","            req.end(data);","        });","    }","","    options.headers = options.headers || {};","","    if (this.gzip) {","        options.headers['accept-encoding'] = 'gzip';","    }","","    if (body) {","        if (this.gzip) {","            options.headers['content-encoding'] = 'gzip';","            zlib.gzip(body, function (err, data) {","                if (err) {","                    callback(err, null);","                    return;","                }","","                options.headers['content-length'] = data.length;","                _write(data);","            });","        } else {","            options.headers['content-length'] =","                Buffer.byteLength(body);","            _write(body);","        }","    } else {","        _write();","    }","","    return (this);","};","","","StringClient.prototype.parse = function parse(req, callback) {","    function parseResponse(err, res) {","        var body = '';","        var gz;","        var hash;","        var md5;","","        function done() {","            res.log.trace('body received:\\n%s', body);","            res.body = body;","","            if (hash && md5 !== hash.digest('base64')) {","                err = new Error('BadDigest');","                callback(err, req, res);","                return;","            }","","            if (err) {","                err.body = body;","                err.message = body;","            }","","            callback(err, req, res, body);","        }","","        if (res) {","            md5 = res.headers['content-md5'];","","            if (md5 && req.method !== 'HEAD' && res.statusCode !== 206) {","                hash = crypto.createHash('md5');","            }","","            if (res.headers['content-encoding'] === 'gzip') {","                gz = zlib.createGunzip();","                gz.on('data', function (chunk) {","                    body += chunk.toString('utf8');","                });","                gz.once('end', done);","                res.once('end', gz.end.bind(gz));","            } else {","                res.setEncoding('utf8');","                res.once('end', done);","            }","","            res.on('data', function onData(chunk) {","                if (hash) {","                    hash.update(chunk);","                }","","                if (gz) {","                    gz.write(chunk);","                } else {","                    body += chunk;","                }","            });","","        } else {","            callback(err, req, null, null);","        }","    }","","    return (parseResponse);","};",""],"l":{"5":1,"6":1,"8":1,"9":1,"10":1,"12":1,"20":1,"21":0,"22":0,"24":0,"25":0,"26":0,"29":0,"30":0,"32":1,"34":1,"37":1,"38":0,"40":0,"41":0,"42":0,"45":0,"49":1,"50":0,"52":0,"53":0,"54":0,"57":0,"61":1,"62":0,"64":0,"65":0,"66":0,"69":0,"73":1,"74":0,"75":0,"76":0,"77":0,"80":0,"81":0,"83":0,"87":1,"88":0,"89":0,"92":0,"94":1,"95":0,"96":0,"97":0,"98":0,"101":0,"102":0,"103":0,"104":0,"107":0,"108":0,"112":0,"114":0,"115":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"127":0,"128":0,"131":0,"133":0,"136":0,"139":0,"143":1,"144":1,"145":0,"146":0,"147":0,"148":0,"150":1,"151":0,"152":0,"154":0,"155":0,"156":0,"157":0,"160":0,"161":0,"162":0,"165":0,"168":0,"169":0,"171":0,"172":0,"175":0,"176":0,"177":0,"178":0,"180":0,"181":0,"183":0,"184":0,"187":0,"188":0,"189":0,"192":0,"193":0,"195":0,"200":0,"204":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/request.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/request.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":0,"13":0,"14":0,"15":1,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":1,"47":1,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":1,"61":0,"62":0,"63":0,"64":0,"65":1,"66":0,"67":1,"68":1,"69":0,"70":0,"71":0,"72":0,"73":1,"74":1,"75":0,"76":1,"77":1,"78":0,"79":1,"80":1,"81":0,"82":1,"83":0,"84":0,"85":0,"86":0,"87":1,"88":0,"89":0,"90":0,"91":0,"92":1,"93":1,"94":0,"95":0,"96":0,"97":1,"98":0,"99":0,"100":0,"101":0,"102":0,"103":1,"104":0,"105":0,"106":0,"107":0,"108":0,"109":1,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":1,"125":0,"126":1,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":1,"134":0,"135":0,"136":0,"137":0,"138":1,"139":0,"140":0,"141":0,"142":1,"143":0,"144":0,"145":1,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":1,"154":0,"155":1,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":1,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0},"fnMap":{"1":{"name":"negotiator","line":31,"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":25}}},"2":{"name":"absoluteUri","line":59,"loc":{"start":{"line":59,"column":32},"end":{"line":59,"column":59}}},"3":{"name":"accepts","line":76,"loc":{"start":{"line":76,"column":28},"end":{"line":76,"column":52}}},"4":{"name":"(anonymous_4)","line":81,"loc":{"start":{"line":81,"column":22},"end":{"line":81,"column":35}}},"5":{"name":"acceptsEncoding","line":103,"loc":{"start":{"line":103,"column":36},"end":{"line":103,"column":68}}},"6":{"name":"getContentLength","line":122,"loc":{"start":{"line":122,"column":37},"end":{"line":122,"column":65}}},"7":{"name":"getContentType","line":158,"loc":{"start":{"line":158,"column":35},"end":{"line":158,"column":61}}},"8":{"name":"date","line":192,"loc":{"start":{"line":192,"column":25},"end":{"line":192,"column":41}}},"9":{"name":"getHref","line":208,"loc":{"start":{"line":208,"column":28},"end":{"line":208,"column":47}}},"10":{"name":"getId","line":220,"loc":{"start":{"line":220,"column":26},"end":{"line":220,"column":43}}},"11":{"name":"getPath","line":241,"loc":{"start":{"line":241,"column":28},"end":{"line":241,"column":47}}},"12":{"name":"getQuery","line":253,"loc":{"start":{"line":253,"column":29},"end":{"line":253,"column":49}}},"13":{"name":"time","line":268,"loc":{"start":{"line":268,"column":25},"end":{"line":268,"column":41}}},"14":{"name":"getUrl","line":279,"loc":{"start":{"line":279,"column":27},"end":{"line":279,"column":45}}},"15":{"name":"getVersion","line":294,"loc":{"start":{"line":294,"column":31},"end":{"line":294,"column":53}}},"16":{"name":"matchedVersion","line":308,"loc":{"start":{"line":308,"column":35},"end":{"line":308,"column":61}}},"17":{"name":"header","line":325,"loc":{"start":{"line":325,"column":27},"end":{"line":325,"column":56}}},"18":{"name":"trailer","line":347,"loc":{"start":{"line":347,"column":28},"end":{"line":347,"column":58}}},"19":{"name":"is","line":367,"loc":{"start":{"line":367,"column":23},"end":{"line":367,"column":41}}},"20":{"name":"isChunked","line":400,"loc":{"start":{"line":400,"column":30},"end":{"line":400,"column":51}}},"21":{"name":"isKeepAlive","line":411,"loc":{"start":{"line":411,"column":32},"end":{"line":411,"column":55}}},"22":{"name":"isSecure","line":432,"loc":{"start":{"line":432,"column":29},"end":{"line":432,"column":49}}},"23":{"name":"isUpgradeRequest","line":448,"loc":{"start":{"line":448,"column":37},"end":{"line":448,"column":65}}},"24":{"name":"isUpload","line":463,"loc":{"start":{"line":463,"column":29},"end":{"line":463,"column":49}}},"25":{"name":"toString","line":475,"loc":{"start":{"line":475,"column":29},"end":{"line":475,"column":49}}},"26":{"name":"(anonymous_26)","line":480,"loc":{"start":{"line":480,"column":38},"end":{"line":480,"column":51}}},"27":{"name":"userAgent","line":500,"loc":{"start":{"line":500,"column":30},"end":{"line":500,"column":51}}},"28":{"name":"startHandlerTimer","line":514,"loc":{"start":{"line":514,"column":38},"end":{"line":514,"column":78}}},"29":{"name":"(anonymous_29)","line":527,"loc":{"start":{"line":527,"column":47},"end":{"line":527,"column":59}}},"30":{"name":"endHandlerTimer","line":545,"loc":{"start":{"line":545,"column":36},"end":{"line":545,"column":74}}},"31":{"name":"(anonymous_31)","line":562,"loc":{"start":{"line":562,"column":46},"end":{"line":562,"column":58}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":27}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":25}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":37}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":36}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":39}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"8":{"start":{"line":14,"column":0},"end":{"line":14,"column":33}},"9":{"start":{"line":19,"column":0},"end":{"line":19,"column":35}},"10":{"start":{"line":31,"column":0},"end":{"line":45,"column":1}},"11":{"start":{"line":32,"column":4},"end":{"line":32,"column":24}},"12":{"start":{"line":34,"column":4},"end":{"line":42,"column":5}},"13":{"start":{"line":35,"column":8},"end":{"line":41,"column":11}},"14":{"start":{"line":44,"column":4},"end":{"line":44,"column":29}},"15":{"start":{"line":59,"column":0},"end":{"line":65,"column":2}},"16":{"start":{"line":60,"column":4},"end":{"line":60,"column":32}},"17":{"start":{"line":62,"column":4},"end":{"line":62,"column":56}},"18":{"start":{"line":63,"column":4},"end":{"line":63,"column":37}},"19":{"start":{"line":64,"column":4},"end":{"line":64,"column":72}},"20":{"start":{"line":76,"column":0},"end":{"line":93,"column":2}},"21":{"start":{"line":77,"column":4},"end":{"line":79,"column":5}},"22":{"start":{"line":78,"column":8},"end":{"line":78,"column":24}},"23":{"start":{"line":81,"column":4},"end":{"line":88,"column":7}},"24":{"start":{"line":82,"column":8},"end":{"line":82,"column":33}},"25":{"start":{"line":84,"column":8},"end":{"line":86,"column":9}},"26":{"start":{"line":85,"column":12},"end":{"line":85,"column":31}},"27":{"start":{"line":87,"column":8},"end":{"line":87,"column":19}},"28":{"start":{"line":90,"column":4},"end":{"line":90,"column":21}},"29":{"start":{"line":92,"column":4},"end":{"line":92,"column":56}},"30":{"start":{"line":103,"column":0},"end":{"line":113,"column":2}},"31":{"start":{"line":104,"column":4},"end":{"line":106,"column":5}},"32":{"start":{"line":105,"column":8},"end":{"line":105,"column":24}},"33":{"start":{"line":108,"column":4},"end":{"line":108,"column":41}},"34":{"start":{"line":110,"column":4},"end":{"line":110,"column":21}},"35":{"start":{"line":112,"column":4},"end":{"line":112,"column":55}},"36":{"start":{"line":122,"column":0},"end":{"line":142,"column":2}},"37":{"start":{"line":123,"column":4},"end":{"line":125,"column":5}},"38":{"start":{"line":124,"column":8},"end":{"line":124,"column":63}},"39":{"start":{"line":129,"column":4},"end":{"line":131,"column":5}},"40":{"start":{"line":130,"column":8},"end":{"line":130,"column":19}},"41":{"start":{"line":133,"column":4},"end":{"line":133,"column":44}},"42":{"start":{"line":135,"column":4},"end":{"line":139,"column":5}},"43":{"start":{"line":136,"column":8},"end":{"line":136,"column":27}},"44":{"start":{"line":138,"column":8},"end":{"line":138,"column":39}},"45":{"start":{"line":141,"column":4},"end":{"line":141,"column":59}},"46":{"start":{"line":149,"column":0},"end":{"line":149,"column":69}},"47":{"start":{"line":158,"column":0},"end":{"line":181,"column":2}},"48":{"start":{"line":159,"column":4},"end":{"line":161,"column":5}},"49":{"start":{"line":160,"column":8},"end":{"line":160,"column":35}},"50":{"start":{"line":163,"column":4},"end":{"line":163,"column":14}},"51":{"start":{"line":164,"column":4},"end":{"line":164,"column":44}},"52":{"start":{"line":166,"column":4},"end":{"line":175,"column":5}},"53":{"start":{"line":168,"column":8},"end":{"line":168,"column":55}},"54":{"start":{"line":170,"column":8},"end":{"line":174,"column":9}},"55":{"start":{"line":171,"column":12},"end":{"line":171,"column":37}},"56":{"start":{"line":173,"column":12},"end":{"line":173,"column":57}},"57":{"start":{"line":178,"column":4},"end":{"line":178,"column":56}},"58":{"start":{"line":180,"column":4},"end":{"line":180,"column":31}},"59":{"start":{"line":182,"column":0},"end":{"line":182,"column":65}},"60":{"start":{"line":192,"column":0},"end":{"line":199,"column":2}},"61":{"start":{"line":193,"column":4},"end":{"line":195,"column":5}},"62":{"start":{"line":194,"column":8},"end":{"line":194,"column":28}},"63":{"start":{"line":197,"column":4},"end":{"line":197,"column":38}},"64":{"start":{"line":198,"column":4},"end":{"line":198,"column":24}},"65":{"start":{"line":208,"column":0},"end":{"line":210,"column":2}},"66":{"start":{"line":209,"column":4},"end":{"line":209,"column":32}},"67":{"start":{"line":211,"column":0},"end":{"line":211,"column":51}},"68":{"start":{"line":220,"column":0},"end":{"line":230,"column":2}},"69":{"start":{"line":221,"column":4},"end":{"line":223,"column":5}},"70":{"start":{"line":222,"column":8},"end":{"line":222,"column":26}},"71":{"start":{"line":225,"column":4},"end":{"line":227,"column":18}},"72":{"start":{"line":229,"column":4},"end":{"line":229,"column":22}},"73":{"start":{"line":231,"column":0},"end":{"line":231,"column":47}},"74":{"start":{"line":241,"column":0},"end":{"line":243,"column":2}},"75":{"start":{"line":242,"column":4},"end":{"line":242,"column":36}},"76":{"start":{"line":244,"column":0},"end":{"line":244,"column":51}},"77":{"start":{"line":253,"column":0},"end":{"line":258,"column":2}},"78":{"start":{"line":257,"column":4},"end":{"line":257,"column":39}},"79":{"start":{"line":259,"column":0},"end":{"line":259,"column":53}},"80":{"start":{"line":268,"column":0},"end":{"line":270,"column":2}},"81":{"start":{"line":269,"column":4},"end":{"line":269,"column":24}},"82":{"start":{"line":279,"column":0},"end":{"line":285,"column":2}},"83":{"start":{"line":280,"column":4},"end":{"line":283,"column":5}},"84":{"start":{"line":281,"column":8},"end":{"line":281,"column":40}},"85":{"start":{"line":282,"column":8},"end":{"line":282,"column":34}},"86":{"start":{"line":284,"column":4},"end":{"line":284,"column":23}},"87":{"start":{"line":294,"column":0},"end":{"line":305,"column":2}},"88":{"start":{"line":295,"column":4},"end":{"line":297,"column":5}},"89":{"start":{"line":296,"column":8},"end":{"line":296,"column":31}},"90":{"start":{"line":299,"column":4},"end":{"line":302,"column":16}},"91":{"start":{"line":304,"column":4},"end":{"line":304,"column":27}},"92":{"start":{"line":306,"column":0},"end":{"line":306,"column":57}},"93":{"start":{"line":308,"column":0},"end":{"line":314,"column":2}},"94":{"start":{"line":309,"column":4},"end":{"line":313,"column":5}},"95":{"start":{"line":310,"column":8},"end":{"line":310,"column":38}},"96":{"start":{"line":312,"column":8},"end":{"line":312,"column":32}},"97":{"start":{"line":325,"column":0},"end":{"line":335,"column":2}},"98":{"start":{"line":326,"column":4},"end":{"line":326,"column":32}},"99":{"start":{"line":328,"column":4},"end":{"line":328,"column":30}},"100":{"start":{"line":330,"column":4},"end":{"line":332,"column":5}},"101":{"start":{"line":331,"column":8},"end":{"line":331,"column":25}},"102":{"start":{"line":334,"column":4},"end":{"line":334,"column":41}},"103":{"start":{"line":347,"column":0},"end":{"line":356,"column":2}},"104":{"start":{"line":348,"column":4},"end":{"line":348,"column":32}},"105":{"start":{"line":349,"column":4},"end":{"line":349,"column":30}},"106":{"start":{"line":351,"column":4},"end":{"line":353,"column":5}},"107":{"start":{"line":352,"column":8},"end":{"line":352,"column":25}},"108":{"start":{"line":355,"column":4},"end":{"line":355,"column":50}},"109":{"start":{"line":367,"column":0},"end":{"line":391,"column":2}},"110":{"start":{"line":368,"column":4},"end":{"line":368,"column":32}},"111":{"start":{"line":370,"column":4},"end":{"line":370,"column":44}},"112":{"start":{"line":371,"column":4},"end":{"line":371,"column":23}},"113":{"start":{"line":373,"column":4},"end":{"line":375,"column":5}},"114":{"start":{"line":374,"column":8},"end":{"line":374,"column":23}},"115":{"start":{"line":377,"column":4},"end":{"line":379,"column":5}},"116":{"start":{"line":378,"column":8},"end":{"line":378,"column":33}},"117":{"start":{"line":381,"column":4},"end":{"line":388,"column":5}},"118":{"start":{"line":382,"column":8},"end":{"line":382,"column":31}},"119":{"start":{"line":383,"column":8},"end":{"line":383,"column":45}},"120":{"start":{"line":384,"column":8},"end":{"line":384,"column":67}},"121":{"start":{"line":385,"column":8},"end":{"line":385,"column":67}},"122":{"start":{"line":387,"column":8},"end":{"line":387,"column":41}},"123":{"start":{"line":390,"column":4},"end":{"line":390,"column":21}},"124":{"start":{"line":400,"column":0},"end":{"line":402,"column":2}},"125":{"start":{"line":401,"column":4},"end":{"line":401,"column":61}},"126":{"start":{"line":411,"column":0},"end":{"line":423,"column":2}},"127":{"start":{"line":412,"column":4},"end":{"line":414,"column":5}},"128":{"start":{"line":413,"column":8},"end":{"line":413,"column":33}},"129":{"start":{"line":416,"column":4},"end":{"line":420,"column":5}},"130":{"start":{"line":417,"column":8},"end":{"line":417,"column":70}},"131":{"start":{"line":419,"column":8},"end":{"line":419,"column":68}},"132":{"start":{"line":422,"column":4},"end":{"line":422,"column":29}},"133":{"start":{"line":432,"column":0},"end":{"line":439,"column":2}},"134":{"start":{"line":433,"column":4},"end":{"line":435,"column":5}},"135":{"start":{"line":434,"column":8},"end":{"line":434,"column":30}},"136":{"start":{"line":437,"column":4},"end":{"line":437,"column":60}},"137":{"start":{"line":438,"column":4},"end":{"line":438,"column":26}},"138":{"start":{"line":448,"column":0},"end":{"line":454,"column":2}},"139":{"start":{"line":449,"column":4},"end":{"line":453,"column":5}},"140":{"start":{"line":450,"column":8},"end":{"line":450,"column":38}},"141":{"start":{"line":452,"column":8},"end":{"line":452,"column":23}},"142":{"start":{"line":463,"column":0},"end":{"line":466,"column":2}},"143":{"start":{"line":464,"column":4},"end":{"line":464,"column":24}},"144":{"start":{"line":465,"column":4},"end":{"line":465,"column":58}},"145":{"start":{"line":475,"column":0},"end":{"line":491,"column":2}},"146":{"start":{"line":476,"column":4},"end":{"line":476,"column":21}},"147":{"start":{"line":477,"column":4},"end":{"line":477,"column":20}},"148":{"start":{"line":478,"column":4},"end":{"line":478,"column":12}},"149":{"start":{"line":480,"column":4},"end":{"line":482,"column":7}},"150":{"start":{"line":481,"column":8},"end":{"line":481,"column":59}},"151":{"start":{"line":484,"column":4},"end":{"line":488,"column":17}},"152":{"start":{"line":490,"column":4},"end":{"line":490,"column":17}},"153":{"start":{"line":500,"column":0},"end":{"line":502,"column":2}},"154":{"start":{"line":501,"column":4},"end":{"line":501,"column":40}},"155":{"start":{"line":514,"column":0},"end":{"line":535,"column":2}},"156":{"start":{"line":515,"column":4},"end":{"line":515,"column":20}},"157":{"start":{"line":518,"column":4},"end":{"line":519,"column":72}},"158":{"start":{"line":521,"column":4},"end":{"line":523,"column":5}},"159":{"start":{"line":522,"column":8},"end":{"line":522,"column":28}},"160":{"start":{"line":525,"column":4},"end":{"line":525,"column":44}},"161":{"start":{"line":527,"column":4},"end":{"line":534,"column":7}},"162":{"start":{"line":528,"column":8},"end":{"line":533,"column":11}},"163":{"start":{"line":545,"column":0},"end":{"line":570,"column":2}},"164":{"start":{"line":546,"column":4},"end":{"line":546,"column":20}},"165":{"start":{"line":549,"column":4},"end":{"line":550,"column":72}},"166":{"start":{"line":552,"column":4},"end":{"line":554,"column":5}},"167":{"start":{"line":553,"column":8},"end":{"line":553,"column":25}},"168":{"start":{"line":556,"column":4},"end":{"line":556,"column":64}},"169":{"start":{"line":557,"column":4},"end":{"line":560,"column":7}},"170":{"start":{"line":562,"column":4},"end":{"line":569,"column":7}},"171":{"start":{"line":563,"column":8},"end":{"line":568,"column":11}}},"branchMap":{"1":{"line":34,"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":34,"column":4}},{"start":{"line":34,"column":4},"end":{"line":34,"column":4}}]},"2":{"line":37,"type":"binary-expr","locations":[{"start":{"line":37,"column":24},"end":{"line":37,"column":32}},{"start":{"line":37,"column":36},"end":{"line":37,"column":41}}]},"3":{"line":38,"type":"binary-expr","locations":[{"start":{"line":38,"column":35},"end":{"line":38,"column":55}},{"start":{"line":39,"column":20},"end":{"line":39,"column":30}}]},"4":{"line":62,"type":"cond-expr","locations":[{"start":{"line":62,"column":33},"end":{"line":62,"column":43}},{"start":{"line":62,"column":46},"end":{"line":62,"column":55}}]},"5":{"line":77,"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":77,"column":4}},{"start":{"line":77,"column":4},"end":{"line":77,"column":4}}]},"6":{"line":84,"type":"if","locations":[{"start":{"line":84,"column":8},"end":{"line":84,"column":8}},{"start":{"line":84,"column":8},"end":{"line":84,"column":8}}]},"7":{"line":104,"type":"if","locations":[{"start":{"line":104,"column":4},"end":{"line":104,"column":4}},{"start":{"line":104,"column":4},"end":{"line":104,"column":4}}]},"8":{"line":123,"type":"if","locations":[{"start":{"line":123,"column":4},"end":{"line":123,"column":4}},{"start":{"line":123,"column":4},"end":{"line":123,"column":4}}]},"9":{"line":124,"type":"cond-expr","locations":[{"start":{"line":124,"column":39},"end":{"line":124,"column":48}},{"start":{"line":124,"column":51},"end":{"line":124,"column":61}}]},"10":{"line":129,"type":"if","locations":[{"start":{"line":129,"column":4},"end":{"line":129,"column":4}},{"start":{"line":129,"column":4},"end":{"line":129,"column":4}}]},"11":{"line":135,"type":"if","locations":[{"start":{"line":135,"column":4},"end":{"line":135,"column":4}},{"start":{"line":135,"column":4},"end":{"line":135,"column":4}}]},"12":{"line":141,"type":"cond-expr","locations":[{"start":{"line":141,"column":35},"end":{"line":141,"column":44}},{"start":{"line":141,"column":47},"end":{"line":141,"column":57}}]},"13":{"line":159,"type":"if","locations":[{"start":{"line":159,"column":4},"end":{"line":159,"column":4}},{"start":{"line":159,"column":4},"end":{"line":159,"column":4}}]},"14":{"line":166,"type":"if","locations":[{"start":{"line":166,"column":4},"end":{"line":166,"column":4}},{"start":{"line":166,"column":4},"end":{"line":166,"column":4}}]},"15":{"line":170,"type":"if","locations":[{"start":{"line":170,"column":8},"end":{"line":170,"column":8}},{"start":{"line":170,"column":8},"end":{"line":170,"column":8}}]},"16":{"line":193,"type":"if","locations":[{"start":{"line":193,"column":4},"end":{"line":193,"column":4}},{"start":{"line":193,"column":4},"end":{"line":193,"column":4}}]},"17":{"line":221,"type":"if","locations":[{"start":{"line":221,"column":4},"end":{"line":221,"column":4}},{"start":{"line":221,"column":4},"end":{"line":221,"column":4}}]},"18":{"line":225,"type":"binary-expr","locations":[{"start":{"line":225,"column":15},"end":{"line":225,"column":41}},{"start":{"line":226,"column":8},"end":{"line":226,"column":36}},{"start":{"line":227,"column":8},"end":{"line":227,"column":17}}]},"19":{"line":257,"type":"binary-expr","locations":[{"start":{"line":257,"column":12},"end":{"line":257,"column":31}},{"start":{"line":257,"column":35},"end":{"line":257,"column":37}}]},"20":{"line":280,"type":"if","locations":[{"start":{"line":280,"column":4},"end":{"line":280,"column":4}},{"start":{"line":280,"column":4},"end":{"line":280,"column":4}}]},"21":{"line":295,"type":"if","locations":[{"start":{"line":295,"column":4},"end":{"line":295,"column":4}},{"start":{"line":295,"column":4},"end":{"line":295,"column":4}}]},"22":{"line":300,"type":"binary-expr","locations":[{"start":{"line":300,"column":8},"end":{"line":300,"column":38}},{"start":{"line":301,"column":12},"end":{"line":301,"column":41}},{"start":{"line":302,"column":12},"end":{"line":302,"column":15}}]},"23":{"line":309,"type":"if","locations":[{"start":{"line":309,"column":4},"end":{"line":309,"column":4}},{"start":{"line":309,"column":4},"end":{"line":309,"column":4}}]},"24":{"line":330,"type":"if","locations":[{"start":{"line":330,"column":4},"end":{"line":330,"column":4}},{"start":{"line":330,"column":4},"end":{"line":330,"column":4}}]},"25":{"line":330,"type":"binary-expr","locations":[{"start":{"line":330,"column":8},"end":{"line":330,"column":26}},{"start":{"line":330,"column":30},"end":{"line":330,"column":49}}]},"26":{"line":334,"type":"binary-expr","locations":[{"start":{"line":334,"column":12},"end":{"line":334,"column":30}},{"start":{"line":334,"column":34},"end":{"line":334,"column":39}}]},"27":{"line":351,"type":"if","locations":[{"start":{"line":351,"column":4},"end":{"line":351,"column":4}},{"start":{"line":351,"column":4},"end":{"line":351,"column":4}}]},"28":{"line":351,"type":"binary-expr","locations":[{"start":{"line":351,"column":8},"end":{"line":351,"column":26}},{"start":{"line":351,"column":30},"end":{"line":351,"column":49}}]},"29":{"line":355,"type":"binary-expr","locations":[{"start":{"line":355,"column":12},"end":{"line":355,"column":39}},{"start":{"line":355,"column":43},"end":{"line":355,"column":48}}]},"30":{"line":355,"type":"binary-expr","locations":[{"start":{"line":355,"column":13},"end":{"line":355,"column":26}},{"start":{"line":355,"column":30},"end":{"line":355,"column":32}}]},"31":{"line":373,"type":"if","locations":[{"start":{"line":373,"column":4},"end":{"line":373,"column":4}},{"start":{"line":373,"column":4},"end":{"line":373,"column":4}}]},"32":{"line":377,"type":"if","locations":[{"start":{"line":377,"column":4},"end":{"line":377,"column":4}},{"start":{"line":377,"column":4},"end":{"line":377,"column":4}}]},"33":{"line":381,"type":"if","locations":[{"start":{"line":381,"column":4},"end":{"line":381,"column":4}},{"start":{"line":381,"column":4},"end":{"line":381,"column":4}}]},"34":{"line":384,"type":"binary-expr","locations":[{"start":{"line":384,"column":20},"end":{"line":384,"column":35}},{"start":{"line":384,"column":39},"end":{"line":384,"column":65}}]},"35":{"line":385,"type":"binary-expr","locations":[{"start":{"line":385,"column":20},"end":{"line":385,"column":35}},{"start":{"line":385,"column":39},"end":{"line":385,"column":65}}]},"36":{"line":412,"type":"if","locations":[{"start":{"line":412,"column":4},"end":{"line":412,"column":4}},{"start":{"line":412,"column":4},"end":{"line":412,"column":4}}]},"37":{"line":416,"type":"if","locations":[{"start":{"line":416,"column":4},"end":{"line":416,"column":4}},{"start":{"line":416,"column":4},"end":{"line":416,"column":4}}]},"38":{"line":419,"type":"cond-expr","locations":[{"start":{"line":419,"column":55},"end":{"line":419,"column":60}},{"start":{"line":419,"column":63},"end":{"line":419,"column":67}}]},"39":{"line":433,"type":"if","locations":[{"start":{"line":433,"column":4},"end":{"line":433,"column":4}},{"start":{"line":433,"column":4},"end":{"line":433,"column":4}}]},"40":{"line":437,"type":"cond-expr","locations":[{"start":{"line":437,"column":47},"end":{"line":437,"column":51}},{"start":{"line":437,"column":54},"end":{"line":437,"column":59}}]},"41":{"line":449,"type":"if","locations":[{"start":{"line":449,"column":4},"end":{"line":449,"column":4}},{"start":{"line":449,"column":4},"end":{"line":449,"column":4}}]},"42":{"line":465,"type":"binary-expr","locations":[{"start":{"line":465,"column":12},"end":{"line":465,"column":25}},{"start":{"line":465,"column":29},"end":{"line":465,"column":41}},{"start":{"line":465,"column":45},"end":{"line":465,"column":56}}]},"43":{"line":518,"type":"cond-expr","locations":[{"start":{"line":519,"column":16},"end":{"line":519,"column":27}},{"start":{"line":519,"column":30},"end":{"line":519,"column":70}}]},"44":{"line":521,"type":"if","locations":[{"start":{"line":521,"column":4},"end":{"line":521,"column":4}},{"start":{"line":521,"column":4},"end":{"line":521,"column":4}}]},"45":{"line":549,"type":"cond-expr","locations":[{"start":{"line":550,"column":16},"end":{"line":550,"column":27}},{"start":{"line":550,"column":30},"end":{"line":550,"column":70}}]},"46":{"line":552,"type":"if","locations":[{"start":{"line":552,"column":4},"end":{"line":552,"column":4}},{"start":{"line":552,"column":4},"end":{"line":552,"column":4}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var http = require('http');","var url = require('url');","var sprintf = require('util').format;","","var assert = require('assert-plus');","var mime = require('mime');","var Negotatior = require('negotiator');","var uuid = require('node-uuid');","","var dtrace = require('./dtrace');","","","///--- Globals","","var Request = http.IncomingMessage;","","","///-- Helpers","/**"," * creates and sets negotiator on request if one doesn't already exist,"," * then returns it."," * @private"," * @function negotiator"," * @param    {Object} req the request object"," * @returns  {Object}     a negotiator"," */","function negotiator(req) {","    var h = req.headers;","","    if (!req._negotatiator) {","        req._negotiator = new Negotatior({","            headers: {","                accept: h.accept || '*/*',","                'accept-encoding': h['accept-encoding'] ||","                    'identity'","            }","        });","    }","","    return (req._negotiator);","}","","","///--- API","","///--- Patches","","/**"," * builds an absolute URI for the request."," * @private"," * @function absoluteUri"," * @param    {String} path a url path"," * @returns  {String}"," */","Request.prototype.absoluteUri = function absoluteUri(path) {","    assert.string(path, 'path');","","    var protocol = this.secure ? 'https://' : 'http://';","    var hostname = this.headers.host;","    return (url.resolve(protocol + hostname + this.path() + '/', path));","};","","","/**"," * checks if the accept header is present and has the value requested."," * e.g., req.accepts('html');"," * @public"," * @function accepts"," * @param    {String | Array} types an array of accept type headers"," * @returns  {Boolean}"," */","Request.prototype.accepts = function accepts(types) {","    if (typeof (types) === 'string') {","        types = [types];","    }","","    types = types.map(function (t) {","        assert.string(t, 'type');","","        if (t.indexOf('/') === -1) {","            t = mime.lookup(t);","        }","        return (t);","    });","","    negotiator(this);","","    return (this._negotiator.preferredMediaType(types));","};","","","/**"," * checks if the request accepts the encoding types."," * @public"," * @function acceptsEncoding"," * @param    {String | Array} types an array of accept type headers"," * @returns  {Boolean}"," */","Request.prototype.acceptsEncoding = function acceptsEncoding(types) {","    if (typeof (types) === 'string') {","        types = [types];","    }","","    assert.arrayOfString(types, 'types');","","    negotiator(this);","","    return (this._negotiator.preferredEncoding(types));","};","","","/**"," * gets the content-length header off the request."," * @public"," * @function getContentLength"," * @returns {Number}"," */","Request.prototype.getContentLength = function getContentLength() {","    if (this._clen !== undefined) {","        return (this._clen === false ? undefined : this._clen);","    }","","    // We should not attempt to read and parse the body of an","    // Upgrade request, so force Content-Length to zero:","    if (this.isUpgradeRequest()) {","        return (0);","    }","","    var len = this.header('content-length');","","    if (!len) {","        this._clen = false;","    } else {","        this._clen = parseInt(len, 10);","    }","","    return (this._clen === false ? undefined : this._clen);","};","/**"," * pass through to getContentLength"," * @public"," * @function contentLength"," * @returns {Number}"," */","Request.prototype.contentLength = Request.prototype.getContentLength;","","","/**"," * gets the content-type header."," * @public"," * @function getContentType"," * @returns {String}"," */","Request.prototype.getContentType = function getContentType() {","    if (this._contentType !== undefined) {","        return (this._contentType);","    }","","    var index;","    var type = this.headers['content-type'];","","    if (!type) {","        // RFC2616 section 7.2.1","        this._contentType = 'application/octet-stream';","    } else {","        if ((index = type.indexOf(';')) === -1) {","            this._contentType = type;","        } else {","            this._contentType = type.substring(0, index);","        }","    }","","    // #877 content-types need to be case insensitive.","    this._contentType = this._contentType.toLowerCase();","","    return (this._contentType);","};","Request.prototype.contentType = Request.prototype.getContentType;","","","/**"," * gets the _date property off the request. was created when the request"," * was setup."," * @private"," * @function date"," * @returns  {Date}"," */","Request.prototype.date = function date() {","    if (this._date !== undefined) {","        return (this._date);","    }","","    this._date = new Date(this._time);","    return (this._date);","};","","","/**"," * retrieves the complete URI requested by the client."," * @public"," * @function getHref"," * @returns {String}"," */","Request.prototype.getHref = function getHref() {","    return (this.getUrl().href);","};","Request.prototype.href = Request.prototype.getHref;","","","/**"," * retrieves the request uuid. was created when the request was setup."," * @public"," * @function getId"," * @returns  {String}"," */","Request.prototype.getId = function getId() {","    if (this._id !== undefined) {","        return (this._id);","    }","","    this._id = this.headers['request-id'] ||","        this.headers['x-request-id'] ||","        uuid.v4();","","    return (this._id);","};","Request.prototype.id = Request.prototype.getId;","","","/**"," * retrieves the cleaned up url path."," * e.g., /foo?a=1  =>  /foo"," * @public"," * @function getPath"," * @returns  {String}"," */","Request.prototype.getPath = function getPath() {","    return (this.getUrl().pathname);","};","Request.prototype.path = Request.prototype.getPath;","","","/**"," * returns the raw query string"," * @public"," * @function getQuery"," * @returns  {String}"," */","Request.prototype.getQuery = function getQuery() {","    // always return a string, because this is the raw query string.","    // if the queryParser plugin is used, req.query will provide an empty","    // object fallback.","    return (this.getUrl().query || '');","};","Request.prototype.query = Request.prototype.getQuery;","","","/**"," * returns ms since epoch when request was setup."," * @public"," * @function time"," * @returns  {Number}"," */","Request.prototype.time = function time() {","    return (this._time);","};","","","/**"," * returns a parsed URL object."," * @public"," * @function getUrl"," * @returns  {Object}"," */","Request.prototype.getUrl = function getUrl() {","    if (this._cacheURL !== this.url) {","        this._url = url.parse(this.url);","        this._cacheURL = this.url;","    }","    return (this._url);","};","","","/**"," * returns the accept-version header."," * @public"," * @function getVersion"," * @returns  {String}"," */","Request.prototype.getVersion = function getVersion() {","    if (this._version !== undefined) {","        return (this._version);","    }","","    this._version =","        this.headers['accept-version'] ||","            this.headers['x-api-version'] ||","            '*';","","    return (this._version);","};","Request.prototype.version = Request.prototype.getVersion;","","Request.prototype.matchedVersion = function matchedVersion() {","    if (this._matchedVersion !== undefined) {","        return (this._matchedVersion);","    } else {","        return (this.version());","    }","};","","/**"," * returns any header off the request. also, 'correct' any"," * correctly spelled 'referrer' header to the actual spelling used."," * @public"," * @function header"," * @param    {String} name  the name of the header"," * @param    {String} value default value if header isn't found on the req"," * @returns  {String}"," */","Request.prototype.header = function header(name, value) {","    assert.string(name, 'name');","","    name = name.toLowerCase();","","    if (name === 'referer' || name === 'referrer') {","        name = 'referer';","    }","","    return (this.headers[name] || value);","};","","","/**"," * returns any trailer header off the request. also, 'correct' any"," * correctly spelled 'referrer' header to the actual spelling used."," * @public"," * @function trailer"," * @param    {String} name  the name of the header"," * @param    {String} value default value if header isn't found on the req"," * @returns  {String}"," */","Request.prototype.trailer = function trailer(name, value) {","    assert.string(name, 'name');","    name = name.toLowerCase();","","    if (name === 'referer' || name === 'referrer') {","        name = 'referer';","    }","","    return ((this.trailers || {})[name] || value);","};","","","/**"," * Check if the incoming request contains the Content-Type header field, and"," * if it contains the given mime type."," * @public"," * @function is"," * @param    {String} type  a content-type header value"," * @returns  {Boolean}"," */","Request.prototype.is = function is(type) {","    assert.string(type, 'type');","","    var contentType = this.getContentType();","    var matches = true;","","    if (!contentType) {","        return (false);","    }","","    if (type.indexOf('/') === -1) {","        type = mime.lookup(type);","    }","","    if (type.indexOf('*') !== -1) {","        type = type.split('/');","        contentType = contentType.split('/');","        matches &= (type[0] === '*' || type[0] === contentType[0]);","        matches &= (type[1] === '*' || type[1] === contentType[1]);","    } else {","        matches = (contentType === type);","    }","","    return (matches);","};","","","/**"," * Check if the incoming request is chunked."," * @public"," * @function isChunked"," * @returns  {Boolean}"," */","Request.prototype.isChunked = function isChunked() {","    return (this.headers['transfer-encoding'] === 'chunked');","};","","","/**"," * Check if the incoming request is kept alive."," * @public"," * @function isKeepAlive"," * @returns  {Boolean}"," */","Request.prototype.isKeepAlive = function isKeepAlive() {","    if (this._keepAlive !== undefined) {","        return (this._keepAlive);","    }","","    if (this.headers.connection) {","        this._keepAlive = /keep-alive/i.test(this.headers.connection);","    } else {","        this._keepAlive = this.httpVersion === '1.0' ? false : true;","    }","","    return (this._keepAlive);","};","","","/**"," * Check if the incoming request is encrypted."," * @public"," * @function isSecure"," * @returns  {Boolean}"," */","Request.prototype.isSecure = function isSecure() {","    if (this._secure !== undefined) {","        return (this._secure);","    }","","    this._secure = this.connection.encrypted ? true : false;","    return (this._secure);","};","","","/**"," * Check if the incoming request has been upgraded."," * @public"," * @function isUpgradeRequest"," * @returns  {Boolean}"," */","Request.prototype.isUpgradeRequest = function isUpgradeRequest() {","    if (this._upgradeRequest !== undefined) {","        return (this._upgradeRequest);","    } else {","        return (false);","    }","};","","","/**"," * Check if the incoming request is an upload verb."," * @public"," * @function isUpload"," * @returns  {Boolean}"," */","Request.prototype.isUpload = function isUpload() {","    var m = this.method;","    return (m === 'PATCH' || m === 'POST' || m === 'PUT');","};","","","/**"," * toString serialization"," * @public"," * @function toString"," * @returns  {String}"," */","Request.prototype.toString = function toString() {","    var headers = '';","    var self = this;","    var str;","","    Object.keys(this.headers).forEach(function (k) {","        headers += sprintf('%s: %s\\n', k, self.headers[k]);","    });","","    str = sprintf('%s %s HTTP/%s\\n%s',","        this.method,","        this.url,","        this.httpVersion,","        headers);","","    return (str);","};","","","/**"," * retrieves the user-agent header."," * @public"," * @function userAgent"," * @returns  {String}"," */","Request.prototype.userAgent = function userAgent() {","    return (this.headers['user-agent']);","};","","","/**"," * Start the timer for a request handler function. You must explicitly invoke"," * endHandlerTimer() after invoking this function. Otherwise timing information"," * will be inaccurate."," * @public"," * @function startHandlerTimer"," * @param    {String}    handlerName The name of the handler."," * @returns  {undefined}"," */","Request.prototype.startHandlerTimer = function startHandlerTimer(handlerName) {","    var self = this;","","    // For nested handlers, we prepend the top level handler func name","    var name = (self._currentHandler === handlerName ?","                handlerName : self._currentHandler + '-' + handlerName);","","    if (!self._timerMap) {","        self._timerMap = {};","    }","","    self._timerMap[name] = process.hrtime();","","    dtrace._rstfy_probes['handler-start'].fire(function () {","        return ([","            self.serverName,","            self._currentRoute, // set in server._run","            name,","            self._dtraceId","        ]);","    });","};","","","/**"," * Stop the timer for a request handler function."," * @public"," * @function endHandlerTimer"," * @param    {String}    handlerName The name of the handler."," * @returns  {undefined}"," */","Request.prototype.endHandlerTimer = function endHandlerTimer(handlerName) {","    var self = this;","","    // For nested handlers, we prepend the top level handler func name","    var name = (self._currentHandler === handlerName ?","                handlerName : self._currentHandler + '-' + handlerName);","","    if (!self.timers) {","        self.timers = [];","    }","","    self._timerMap[name] = process.hrtime(self._timerMap[name]);","    self.timers.push({","        name: name,","        time: self._timerMap[name]","    });","","    dtrace._rstfy_probes['handler-done'].fire(function () {","        return ([","            self.serverName,","            self._currentRoute, // set in server._run","            name,","            self._dtraceId","        ]);","    });","};",""],"l":{"5":1,"6":1,"7":1,"9":1,"10":1,"11":1,"12":1,"14":1,"19":1,"31":1,"32":0,"34":0,"35":0,"44":0,"59":1,"60":0,"62":0,"63":0,"64":0,"76":1,"77":0,"78":0,"81":0,"82":0,"84":0,"85":0,"87":0,"90":0,"92":0,"103":1,"104":0,"105":0,"108":0,"110":0,"112":0,"122":1,"123":0,"124":0,"129":0,"130":0,"133":0,"135":0,"136":0,"138":0,"141":0,"149":1,"158":1,"159":0,"160":0,"163":0,"164":0,"166":0,"168":0,"170":0,"171":0,"173":0,"178":0,"180":0,"182":1,"192":1,"193":0,"194":0,"197":0,"198":0,"208":1,"209":0,"211":1,"220":1,"221":0,"222":0,"225":0,"229":0,"231":1,"241":1,"242":0,"244":1,"253":1,"257":0,"259":1,"268":1,"269":0,"279":1,"280":0,"281":0,"282":0,"284":0,"294":1,"295":0,"296":0,"299":0,"304":0,"306":1,"308":1,"309":0,"310":0,"312":0,"325":1,"326":0,"328":0,"330":0,"331":0,"334":0,"347":1,"348":0,"349":0,"351":0,"352":0,"355":0,"367":1,"368":0,"370":0,"371":0,"373":0,"374":0,"377":0,"378":0,"381":0,"382":0,"383":0,"384":0,"385":0,"387":0,"390":0,"400":1,"401":0,"411":1,"412":0,"413":0,"416":0,"417":0,"419":0,"422":0,"432":1,"433":0,"434":0,"437":0,"438":0,"448":1,"449":0,"450":0,"452":0,"463":1,"464":0,"465":0,"475":1,"476":0,"477":0,"478":0,"480":0,"481":0,"484":0,"490":0,"500":1,"501":0,"514":1,"515":0,"518":0,"521":0,"522":0,"525":0,"527":0,"528":0,"545":1,"546":0,"549":0,"552":0,"553":0,"556":0,"557":0,"562":0,"563":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/response.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/response.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0,"21":0,"22":0,"23":0,"24":1,"25":0,"26":0,"27":0,"28":1,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":1,"59":0,"60":0,"61":1,"62":0,"63":1,"64":1,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":1,"82":0,"83":0,"84":0,"85":1,"86":0,"87":0,"88":0,"89":0,"90":1,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":1,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":1,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":1,"139":0,"140":0,"141":0,"142":1,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":1,"151":1,"152":1,"153":14,"154":14,"155":0,"156":0,"157":0,"158":0,"159":14,"160":1,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":0,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[1,0],"41":[0,14],"42":[14,14],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":14,"19":0},"fnMap":{"1":{"name":"cache","line":34,"loc":{"start":{"line":34,"column":27},"end":{"line":34,"column":57}}},"2":{"name":"noCache","line":55,"loc":{"start":{"line":55,"column":29},"end":{"line":55,"column":48}}},"3":{"name":"charSet","line":77,"loc":{"start":{"line":77,"column":29},"end":{"line":77,"column":52}}},"4":{"name":"format","line":96,"loc":{"start":{"line":96,"column":28},"end":{"line":96,"column":54}}},"5":{"name":"get","line":163,"loc":{"start":{"line":163,"column":25},"end":{"line":163,"column":44}}},"6":{"name":"getHeaders","line":176,"loc":{"start":{"line":176,"column":32},"end":{"line":176,"column":54}}},"7":{"name":"header","line":190,"loc":{"start":{"line":190,"column":28},"end":{"line":190,"column":57}}},"8":{"name":"json","line":234,"loc":{"start":{"line":234,"column":26},"end":{"line":234,"column":63}}},"9":{"name":"link","line":251,"loc":{"start":{"line":251,"column":26},"end":{"line":251,"column":48}}},"10":{"name":"send","line":270,"loc":{"start":{"line":270,"column":26},"end":{"line":270,"column":61}}},"11":{"name":"_cb","line":307,"loc":{"start":{"line":307,"column":4},"end":{"line":307,"column":29}}},"12":{"name":"(anonymous_12)","line":322,"loc":{"start":{"line":322,"column":37},"end":{"line":322,"column":50}}},"13":{"name":"set","line":357,"loc":{"start":{"line":357,"column":25},"end":{"line":357,"column":49}}},"14":{"name":"(anonymous_14)","line":365,"loc":{"start":{"line":365,"column":34},"end":{"line":365,"column":47}}},"15":{"name":"status","line":381,"loc":{"start":{"line":381,"column":28},"end":{"line":381,"column":50}}},"16":{"name":"toString","line":395,"loc":{"start":{"line":395,"column":30},"end":{"line":395,"column":50}}},"17":{"name":"(anonymous_17)","line":400,"loc":{"start":{"line":400,"column":33},"end":{"line":400,"column":46}}},"18":{"name":"restifyWriteHead","line":422,"loc":{"start":{"line":422,"column":31},"end":{"line":422,"column":59}}},"19":{"name":"redirect","line":449,"loc":{"start":{"line":449,"column":30},"end":{"line":449,"column":66}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":27}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":37}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":25}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":36}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":27}},"6":{"start":{"line":12,"column":0},"end":{"line":12,"column":38}},"7":{"start":{"line":13,"column":0},"end":{"line":13,"column":31}},"8":{"start":{"line":14,"column":0},"end":{"line":14,"column":33}},"9":{"start":{"line":18,"column":0},"end":{"line":18,"column":53}},"10":{"start":{"line":20,"column":0},"end":{"line":20,"column":35}},"11":{"start":{"line":34,"column":0},"end":{"line":46,"column":2}},"12":{"start":{"line":35,"column":4},"end":{"line":38,"column":5}},"13":{"start":{"line":36,"column":8},"end":{"line":36,"column":23}},"14":{"start":{"line":37,"column":8},"end":{"line":37,"column":24}},"15":{"start":{"line":40,"column":4},"end":{"line":43,"column":5}},"16":{"start":{"line":41,"column":8},"end":{"line":41,"column":56}},"17":{"start":{"line":42,"column":8},"end":{"line":42,"column":46}},"18":{"start":{"line":45,"column":4},"end":{"line":45,"column":48}},"19":{"start":{"line":55,"column":0},"end":{"line":66,"column":2}},"20":{"start":{"line":57,"column":4},"end":{"line":57,"column":72}},"21":{"start":{"line":60,"column":4},"end":{"line":60,"column":38}},"22":{"start":{"line":63,"column":4},"end":{"line":63,"column":32}},"23":{"start":{"line":65,"column":4},"end":{"line":65,"column":18}},"24":{"start":{"line":77,"column":0},"end":{"line":83,"column":2}},"25":{"start":{"line":78,"column":4},"end":{"line":78,"column":35}},"26":{"start":{"line":80,"column":4},"end":{"line":80,"column":25}},"27":{"start":{"line":82,"column":4},"end":{"line":82,"column":18}},"28":{"start":{"line":96,"column":0},"end":{"line":153,"column":2}},"29":{"start":{"line":97,"column":4},"end":{"line":97,"column":23}},"30":{"start":{"line":98,"column":4},"end":{"line":98,"column":18}},"31":{"start":{"line":99,"column":4},"end":{"line":99,"column":66}},"32":{"start":{"line":100,"column":4},"end":{"line":100,"column":20}},"33":{"start":{"line":102,"column":4},"end":{"line":119,"column":5}},"34":{"start":{"line":103,"column":8},"end":{"line":105,"column":9}},"35":{"start":{"line":104,"column":12},"end":{"line":104,"column":53}},"36":{"start":{"line":107,"column":8},"end":{"line":116,"column":9}},"37":{"start":{"line":111,"column":12},"end":{"line":113,"column":13}},"38":{"start":{"line":112,"column":16},"end":{"line":112,"column":38}},"39":{"start":{"line":115,"column":12},"end":{"line":115,"column":28}},"40":{"start":{"line":117,"column":11},"end":{"line":119,"column":5}},"41":{"start":{"line":118,"column":8},"end":{"line":118,"column":34}},"42":{"start":{"line":121,"column":4},"end":{"line":141,"column":5}},"43":{"start":{"line":122,"column":8},"end":{"line":124,"column":9}},"44":{"start":{"line":123,"column":12},"end":{"line":123,"column":37}},"45":{"start":{"line":126,"column":8},"end":{"line":128,"column":9}},"46":{"start":{"line":127,"column":12},"end":{"line":127,"column":46}},"47":{"start":{"line":130,"column":8},"end":{"line":130,"column":68}},"48":{"start":{"line":134,"column":8},"end":{"line":140,"column":9}},"49":{"start":{"line":135,"column":12},"end":{"line":137,"column":53}},"50":{"start":{"line":138,"column":12},"end":{"line":138,"column":34}},"51":{"start":{"line":139,"column":12},"end":{"line":139,"column":28}},"52":{"start":{"line":143,"column":4},"end":{"line":145,"column":5}},"53":{"start":{"line":144,"column":8},"end":{"line":144,"column":51}},"54":{"start":{"line":147,"column":4},"end":{"line":147,"column":41}},"55":{"start":{"line":149,"column":4},"end":{"line":151,"column":5}},"56":{"start":{"line":150,"column":8},"end":{"line":150,"column":42}},"57":{"start":{"line":152,"column":4},"end":{"line":152,"column":60}},"58":{"start":{"line":163,"column":0},"end":{"line":167,"column":2}},"59":{"start":{"line":164,"column":4},"end":{"line":164,"column":32}},"60":{"start":{"line":166,"column":4},"end":{"line":166,"column":34}},"61":{"start":{"line":176,"column":0},"end":{"line":178,"column":2}},"62":{"start":{"line":177,"column":4},"end":{"line":177,"column":33}},"63":{"start":{"line":179,"column":0},"end":{"line":179,"column":59}},"64":{"start":{"line":190,"column":0},"end":{"line":220,"column":2}},"65":{"start":{"line":191,"column":4},"end":{"line":191,"column":32}},"66":{"start":{"line":193,"column":4},"end":{"line":195,"column":5}},"67":{"start":{"line":194,"column":8},"end":{"line":194,"column":38}},"68":{"start":{"line":197,"column":4},"end":{"line":203,"column":5}},"69":{"start":{"line":198,"column":8},"end":{"line":198,"column":32}},"70":{"start":{"line":199,"column":11},"end":{"line":203,"column":5}},"71":{"start":{"line":201,"column":8},"end":{"line":201,"column":65}},"72":{"start":{"line":202,"column":8},"end":{"line":202,"column":36}},"73":{"start":{"line":205,"column":4},"end":{"line":205,"column":39}},"74":{"start":{"line":209,"column":4},"end":{"line":216,"column":5}},"75":{"start":{"line":210,"column":8},"end":{"line":215,"column":9}},"76":{"start":{"line":211,"column":12},"end":{"line":211,"column":32}},"77":{"start":{"line":212,"column":12},"end":{"line":212,"column":28}},"78":{"start":{"line":214,"column":12},"end":{"line":214,"column":37}},"79":{"start":{"line":218,"column":4},"end":{"line":218,"column":32}},"80":{"start":{"line":219,"column":4},"end":{"line":219,"column":19}},"81":{"start":{"line":234,"column":0},"end":{"line":240,"column":2}},"82":{"start":{"line":235,"column":4},"end":{"line":237,"column":5}},"83":{"start":{"line":236,"column":8},"end":{"line":236,"column":56}},"84":{"start":{"line":239,"column":4},"end":{"line":239,"column":46}},"85":{"start":{"line":251,"column":0},"end":{"line":257,"column":2}},"86":{"start":{"line":252,"column":4},"end":{"line":252,"column":29}},"87":{"start":{"line":253,"column":4},"end":{"line":253,"column":30}},"88":{"start":{"line":255,"column":4},"end":{"line":255,"column":50}},"89":{"start":{"line":256,"column":4},"end":{"line":256,"column":40}},"90":{"start":{"line":270,"column":0},"end":{"line":346,"column":2}},"91":{"start":{"line":271,"column":4},"end":{"line":271,"column":46}},"92":{"start":{"line":272,"column":4},"end":{"line":272,"column":23}},"93":{"start":{"line":273,"column":4},"end":{"line":273,"column":20}},"94":{"start":{"line":275,"column":4},"end":{"line":287,"column":5}},"95":{"start":{"line":276,"column":8},"end":{"line":276,"column":30}},"96":{"start":{"line":277,"column":11},"end":{"line":287,"column":5}},"97":{"start":{"line":278,"column":8},"end":{"line":278,"column":31}},"98":{"start":{"line":280,"column":8},"end":{"line":282,"column":9}},"99":{"start":{"line":281,"column":12},"end":{"line":281,"column":46}},"100":{"start":{"line":284,"column":8},"end":{"line":284,"column":23}},"101":{"start":{"line":285,"column":8},"end":{"line":285,"column":20}},"102":{"start":{"line":286,"column":8},"end":{"line":286,"column":20}},"103":{"start":{"line":289,"column":4},"end":{"line":289,"column":28}},"104":{"start":{"line":291,"column":4},"end":{"line":303,"column":5}},"105":{"start":{"line":292,"column":8},"end":{"line":295,"column":10}},"106":{"start":{"line":297,"column":8},"end":{"line":301,"column":9}},"107":{"start":{"line":298,"column":12},"end":{"line":298,"column":30}},"108":{"start":{"line":300,"column":12},"end":{"line":300,"column":31}},"109":{"start":{"line":302,"column":8},"end":{"line":302,"column":52}},"110":{"start":{"line":305,"column":4},"end":{"line":305,"column":22}},"111":{"start":{"line":307,"column":4},"end":{"line":337,"column":5}},"112":{"start":{"line":315,"column":8},"end":{"line":321,"column":9}},"113":{"start":{"line":316,"column":12},"end":{"line":316,"column":30}},"114":{"start":{"line":317,"column":12},"end":{"line":317,"column":34}},"115":{"start":{"line":318,"column":12},"end":{"line":318,"column":56}},"116":{"start":{"line":320,"column":12},"end":{"line":320,"column":31}},"117":{"start":{"line":322,"column":8},"end":{"line":324,"column":11}},"118":{"start":{"line":323,"column":12},"end":{"line":323,"column":42}},"119":{"start":{"line":326,"column":8},"end":{"line":326,"column":40}},"120":{"start":{"line":328,"column":8},"end":{"line":330,"column":9}},"121":{"start":{"line":329,"column":12},"end":{"line":329,"column":35}},"122":{"start":{"line":332,"column":8},"end":{"line":332,"column":19}},"123":{"start":{"line":334,"column":8},"end":{"line":336,"column":9}},"124":{"start":{"line":335,"column":12},"end":{"line":335,"column":52}},"125":{"start":{"line":339,"column":4},"end":{"line":343,"column":5}},"126":{"start":{"line":340,"column":8},"end":{"line":340,"column":31}},"127":{"start":{"line":342,"column":8},"end":{"line":342,"column":24}},"128":{"start":{"line":345,"column":4},"end":{"line":345,"column":18}},"129":{"start":{"line":357,"column":0},"end":{"line":371,"column":2}},"130":{"start":{"line":358,"column":4},"end":{"line":358,"column":20}},"131":{"start":{"line":360,"column":4},"end":{"line":368,"column":5}},"132":{"start":{"line":361,"column":8},"end":{"line":361,"column":36}},"133":{"start":{"line":362,"column":8},"end":{"line":362,"column":31}},"134":{"start":{"line":364,"column":8},"end":{"line":364,"column":38}},"135":{"start":{"line":365,"column":8},"end":{"line":367,"column":11}},"136":{"start":{"line":366,"column":12},"end":{"line":366,"column":36}},"137":{"start":{"line":370,"column":4},"end":{"line":370,"column":18}},"138":{"start":{"line":381,"column":0},"end":{"line":386,"column":2}},"139":{"start":{"line":382,"column":4},"end":{"line":382,"column":32}},"140":{"start":{"line":384,"column":4},"end":{"line":384,"column":27}},"141":{"start":{"line":385,"column":4},"end":{"line":385,"column":18}},"142":{"start":{"line":395,"column":0},"end":{"line":409,"column":2}},"143":{"start":{"line":396,"column":4},"end":{"line":396,"column":36}},"144":{"start":{"line":397,"column":4},"end":{"line":397,"column":26}},"145":{"start":{"line":398,"column":4},"end":{"line":398,"column":12}},"146":{"start":{"line":400,"column":4},"end":{"line":402,"column":7}},"147":{"start":{"line":401,"column":8},"end":{"line":401,"column":53}},"148":{"start":{"line":403,"column":4},"end":{"line":406,"column":22}},"149":{"start":{"line":408,"column":4},"end":{"line":408,"column":17}},"150":{"start":{"line":411,"column":0},"end":{"line":413,"column":1}},"151":{"start":{"line":412,"column":4},"end":{"line":412,"column":65}},"152":{"start":{"line":422,"column":0},"end":{"line":433,"column":2}},"153":{"start":{"line":423,"column":4},"end":{"line":423,"column":24}},"154":{"start":{"line":425,"column":4},"end":{"line":430,"column":5}},"155":{"start":{"line":426,"column":8},"end":{"line":426,"column":44}},"156":{"start":{"line":427,"column":8},"end":{"line":427,"column":41}},"157":{"start":{"line":428,"column":8},"end":{"line":428,"column":42}},"158":{"start":{"line":429,"column":8},"end":{"line":429,"column":46}},"159":{"start":{"line":432,"column":4},"end":{"line":432,"column":43}},"160":{"start":{"line":449,"column":0},"end":{"line":549,"column":2}},"161":{"start":{"line":451,"column":4},"end":{"line":451,"column":20}},"162":{"start":{"line":452,"column":4},"end":{"line":452,"column":25}},"163":{"start":{"line":453,"column":4},"end":{"line":453,"column":17}},"164":{"start":{"line":454,"column":4},"end":{"line":454,"column":13}},"165":{"start":{"line":460,"column":4},"end":{"line":529,"column":5}},"166":{"start":{"line":461,"column":8},"end":{"line":461,"column":26}},"167":{"start":{"line":462,"column":8},"end":{"line":462,"column":24}},"168":{"start":{"line":463,"column":8},"end":{"line":463,"column":20}},"169":{"start":{"line":467,"column":9},"end":{"line":529,"column":5}},"170":{"start":{"line":469,"column":8},"end":{"line":469,"column":24}},"171":{"start":{"line":470,"column":8},"end":{"line":470,"column":20}},"172":{"start":{"line":474,"column":9},"end":{"line":529,"column":5}},"173":{"start":{"line":477,"column":8},"end":{"line":477,"column":20}},"174":{"start":{"line":479,"column":8},"end":{"line":479,"column":27}},"175":{"start":{"line":480,"column":8},"end":{"line":480,"column":29}},"176":{"start":{"line":481,"column":8},"end":{"line":481,"column":41}},"177":{"start":{"line":482,"column":8},"end":{"line":484,"column":39}},"178":{"start":{"line":488,"column":8},"end":{"line":488,"column":73}},"179":{"start":{"line":495,"column":8},"end":{"line":500,"column":10}},"180":{"start":{"line":504,"column":8},"end":{"line":504,"column":65}},"181":{"start":{"line":507,"column":8},"end":{"line":509,"column":9}},"182":{"start":{"line":508,"column":12},"end":{"line":508,"column":45}},"183":{"start":{"line":512,"column":8},"end":{"line":514,"column":9}},"184":{"start":{"line":513,"column":12},"end":{"line":513,"column":45}},"185":{"start":{"line":517,"column":8},"end":{"line":523,"column":9}},"186":{"start":{"line":518,"column":12},"end":{"line":522,"column":13}},"187":{"start":{"line":519,"column":16},"end":{"line":519,"column":43}},"188":{"start":{"line":521,"column":16},"end":{"line":521,"column":74}},"189":{"start":{"line":526,"column":8},"end":{"line":528,"column":9}},"190":{"start":{"line":527,"column":12},"end":{"line":527,"column":29}},"191":{"start":{"line":534,"column":4},"end":{"line":534,"column":62}},"192":{"start":{"line":538,"column":4},"end":{"line":540,"column":5}},"193":{"start":{"line":539,"column":8},"end":{"line":539,"column":74}},"194":{"start":{"line":543,"column":4},"end":{"line":545,"column":7}},"195":{"start":{"line":548,"column":4},"end":{"line":548,"column":25}}},"branchMap":{"1":{"line":35,"type":"if","locations":[{"start":{"line":35,"column":4},"end":{"line":35,"column":4}},{"start":{"line":35,"column":4},"end":{"line":35,"column":4}}]},"2":{"line":40,"type":"if","locations":[{"start":{"line":40,"column":4},"end":{"line":40,"column":4}},{"start":{"line":40,"column":4},"end":{"line":40,"column":4}}]},"3":{"line":40,"type":"binary-expr","locations":[{"start":{"line":40,"column":8},"end":{"line":40,"column":15}},{"start":{"line":40,"column":19},"end":{"line":40,"column":47}}]},"4":{"line":99,"type":"binary-expr","locations":[{"start":{"line":99,"column":15},"end":{"line":99,"column":31}},{"start":{"line":99,"column":35},"end":{"line":99,"column":65}}]},"5":{"line":102,"type":"if","locations":[{"start":{"line":102,"column":4},"end":{"line":102,"column":4}},{"start":{"line":102,"column":4},"end":{"line":102,"column":4}}]},"6":{"line":103,"type":"if","locations":[{"start":{"line":103,"column":8},"end":{"line":103,"column":8}},{"start":{"line":103,"column":8},"end":{"line":103,"column":8}}]},"7":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":8},"end":{"line":107,"column":8}},{"start":{"line":107,"column":8},"end":{"line":107,"column":8}}]},"8":{"line":111,"type":"if","locations":[{"start":{"line":111,"column":12},"end":{"line":111,"column":12}},{"start":{"line":111,"column":12},"end":{"line":111,"column":12}}]},"9":{"line":111,"type":"binary-expr","locations":[{"start":{"line":111,"column":16},"end":{"line":111,"column":38}},{"start":{"line":111,"column":42},"end":{"line":111,"column":63}}]},"10":{"line":117,"type":"if","locations":[{"start":{"line":117,"column":11},"end":{"line":117,"column":11}},{"start":{"line":117,"column":11},"end":{"line":117,"column":11}}]},"11":{"line":121,"type":"if","locations":[{"start":{"line":121,"column":4},"end":{"line":121,"column":4}},{"start":{"line":121,"column":4},"end":{"line":121,"column":4}}]},"12":{"line":122,"type":"if","locations":[{"start":{"line":122,"column":8},"end":{"line":122,"column":8}},{"start":{"line":122,"column":8},"end":{"line":122,"column":8}}]},"13":{"line":126,"type":"if","locations":[{"start":{"line":126,"column":8},"end":{"line":126,"column":8}},{"start":{"line":126,"column":8},"end":{"line":126,"column":8}}]},"14":{"line":130,"type":"binary-expr","locations":[{"start":{"line":130,"column":20},"end":{"line":130,"column":41}},{"start":{"line":130,"column":45},"end":{"line":130,"column":67}}]},"15":{"line":134,"type":"if","locations":[{"start":{"line":134,"column":8},"end":{"line":134,"column":8}},{"start":{"line":134,"column":8},"end":{"line":134,"column":8}}]},"16":{"line":143,"type":"if","locations":[{"start":{"line":143,"column":4},"end":{"line":143,"column":4}},{"start":{"line":143,"column":4},"end":{"line":143,"column":4}}]},"17":{"line":149,"type":"if","locations":[{"start":{"line":149,"column":4},"end":{"line":149,"column":4}},{"start":{"line":149,"column":4},"end":{"line":149,"column":4}}]},"18":{"line":149,"type":"binary-expr","locations":[{"start":{"line":149,"column":8},"end":{"line":149,"column":29}},{"start":{"line":149,"column":33},"end":{"line":149,"column":62}}]},"19":{"line":177,"type":"binary-expr","locations":[{"start":{"line":177,"column":12},"end":{"line":177,"column":25}},{"start":{"line":177,"column":29},"end":{"line":177,"column":31}}]},"20":{"line":193,"type":"if","locations":[{"start":{"line":193,"column":4},"end":{"line":193,"column":4}},{"start":{"line":193,"column":4},"end":{"line":193,"column":4}}]},"21":{"line":197,"type":"if","locations":[{"start":{"line":197,"column":4},"end":{"line":197,"column":4}},{"start":{"line":197,"column":4},"end":{"line":197,"column":4}}]},"22":{"line":199,"type":"if","locations":[{"start":{"line":199,"column":11},"end":{"line":199,"column":11}},{"start":{"line":199,"column":11},"end":{"line":199,"column":11}}]},"23":{"line":209,"type":"if","locations":[{"start":{"line":209,"column":4},"end":{"line":209,"column":4}},{"start":{"line":209,"column":4},"end":{"line":209,"column":4}}]},"24":{"line":209,"type":"binary-expr","locations":[{"start":{"line":209,"column":8},"end":{"line":209,"column":15}},{"start":{"line":209,"column":19},"end":{"line":209,"column":54}}]},"25":{"line":210,"type":"if","locations":[{"start":{"line":210,"column":8},"end":{"line":210,"column":8}},{"start":{"line":210,"column":8},"end":{"line":210,"column":8}}]},"26":{"line":235,"type":"if","locations":[{"start":{"line":235,"column":4},"end":{"line":235,"column":4}},{"start":{"line":235,"column":4},"end":{"line":235,"column":4}}]},"27":{"line":275,"type":"if","locations":[{"start":{"line":275,"column":4},"end":{"line":275,"column":4}},{"start":{"line":275,"column":4},"end":{"line":275,"column":4}}]},"28":{"line":277,"type":"if","locations":[{"start":{"line":277,"column":11},"end":{"line":277,"column":11}},{"start":{"line":277,"column":11},"end":{"line":277,"column":11}}]},"29":{"line":280,"type":"if","locations":[{"start":{"line":280,"column":8},"end":{"line":280,"column":8}},{"start":{"line":280,"column":8},"end":{"line":280,"column":8}}]},"30":{"line":289,"type":"binary-expr","locations":[{"start":{"line":289,"column":14},"end":{"line":289,"column":21}},{"start":{"line":289,"column":25},"end":{"line":289,"column":27}}]},"31":{"line":291,"type":"if","locations":[{"start":{"line":291,"column":4},"end":{"line":291,"column":4}},{"start":{"line":291,"column":4},"end":{"line":291,"column":4}}]},"32":{"line":297,"type":"if","locations":[{"start":{"line":297,"column":8},"end":{"line":297,"column":8}},{"start":{"line":297,"column":8},"end":{"line":297,"column":8}}]},"33":{"line":315,"type":"if","locations":[{"start":{"line":315,"column":8},"end":{"line":315,"column":8}},{"start":{"line":315,"column":8},"end":{"line":315,"column":8}}]},"34":{"line":328,"type":"if","locations":[{"start":{"line":328,"column":8},"end":{"line":328,"column":8}},{"start":{"line":328,"column":8},"end":{"line":328,"column":8}}]},"35":{"line":328,"type":"binary-expr","locations":[{"start":{"line":328,"column":12},"end":{"line":328,"column":22}},{"start":{"line":328,"column":26},"end":{"line":328,"column":67}}]},"36":{"line":328,"type":"binary-expr","locations":[{"start":{"line":328,"column":28},"end":{"line":328,"column":34}},{"start":{"line":328,"column":38},"end":{"line":328,"column":50}},{"start":{"line":328,"column":54},"end":{"line":328,"column":66}}]},"37":{"line":334,"type":"if","locations":[{"start":{"line":334,"column":8},"end":{"line":334,"column":8}},{"start":{"line":334,"column":8},"end":{"line":334,"column":8}}]},"38":{"line":339,"type":"if","locations":[{"start":{"line":339,"column":4},"end":{"line":339,"column":4}},{"start":{"line":339,"column":4},"end":{"line":339,"column":4}}]},"39":{"line":360,"type":"if","locations":[{"start":{"line":360,"column":4},"end":{"line":360,"column":4}},{"start":{"line":360,"column":4},"end":{"line":360,"column":4}}]},"40":{"line":411,"type":"if","locations":[{"start":{"line":411,"column":0},"end":{"line":411,"column":0}},{"start":{"line":411,"column":0},"end":{"line":411,"column":0}}]},"41":{"line":425,"type":"if","locations":[{"start":{"line":425,"column":4},"end":{"line":425,"column":4}},{"start":{"line":425,"column":4},"end":{"line":425,"column":4}}]},"42":{"line":425,"type":"binary-expr","locations":[{"start":{"line":425,"column":8},"end":{"line":425,"column":31}},{"start":{"line":425,"column":35},"end":{"line":425,"column":58}}]},"43":{"line":460,"type":"if","locations":[{"start":{"line":460,"column":4},"end":{"line":460,"column":4}},{"start":{"line":460,"column":4},"end":{"line":460,"column":4}}]},"44":{"line":460,"type":"binary-expr","locations":[{"start":{"line":460,"column":8},"end":{"line":460,"column":12}},{"start":{"line":460,"column":16},"end":{"line":460,"column":28}}]},"45":{"line":467,"type":"if","locations":[{"start":{"line":467,"column":9},"end":{"line":467,"column":9}},{"start":{"line":467,"column":9},"end":{"line":467,"column":9}}]},"46":{"line":474,"type":"if","locations":[{"start":{"line":474,"column":9},"end":{"line":474,"column":9}},{"start":{"line":474,"column":9},"end":{"line":474,"column":9}}]},"47":{"line":480,"type":"binary-expr","locations":[{"start":{"line":480,"column":18},"end":{"line":480,"column":22}},{"start":{"line":480,"column":26},"end":{"line":480,"column":28}}]},"48":{"line":482,"type":"cond-expr","locations":[{"start":{"line":483,"column":24},"end":{"line":483,"column":34}},{"start":{"line":484,"column":24},"end":{"line":484,"column":38}}]},"49":{"line":488,"type":"binary-expr","locations":[{"start":{"line":488,"column":34},"end":{"line":488,"column":46}},{"start":{"line":488,"column":50},"end":{"line":488,"column":65}}]},"50":{"line":504,"type":"cond-expr","locations":[{"start":{"line":504,"column":48},"end":{"line":504,"column":55}},{"start":{"line":504,"column":58},"end":{"line":504,"column":64}}]},"51":{"line":507,"type":"if","locations":[{"start":{"line":507,"column":8},"end":{"line":507,"column":8}},{"start":{"line":507,"column":8},"end":{"line":507,"column":8}}]},"52":{"line":512,"type":"if","locations":[{"start":{"line":512,"column":8},"end":{"line":512,"column":8}},{"start":{"line":512,"column":8},"end":{"line":512,"column":8}}]},"53":{"line":517,"type":"if","locations":[{"start":{"line":517,"column":8},"end":{"line":517,"column":8}},{"start":{"line":517,"column":8},"end":{"line":517,"column":8}}]},"54":{"line":518,"type":"if","locations":[{"start":{"line":518,"column":12},"end":{"line":518,"column":12}},{"start":{"line":518,"column":12},"end":{"line":518,"column":12}}]},"55":{"line":526,"type":"if","locations":[{"start":{"line":526,"column":8},"end":{"line":526,"column":8}},{"start":{"line":526,"column":8},"end":{"line":526,"column":8}}]},"56":{"line":538,"type":"if","locations":[{"start":{"line":538,"column":4},"end":{"line":538,"column":4}},{"start":{"line":538,"column":4},"end":{"line":538,"column":4}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var http = require('http');","var sprintf = require('util').format;","var url = require('url');","","var assert = require('assert-plus');","var mime = require('mime');","","var httpDate = require('./http_date');","var utils = require('./utils');","var errors = require('./errors');","","///--- Globals","","var InternalServerError = errors.InternalServerError;","","var Response = http.ServerResponse;","","","///--- API","","/**"," * sets the cache-control header. `type` defaults to _public_,"," * and options currently only takes maxAge."," * @public"," * @function cache"," * @param    {String} type    value of the header"," * @param    {Object} options an options object"," * @returns  {String}         the value set to the header"," */","Response.prototype.cache = function cache(type, options) {","    if (typeof (type) !== 'string') {","        options = type;","        type = 'public';","    }","","    if (options && options.maxAge !== undefined) {","        assert.number(options.maxAge, 'options.maxAge');","        type += ', max-age=' + options.maxAge;","    }","","    return (this.header('Cache-Control', type));","};","","","/**"," * turns off all cache related headers."," * @public"," * @function noCache"," * @returns  {Object} self, the response object"," */","Response.prototype.noCache = function noCache() {","    // HTTP 1.1","    this.header('Cache-Control', 'no-cache, no-store, must-revalidate');","","    // HTTP 1.0","    this.header('Pragma', 'no-cache');","","    // Proxies","    this.header('Expires', '0');","","    return (this);","};","","","/**"," * Appends the provided character set to the response's Content-Type."," * e.g., res.charSet('utf-8');"," * @public"," * @function charSet"," * @param    {String} type char-set value"," * @returns  {Object} self, the response object"," */","Response.prototype.charSet = function charSet(type) {","    assert.string(type, 'charset');","","    this._charSet = type;","","    return (this);","};","","","/**"," * the response formatter. formats the response in preparation to send it off."," * callback only used in async formatters. restify does not ship with any"," * async formatters currently."," * @public"," * @function format"," * @param    {Object | String} body the response body to format"," * @param    {Function}        cb   callback function"," * @returns  {undefined}"," */","Response.prototype.format = function format(body, cb) {","    var log = this.log;","    var formatter;","    var type = this.contentType || this.getHeader('Content-Type');","    var self = this;","","    if (!type) {","        if (this.req.accepts(this.acceptable)) {","            type = this.req.accepts(this.acceptable);","        }","","        if (!type) {","            // The importance of a status code outside of the","            // 2xx range probably outweighs that of unable being to","            // format the response body","            if (this.statusCode >= 200 && this.statusCode < 300) {","                this.statusCode = 406;","            }","","            return cb(null);","        }","    } else if (type.indexOf(';') !== '-1') {","        type = type.split(';')[0];","    }","","    if (!(formatter = this.formatters[type])) {","        if (type.indexOf('/') === -1) {","            type = mime.lookup(type);","        }","","        if (this.acceptable.indexOf(type) === -1) {","            type = 'application/octet-stream';","        }","","        formatter = this.formatters[type] || this.formatters['*/*'];","","        // this is a catastrophic case - should always fall back on octet-stream","        // but if for some reason that's gone, return a 500.","        if (!formatter) {","            log.warn({","                req: self.req","            }, 'no formatter found. Returning 500.');","            this.statusCode = 500;","            return cb(null);","        }","    }","","    if (this._charSet) {","        type = type + '; charset=' + this._charSet;","    }","","    this.setHeader('Content-Type', type);","","    if (body instanceof Error && body.statusCode !== undefined) {","        this.statusCode = body.statusCode;","    }","    return (formatter.call(this, this.req, this, body, cb));","};","","","/**"," * retrieves a header off the response."," * @public"," * @function get"," * @param    {Object} name the header name"," * @returns  {String}"," */","Response.prototype.get = function get(name) {","    assert.string(name, 'name');","","    return (this.getHeader(name));","};","","","/**"," * retrieves all headers off the response."," * @public"," * @function getHeaders"," * @returns  {Object}"," */","Response.prototype.getHeaders = function getHeaders() {","    return (this._headers || {});","};","Response.prototype.headers = Response.prototype.getHeaders;","","","/**"," * sets headers on the response."," * @public"," * @function header"," * @param    {String} name  the name of the header"," * @param    {String} value the value of the header"," * @returns  {Object}"," */","Response.prototype.header = function header(name, value) {","    assert.string(name, 'name');","","    if (value === undefined) {","        return (this.getHeader(name));","    }","","    if (value instanceof Date) {","        value = httpDate(value);","    } else if (arguments.length > 2) {","        // Support res.header('foo', 'bar %s', 'baz');","        var arg = Array.prototype.slice.call(arguments).slice(2);","        value = sprintf(value, arg);","    }","","    var current = this.getHeader(name);","","    // #779, don't use comma separated values for set-cookie, see","    // http://tools.ietf.org/html/rfc6265#section-3","    if (current && name.toLowerCase() !== 'set-cookie') {","        if (Array.isArray(current)) {","            current.push(value);","            value = current;","        } else {","            value = [current, value];","        }","    }","","    this.setHeader(name, value);","    return (value);","};","","","/**"," * short hand method for:"," *     res.contentType = 'json';"," *     res.send({hello: 'world'});"," * @public"," * @function json"," * @param    {Number} code    http status code"," * @param    {Object} object  value to json.stringify"," * @param    {Object} headers headers to set on the response"," * @returns  {Object}"," */","Response.prototype.json = function json(code, object, headers) {","    if (!/application\\/json/.test(this.header('content-type'))) {","        this.header('Content-Type', 'application/json');","    }","","    return (this.send(code, object, headers));","};","","","/**"," * sets the link heaader."," * @public"," * @function link"," * @param    {String} l   the link key"," * @param    {String} rel the link value"," * @returns  {String}     the header value set to res"," */","Response.prototype.link = function link(l, rel) {","    assert.string(l, 'link');","    assert.string(rel, 'rel');","","    var _link = sprintf('<%s>; rel=\"%s\"', l, rel);","    return (this.header('Link', _link));","};","","","/**"," * sends the response object. convenience method that handles:"," *     writeHead(), write(), end()"," * @public"," * @function send"," * @param    {Number} code                      http status code"," * @param    {Object | Buffer | Error} body     the content to send"," * @param    {Object}                  headers  any add'l headers to set"," * @returns  {Object}                           self, the response object"," */","Response.prototype.send = function send(code, body, headers) {","    var isHead = (this.req.method === 'HEAD');","    var log = this.log;","    var self = this;","","    if (code === undefined) {","        this.statusCode = 200;","    } else if (code.constructor.name === 'Number') {","        this.statusCode = code;","","        if (body instanceof Error) {","            body.statusCode = this.statusCode;","        }","    } else {","        headers = body;","        body = code;","        code = null;","    }","","    headers = headers || {};","","    if (log.trace()) {","        var _props = {","            code: self.statusCode,","            headers: headers","        };","","        if (body instanceof Error) {","            _props.err = body;","        } else {","            _props.body = body;","        }","        log.trace(_props, 'response::send entered');","    }","","    this._body = body;","","    function _cb(err, _body) {","        // the problem here is that if the formatter throws an error, we can't","        // actually format the error again, since the formatter already failed.","        // So all we can do is send back a 500 with no body, since we don't","        // know at this point what format to send the error as. Additionally,","        // the current 'after' event is emitted _before_ we send the response,","        // so there's no way to re-emit the error here. TODO: clean up 'after'","        // even emitter so we pick up the error here.","        if (err) {","            self._data = null;","            self.statusCode = 500;","            log.error(err, 'unable to format response');","        } else {","            self._data = _body;","        }","        Object.keys(headers).forEach(function (k) {","            self.setHeader(k, headers[k]);","        });","","        self.writeHead(self.statusCode);","","        if (self._data && !(isHead || code === 204 || code === 304)) {","            self.write(self._data);","        }","","        self.end();","","        if (log.trace()) {","            log.trace({res: self}, 'response sent');","        }","    }","","    if (body !== undefined) {","        this.format(body, _cb);","    } else {","        _cb(null, null);","    }","","    return (this);","};","","","/**"," * sets a header on the response."," * @public"," * @function set"," * @param    {String} name name of the header"," * @param    {String} val  value of the header"," * @returns  {Object}      self, the response object"," */","Response.prototype.set = function set(name, val) {","    var self = this;","","    if (arguments.length === 2) {","        assert.string(name, 'name');","        this.header(name, val);","    } else {","        assert.object(name, 'object');","        Object.keys(name).forEach(function (k) {","            self.header(k, name[k]);","        });","    }","","    return (this);","};","","","/**"," * sets the http status code on the response."," * @public"," * @function status"," * @param    {Number} code http status code"," * @returns  {Number}     the status code passed in"," */","Response.prototype.status = function status(code) {","    assert.number(code, 'code');","","    this.statusCode = code;","    return (code);","};","","","/**"," * toString() serialization."," * @public"," * @function toString"," * @returns  {String}"," */","Response.prototype.toString = function toString() {","    var headers = this.getHeaders();","    var headerString = '';","    var str;","","    Object.keys(headers).forEach(function (k) {","        headerString += k + ': ' + headers[k] + '\\n';","    });","    str = sprintf('HTTP/1.1 %s %s\\n%s',","        this.statusCode,","        http.STATUS_CODES[this.statusCode],","        headerString);","","    return (str);","};","","if (!Response.prototype.hasOwnProperty('_writeHead')) {","    Response.prototype._writeHead = Response.prototype.writeHead;","}","","","/**"," * pass through to native response.writeHead()"," * @public"," * @function writeHead"," * @returns  {undefined}"," */","Response.prototype.writeHead = function restifyWriteHead() {","    this.emit('header');","","    if (this.statusCode === 204 || this.statusCode === 304) {","        this.removeHeader('Content-Length');","        this.removeHeader('Content-MD5');","        this.removeHeader('Content-Type');","        this.removeHeader('Content-Encoding');","    }","","    this._writeHead.apply(this, arguments);","};","","","/*"," * redirect is sugar method for redirecting. takes a few different signatures:"," * 1) res.redirect(301, 'www.foo.com', next);"," * 2) res.redirect('www.foo.com', next);"," * 3) res.redirect({...}, next);"," * `next` is mandatory, to complete the response and trigger audit logger."," * @public"," * @param    {Number | String}   arg1 the status code or url to direct to"," * @param    {String | Function} arg2 the url to redirect to, or `next` fn"," * @param    {Function}          arg3 `next` fn"," * @function redirect"," * @return   {undefined}"," */","Response.prototype.redirect = function redirect(arg1, arg2, arg3) {","","    var self = this;","    var statusCode = 302;","    var finalUri;","    var next;","","    // 1) this is signature 1, where an explicit status code is passed in.","    //    MUST guard against null here, passing null is likely indicative","    //    of an attempt to call res.redirect(null, next);","    //    as a way to do a reload of the current page.","    if (arg1 && !isNaN(arg1)) {","        statusCode = arg1;","        finalUri = arg2;","        next = arg3;","    }","","    // 2) this is signaure number 2","    else if (typeof (arg1) === 'string') {","        // otherwise, it's a string, and use it directly","        finalUri = arg1;","        next = arg2;","    }","","    // 3) signature number 3, using an options object.","    else if (typeof (arg1) === 'object') {","","        // set next, then go to work.","        next = arg2;","","        var req = self.req;","        var opt = arg1 || {};","        var currentFullPath = req.href();","        var secure = (opt.hasOwnProperty('secure')) ?","                        opt.secure :","                        req.isSecure();","","        // if hostname is passed in, use that as the base,","        // otherwise fall back on current url.","        var parsedUri = url.parse(opt.hostname || currentFullPath, true);","","        // create the object we'll use to format for the final uri.","        // this object will eventually get passed to url.format().","        // can't use parsedUri to seed it, as it confuses the url module","        // with some existing parsed state. instead, we'll pick the things","        // we want and use that as a starting point.","        finalUri = {","            port: parsedUri.port,","            hostname: parsedUri.hostname,","            query: parsedUri.query,","            pathname: parsedUri.pathname","        };","","        // start building url based on options.","        // first, set protocol.","        finalUri.protocol = (secure === true) ? 'https' : 'http';","","        // then set host","        if (opt.hostname) {","            finalUri.hostname = opt.hostname;","        }","","        // then set current path after the host","        if (opt.pathname) {","            finalUri.pathname = opt.pathname;","        }","","        // then add query params","        if (opt.query) {","            if (opt.overrideQuery === true) {","                finalUri.query = opt.query;","            } else {","                finalUri.query = utils.mergeQs(opt.query, finalUri.query);","            }","        }","","        // change status code to 301 permanent if specified","        if (opt.permanent) {","            statusCode = 301;","        }","    }","","    // if we're missing a next we should probably throw. if user wanted","    // to redirect but we were unable to do so, we should not continue","    // down the handler stack.","    assert.func(next, 'res.redirect() requires a next param');","","    // if we are missing a finalized uri","    // by this point, pass an error to next.","    if (!finalUri) {","        return (next(new InternalServerError('could not construct url')));","    }","","    // now we're done constructing url, send the res","    self.send(statusCode, null, {","        location: url.format(finalUri)","    });","","    // tell server to stop processing the handler stack.","    return (next(false));","};",""],"l":{"5":1,"6":1,"7":1,"9":1,"10":1,"12":1,"13":1,"14":1,"18":1,"20":1,"34":1,"35":0,"36":0,"37":0,"40":0,"41":0,"42":0,"45":0,"55":1,"57":0,"60":0,"63":0,"65":0,"77":1,"78":0,"80":0,"82":0,"96":1,"97":0,"98":0,"99":0,"100":0,"102":0,"103":0,"104":0,"107":0,"111":0,"112":0,"115":0,"117":0,"118":0,"121":0,"122":0,"123":0,"126":0,"127":0,"130":0,"134":0,"135":0,"138":0,"139":0,"143":0,"144":0,"147":0,"149":0,"150":0,"152":0,"163":1,"164":0,"166":0,"176":1,"177":0,"179":1,"190":1,"191":0,"193":0,"194":0,"197":0,"198":0,"199":0,"201":0,"202":0,"205":0,"209":0,"210":0,"211":0,"212":0,"214":0,"218":0,"219":0,"234":1,"235":0,"236":0,"239":0,"251":1,"252":0,"253":0,"255":0,"256":0,"270":1,"271":0,"272":0,"273":0,"275":0,"276":0,"277":0,"278":0,"280":0,"281":0,"284":0,"285":0,"286":0,"289":0,"291":0,"292":0,"297":0,"298":0,"300":0,"302":0,"305":0,"307":1,"315":0,"316":0,"317":0,"318":0,"320":0,"322":0,"323":0,"326":0,"328":0,"329":0,"332":0,"334":0,"335":0,"339":0,"340":0,"342":0,"345":0,"357":1,"358":0,"360":0,"361":0,"362":0,"364":0,"365":0,"366":0,"370":0,"381":1,"382":0,"384":0,"385":0,"395":1,"396":0,"397":0,"398":0,"400":0,"401":0,"403":0,"408":0,"411":1,"412":1,"422":1,"423":14,"425":14,"426":0,"427":0,"428":0,"429":0,"432":14,"449":1,"451":0,"452":0,"453":0,"454":0,"460":0,"461":0,"462":0,"463":0,"467":0,"469":0,"470":0,"474":0,"477":0,"479":0,"480":0,"481":0,"482":0,"488":0,"495":0,"504":0,"507":0,"508":0,"512":0,"513":0,"517":0,"518":0,"519":0,"521":0,"526":0,"527":0,"534":0,"538":0,"539":0,"543":0,"548":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/router.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/router.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":1,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1,"92":1,"93":1,"94":1,"95":0,"96":0,"97":0,"98":1,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":1,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":1,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":1,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":0,"166":0,"167":0,"168":0,"169":0,"170":0,"171":0,"172":1,"173":0,"174":0,"175":0,"176":0,"177":0,"178":0,"179":0,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":0,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":0,"216":0,"217":0,"218":0,"219":0,"220":0,"221":0,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":0,"235":0,"236":0,"237":0,"238":0,"239":0,"240":0,"241":0,"242":0,"243":1,"244":0,"245":0,"246":1,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0,"275":0,"276":0,"277":0,"278":1,"279":0,"280":0,"281":0,"282":0,"283":0,"284":0,"285":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0,0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},"fnMap":{"1":{"name":"matchURL","line":47,"loc":{"start":{"line":47,"column":0},"end":{"line":47,"column":27}}},"2":{"name":"(anonymous_2)","line":72,"loc":{"start":{"line":72,"column":29},"end":{"line":72,"column":42}}},"3":{"name":"compileURL","line":90,"loc":{"start":{"line":90,"column":0},"end":{"line":90,"column":29}}},"4":{"name":"(anonymous_4)","line":100,"loc":{"start":{"line":100,"column":28},"end":{"line":100,"column":44}}},"5":{"name":"Router","line":151,"loc":{"start":{"line":151,"column":0},"end":{"line":151,"column":25}}},"6":{"name":"(anonymous_6)","line":191,"loc":{"start":{"line":191,"column":26},"end":{"line":191,"column":39}}},"7":{"name":"render","line":214,"loc":{"start":{"line":214,"column":26},"end":{"line":214,"column":68}}},"8":{"name":"pathItem","line":215,"loc":{"start":{"line":215,"column":4},"end":{"line":215,"column":34}}},"9":{"name":"queryItem","line":224,"loc":{"start":{"line":224,"column":4},"end":{"line":224,"column":28}}},"10":{"name":"mount","line":250,"loc":{"start":{"line":250,"column":25},"end":{"line":250,"column":49}}},"11":{"name":"(anonymous_11)","line":267,"loc":{"start":{"line":267,"column":20},"end":{"line":267,"column":33}}},"12":{"name":"(anonymous_12)","line":279,"loc":{"start":{"line":279,"column":25},"end":{"line":279,"column":38}}},"13":{"name":"unmount","line":328,"loc":{"start":{"line":328,"column":27},"end":{"line":328,"column":50}}},"14":{"name":"(anonymous_14)","line":338,"loc":{"start":{"line":338,"column":46},"end":{"line":338,"column":59}}},"15":{"name":"(anonymous_15)","line":342,"loc":{"start":{"line":342,"column":53},"end":{"line":342,"column":66}}},"16":{"name":"get","line":365,"loc":{"start":{"line":365,"column":23},"end":{"line":365,"column":51}}},"17":{"name":"find","line":403,"loc":{"start":{"line":403,"column":24},"end":{"line":403,"column":58}}},"18":{"name":"(anonymous_18)","line":470,"loc":{"start":{"line":470,"column":43},"end":{"line":470,"column":56}}},"19":{"name":"(anonymous_19)","line":488,"loc":{"start":{"line":488,"column":31},"end":{"line":488,"column":44}}},"20":{"name":"inAllowedHeaders","line":543,"loc":{"start":{"line":543,"column":4},"end":{"line":543,"column":38}}},"21":{"name":"preflight","line":553,"loc":{"start":{"line":553,"column":4},"end":{"line":553,"column":32}}},"22":{"name":"toString","line":625,"loc":{"start":{"line":625,"column":28},"end":{"line":625,"column":48}}},"23":{"name":"(anonymous_23)","line":629,"loc":{"start":{"line":629,"column":37},"end":{"line":629,"column":50}}},"24":{"name":"(anonymous_24)","line":630,"loc":{"start":{"line":630,"column":40},"end":{"line":630,"column":53}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":50}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":25}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"4":{"start":{"line":9,"column":0},"end":{"line":9,"column":36}},"5":{"start":{"line":10,"column":0},"end":{"line":10,"column":31}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":39}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":31}},"8":{"start":{"line":14,"column":0},"end":{"line":14,"column":37}},"9":{"start":{"line":15,"column":0},"end":{"line":15,"column":33}},"10":{"start":{"line":16,"column":0},"end":{"line":16,"column":31}},"11":{"start":{"line":21,"column":0},"end":{"line":21,"column":40}},"12":{"start":{"line":23,"column":0},"end":{"line":23,"column":45}},"13":{"start":{"line":24,"column":0},"end":{"line":24,"column":41}},"14":{"start":{"line":25,"column":0},"end":{"line":25,"column":55}},"15":{"start":{"line":26,"column":0},"end":{"line":26,"column":53}},"16":{"start":{"line":27,"column":0},"end":{"line":27,"column":57}},"17":{"start":{"line":28,"column":0},"end":{"line":28,"column":57}},"18":{"start":{"line":29,"column":0},"end":{"line":29,"column":65}},"19":{"start":{"line":31,"column":0},"end":{"line":31,"column":36}},"20":{"start":{"line":47,"column":0},"end":{"line":79,"column":1}},"21":{"start":{"line":48,"column":4},"end":{"line":48,"column":14}},"22":{"start":{"line":49,"column":4},"end":{"line":49,"column":37}},"23":{"start":{"line":50,"column":4},"end":{"line":50,"column":20}},"24":{"start":{"line":52,"column":4},"end":{"line":54,"column":5}},"25":{"start":{"line":53,"column":8},"end":{"line":53,"column":23}},"26":{"start":{"line":58,"column":4},"end":{"line":64,"column":5}},"27":{"start":{"line":59,"column":8},"end":{"line":61,"column":9}},"28":{"start":{"line":60,"column":12},"end":{"line":60,"column":40}},"29":{"start":{"line":63,"column":8},"end":{"line":63,"column":24}},"30":{"start":{"line":67,"column":4},"end":{"line":69,"column":5}},"31":{"start":{"line":68,"column":8},"end":{"line":68,"column":24}},"32":{"start":{"line":72,"column":4},"end":{"line":76,"column":7}},"33":{"start":{"line":73,"column":8},"end":{"line":75,"column":9}},"34":{"start":{"line":74,"column":12},"end":{"line":74,"column":54}},"35":{"start":{"line":78,"column":4},"end":{"line":78,"column":20}},"36":{"start":{"line":90,"column":0},"end":{"line":139,"column":1}},"37":{"start":{"line":91,"column":4},"end":{"line":93,"column":5}},"38":{"start":{"line":92,"column":8},"end":{"line":92,"column":29}},"39":{"start":{"line":94,"column":4},"end":{"line":94,"column":38}},"40":{"start":{"line":96,"column":4},"end":{"line":96,"column":20}},"41":{"start":{"line":97,"column":4},"end":{"line":97,"column":22}},"42":{"start":{"line":98,"column":4},"end":{"line":98,"column":11}},"43":{"start":{"line":99,"column":4},"end":{"line":99,"column":47}},"44":{"start":{"line":100,"column":4},"end":{"line":128,"column":7}},"45":{"start":{"line":101,"column":8},"end":{"line":103,"column":9}},"46":{"start":{"line":102,"column":12},"end":{"line":102,"column":27}},"47":{"start":{"line":105,"column":8},"end":{"line":105,"column":26}},"48":{"start":{"line":107,"column":8},"end":{"line":126,"column":9}},"49":{"start":{"line":108,"column":12},"end":{"line":108,"column":29}},"50":{"start":{"line":109,"column":12},"end":{"line":109,"column":42}},"51":{"start":{"line":110,"column":12},"end":{"line":110,"column":23}},"52":{"start":{"line":112,"column":12},"end":{"line":121,"column":13}},"53":{"start":{"line":113,"column":16},"end":{"line":117,"column":17}},"54":{"start":{"line":114,"column":20},"end":{"line":114,"column":53}},"55":{"start":{"line":116,"column":20},"end":{"line":116,"column":37}},"56":{"start":{"line":119,"column":16},"end":{"line":119,"column":49}},"57":{"start":{"line":120,"column":16},"end":{"line":120,"column":68}},"58":{"start":{"line":122,"column":12},"end":{"line":122,"column":42}},"59":{"start":{"line":123,"column":12},"end":{"line":123,"column":40}},"60":{"start":{"line":125,"column":12},"end":{"line":125,"column":28}},"61":{"start":{"line":127,"column":8},"end":{"line":127,"column":22}},"62":{"start":{"line":130,"column":4},"end":{"line":132,"column":5}},"63":{"start":{"line":131,"column":8},"end":{"line":131,"column":25}},"64":{"start":{"line":133,"column":4},"end":{"line":133,"column":19}},"65":{"start":{"line":135,"column":4},"end":{"line":135,"column":44}},"66":{"start":{"line":136,"column":4},"end":{"line":136,"column":30}},"67":{"start":{"line":138,"column":4},"end":{"line":138,"column":16}},"68":{"start":{"line":151,"column":0},"end":{"line":200,"column":1}},"69":{"start":{"line":152,"column":4},"end":{"line":152,"column":38}},"70":{"start":{"line":153,"column":4},"end":{"line":153,"column":46}},"71":{"start":{"line":155,"column":4},"end":{"line":155,"column":28}},"72":{"start":{"line":157,"column":4},"end":{"line":157,"column":33}},"73":{"start":{"line":158,"column":4},"end":{"line":158,"column":49}},"74":{"start":{"line":160,"column":4},"end":{"line":162,"column":5}},"75":{"start":{"line":161,"column":8},"end":{"line":161,"column":46}},"76":{"start":{"line":163,"column":4},"end":{"line":163,"column":66}},"77":{"start":{"line":165,"column":4},"end":{"line":165,"column":27}},"78":{"start":{"line":166,"column":4},"end":{"line":166,"column":21}},"79":{"start":{"line":167,"column":4},"end":{"line":167,"column":32}},"80":{"start":{"line":170,"column":4},"end":{"line":178,"column":6}},"81":{"start":{"line":182,"column":4},"end":{"line":182,"column":22}},"82":{"start":{"line":184,"column":4},"end":{"line":184,"column":62}},"83":{"start":{"line":186,"column":4},"end":{"line":188,"column":5}},"84":{"start":{"line":187,"column":8},"end":{"line":187,"column":40}},"85":{"start":{"line":189,"column":4},"end":{"line":189,"column":60}},"86":{"start":{"line":191,"column":4},"end":{"line":197,"column":7}},"87":{"start":{"line":192,"column":8},"end":{"line":194,"column":9}},"88":{"start":{"line":193,"column":12},"end":{"line":193,"column":26}},"89":{"start":{"line":196,"column":8},"end":{"line":196,"column":70}},"90":{"start":{"line":198,"column":4},"end":{"line":198,"column":25}},"91":{"start":{"line":201,"column":0},"end":{"line":201,"column":36}},"92":{"start":{"line":203,"column":0},"end":{"line":203,"column":24}},"93":{"start":{"line":214,"column":0},"end":{"line":240,"column":2}},"94":{"start":{"line":215,"column":4},"end":{"line":222,"column":5}},"95":{"start":{"line":216,"column":8},"end":{"line":220,"column":9}},"96":{"start":{"line":217,"column":12},"end":{"line":219,"column":39}},"97":{"start":{"line":221,"column":8},"end":{"line":221,"column":55}},"98":{"start":{"line":224,"column":4},"end":{"line":226,"column":5}},"99":{"start":{"line":225,"column":8},"end":{"line":225,"column":80}},"100":{"start":{"line":228,"column":4},"end":{"line":228,"column":62}},"101":{"start":{"line":229,"column":4},"end":{"line":229,"column":38}},"102":{"start":{"line":231,"column":4},"end":{"line":233,"column":5}},"103":{"start":{"line":232,"column":8},"end":{"line":232,"column":22}},"104":{"start":{"line":235,"column":4},"end":{"line":235,"column":32}},"105":{"start":{"line":236,"column":4},"end":{"line":236,"column":76}},"106":{"start":{"line":237,"column":4},"end":{"line":237,"column":56}},"107":{"start":{"line":238,"column":4},"end":{"line":238,"column":70}},"108":{"start":{"line":239,"column":4},"end":{"line":239,"column":32}},"109":{"start":{"line":250,"column":0},"end":{"line":318,"column":2}},"110":{"start":{"line":251,"column":4},"end":{"line":251,"column":38}},"111":{"start":{"line":252,"column":4},"end":{"line":252,"column":52}},"112":{"start":{"line":253,"column":4},"end":{"line":253,"column":48}},"113":{"start":{"line":255,"column":4},"end":{"line":255,"column":15}},"114":{"start":{"line":256,"column":4},"end":{"line":256,"column":28}},"115":{"start":{"line":257,"column":4},"end":{"line":257,"column":14}},"116":{"start":{"line":258,"column":4},"end":{"line":258,"column":45}},"117":{"start":{"line":259,"column":4},"end":{"line":259,"column":20}},"118":{"start":{"line":260,"column":4},"end":{"line":260,"column":55}},"119":{"start":{"line":261,"column":4},"end":{"line":261,"column":72}},"120":{"start":{"line":263,"column":4},"end":{"line":270,"column":5}},"121":{"start":{"line":264,"column":8},"end":{"line":266,"column":9}},"122":{"start":{"line":265,"column":12},"end":{"line":265,"column":26}},"123":{"start":{"line":267,"column":8},"end":{"line":269,"column":25}},"124":{"start":{"line":268,"column":12},"end":{"line":268,"column":23}},"125":{"start":{"line":272,"column":4},"end":{"line":277,"column":5}},"126":{"start":{"line":273,"column":8},"end":{"line":275,"column":9}},"127":{"start":{"line":274,"column":12},"end":{"line":274,"column":34}},"128":{"start":{"line":276,"column":8},"end":{"line":276,"column":24}},"129":{"start":{"line":279,"column":4},"end":{"line":281,"column":7}},"130":{"start":{"line":280,"column":8},"end":{"line":280,"column":33}},"131":{"start":{"line":283,"column":4},"end":{"line":285,"column":5}},"132":{"start":{"line":284,"column":8},"end":{"line":284,"column":23}},"133":{"start":{"line":287,"column":4},"end":{"line":298,"column":6}},"134":{"start":{"line":299,"column":4},"end":{"line":299,"column":23}},"135":{"start":{"line":301,"column":4},"end":{"line":303,"column":5}},"136":{"start":{"line":302,"column":8},"end":{"line":302,"column":45}},"137":{"start":{"line":305,"column":4},"end":{"line":307,"column":5}},"138":{"start":{"line":306,"column":8},"end":{"line":306,"column":59}},"139":{"start":{"line":309,"column":4},"end":{"line":309,"column":36}},"140":{"start":{"line":311,"column":4},"end":{"line":315,"column":24}},"141":{"start":{"line":317,"column":4},"end":{"line":317,"column":24}},"142":{"start":{"line":328,"column":0},"end":{"line":353,"column":2}},"143":{"start":{"line":329,"column":4},"end":{"line":329,"column":34}},"144":{"start":{"line":331,"column":4},"end":{"line":334,"column":5}},"145":{"start":{"line":332,"column":8},"end":{"line":332,"column":72}},"146":{"start":{"line":333,"column":8},"end":{"line":333,"column":23}},"147":{"start":{"line":336,"column":4},"end":{"line":336,"column":50}},"148":{"start":{"line":337,"column":4},"end":{"line":337,"column":43}},"149":{"start":{"line":338,"column":4},"end":{"line":340,"column":7}},"150":{"start":{"line":339,"column":8},"end":{"line":339,"column":39}},"151":{"start":{"line":342,"column":4},"end":{"line":344,"column":7}},"152":{"start":{"line":343,"column":8},"end":{"line":343,"column":36}},"153":{"start":{"line":346,"column":4},"end":{"line":348,"column":5}},"154":{"start":{"line":347,"column":8},"end":{"line":347,"column":47}},"155":{"start":{"line":350,"column":4},"end":{"line":350,"column":29}},"156":{"start":{"line":352,"column":4},"end":{"line":352,"column":18}},"157":{"start":{"line":365,"column":0},"end":{"line":391,"column":2}},"158":{"start":{"line":366,"column":4},"end":{"line":366,"column":15}},"159":{"start":{"line":367,"column":4},"end":{"line":367,"column":22}},"160":{"start":{"line":368,"column":4},"end":{"line":368,"column":47}},"161":{"start":{"line":370,"column":4},"end":{"line":370,"column":58}},"162":{"start":{"line":372,"column":4},"end":{"line":384,"column":5}},"163":{"start":{"line":373,"column":8},"end":{"line":383,"column":9}},"164":{"start":{"line":374,"column":12},"end":{"line":374,"column":30}},"165":{"start":{"line":376,"column":12},"end":{"line":381,"column":13}},"166":{"start":{"line":377,"column":16},"end":{"line":377,"column":51}},"167":{"start":{"line":380,"column":16},"end":{"line":380,"column":31}},"168":{"start":{"line":382,"column":12},"end":{"line":382,"column":18}},"169":{"start":{"line":386,"column":4},"end":{"line":390,"column":5}},"170":{"start":{"line":387,"column":8},"end":{"line":387,"column":38}},"171":{"start":{"line":389,"column":8},"end":{"line":389,"column":32}},"172":{"start":{"line":403,"column":0},"end":{"line":616,"column":2}},"173":{"start":{"line":404,"column":4},"end":{"line":404,"column":24}},"174":{"start":{"line":405,"column":4},"end":{"line":405,"column":51}},"175":{"start":{"line":406,"column":4},"end":{"line":406,"column":61}},"176":{"start":{"line":407,"column":4},"end":{"line":407,"column":17}},"177":{"start":{"line":408,"column":4},"end":{"line":408,"column":12}},"178":{"start":{"line":409,"column":4},"end":{"line":409,"column":15}},"179":{"start":{"line":410,"column":4},"end":{"line":410,"column":10}},"180":{"start":{"line":411,"column":4},"end":{"line":411,"column":16}},"181":{"start":{"line":412,"column":4},"end":{"line":412,"column":47}},"182":{"start":{"line":413,"column":4},"end":{"line":413,"column":14}},"183":{"start":{"line":414,"column":4},"end":{"line":414,"column":18}},"184":{"start":{"line":415,"column":4},"end":{"line":415,"column":13}},"185":{"start":{"line":417,"column":4},"end":{"line":422,"column":5}},"186":{"start":{"line":418,"column":8},"end":{"line":418,"column":47}},"187":{"start":{"line":419,"column":8},"end":{"line":419,"column":54}},"188":{"start":{"line":420,"column":8},"end":{"line":420,"column":63}},"189":{"start":{"line":421,"column":8},"end":{"line":421,"column":15}},"190":{"start":{"line":424,"column":4},"end":{"line":464,"column":5}},"191":{"start":{"line":425,"column":8},"end":{"line":431,"column":9}},"192":{"start":{"line":426,"column":12},"end":{"line":426,"column":51}},"193":{"start":{"line":428,"column":12},"end":{"line":428,"column":58}},"194":{"start":{"line":429,"column":12},"end":{"line":429,"column":53}},"195":{"start":{"line":430,"column":12},"end":{"line":430,"column":19}},"196":{"start":{"line":433,"column":8},"end":{"line":435,"column":9}},"197":{"start":{"line":434,"column":12},"end":{"line":434,"column":21}},"198":{"start":{"line":437,"column":8},"end":{"line":437,"column":54}},"199":{"start":{"line":439,"column":8},"end":{"line":446,"column":9}},"200":{"start":{"line":440,"column":12},"end":{"line":443,"column":15}},"201":{"start":{"line":444,"column":12},"end":{"line":444,"column":25}},"202":{"start":{"line":445,"column":12},"end":{"line":445,"column":21}},"203":{"start":{"line":452,"column":8},"end":{"line":455,"column":9}},"204":{"start":{"line":453,"column":12},"end":{"line":453,"column":26}},"205":{"start":{"line":454,"column":12},"end":{"line":454,"column":18}},"206":{"start":{"line":457,"column":8},"end":{"line":463,"column":9}},"207":{"start":{"line":458,"column":12},"end":{"line":461,"column":15}},"208":{"start":{"line":462,"column":12},"end":{"line":462,"column":29}},"209":{"start":{"line":466,"column":4},"end":{"line":501,"column":5}},"210":{"start":{"line":468,"column":8},"end":{"line":485,"column":9}},"211":{"start":{"line":469,"column":12},"end":{"line":469,"column":41}},"212":{"start":{"line":470,"column":12},"end":{"line":478,"column":15}},"213":{"start":{"line":471,"column":16},"end":{"line":475,"column":19}},"214":{"start":{"line":476,"column":16},"end":{"line":476,"column":53}},"215":{"start":{"line":477,"column":16},"end":{"line":477,"column":43}},"216":{"start":{"line":481,"column":12},"end":{"line":484,"column":13}},"217":{"start":{"line":482,"column":16},"end":{"line":482,"column":36}},"218":{"start":{"line":483,"column":16},"end":{"line":483,"column":41}},"219":{"start":{"line":487,"column":8},"end":{"line":500,"column":9}},"220":{"start":{"line":488,"column":12},"end":{"line":499,"column":15}},"221":{"start":{"line":489,"column":16},"end":{"line":489,"column":37}},"222":{"start":{"line":490,"column":16},"end":{"line":490,"column":63}},"223":{"start":{"line":492,"column":16},"end":{"line":498,"column":17}},"224":{"start":{"line":493,"column":20},"end":{"line":497,"column":21}},"225":{"start":{"line":494,"column":24},"end":{"line":494,"column":32}},"226":{"start":{"line":495,"column":24},"end":{"line":495,"column":37}},"227":{"start":{"line":496,"column":24},"end":{"line":496,"column":33}},"228":{"start":{"line":510,"column":4},"end":{"line":527,"column":5}},"229":{"start":{"line":511,"column":8},"end":{"line":516,"column":10}},"230":{"start":{"line":518,"column":8},"end":{"line":521,"column":9}},"231":{"start":{"line":519,"column":12},"end":{"line":519,"column":39}},"232":{"start":{"line":520,"column":12},"end":{"line":520,"column":43}},"233":{"start":{"line":523,"column":8},"end":{"line":523,"column":43}},"234":{"start":{"line":524,"column":8},"end":{"line":524,"column":38}},"235":{"start":{"line":525,"column":8},"end":{"line":525,"column":54}},"236":{"start":{"line":526,"column":8},"end":{"line":526,"column":15}},"237":{"start":{"line":529,"column":4},"end":{"line":532,"column":5}},"238":{"start":{"line":530,"column":8},"end":{"line":530,"column":52}},"239":{"start":{"line":531,"column":8},"end":{"line":531,"column":15}},"240":{"start":{"line":534,"column":4},"end":{"line":540,"column":5}},"241":{"start":{"line":535,"column":8},"end":{"line":538,"column":25}},"242":{"start":{"line":539,"column":8},"end":{"line":539,"column":15}},"243":{"start":{"line":543,"column":4},"end":{"line":546,"column":5}},"244":{"start":{"line":544,"column":8},"end":{"line":544,"column":38}},"245":{"start":{"line":545,"column":8},"end":{"line":545,"column":59}},"246":{"start":{"line":553,"column":4},"end":{"line":588,"column":5}},"247":{"start":{"line":554,"column":8},"end":{"line":554,"column":68}},"248":{"start":{"line":555,"column":8},"end":{"line":555,"column":66}},"249":{"start":{"line":556,"column":8},"end":{"line":556,"column":40}},"250":{"start":{"line":558,"column":8},"end":{"line":561,"column":9}},"251":{"start":{"line":560,"column":12},"end":{"line":560,"column":27}},"252":{"start":{"line":564,"column":8},"end":{"line":564,"column":78}},"253":{"start":{"line":566,"column":8},"end":{"line":568,"column":9}},"254":{"start":{"line":567,"column":12},"end":{"line":567,"column":27}},"255":{"start":{"line":572,"column":8},"end":{"line":580,"column":9}},"256":{"start":{"line":573,"column":12},"end":{"line":573,"column":65}},"257":{"start":{"line":575,"column":12},"end":{"line":577,"column":13}},"258":{"start":{"line":576,"column":16},"end":{"line":576,"column":74}},"259":{"start":{"line":579,"column":12},"end":{"line":579,"column":62}},"260":{"start":{"line":581,"column":8},"end":{"line":582,"column":32}},"261":{"start":{"line":583,"column":8},"end":{"line":584,"column":43}},"262":{"start":{"line":585,"column":8},"end":{"line":585,"column":54}},"263":{"start":{"line":587,"column":8},"end":{"line":587,"column":22}},"264":{"start":{"line":591,"column":4},"end":{"line":591,"column":10}},"265":{"start":{"line":592,"column":4},"end":{"line":592,"column":41}},"266":{"start":{"line":594,"column":4},"end":{"line":608,"column":5}},"267":{"start":{"line":595,"column":8},"end":{"line":607,"column":9}},"268":{"start":{"line":596,"column":12},"end":{"line":596,"column":56}},"269":{"start":{"line":597,"column":12},"end":{"line":597,"column":59}},"270":{"start":{"line":599,"column":12},"end":{"line":602,"column":13}},"271":{"start":{"line":600,"column":16},"end":{"line":600,"column":52}},"272":{"start":{"line":601,"column":16},"end":{"line":601,"column":23}},"273":{"start":{"line":603,"column":12},"end":{"line":604,"column":28}},"274":{"start":{"line":605,"column":12},"end":{"line":605,"column":26}},"275":{"start":{"line":606,"column":12},"end":{"line":606,"column":19}},"276":{"start":{"line":612,"column":4},"end":{"line":612,"column":49}},"277":{"start":{"line":613,"column":4},"end":{"line":615,"column":7}},"278":{"start":{"line":625,"column":0},"end":{"line":638,"column":2}},"279":{"start":{"line":626,"column":4},"end":{"line":626,"column":20}},"280":{"start":{"line":627,"column":4},"end":{"line":627,"column":32}},"281":{"start":{"line":629,"column":4},"end":{"line":635,"column":7}},"282":{"start":{"line":630,"column":8},"end":{"line":632,"column":11}},"283":{"start":{"line":631,"column":12},"end":{"line":631,"column":28}},"284":{"start":{"line":634,"column":8},"end":{"line":634,"column":62}},"285":{"start":{"line":637,"column":4},"end":{"line":637,"column":17}}},"branchMap":{"1":{"line":52,"type":"if","locations":[{"start":{"line":52,"column":4},"end":{"line":52,"column":4}},{"start":{"line":52,"column":4},"end":{"line":52,"column":4}}]},"2":{"line":58,"type":"if","locations":[{"start":{"line":58,"column":4},"end":{"line":58,"column":4}},{"start":{"line":58,"column":4},"end":{"line":58,"column":4}}]},"3":{"line":67,"type":"if","locations":[{"start":{"line":67,"column":4},"end":{"line":67,"column":4}},{"start":{"line":67,"column":4},"end":{"line":67,"column":4}}]},"4":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":8},"end":{"line":73,"column":8}},{"start":{"line":73,"column":8},"end":{"line":73,"column":8}}]},"5":{"line":91,"type":"if","locations":[{"start":{"line":91,"column":4},"end":{"line":91,"column":4}},{"start":{"line":91,"column":4},"end":{"line":91,"column":4}}]},"6":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":8},"end":{"line":101,"column":8}},{"start":{"line":101,"column":8},"end":{"line":101,"column":8}}]},"7":{"line":107,"type":"if","locations":[{"start":{"line":107,"column":8},"end":{"line":107,"column":8}},{"start":{"line":107,"column":8},"end":{"line":107,"column":8}}]},"8":{"line":112,"type":"if","locations":[{"start":{"line":112,"column":12},"end":{"line":112,"column":12}},{"start":{"line":112,"column":12},"end":{"line":112,"column":12}}]},"9":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":16},"end":{"line":113,"column":16}},{"start":{"line":113,"column":16},"end":{"line":113,"column":16}}]},"10":{"line":130,"type":"if","locations":[{"start":{"line":130,"column":4},"end":{"line":130,"column":4}},{"start":{"line":130,"column":4},"end":{"line":130,"column":4}}]},"11":{"line":158,"type":"binary-expr","locations":[{"start":{"line":158,"column":23},"end":{"line":158,"column":42}},{"start":{"line":158,"column":46},"end":{"line":158,"column":48}}]},"12":{"line":160,"type":"if","locations":[{"start":{"line":160,"column":4},"end":{"line":160,"column":4}},{"start":{"line":160,"column":4},"end":{"line":160,"column":4}}]},"13":{"line":184,"type":"binary-expr","locations":[{"start":{"line":184,"column":20},"end":{"line":184,"column":36}},{"start":{"line":184,"column":40},"end":{"line":184,"column":55}},{"start":{"line":184,"column":59},"end":{"line":184,"column":61}}]},"14":{"line":186,"type":"if","locations":[{"start":{"line":186,"column":4},"end":{"line":186,"column":4}},{"start":{"line":186,"column":4},"end":{"line":186,"column":4}}]},"15":{"line":192,"type":"if","locations":[{"start":{"line":192,"column":8},"end":{"line":192,"column":8}},{"start":{"line":192,"column":8},"end":{"line":192,"column":8}}]},"16":{"line":216,"type":"if","locations":[{"start":{"line":216,"column":8},"end":{"line":216,"column":8}},{"start":{"line":216,"column":8},"end":{"line":216,"column":8}}]},"17":{"line":231,"type":"if","locations":[{"start":{"line":231,"column":4},"end":{"line":231,"column":4}},{"start":{"line":231,"column":4},"end":{"line":231,"column":4}}]},"18":{"line":237,"type":"binary-expr","locations":[{"start":{"line":237,"column":28},"end":{"line":237,"column":33}},{"start":{"line":237,"column":37},"end":{"line":237,"column":39}}]},"19":{"line":238,"type":"cond-expr","locations":[{"start":{"line":238,"column":42},"end":{"line":238,"column":63}},{"start":{"line":238,"column":67},"end":{"line":238,"column":69}}]},"20":{"line":260,"type":"binary-expr","locations":[{"start":{"line":260,"column":15},"end":{"line":260,"column":34}},{"start":{"line":260,"column":38},"end":{"line":260,"column":54}}]},"21":{"line":261,"type":"binary-expr","locations":[{"start":{"line":261,"column":19},"end":{"line":261,"column":35}},{"start":{"line":261,"column":39},"end":{"line":261,"column":54}},{"start":{"line":261,"column":58},"end":{"line":261,"column":71}}]},"22":{"line":263,"type":"if","locations":[{"start":{"line":263,"column":4},"end":{"line":263,"column":4}},{"start":{"line":263,"column":4},"end":{"line":263,"column":4}}]},"23":{"line":264,"type":"if","locations":[{"start":{"line":264,"column":8},"end":{"line":264,"column":8}},{"start":{"line":264,"column":8},"end":{"line":264,"column":8}}]},"24":{"line":272,"type":"if","locations":[{"start":{"line":272,"column":4},"end":{"line":272,"column":4}},{"start":{"line":272,"column":4},"end":{"line":272,"column":4}}]},"25":{"line":273,"type":"if","locations":[{"start":{"line":273,"column":8},"end":{"line":273,"column":8}},{"start":{"line":273,"column":8},"end":{"line":273,"column":8}}]},"26":{"line":283,"type":"if","locations":[{"start":{"line":283,"column":4},"end":{"line":283,"column":4}},{"start":{"line":283,"column":4},"end":{"line":283,"column":4}}]},"27":{"line":291,"type":"binary-expr","locations":[{"start":{"line":291,"column":17},"end":{"line":291,"column":29}},{"start":{"line":291,"column":33},"end":{"line":291,"column":44}}]},"28":{"line":301,"type":"if","locations":[{"start":{"line":301,"column":4},"end":{"line":301,"column":4}},{"start":{"line":301,"column":4},"end":{"line":301,"column":4}}]},"29":{"line":305,"type":"if","locations":[{"start":{"line":305,"column":4},"end":{"line":305,"column":4}},{"start":{"line":305,"column":4},"end":{"line":305,"column":4}}]},"30":{"line":331,"type":"if","locations":[{"start":{"line":331,"column":4},"end":{"line":331,"column":4}},{"start":{"line":331,"column":4},"end":{"line":331,"column":4}}]},"31":{"line":346,"type":"if","locations":[{"start":{"line":346,"column":4},"end":{"line":346,"column":4}},{"start":{"line":346,"column":4},"end":{"line":346,"column":4}}]},"32":{"line":368,"type":"binary-expr","locations":[{"start":{"line":368,"column":17},"end":{"line":368,"column":40}},{"start":{"line":368,"column":44},"end":{"line":368,"column":46}}]},"33":{"line":373,"type":"if","locations":[{"start":{"line":373,"column":8},"end":{"line":373,"column":8}},{"start":{"line":373,"column":8},"end":{"line":373,"column":8}}]},"34":{"line":386,"type":"if","locations":[{"start":{"line":386,"column":4},"end":{"line":386,"column":4}},{"start":{"line":386,"column":4},"end":{"line":386,"column":4}}]},"35":{"line":387,"type":"binary-expr","locations":[{"start":{"line":387,"column":24},"end":{"line":387,"column":30}},{"start":{"line":387,"column":34},"end":{"line":387,"column":36}}]},"36":{"line":405,"type":"binary-expr","locations":[{"start":{"line":405,"column":13},"end":{"line":405,"column":40}},{"start":{"line":405,"column":44},"end":{"line":405,"column":50}}]},"37":{"line":412,"type":"binary-expr","locations":[{"start":{"line":412,"column":17},"end":{"line":412,"column":40}},{"start":{"line":412,"column":44},"end":{"line":412,"column":46}}]},"38":{"line":417,"type":"if","locations":[{"start":{"line":417,"column":4},"end":{"line":417,"column":4}},{"start":{"line":417,"column":4},"end":{"line":417,"column":4}}]},"39":{"line":433,"type":"if","locations":[{"start":{"line":433,"column":8},"end":{"line":433,"column":8}},{"start":{"line":433,"column":8},"end":{"line":433,"column":8}}]},"40":{"line":439,"type":"if","locations":[{"start":{"line":439,"column":8},"end":{"line":439,"column":8}},{"start":{"line":439,"column":8},"end":{"line":439,"column":8}}]},"41":{"line":439,"type":"binary-expr","locations":[{"start":{"line":439,"column":12},"end":{"line":439,"column":34}},{"start":{"line":439,"column":38},"end":{"line":439,"column":52}}]},"42":{"line":452,"type":"if","locations":[{"start":{"line":452,"column":8},"end":{"line":452,"column":8}},{"start":{"line":452,"column":8},"end":{"line":452,"column":8}}]},"43":{"line":452,"type":"binary-expr","locations":[{"start":{"line":452,"column":12},"end":{"line":452,"column":43}},{"start":{"line":452,"column":47},"end":{"line":452,"column":68}}]},"44":{"line":457,"type":"if","locations":[{"start":{"line":457,"column":8},"end":{"line":457,"column":8}},{"start":{"line":457,"column":8},"end":{"line":457,"column":8}}]},"45":{"line":466,"type":"if","locations":[{"start":{"line":466,"column":4},"end":{"line":466,"column":4}},{"start":{"line":466,"column":4},"end":{"line":466,"column":4}}]},"46":{"line":468,"type":"if","locations":[{"start":{"line":468,"column":8},"end":{"line":468,"column":8}},{"start":{"line":468,"column":8},"end":{"line":468,"column":8}}]},"47":{"line":477,"type":"binary-expr","locations":[{"start":{"line":477,"column":24},"end":{"line":477,"column":27}},{"start":{"line":477,"column":31},"end":{"line":477,"column":41}}]},"48":{"line":481,"type":"if","locations":[{"start":{"line":481,"column":12},"end":{"line":481,"column":12}},{"start":{"line":481,"column":12},"end":{"line":481,"column":12}}]},"49":{"line":487,"type":"if","locations":[{"start":{"line":487,"column":8},"end":{"line":487,"column":8}},{"start":{"line":487,"column":8},"end":{"line":487,"column":8}}]},"50":{"line":492,"type":"if","locations":[{"start":{"line":492,"column":16},"end":{"line":492,"column":16}},{"start":{"line":492,"column":16},"end":{"line":492,"column":16}}]},"51":{"line":493,"type":"if","locations":[{"start":{"line":493,"column":20},"end":{"line":493,"column":20}},{"start":{"line":493,"column":20},"end":{"line":493,"column":20}}]},"52":{"line":493,"type":"binary-expr","locations":[{"start":{"line":493,"column":24},"end":{"line":493,"column":26}},{"start":{"line":493,"column":30},"end":{"line":493,"column":48}}]},"53":{"line":510,"type":"if","locations":[{"start":{"line":510,"column":4},"end":{"line":510,"column":4}},{"start":{"line":510,"column":4},"end":{"line":510,"column":4}}]},"54":{"line":510,"type":"binary-expr","locations":[{"start":{"line":510,"column":8},"end":{"line":510,"column":14}},{"start":{"line":510,"column":18},"end":{"line":510,"column":19}}]},"55":{"line":518,"type":"if","locations":[{"start":{"line":518,"column":8},"end":{"line":518,"column":8}},{"start":{"line":518,"column":8},"end":{"line":518,"column":8}}]},"56":{"line":529,"type":"if","locations":[{"start":{"line":529,"column":4},"end":{"line":529,"column":4}},{"start":{"line":529,"column":4},"end":{"line":529,"column":4}}]},"57":{"line":534,"type":"if","locations":[{"start":{"line":534,"column":4},"end":{"line":534,"column":4}},{"start":{"line":534,"column":4},"end":{"line":534,"column":4}}]},"58":{"line":536,"type":"binary-expr","locations":[{"start":{"line":536,"column":12},"end":{"line":536,"column":25}},{"start":{"line":536,"column":29},"end":{"line":536,"column":32}}]},"59":{"line":558,"type":"if","locations":[{"start":{"line":558,"column":8},"end":{"line":558,"column":8}},{"start":{"line":558,"column":8},"end":{"line":558,"column":8}}]},"60":{"line":558,"type":"binary-expr","locations":[{"start":{"line":558,"column":12},"end":{"line":558,"column":36}},{"start":{"line":558,"column":40},"end":{"line":558,"column":47}},{"start":{"line":558,"column":51},"end":{"line":558,"column":58}},{"start":{"line":559,"column":12},"end":{"line":559,"column":42}}]},"61":{"line":564,"type":"binary-expr","locations":[{"start":{"line":564,"column":17},"end":{"line":564,"column":25}},{"start":{"line":564,"column":29},"end":{"line":564,"column":77}}]},"62":{"line":566,"type":"if","locations":[{"start":{"line":566,"column":8},"end":{"line":566,"column":8}},{"start":{"line":566,"column":8},"end":{"line":566,"column":8}}]},"63":{"line":572,"type":"if","locations":[{"start":{"line":572,"column":8},"end":{"line":572,"column":8}},{"start":{"line":572,"column":8},"end":{"line":572,"column":8}}]},"64":{"line":575,"type":"if","locations":[{"start":{"line":575,"column":12},"end":{"line":575,"column":12}},{"start":{"line":575,"column":12},"end":{"line":575,"column":12}}]},"65":{"line":595,"type":"if","locations":[{"start":{"line":595,"column":8},"end":{"line":595,"column":8}},{"start":{"line":595,"column":8},"end":{"line":595,"column":8}}]},"66":{"line":599,"type":"if","locations":[{"start":{"line":599,"column":12},"end":{"line":599,"column":12}},{"start":{"line":599,"column":12},"end":{"line":599,"column":12}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var EventEmitter = require('events').EventEmitter;","var url = require('url');","var util = require('util');","","var assert = require('assert-plus');","var LRU = require('lru-cache');","var Negotiator = require('negotiator');","var semver = require('semver');","","var cors = require('./plugins/cors');","var errors = require('./errors');","var utils = require('./utils');","","","///--- Globals","","var DEF_CT = 'application/octet-stream';","","var BadRequestError = errors.BadRequestError;","var InternalError = errors.InternalError;","var InvalidArgumentError = errors.InvalidArgumentError;","var InvalidVersionError = errors.InvalidVersionError;","var MethodNotAllowedError = errors.MethodNotAllowedError;","var ResourceNotFoundError = errors.ResourceNotFoundError;","var UnsupportedMediaTypeError = errors.UnsupportedMediaTypeError;","","var shallowCopy = utils.shallowCopy;","","","///--- Helpers","","","/**"," * given a request, try to match it against the regular expression to"," * get the route params."," * i.e., /foo/:param1/:param2"," * @private"," * @function matchURL"," * @param    {String | RegExp} re   a string or regular expression"," * @param    {Object}          req  the request object"," * @returns  {Object}"," */","function matchURL(re, req) {","    var i = 0;","    var result = re.exec(req.path());","    var params = {};","","    if (!result) {","        return (false);","    }","","    // This means the user original specified a regexp match, not a url","    // string like /:foo/:bar","    if (!re.restifyParams) {","        for (i = 1; i < result.length; i++) {","            params[(i - 1)] = result[i];","        }","","        return (params);","    }","","    // This was a static string, like /foo","    if (re.restifyParams.length === 0) {","        return (params);","    }","","    // This was the \"normal\" case, of /foo/:id","    re.restifyParams.forEach(function (p) {","        if (++i < result.length) {","            params[p] = decodeURIComponent(result[i]);","        }","    });","","    return (params);","}","","","/**"," * called while installing routes. attempts to compile the passed in string"," * or regexp and register it."," * @private"," * @function compileURL"," * @param    {Object} options an options object"," * @returns  {RegExp}"," */","function compileURL(options) {","    if (options.url instanceof RegExp) {","        return (options.url);","    }","    assert.string(options.url, 'url');","","    var params = [];","    var pattern = '^';","    var re;","    var _url = url.parse(options.url).pathname;","    _url.split('/').forEach(function (frag) {","        if (frag.length <= 0) {","            return (false);","        }","","        pattern += '\\\\/+';","","        if (frag.charAt(0) === ':') {","            var label = frag;","            var index = frag.indexOf('(');","            var subexp;","","            if (index === -1) {","                if (options.urlParamPattern) {","                    subexp = options.urlParamPattern;","                } else {","                    subexp = '[^/]*';","                }","            } else {","                label = frag.substring(0, index);","                subexp = frag.substring(index + 1, frag.length - 1);","            }","            pattern += '(' + subexp + ')';","            params.push(label.slice(1));","        } else {","            pattern += frag;","        }","        return (true);","    });","","    if (pattern === '^') {","        pattern += '\\\\/';","    }","    pattern += '$';","","    re = new RegExp(pattern, options.flags);","    re.restifyParams = params;","","    return (re);","}","","","///--- API","","/**"," * Router class handles mapping of http verbs and a regexp path,"," * to an array of handler functions."," * @class"," * @public"," * @param  {Object} options an options object"," */","function Router(options) {","    assert.object(options, 'options');","    assert.object(options.log, 'options.log');","","    EventEmitter.call(this);","","    this.cache = LRU({max: 100});","    this.contentType = options.contentType || [];","","    if (!Array.isArray(this.contentType)) {","        this.contentType = [this.contentType];","    }","    assert.arrayOfString(this.contentType, 'options.contentType');","","    this.log = options.log;","    this.mounts = {};","    this.name = 'RestifyRouter';","","    // A list of methods to routes","    this.routes = {","        DELETE: [],","        GET: [],","        HEAD: [],","        OPTIONS: [],","        PATCH: [],","        POST: [],","        PUT: []","    };","","    // So we can retrun 405 vs 404, we maintain a reverse mapping of URLs","    // to method","    this.reverse = {};","","    this.versions = options.versions || options.version || [];","","    if (!Array.isArray(this.versions)) {","        this.versions = [this.versions];","    }","    assert.arrayOfString(this.versions, 'options.versions');","","    this.versions.forEach(function (v) {","        if (semver.valid(v)) {","            return (true);","        }","","        throw new InvalidArgumentError('%s is not a valid semver', v);","    });","    this.versions.sort();","","}","util.inherits(Router, EventEmitter);","","module.exports = Router;","","/**"," * takes an object of route params and query params, and 'renders' a URL."," * @public"," * @function render"," * @param    {String} routeName the route name"," * @param    {Object} params    an object of route params"," * @param    {Object} query     an object of query params"," * @returns  {String}"," */","Router.prototype.render = function render(routeName, params, query) {","    function pathItem(match, key) {","        if (params.hasOwnProperty(key) === false) {","            throw new Error('Route <' + routeName +","                            '> is missing parameter <' +","                            key + '>');","        }","        return ('/' + encodeURIComponent(params[key]));","    }","","    function queryItem(key) {","        return (encodeURIComponent(key) + '=' + encodeURIComponent(query[key]));","    }","","    var routeKey = routeName.replace(/\\W/g, '').toLowerCase();","    var route = this.mounts[routeKey];","","    if (!route) {","        return (null);","    }","","    var _path = route.spec.path;","    var _url = _path.replace(/\\/:([A-Za-z0-9_]+)(\\([^\\\\]+?\\))?/g, pathItem);","    var items = Object.keys(query || {}).map(queryItem);","    var queryString = items.length > 0 ? ('?' + items.join('&')) : '';","    return (_url + queryString);","};","","","/**"," * adds a route."," * @public"," * @function mount"," * @param    {Object} options an options object"," * @returns  {String}         returns the route name if creation is successful."," */","Router.prototype.mount = function mount(options) {","    assert.object(options, 'options');","    assert.string(options.method, 'options.method');","    assert.string(options.name, 'options.name');","","    var exists;","    var name = options.name;","    var route;","    var routes = this.routes[options.method];","    var self = this;","    var type = options.contentType || self.contentType;","    var versions = options.versions || options.version || self.versions;","","    if (type) {","        if (!Array.isArray(type)) {","            type = [type];","        }","        type.filter(function (t) {","            return (t);","        }).sort().join();","    }","","    if (versions) {","        if (!Array.isArray(versions)) {","            versions = [versions];","        }","        versions.sort();","    }","","    exists = routes.some(function (r) {","        return (r.name === name);","    });","","    if (exists) {","        return (false);","    }","","    route = {","        name: name,","        method: options.method,","        path: compileURL({","            url: options.path || options.url,","            flags: options.flags,","            urlParamPattern: options.urlParamPattern","        }),","        spec: options,","        types: type,","        versions: versions","    };","    routes.push(route);","","    if (!this.reverse[route.path.source]) {","        this.reverse[route.path.source] = [];","    }","","    if (this.reverse[route.path.source].indexOf(route.method) === -1) {","        this.reverse[route.path.source].push(route.method);","    }","","    this.mounts[route.name] = route;","","    this.emit('mount',","        route.method,","        route.path,","        route.types,","        route.versions);","","    return (route.name);","};","","","/**"," * unmounts a route."," * @public"," * @function unmount"," * @param    {String} name the route name"," * @returns  {String}      the name of the deleted route."," */","Router.prototype.unmount = function unmount(name) {","    var route = this.mounts[name];","","    if (!route) {","        this.log.warn('router.unmount(%s): route does not exist', name);","        return (false);","    }","","    var reverse = this.reverse[route.path.source];","    var routes = this.routes[route.method];","    this.routes[route.method] = routes.filter(function (r) {","        return (r.name !== route.name);","    });","","    this.reverse[route.path.source] = reverse.filter(function (r) {","        return (r !== route.method);","    });","","    if (this.reverse[route.path.source].length === 0) {","        delete this.reverse[route.path.source];","    }","","    delete this.mounts[name];","","    return (name);","};","","","/**"," * get a route from the router."," * @public"," * @function get"," * @param    {String}    name the name of the route to retrieve"," * @param    {Object}    req  the request object"," * @param    {Function}  cb   callback function"," * @returns  {undefined}"," */","Router.prototype.get = function get(name, req, cb) {","    var params;","    var route = false;","    var routes = this.routes[req.method] || [];","","    var routeName = name.replace(/\\W/g, '').toLowerCase();","","    for (var i = 0; i < routes.length; i++) {","        if (routes[i].name === routeName) {","            route = routes[i];","","            try {","                params = matchURL(route.path, req);","            } catch (e) {","                // if we couldn't match the URL, log it out.","                console.log(e);","            }","            break;","        }","    }","","    if (route) {","        cb(null, route, params || {});","    } else {","        cb(new InternalError());","    }","};","","","/**"," * find a route from inside the router, handles versioned routes."," * @public"," * @function find"," * @param    {Object}   req      the request object"," * @param    {Object}   res      the response object"," * @param    {Function} callback callback function"," * @returns  {undefined}"," */","Router.prototype.find = function find(req, res, callback) {","    var candidates = [];","    var ct = req.headers['content-type'] || DEF_CT;","    var cacheKey = req.method + req.url + req.version() + ct;","    var cacheVal;","    var neg;","    var params;","    var r;","    var reverse;","    var routes = this.routes[req.method] || [];","    var typed;","    var versioned;","    var maxV;","","    if ((cacheVal = this.cache.get(cacheKey))) {","        res.methods = cacheVal.methods.slice();","        req._matchedVersion = cacheVal.matchedVersion;","        callback(null, cacheVal, shallowCopy(cacheVal.params));","        return;","    }","","    for (var i = 0; i < routes.length; i++) {","        try {","            params = matchURL(routes[i].path, req);","        } catch (e) {","            this.log.trace({err: e}, 'error parsing URL');","            callback(new BadRequestError(e.message));","            return;","        }","","        if (params === false) {","            continue;","        }","","        reverse = this.reverse[routes[i].path.source];","","        if (routes[i].types.length && req.isUpload()) {","            candidates.push({","                p: params,","                r: routes[i]","            });","            typed = true;","            continue;","        }","","        // GH-283: we want to find the latest version for a given route,","        // not the first one.  However, if neither the client nor","        // server specified any version, we're done, because neither","        // cared","        if (routes[i].versions.length === 0 && req.version() === '*') {","            r = routes[i];","            break;","        }","","        if (routes[i].versions.length > 0) {","            candidates.push({","                p: params,","                r: routes[i]","            });","            versioned = true;","        }","    }","","    if (!r) {","        // If upload and typed","        if (typed) {","            var _t = ct.split(/\\s*,\\s*/);","            candidates = candidates.filter(function (c) {","                neg = new Negotiator({","                    headers: {","                        accept: c.r.types.join(', ')","                    }","                });","                var tmp = neg.preferredMediaType(_t);","                return (tmp && tmp.length);","            });","","            // Pick the first one in case not versioned","            if (candidates.length) {","                r = candidates[0].r;","                params = candidates[0].p;","            }","        }","","        if (versioned) {","            candidates.forEach(function (c) {","                var k = c.r.versions;","                var v = semver.maxSatisfying(k, req.version());","","                if (v) {","                    if (!r || semver.gt(v, maxV)) {","                        r = c.r;","                        params = c.p;","                        maxV = v;","                    }","                }","            });","        }","    }","","    // In order, we check if the route exists, in which case, we're good.","    // Otherwise we look to see if ver was set to false; that would tell us","    // we indeed did find a matching route (method+url), but the version","    // field didn't line up, so we return bad version.  If no route and no","    // version, we now need to go walk the reverse map and look at whether","    // we should return 405 or 404.  If it was an OPTIONS request, we need","    // to handle this having been a preflight request.","    if (params && r) {","        cacheVal = {","            methods: reverse,","            name: r.name,","            params: params,","            spec: r.spec","        };","","        if (versioned) {","            req._matchedVersion = maxV;","            cacheVal.matchedVersion = maxV;","        }","","        this.cache.set(cacheKey, cacheVal);","        res.methods = reverse.slice();","        callback(null, cacheVal, shallowCopy(params));","        return;","    }","","    if (typed) {","        callback(new UnsupportedMediaTypeError(ct));","        return;","    }","","    if (versioned) {","        callback(new InvalidVersionError('%s is not supported by %s %s',","            req.version() || '?',","            req.method,","            req.path()));","        return;","    }","","    //Checks if header is in cors.ALLOWED_HEADERS","    function inAllowedHeaders(header) {","        header = header.toLowerCase();","        return (cors.ALLOW_HEADERS.indexOf(header) !== -1);","    }","","    // This is a very generic preflight handler - it does","    // not handle requiring authentication, nor does it do","    // any special checking for extra user headers. The","    // user will need to defined their own .opts handler to","    // do that","    function preflight(methods) {","        var headers = req.headers['access-control-request-headers'];","        var method = req.headers['access-control-request-method'];","        var origin = req.headers.origin;","","        if (req.method !== 'OPTIONS' || !origin || !method ||","            methods.indexOf(method) === -1) {","            return (false);","        }","","        // Last, check request-headers","        var ok = !headers || headers.split(/\\s*,\\s*/).every(inAllowedHeaders);","","        if (!ok) {","            return (false);","        }","","        // Verify the incoming origin against the whitelist. Pass the origin","        // through if there is a match.","        if (cors.matchOrigin(req, cors.origins)) {","            res.setHeader('Access-Control-Allow-Origin', origin);","","            if (cors.credentials) {","                res.setHeader('Access-Control-Allow-Credentials', 'true');","            }","        } else {","            res.setHeader('Access-Control-Allow-Origin', '*');","        }","        res.setHeader('Access-Control-Allow-Methods',","            methods.join(', '));","        res.setHeader('Access-Control-Allow-Headers',","            cors.ALLOW_HEADERS.join(', '));","        res.setHeader('Access-Control-Max-Age', 3600);","","        return (true);","    }","","    // Check for 405 instead of 404","    var j;","    var urls = Object.keys(this.reverse);","","    for (j = 0; j < urls.length; j++) {","        if (matchURL(new RegExp(urls[j]), req)) {","            res.methods = this.reverse[urls[j]].slice();","            res.setHeader('Allow', res.methods.join(', '));","","            if (preflight(res.methods)) {","                callback(null, {name: 'preflight'});","                return;","            }","            var err = new MethodNotAllowedError('%s is not allowed',","                req.method);","            callback(err);","            return;","        }","    }","","    // clean up the url in case of potential xss","    // https://github.com/restify/node-restify/issues/1018","    var cleanedUrl = url.parse(req.url).pathname;","    callback(new ResourceNotFoundError(","        '%s does not exist', cleanedUrl","    ));","};","","","/**"," * toString() serialization."," * @public"," * @function toString"," * @returns  {String}"," */","Router.prototype.toString = function toString() {","    var self = this;","    var str = this.name + ':\\n';","","    Object.keys(this.routes).forEach(function (k) {","        var routes = self.routes[k].map(function (r) {","            return (r.name);","        });","","        str += '\\t\\t' + k + ': [' + routes.join(', ') + ']\\n';","    });","","    return (str);","};",""],"l":{"5":1,"6":1,"7":1,"9":1,"10":1,"11":1,"12":1,"14":1,"15":1,"16":1,"21":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1,"31":1,"47":1,"48":0,"49":0,"50":0,"52":0,"53":0,"58":0,"59":0,"60":0,"63":0,"67":0,"68":0,"72":0,"73":0,"74":0,"78":0,"90":1,"91":0,"92":0,"94":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"105":0,"107":0,"108":0,"109":0,"110":0,"112":0,"113":0,"114":0,"116":0,"119":0,"120":0,"122":0,"123":0,"125":0,"127":0,"130":0,"131":0,"133":0,"135":0,"136":0,"138":0,"151":1,"152":0,"153":0,"155":0,"157":0,"158":0,"160":0,"161":0,"163":0,"165":0,"166":0,"167":0,"170":0,"182":0,"184":0,"186":0,"187":0,"189":0,"191":0,"192":0,"193":0,"196":0,"198":0,"201":1,"203":1,"214":1,"215":1,"216":0,"217":0,"221":0,"224":1,"225":0,"228":0,"229":0,"231":0,"232":0,"235":0,"236":0,"237":0,"238":0,"239":0,"250":1,"251":0,"252":0,"253":0,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"263":0,"264":0,"265":0,"267":0,"268":0,"272":0,"273":0,"274":0,"276":0,"279":0,"280":0,"283":0,"284":0,"287":0,"299":0,"301":0,"302":0,"305":0,"306":0,"309":0,"311":0,"317":0,"328":1,"329":0,"331":0,"332":0,"333":0,"336":0,"337":0,"338":0,"339":0,"342":0,"343":0,"346":0,"347":0,"350":0,"352":0,"365":1,"366":0,"367":0,"368":0,"370":0,"372":0,"373":0,"374":0,"376":0,"377":0,"380":0,"382":0,"386":0,"387":0,"389":0,"403":1,"404":0,"405":0,"406":0,"407":0,"408":0,"409":0,"410":0,"411":0,"412":0,"413":0,"414":0,"415":0,"417":0,"418":0,"419":0,"420":0,"421":0,"424":0,"425":0,"426":0,"428":0,"429":0,"430":0,"433":0,"434":0,"437":0,"439":0,"440":0,"444":0,"445":0,"452":0,"453":0,"454":0,"457":0,"458":0,"462":0,"466":0,"468":0,"469":0,"470":0,"471":0,"476":0,"477":0,"481":0,"482":0,"483":0,"487":0,"488":0,"489":0,"490":0,"492":0,"493":0,"494":0,"495":0,"496":0,"510":0,"511":0,"518":0,"519":0,"520":0,"523":0,"524":0,"525":0,"526":0,"529":0,"530":0,"531":0,"534":0,"535":0,"539":0,"543":1,"544":0,"545":0,"553":1,"554":0,"555":0,"556":0,"558":0,"560":0,"564":0,"566":0,"567":0,"572":0,"573":0,"575":0,"576":0,"579":0,"581":0,"583":0,"585":0,"587":0,"591":0,"592":0,"594":0,"595":0,"596":0,"597":0,"599":0,"600":0,"601":0,"603":0,"605":0,"606":0,"612":0,"613":0,"625":1,"626":0,"627":0,"629":0,"630":0,"631":0,"634":0,"637":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/server.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/server.js","s":{"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":0,"25":0,"26":0,"27":0,"28":0,"29":1,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":1,"60":1,"61":0,"62":0,"63":0,"64":0,"65":1,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":1,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":1,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0,"136":0,"137":0,"138":0,"139":0,"140":0,"141":0,"142":0,"143":0,"144":0,"145":0,"146":0,"147":0,"148":0,"149":0,"150":0,"151":0,"152":0,"153":0,"154":0,"155":0,"156":0,"157":0,"158":0,"159":0,"160":0,"161":0,"162":0,"163":0,"164":0,"165":1,"166":1,"167":1,"168":0,"169":1,"170":0,"171":0,"172":1,"173":0,"174":0,"175":0,"176":0,"177":0,"178":1,"179":7,"180":0,"181":0,"182":0,"183":0,"184":0,"185":0,"186":0,"187":0,"188":0,"189":0,"190":1,"191":0,"192":0,"193":0,"194":0,"195":0,"196":0,"197":0,"198":0,"199":0,"200":0,"201":0,"202":0,"203":0,"204":0,"205":0,"206":0,"207":0,"208":0,"209":0,"210":0,"211":0,"212":0,"213":0,"214":0,"215":1,"216":0,"217":0,"218":0,"219":0,"220":0,"221":1,"222":0,"223":0,"224":0,"225":0,"226":0,"227":0,"228":0,"229":0,"230":0,"231":0,"232":0,"233":0,"234":1,"235":0,"236":0,"237":0,"238":0,"239":1,"240":0,"241":0,"242":0,"243":0,"244":1,"245":0,"246":0,"247":0,"248":0,"249":1,"250":0,"251":0,"252":0,"253":0,"254":1,"255":0,"256":0,"257":0,"258":0,"259":0,"260":0,"261":0,"262":0,"263":0,"264":0,"265":0,"266":0,"267":0,"268":0,"269":0,"270":1,"271":0,"272":1,"273":0,"274":0,"275":0,"276":0,"277":0,"278":0,"279":0,"280":0,"281":0,"282":0,"283":0,"284":0,"285":1,"286":0,"287":0,"288":0,"289":0,"290":0,"291":0,"292":0,"293":0,"294":0,"295":0,"296":0,"297":0,"298":0,"299":0,"300":0,"301":0,"302":0,"303":0,"304":0,"305":0,"306":0,"307":0,"308":1,"309":0,"310":0,"311":0,"312":0,"313":0,"314":0,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"321":0,"322":1,"323":0,"324":0,"325":0,"326":0,"327":0,"328":0,"329":0,"330":0,"331":0,"332":0,"333":0,"334":0,"335":0,"336":0,"337":0,"338":0,"339":0,"340":0,"341":0,"342":0,"343":0,"344":0,"345":1,"346":0,"347":0,"348":0,"349":0,"350":0,"351":0,"352":0,"353":0,"354":0,"355":0,"356":0,"357":0,"358":0,"359":0,"360":0,"361":0,"362":0,"363":0,"364":0,"365":0,"366":0,"367":0,"368":0,"369":0,"370":0,"371":0,"372":0,"373":0,"374":0,"375":0,"376":0,"377":0,"378":0,"379":0,"380":0,"381":0,"382":0,"383":0,"384":0,"385":0,"386":0,"387":0,"388":0,"389":0,"390":0,"391":0,"392":0,"393":1,"394":0,"395":0,"396":0,"397":0,"398":0,"399":0,"400":0,"401":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0,0],"14":[0,0],"15":[0,0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[0,0],"30":[0,0],"31":[0,0],"32":[0,0],"33":[0,0],"34":[0,0],"35":[0,0],"36":[0,0],"37":[0,0],"38":[0,0],"39":[0,0],"40":[0,0],"41":[0,0],"42":[0,0],"43":[0,0],"44":[0,0,0],"45":[0,0],"46":[0,0],"47":[0,0],"48":[0,0],"49":[0,0],"50":[0,0],"51":[0,0],"52":[0,0],"53":[0,0],"54":[0,0],"55":[0,0],"56":[0,0],"57":[0,0],"58":[0,0],"59":[0,0],"60":[0,0],"61":[0,0],"62":[0,0],"63":[0,0],"64":[0,0],"65":[0,0],"66":[0,0],"67":[0,0],"68":[0,0],"69":[0,0],"70":[0,0],"71":[0,0],"72":[0,0],"73":[0,0],"74":[0,0],"75":[0,0],"76":[0,0],"77":[0,0],"78":[0,0],"79":[0,0],"80":[0,0],"81":[0,0],"82":[0,0],"83":[0,0],"84":[0,0],"85":[0,0,0],"86":[0,0],"87":[0,0],"88":[0,0,0],"89":[0,0],"90":[0,0],"91":[0,0],"92":[0,0],"93":[0,0],"94":[0,0],"95":[0,0],"96":[0,0],"97":[0,0],"98":[0,0],"99":[0,0],"100":[0,0],"101":[0,0],"102":[0,0],"103":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":7,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},"fnMap":{"1":{"name":"argumentsToChain","line":60,"loc":{"start":{"line":60,"column":0},"end":{"line":60,"column":39}}},"2":{"name":"process","line":71,"loc":{"start":{"line":71,"column":4},"end":{"line":71,"column":31}}},"3":{"name":"mergeFormatters","line":99,"loc":{"start":{"line":99,"column":0},"end":{"line":99,"column":30}}},"4":{"name":"addFormatter","line":103,"loc":{"start":{"line":103,"column":4},"end":{"line":103,"column":34}}},"5":{"name":"(anonymous_5)","line":132,"loc":{"start":{"line":132,"column":19},"end":{"line":132,"column":35}}},"6":{"name":"(anonymous_6)","line":134,"loc":{"start":{"line":134,"column":11},"end":{"line":134,"column":24}}},"7":{"name":"ifError","line":153,"loc":{"start":{"line":153,"column":0},"end":{"line":153,"column":20}}},"8":{"name":"_ifError","line":161,"loc":{"start":{"line":161,"column":4},"end":{"line":161,"column":27}}},"9":{"name":"emitRouteError","line":183,"loc":{"start":{"line":183,"column":0},"end":{"line":183,"column":47}}},"10":{"name":"(anonymous_10)","line":197,"loc":{"start":{"line":197,"column":46},"end":{"line":197,"column":58}}},"11":{"name":"optionsError","line":216,"loc":{"start":{"line":216,"column":0},"end":{"line":216,"column":37}}},"12":{"name":"Server","line":237,"loc":{"start":{"line":237,"column":0},"end":{"line":237,"column":25}}},"13":{"name":"(anonymous_13)","line":296,"loc":{"start":{"line":296,"column":25},"end":{"line":296,"column":38}}},"14":{"name":"onCheckContinue","line":301,"loc":{"start":{"line":301,"column":36},"end":{"line":301,"column":71}}},"15":{"name":"onUpgrade","line":316,"loc":{"start":{"line":316,"column":34},"end":{"line":316,"column":72}}},"16":{"name":"onRequest","line":324,"loc":{"start":{"line":324,"column":30},"end":{"line":324,"column":59}}},"17":{"name":"(anonymous_17)","line":335,"loc":{"start":{"line":335,"column":45},"end":{"line":335,"column":57}}},"18":{"name":"(anonymous_18)","line":339,"loc":{"start":{"line":339,"column":45},"end":{"line":339,"column":58}}},"19":{"name":"(anonymous_19)","line":344,"loc":{"start":{"line":344,"column":33},"end":{"line":344,"column":45}}},"20":{"name":"address","line":383,"loc":{"start":{"line":383,"column":27},"end":{"line":383,"column":46}}},"21":{"name":"listen","line":402,"loc":{"start":{"line":402,"column":26},"end":{"line":402,"column":44}}},"22":{"name":"close","line":416,"loc":{"start":{"line":416,"column":25},"end":{"line":416,"column":50}}},"23":{"name":"onClose","line":421,"loc":{"start":{"line":421,"column":30},"end":{"line":421,"column":49}}},"24":{"name":"(anonymous_24)","line":447,"loc":{"start":{"line":447,"column":10},"end":{"line":447,"column":28}}},"25":{"name":"(anonymous_25)","line":448,"loc":{"start":{"line":448,"column":35},"end":{"line":448,"column":51}}},"26":{"name":"addHandler","line":467,"loc":{"start":{"line":467,"column":12},"end":{"line":467,"column":35}}},"27":{"name":"param","line":537,"loc":{"start":{"line":537,"column":25},"end":{"line":537,"column":50}}},"28":{"name":"_param","line":538,"loc":{"start":{"line":538,"column":13},"end":{"line":538,"column":45}}},"29":{"name":"versionedUse","line":571,"loc":{"start":{"line":571,"column":32},"end":{"line":571,"column":68}}},"30":{"name":"(anonymous_30)","line":577,"loc":{"start":{"line":577,"column":21},"end":{"line":577,"column":34}}},"31":{"name":"_versionedUse","line":583,"loc":{"start":{"line":583,"column":13},"end":{"line":583,"column":52}}},"32":{"name":"rm","line":608,"loc":{"start":{"line":608,"column":22},"end":{"line":608,"column":41}}},"33":{"name":"use","line":628,"loc":{"start":{"line":628,"column":23},"end":{"line":628,"column":38}}},"34":{"name":"(anonymous_34)","line":631,"loc":{"start":{"line":631,"column":48},"end":{"line":631,"column":61}}},"35":{"name":"pre","line":647,"loc":{"start":{"line":647,"column":23},"end":{"line":647,"column":38}}},"36":{"name":"(anonymous_36)","line":650,"loc":{"start":{"line":650,"column":40},"end":{"line":650,"column":53}}},"37":{"name":"toString","line":664,"loc":{"start":{"line":664,"column":28},"end":{"line":664,"column":48}}},"38":{"name":"handlersToString","line":670,"loc":{"start":{"line":670,"column":4},"end":{"line":670,"column":35}}},"39":{"name":"(anonymous_39)","line":671,"loc":{"start":{"line":671,"column":30},"end":{"line":671,"column":43}}},"40":{"name":"(anonymous_40)","line":683,"loc":{"start":{"line":683,"column":37},"end":{"line":683,"column":50}}},"41":{"name":"_handle","line":707,"loc":{"start":{"line":707,"column":27},"end":{"line":707,"column":54}}},"42":{"name":"routeAndRun","line":710,"loc":{"start":{"line":710,"column":4},"end":{"line":710,"column":27}}},"43":{"name":"(anonymous_43)","line":711,"loc":{"start":{"line":711,"column":30},"end":{"line":711,"column":56}}},"44":{"name":"done","line":718,"loc":{"start":{"line":718,"column":46},"end":{"line":718,"column":63}}},"45":{"name":"(anonymous_45)","line":725,"loc":{"start":{"line":725,"column":47},"end":{"line":725,"column":62}}},"46":{"name":"_route","line":746,"loc":{"start":{"line":746,"column":26},"end":{"line":746,"column":62}}},"47":{"name":"onRoute","line":753,"loc":{"start":{"line":753,"column":35},"end":{"line":753,"column":69}}},"48":{"name":"(anonymous_48)","line":774,"loc":{"start":{"line":774,"column":35},"end":{"line":774,"column":62}}},"49":{"name":"_run","line":807,"loc":{"start":{"line":807,"column":24},"end":{"line":807,"column":66}}},"50":{"name":"next","line":830,"loc":{"start":{"line":830,"column":4},"end":{"line":830,"column":23}}},"51":{"name":"(anonymous_51)","line":840,"loc":{"start":{"line":840,"column":59},"end":{"line":840,"column":71}}},"52":{"name":"(anonymous_52)","line":861,"loc":{"start":{"line":861,"column":50},"end":{"line":861,"column":68}}},"53":{"name":"_uniq","line":867,"loc":{"start":{"line":867,"column":20},"end":{"line":867,"column":39}}},"54":{"name":"(anonymous_54)","line":915,"loc":{"start":{"line":915,"column":48},"end":{"line":915,"column":60}}},"55":{"name":"(anonymous_55)","line":943,"loc":{"start":{"line":943,"column":45},"end":{"line":943,"column":57}}},"56":{"name":"onError","line":963,"loc":{"start":{"line":963,"column":18},"end":{"line":963,"column":40}}},"57":{"name":"_setupRequest","line":983,"loc":{"start":{"line":983,"column":33},"end":{"line":983,"column":66}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":31}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":50}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"4":{"start":{"line":8,"column":0},"end":{"line":8,"column":29}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":27}},"6":{"start":{"line":11,"column":0},"end":{"line":11,"column":36}},"7":{"start":{"line":12,"column":0},"end":{"line":12,"column":27}},"8":{"start":{"line":13,"column":0},"end":{"line":13,"column":27}},"9":{"start":{"line":14,"column":0},"end":{"line":14,"column":27}},"10":{"start":{"line":15,"column":0},"end":{"line":15,"column":32}},"11":{"start":{"line":17,"column":0},"end":{"line":17,"column":33}},"12":{"start":{"line":18,"column":0},"end":{"line":18,"column":33}},"13":{"start":{"line":19,"column":0},"end":{"line":19,"column":41}},"14":{"start":{"line":20,"column":0},"end":{"line":20,"column":49}},"15":{"start":{"line":21,"column":0},"end":{"line":21,"column":35}},"16":{"start":{"line":23,"column":0},"end":{"line":23,"column":31}},"17":{"start":{"line":24,"column":0},"end":{"line":24,"column":41}},"18":{"start":{"line":27,"column":0},"end":{"line":27,"column":21}},"19":{"start":{"line":28,"column":0},"end":{"line":28,"column":22}},"20":{"start":{"line":33,"column":0},"end":{"line":33,"column":26}},"21":{"start":{"line":35,"column":0},"end":{"line":35,"column":57}},"22":{"start":{"line":37,"column":0},"end":{"line":44,"column":2}},"23":{"start":{"line":60,"column":0},"end":{"line":85,"column":1}},"24":{"start":{"line":61,"column":4},"end":{"line":61,"column":20}},"25":{"start":{"line":63,"column":4},"end":{"line":63,"column":51}},"26":{"start":{"line":65,"column":4},"end":{"line":67,"column":5}},"27":{"start":{"line":66,"column":8},"end":{"line":66,"column":59}},"28":{"start":{"line":69,"column":4},"end":{"line":69,"column":19}},"29":{"start":{"line":71,"column":4},"end":{"line":82,"column":5}},"30":{"start":{"line":72,"column":8},"end":{"line":79,"column":9}},"31":{"start":{"line":73,"column":12},"end":{"line":78,"column":13}},"32":{"start":{"line":74,"column":16},"end":{"line":74,"column":40}},"33":{"start":{"line":76,"column":16},"end":{"line":76,"column":52}},"34":{"start":{"line":77,"column":16},"end":{"line":77,"column":40}},"35":{"start":{"line":81,"column":8},"end":{"line":81,"column":23}},"36":{"start":{"line":84,"column":4},"end":{"line":84,"column":27}},"37":{"start":{"line":99,"column":0},"end":{"line":142,"column":1}},"38":{"start":{"line":100,"column":4},"end":{"line":100,"column":17}},"39":{"start":{"line":101,"column":4},"end":{"line":101,"column":17}},"40":{"start":{"line":103,"column":4},"end":{"line":127,"column":5}},"41":{"start":{"line":104,"column":8},"end":{"line":104,"column":41}},"42":{"start":{"line":106,"column":8},"end":{"line":106,"column":20}},"43":{"start":{"line":107,"column":8},"end":{"line":107,"column":18}},"44":{"start":{"line":109,"column":8},"end":{"line":116,"column":9}},"45":{"start":{"line":110,"column":12},"end":{"line":110,"column":41}},"46":{"start":{"line":111,"column":12},"end":{"line":111,"column":23}},"47":{"start":{"line":113,"column":12},"end":{"line":115,"column":13}},"48":{"start":{"line":114,"column":16},"end":{"line":114,"column":53}},"49":{"start":{"line":118,"column":8},"end":{"line":120,"column":9}},"50":{"start":{"line":119,"column":12},"end":{"line":119,"column":31}},"51":{"start":{"line":122,"column":8},"end":{"line":122,"column":24}},"52":{"start":{"line":123,"column":8},"end":{"line":126,"column":11}},"53":{"start":{"line":129,"column":4},"end":{"line":129,"column":73}},"54":{"start":{"line":130,"column":4},"end":{"line":130,"column":71}},"55":{"start":{"line":132,"column":4},"end":{"line":136,"column":11}},"56":{"start":{"line":133,"column":8},"end":{"line":133,"column":27}},"57":{"start":{"line":135,"column":12},"end":{"line":135,"column":25}},"58":{"start":{"line":138,"column":4},"end":{"line":141,"column":7}},"59":{"start":{"line":153,"column":0},"end":{"line":169,"column":1}},"60":{"start":{"line":161,"column":4},"end":{"line":166,"column":5}},"61":{"start":{"line":162,"column":8},"end":{"line":165,"column":9}},"62":{"start":{"line":163,"column":12},"end":{"line":163,"column":34}},"63":{"start":{"line":164,"column":12},"end":{"line":164,"column":22}},"64":{"start":{"line":168,"column":4},"end":{"line":168,"column":22}},"65":{"start":{"line":183,"column":0},"end":{"line":204,"column":1}},"66":{"start":{"line":184,"column":4},"end":{"line":184,"column":13}},"67":{"start":{"line":186,"column":4},"end":{"line":192,"column":5}},"68":{"start":{"line":187,"column":8},"end":{"line":187,"column":26}},"69":{"start":{"line":188,"column":11},"end":{"line":192,"column":5}},"70":{"start":{"line":189,"column":8},"end":{"line":189,"column":35}},"71":{"start":{"line":191,"column":8},"end":{"line":191,"column":46}},"72":{"start":{"line":194,"column":4},"end":{"line":194,"column":69}},"73":{"start":{"line":196,"column":4},"end":{"line":203,"column":5}},"74":{"start":{"line":197,"column":8},"end":{"line":199,"column":12}},"75":{"start":{"line":198,"column":12},"end":{"line":198,"column":49}},"76":{"start":{"line":201,"column":8},"end":{"line":201,"column":22}},"77":{"start":{"line":202,"column":8},"end":{"line":202,"column":45}},"78":{"start":{"line":216,"column":0},"end":{"line":226,"column":1}},"79":{"start":{"line":217,"column":4},"end":{"line":217,"column":30}},"80":{"start":{"line":218,"column":4},"end":{"line":218,"column":19}},"81":{"start":{"line":220,"column":4},"end":{"line":223,"column":5}},"82":{"start":{"line":221,"column":8},"end":{"line":221,"column":22}},"83":{"start":{"line":222,"column":8},"end":{"line":222,"column":18}},"84":{"start":{"line":225,"column":4},"end":{"line":225,"column":16}},"85":{"start":{"line":237,"column":0},"end":{"line":371,"column":1}},"86":{"start":{"line":238,"column":4},"end":{"line":238,"column":38}},"87":{"start":{"line":239,"column":4},"end":{"line":239,"column":46}},"88":{"start":{"line":240,"column":4},"end":{"line":240,"column":52}},"89":{"start":{"line":242,"column":4},"end":{"line":242,"column":20}},"90":{"start":{"line":244,"column":4},"end":{"line":244,"column":28}},"91":{"start":{"line":246,"column":4},"end":{"line":246,"column":21}},"92":{"start":{"line":247,"column":4},"end":{"line":247,"column":20}},"93":{"start":{"line":248,"column":4},"end":{"line":248,"column":27}},"94":{"start":{"line":249,"column":4},"end":{"line":249,"column":42}},"95":{"start":{"line":250,"column":4},"end":{"line":250,"column":33}},"96":{"start":{"line":251,"column":4},"end":{"line":251,"column":21}},"97":{"start":{"line":252,"column":4},"end":{"line":252,"column":24}},"98":{"start":{"line":253,"column":4},"end":{"line":253,"column":62}},"99":{"start":{"line":254,"column":4},"end":{"line":254,"column":46}},"100":{"start":{"line":256,"column":4},"end":{"line":256,"column":50}},"101":{"start":{"line":257,"column":4},"end":{"line":257,"column":37}},"102":{"start":{"line":258,"column":4},"end":{"line":258,"column":37}},"103":{"start":{"line":260,"column":4},"end":{"line":264,"column":5}},"104":{"start":{"line":261,"column":8},"end":{"line":261,"column":73}},"105":{"start":{"line":263,"column":8},"end":{"line":263,"column":45}},"106":{"start":{"line":266,"column":4},"end":{"line":289,"column":5}},"107":{"start":{"line":267,"column":8},"end":{"line":267,"column":25}},"108":{"start":{"line":268,"column":8},"end":{"line":268,"column":54}},"109":{"start":{"line":269,"column":11},"end":{"line":289,"column":5}},"110":{"start":{"line":270,"column":8},"end":{"line":270,"column":29}},"111":{"start":{"line":271,"column":8},"end":{"line":271,"column":63}},"112":{"start":{"line":272,"column":8},"end":{"line":272,"column":31}},"113":{"start":{"line":273,"column":8},"end":{"line":273,"column":53}},"114":{"start":{"line":274,"column":8},"end":{"line":274,"column":27}},"115":{"start":{"line":276,"column":8},"end":{"line":284,"column":11}},"116":{"start":{"line":285,"column":11},"end":{"line":289,"column":5}},"117":{"start":{"line":286,"column":8},"end":{"line":286,"column":69}},"118":{"start":{"line":288,"column":8},"end":{"line":288,"column":42}},"119":{"start":{"line":291,"column":4},"end":{"line":291,"column":59}},"120":{"start":{"line":293,"column":4},"end":{"line":295,"column":5}},"121":{"start":{"line":294,"column":8},"end":{"line":294,"column":37}},"122":{"start":{"line":296,"column":4},"end":{"line":298,"column":7}},"123":{"start":{"line":297,"column":8},"end":{"line":297,"column":51}},"124":{"start":{"line":301,"column":4},"end":{"line":313,"column":7}},"125":{"start":{"line":302,"column":8},"end":{"line":305,"column":9}},"126":{"start":{"line":303,"column":12},"end":{"line":303,"column":49}},"127":{"start":{"line":304,"column":12},"end":{"line":304,"column":19}},"128":{"start":{"line":307,"column":8},"end":{"line":309,"column":9}},"129":{"start":{"line":308,"column":12},"end":{"line":308,"column":32}},"130":{"start":{"line":311,"column":8},"end":{"line":311,"column":37}},"131":{"start":{"line":312,"column":8},"end":{"line":312,"column":37}},"132":{"start":{"line":315,"column":4},"end":{"line":322,"column":5}},"133":{"start":{"line":316,"column":8},"end":{"line":321,"column":11}},"134":{"start":{"line":317,"column":12},"end":{"line":317,"column":39}},"135":{"start":{"line":318,"column":12},"end":{"line":318,"column":64}},"136":{"start":{"line":319,"column":12},"end":{"line":319,"column":41}},"137":{"start":{"line":320,"column":12},"end":{"line":320,"column":35}},"138":{"start":{"line":324,"column":4},"end":{"line":333,"column":7}},"139":{"start":{"line":325,"column":8},"end":{"line":325,"column":39}},"140":{"start":{"line":327,"column":8},"end":{"line":329,"column":9}},"141":{"start":{"line":328,"column":12},"end":{"line":328,"column":19}},"142":{"start":{"line":331,"column":8},"end":{"line":331,"column":37}},"143":{"start":{"line":332,"column":8},"end":{"line":332,"column":31}},"144":{"start":{"line":335,"column":4},"end":{"line":337,"column":7}},"145":{"start":{"line":336,"column":8},"end":{"line":336,"column":45}},"146":{"start":{"line":339,"column":4},"end":{"line":342,"column":7}},"147":{"start":{"line":340,"column":8},"end":{"line":340,"column":40}},"148":{"start":{"line":341,"column":8},"end":{"line":341,"column":19}},"149":{"start":{"line":344,"column":4},"end":{"line":370,"column":7}},"150":{"start":{"line":345,"column":8},"end":{"line":347,"column":9}},"151":{"start":{"line":346,"column":12},"end":{"line":346,"column":49}},"152":{"start":{"line":349,"column":8},"end":{"line":349,"column":34}},"153":{"start":{"line":350,"column":8},"end":{"line":350,"column":21}},"154":{"start":{"line":352,"column":8},"end":{"line":358,"column":9}},"155":{"start":{"line":353,"column":12},"end":{"line":353,"column":29}},"156":{"start":{"line":354,"column":15},"end":{"line":358,"column":9}},"157":{"start":{"line":355,"column":12},"end":{"line":355,"column":30}},"158":{"start":{"line":357,"column":12},"end":{"line":357,"column":29}},"159":{"start":{"line":360,"column":8},"end":{"line":367,"column":9}},"160":{"start":{"line":361,"column":12},"end":{"line":362,"column":56}},"161":{"start":{"line":363,"column":12},"end":{"line":363,"column":23}},"162":{"start":{"line":364,"column":12},"end":{"line":364,"column":29}},"163":{"start":{"line":366,"column":12},"end":{"line":366,"column":38}},"164":{"start":{"line":369,"column":8},"end":{"line":369,"column":21}},"165":{"start":{"line":372,"column":0},"end":{"line":372,"column":36}},"166":{"start":{"line":374,"column":0},"end":{"line":374,"column":24}},"167":{"start":{"line":383,"column":0},"end":{"line":385,"column":2}},"168":{"start":{"line":384,"column":4},"end":{"line":384,"column":35}},"169":{"start":{"line":402,"column":0},"end":{"line":405,"column":2}},"170":{"start":{"line":403,"column":4},"end":{"line":403,"column":53}},"171":{"start":{"line":404,"column":4},"end":{"line":404,"column":57}},"172":{"start":{"line":416,"column":0},"end":{"line":426,"column":2}},"173":{"start":{"line":417,"column":4},"end":{"line":419,"column":5}},"174":{"start":{"line":418,"column":8},"end":{"line":418,"column":42}},"175":{"start":{"line":421,"column":4},"end":{"line":423,"column":7}},"176":{"start":{"line":422,"column":8},"end":{"line":422,"column":47}},"177":{"start":{"line":425,"column":4},"end":{"line":425,"column":33}},"178":{"start":{"line":439,"column":0},"end":{"line":514,"column":7}},"179":{"start":{"line":448,"column":8},"end":{"line":513,"column":10}},"180":{"start":{"line":449,"column":12},"end":{"line":457,"column":13}},"181":{"start":{"line":450,"column":16},"end":{"line":452,"column":18}},"182":{"start":{"line":453,"column":19},"end":{"line":457,"column":13}},"183":{"start":{"line":454,"column":16},"end":{"line":454,"column":41}},"184":{"start":{"line":456,"column":16},"end":{"line":456,"column":62}},"185":{"start":{"line":459,"column":12},"end":{"line":461,"column":13}},"186":{"start":{"line":460,"column":16},"end":{"line":460,"column":67}},"187":{"start":{"line":463,"column":12},"end":{"line":463,"column":27}},"188":{"start":{"line":464,"column":12},"end":{"line":464,"column":22}},"189":{"start":{"line":465,"column":12},"end":{"line":465,"column":28}},"190":{"start":{"line":467,"column":12},"end":{"line":471,"column":13}},"191":{"start":{"line":468,"column":16},"end":{"line":468,"column":42}},"192":{"start":{"line":470,"column":16},"end":{"line":470,"column":30}},"193":{"start":{"line":473,"column":12},"end":{"line":475,"column":13}},"194":{"start":{"line":474,"column":16},"end":{"line":474,"column":34}},"195":{"start":{"line":477,"column":12},"end":{"line":479,"column":13}},"196":{"start":{"line":478,"column":16},"end":{"line":478,"column":35}},"197":{"start":{"line":480,"column":12},"end":{"line":480,"column":47}},"198":{"start":{"line":481,"column":12},"end":{"line":481,"column":75}},"199":{"start":{"line":483,"column":12},"end":{"line":485,"column":13}},"200":{"start":{"line":484,"column":16},"end":{"line":484,"column":48}},"201":{"start":{"line":487,"column":12},"end":{"line":501,"column":13}},"202":{"start":{"line":488,"column":16},"end":{"line":488,"column":67}},"203":{"start":{"line":490,"column":16},"end":{"line":492,"column":17}},"204":{"start":{"line":491,"column":20},"end":{"line":491,"column":64}},"205":{"start":{"line":494,"column":16},"end":{"line":494,"column":71}},"206":{"start":{"line":496,"column":16},"end":{"line":498,"column":17}},"207":{"start":{"line":497,"column":20},"end":{"line":497,"column":56}},"208":{"start":{"line":500,"column":16},"end":{"line":500,"column":71}},"209":{"start":{"line":504,"column":12},"end":{"line":506,"column":13}},"210":{"start":{"line":505,"column":16},"end":{"line":505,"column":31}},"211":{"start":{"line":508,"column":12},"end":{"line":508,"column":43}},"212":{"start":{"line":509,"column":12},"end":{"line":509,"column":63}},"213":{"start":{"line":510,"column":12},"end":{"line":510,"column":39}},"214":{"start":{"line":512,"column":12},"end":{"line":512,"column":27}},"215":{"start":{"line":537,"column":0},"end":{"line":547,"column":2}},"216":{"start":{"line":538,"column":4},"end":{"line":544,"column":7}},"217":{"start":{"line":539,"column":8},"end":{"line":543,"column":9}},"218":{"start":{"line":540,"column":12},"end":{"line":540,"column":66}},"219":{"start":{"line":542,"column":12},"end":{"line":542,"column":19}},"220":{"start":{"line":546,"column":4},"end":{"line":546,"column":18}},"221":{"start":{"line":571,"column":0},"end":{"line":596,"column":2}},"222":{"start":{"line":572,"column":4},"end":{"line":574,"column":5}},"223":{"start":{"line":573,"column":8},"end":{"line":573,"column":30}},"224":{"start":{"line":575,"column":4},"end":{"line":575,"column":47}},"225":{"start":{"line":577,"column":4},"end":{"line":581,"column":7}},"226":{"start":{"line":578,"column":8},"end":{"line":580,"column":9}},"227":{"start":{"line":579,"column":12},"end":{"line":579,"column":63}},"228":{"start":{"line":583,"column":4},"end":{"line":593,"column":7}},"229":{"start":{"line":584,"column":8},"end":{"line":584,"column":16}},"230":{"start":{"line":586,"column":8},"end":{"line":592,"column":9}},"231":{"start":{"line":589,"column":12},"end":{"line":589,"column":47}},"232":{"start":{"line":591,"column":12},"end":{"line":591,"column":19}},"233":{"start":{"line":595,"column":4},"end":{"line":595,"column":18}},"234":{"start":{"line":608,"column":0},"end":{"line":616,"column":2}},"235":{"start":{"line":609,"column":4},"end":{"line":609,"column":39}},"236":{"start":{"line":611,"column":4},"end":{"line":613,"column":5}},"237":{"start":{"line":612,"column":8},"end":{"line":612,"column":30}},"238":{"start":{"line":615,"column":4},"end":{"line":615,"column":15}},"239":{"start":{"line":628,"column":0},"end":{"line":636,"column":2}},"240":{"start":{"line":629,"column":4},"end":{"line":629,"column":20}},"241":{"start":{"line":631,"column":4},"end":{"line":633,"column":7}},"242":{"start":{"line":632,"column":8},"end":{"line":632,"column":27}},"243":{"start":{"line":635,"column":4},"end":{"line":635,"column":18}},"244":{"start":{"line":647,"column":0},"end":{"line":655,"column":2}},"245":{"start":{"line":648,"column":4},"end":{"line":648,"column":20}},"246":{"start":{"line":650,"column":4},"end":{"line":652,"column":7}},"247":{"start":{"line":651,"column":8},"end":{"line":651,"column":28}},"248":{"start":{"line":654,"column":4},"end":{"line":654,"column":18}},"249":{"start":{"line":664,"column":0},"end":{"line":694,"column":2}},"250":{"start":{"line":665,"column":4},"end":{"line":665,"column":32}},"251":{"start":{"line":666,"column":4},"end":{"line":666,"column":38}},"252":{"start":{"line":667,"column":4},"end":{"line":667,"column":20}},"253":{"start":{"line":668,"column":4},"end":{"line":668,"column":17}},"254":{"start":{"line":670,"column":4},"end":{"line":676,"column":5}},"255":{"start":{"line":671,"column":8},"end":{"line":673,"column":28}},"256":{"start":{"line":672,"column":12},"end":{"line":672,"column":42}},"257":{"start":{"line":675,"column":8},"end":{"line":675,"column":19}},"258":{"start":{"line":678,"column":4},"end":{"line":678,"column":68}},"259":{"start":{"line":679,"column":4},"end":{"line":679,"column":48}},"260":{"start":{"line":680,"column":4},"end":{"line":680,"column":67}},"261":{"start":{"line":681,"column":4},"end":{"line":681,"column":63}},"262":{"start":{"line":682,"column":4},"end":{"line":682,"column":43}},"263":{"start":{"line":683,"column":4},"end":{"line":686,"column":7}},"264":{"start":{"line":684,"column":8},"end":{"line":684,"column":56}},"265":{"start":{"line":685,"column":8},"end":{"line":685,"column":50}},"266":{"start":{"line":687,"column":4},"end":{"line":687,"column":52}},"267":{"start":{"line":688,"column":4},"end":{"line":688,"column":46}},"268":{"start":{"line":689,"column":4},"end":{"line":691,"column":34}},"269":{"start":{"line":693,"column":4},"end":{"line":693,"column":17}},"270":{"start":{"line":707,"column":0},"end":{"line":733,"column":2}},"271":{"start":{"line":708,"column":4},"end":{"line":708,"column":20}},"272":{"start":{"line":710,"column":4},"end":{"line":722,"column":5}},"273":{"start":{"line":711,"column":8},"end":{"line":721,"column":11}},"274":{"start":{"line":712,"column":12},"end":{"line":712,"column":47}},"275":{"start":{"line":713,"column":12},"end":{"line":713,"column":35}},"276":{"start":{"line":715,"column":12},"end":{"line":715,"column":46}},"277":{"start":{"line":716,"column":12},"end":{"line":716,"column":39}},"278":{"start":{"line":718,"column":12},"end":{"line":720,"column":15}},"279":{"start":{"line":719,"column":16},"end":{"line":719,"column":55}},"280":{"start":{"line":724,"column":4},"end":{"line":732,"column":5}},"281":{"start":{"line":725,"column":8},"end":{"line":729,"column":11}},"282":{"start":{"line":726,"column":12},"end":{"line":728,"column":13}},"283":{"start":{"line":727,"column":16},"end":{"line":727,"column":30}},"284":{"start":{"line":731,"column":8},"end":{"line":731,"column":22}},"285":{"start":{"line":746,"column":0},"end":{"line":782,"column":2}},"286":{"start":{"line":747,"column":4},"end":{"line":747,"column":20}},"287":{"start":{"line":749,"column":4},"end":{"line":781,"column":5}},"288":{"start":{"line":750,"column":8},"end":{"line":750,"column":18}},"289":{"start":{"line":751,"column":8},"end":{"line":751,"column":20}},"290":{"start":{"line":753,"column":8},"end":{"line":772,"column":11}},"291":{"start":{"line":754,"column":12},"end":{"line":754,"column":46}},"292":{"start":{"line":756,"column":12},"end":{"line":771,"column":13}},"293":{"start":{"line":757,"column":16},"end":{"line":761,"column":17}},"294":{"start":{"line":758,"column":20},"end":{"line":758,"column":54}},"295":{"start":{"line":760,"column":20},"end":{"line":760,"column":56}},"296":{"start":{"line":762,"column":19},"end":{"line":771,"column":13}},"297":{"start":{"line":763,"column":16},"end":{"line":763,"column":35}},"298":{"start":{"line":764,"column":16},"end":{"line":764,"column":26}},"299":{"start":{"line":765,"column":16},"end":{"line":765,"column":51}},"300":{"start":{"line":766,"column":19},"end":{"line":771,"column":13}},"301":{"start":{"line":767,"column":16},"end":{"line":767,"column":60}},"302":{"start":{"line":768,"column":16},"end":{"line":768,"column":52}},"303":{"start":{"line":770,"column":16},"end":{"line":770,"column":31}},"304":{"start":{"line":774,"column":8},"end":{"line":780,"column":11}},"305":{"start":{"line":775,"column":12},"end":{"line":779,"column":13}},"306":{"start":{"line":776,"column":16},"end":{"line":776,"column":52}},"307":{"start":{"line":778,"column":16},"end":{"line":778,"column":31}},"308":{"start":{"line":807,"column":0},"end":{"line":972,"column":2}},"309":{"start":{"line":808,"column":4},"end":{"line":808,"column":10}},"310":{"start":{"line":809,"column":4},"end":{"line":809,"column":15}},"311":{"start":{"line":810,"column":4},"end":{"line":810,"column":29}},"312":{"start":{"line":811,"column":4},"end":{"line":811,"column":23}},"313":{"start":{"line":813,"column":4},"end":{"line":819,"column":5}},"314":{"start":{"line":818,"column":8},"end":{"line":818,"column":31}},"315":{"start":{"line":820,"column":4},"end":{"line":820,"column":23}},"316":{"start":{"line":821,"column":4},"end":{"line":821,"column":20}},"317":{"start":{"line":822,"column":4},"end":{"line":822,"column":27}},"318":{"start":{"line":823,"column":4},"end":{"line":823,"column":16}},"319":{"start":{"line":824,"column":4},"end":{"line":824,"column":29}},"320":{"start":{"line":826,"column":4},"end":{"line":828,"column":5}},"321":{"start":{"line":827,"column":8},"end":{"line":827,"column":22}},"322":{"start":{"line":830,"column":4},"end":{"line":938,"column":5}},"323":{"start":{"line":831,"column":8},"end":{"line":831,"column":25}},"324":{"start":{"line":833,"column":8},"end":{"line":883,"column":9}},"325":{"start":{"line":834,"column":12},"end":{"line":882,"column":13}},"326":{"start":{"line":835,"column":16},"end":{"line":835,"column":57}},"327":{"start":{"line":836,"column":16},"end":{"line":837,"column":43}},"328":{"start":{"line":839,"column":16},"end":{"line":847,"column":17}},"329":{"start":{"line":840,"column":20},"end":{"line":843,"column":24}},"330":{"start":{"line":841,"column":24},"end":{"line":841,"column":38}},"331":{"start":{"line":842,"column":24},"end":{"line":842,"column":53}},"332":{"start":{"line":844,"column":20},"end":{"line":844,"column":40}},"333":{"start":{"line":846,"column":20},"end":{"line":846,"column":34}},"334":{"start":{"line":848,"column":16},"end":{"line":848,"column":28}},"335":{"start":{"line":849,"column":19},"end":{"line":882,"column":13}},"336":{"start":{"line":850,"column":16},"end":{"line":858,"column":17}},"337":{"start":{"line":851,"column":20},"end":{"line":851,"column":56}},"338":{"start":{"line":852,"column":20},"end":{"line":855,"column":37}},"339":{"start":{"line":856,"column":20},"end":{"line":856,"column":33}},"340":{"start":{"line":857,"column":20},"end":{"line":857,"column":35}},"341":{"start":{"line":861,"column":16},"end":{"line":881,"column":19}},"342":{"start":{"line":862,"column":20},"end":{"line":862,"column":51}},"343":{"start":{"line":863,"column":20},"end":{"line":863,"column":39}},"344":{"start":{"line":865,"column":20},"end":{"line":865,"column":51}},"345":{"start":{"line":867,"column":20},"end":{"line":869,"column":21}},"346":{"start":{"line":868,"column":24},"end":{"line":868,"column":55}},"347":{"start":{"line":871,"column":20},"end":{"line":871,"column":60}},"348":{"start":{"line":872,"column":20},"end":{"line":872,"column":55}},"349":{"start":{"line":874,"column":20},"end":{"line":874,"column":52}},"350":{"start":{"line":877,"column":20},"end":{"line":879,"column":21}},"351":{"start":{"line":878,"column":24},"end":{"line":878,"column":57}},"352":{"start":{"line":880,"column":20},"end":{"line":880,"column":55}},"353":{"start":{"line":885,"column":8},"end":{"line":887,"column":9}},"354":{"start":{"line":886,"column":12},"end":{"line":886,"column":24}},"355":{"start":{"line":890,"column":8},"end":{"line":892,"column":9}},"356":{"start":{"line":891,"column":12},"end":{"line":891,"column":45}},"357":{"start":{"line":895,"column":8},"end":{"line":913,"column":9}},"358":{"start":{"line":896,"column":12},"end":{"line":898,"column":13}},"359":{"start":{"line":897,"column":16},"end":{"line":897,"column":32}},"360":{"start":{"line":900,"column":12},"end":{"line":902,"column":13}},"361":{"start":{"line":901,"column":16},"end":{"line":901,"column":62}},"362":{"start":{"line":904,"column":12},"end":{"line":904,"column":70}},"363":{"start":{"line":905,"column":12},"end":{"line":906,"column":64}},"364":{"start":{"line":907,"column":12},"end":{"line":907,"column":46}},"365":{"start":{"line":908,"column":12},"end":{"line":908,"column":47}},"366":{"start":{"line":910,"column":12},"end":{"line":910,"column":31}},"367":{"start":{"line":911,"column":12},"end":{"line":911,"column":35}},"368":{"start":{"line":912,"column":12},"end":{"line":912,"column":54}},"369":{"start":{"line":915,"column":8},"end":{"line":923,"column":11}},"370":{"start":{"line":916,"column":12},"end":{"line":922,"column":15}},"371":{"start":{"line":925,"column":8},"end":{"line":929,"column":9}},"372":{"start":{"line":926,"column":12},"end":{"line":926,"column":43}},"373":{"start":{"line":928,"column":12},"end":{"line":928,"column":47}},"374":{"start":{"line":933,"column":8},"end":{"line":937,"column":9}},"375":{"start":{"line":934,"column":12},"end":{"line":934,"column":41}},"376":{"start":{"line":936,"column":12},"end":{"line":936,"column":26}},"377":{"start":{"line":940,"column":4},"end":{"line":940,"column":24}},"378":{"start":{"line":941,"column":4},"end":{"line":941,"column":29}},"379":{"start":{"line":943,"column":4},"end":{"line":952,"column":7}},"380":{"start":{"line":944,"column":8},"end":{"line":951,"column":11}},"381":{"start":{"line":954,"column":4},"end":{"line":957,"column":5}},"382":{"start":{"line":955,"column":8},"end":{"line":955,"column":13}},"383":{"start":{"line":956,"column":8},"end":{"line":956,"column":15}},"384":{"start":{"line":960,"column":4},"end":{"line":960,"column":24}},"385":{"start":{"line":961,"column":4},"end":{"line":961,"column":15}},"386":{"start":{"line":962,"column":4},"end":{"line":962,"column":15}},"387":{"start":{"line":963,"column":4},"end":{"line":970,"column":7}},"388":{"start":{"line":964,"column":8},"end":{"line":969,"column":9}},"389":{"start":{"line":965,"column":12},"end":{"line":965,"column":35}},"390":{"start":{"line":967,"column":12},"end":{"line":967,"column":55}},"391":{"start":{"line":968,"column":12},"end":{"line":968,"column":65}},"392":{"start":{"line":971,"column":4},"end":{"line":971,"column":14}},"393":{"start":{"line":983,"column":0},"end":{"line":993,"column":2}},"394":{"start":{"line":984,"column":4},"end":{"line":984,"column":33}},"395":{"start":{"line":985,"column":4},"end":{"line":985,"column":39}},"396":{"start":{"line":986,"column":4},"end":{"line":986,"column":31}},"397":{"start":{"line":988,"column":4},"end":{"line":988,"column":37}},"398":{"start":{"line":989,"column":4},"end":{"line":989,"column":37}},"399":{"start":{"line":990,"column":4},"end":{"line":990,"column":18}},"400":{"start":{"line":991,"column":4},"end":{"line":991,"column":31}},"401":{"start":{"line":992,"column":4},"end":{"line":992,"column":72}}},"branchMap":{"1":{"line":65,"type":"if","locations":[{"start":{"line":65,"column":4},"end":{"line":65,"column":4}},{"start":{"line":65,"column":4},"end":{"line":65,"column":4}}]},"2":{"line":73,"type":"if","locations":[{"start":{"line":73,"column":12},"end":{"line":73,"column":12}},{"start":{"line":73,"column":12},"end":{"line":73,"column":12}}]},"3":{"line":109,"type":"if","locations":[{"start":{"line":109,"column":8},"end":{"line":109,"column":8}},{"start":{"line":109,"column":8},"end":{"line":109,"column":8}}]},"4":{"line":113,"type":"if","locations":[{"start":{"line":113,"column":12},"end":{"line":113,"column":12}},{"start":{"line":113,"column":12},"end":{"line":113,"column":12}}]},"5":{"line":118,"type":"if","locations":[{"start":{"line":118,"column":8},"end":{"line":118,"column":8}},{"start":{"line":118,"column":8},"end":{"line":118,"column":8}}]},"6":{"line":130,"type":"binary-expr","locations":[{"start":{"line":130,"column":16},"end":{"line":130,"column":19}},{"start":{"line":130,"column":23},"end":{"line":130,"column":25}}]},"7":{"line":130,"type":"binary-expr","locations":[{"start":{"line":130,"column":59},"end":{"line":130,"column":62}},{"start":{"line":130,"column":66},"end":{"line":130,"column":68}}]},"8":{"line":162,"type":"if","locations":[{"start":{"line":162,"column":8},"end":{"line":162,"column":8}},{"start":{"line":162,"column":8},"end":{"line":162,"column":8}}]},"9":{"line":186,"type":"if","locations":[{"start":{"line":186,"column":4},"end":{"line":186,"column":4}},{"start":{"line":186,"column":4},"end":{"line":186,"column":4}}]},"10":{"line":188,"type":"if","locations":[{"start":{"line":188,"column":11},"end":{"line":188,"column":11}},{"start":{"line":188,"column":11},"end":{"line":188,"column":11}}]},"11":{"line":196,"type":"if","locations":[{"start":{"line":196,"column":4},"end":{"line":196,"column":4}},{"start":{"line":196,"column":4},"end":{"line":196,"column":4}}]},"12":{"line":220,"type":"if","locations":[{"start":{"line":220,"column":4},"end":{"line":220,"column":4}},{"start":{"line":220,"column":4},"end":{"line":220,"column":4}}]},"13":{"line":220,"type":"binary-expr","locations":[{"start":{"line":220,"column":8},"end":{"line":220,"column":20}},{"start":{"line":220,"column":24},"end":{"line":220,"column":48}},{"start":{"line":220,"column":52},"end":{"line":220,"column":67}}]},"14":{"line":249,"type":"binary-expr","locations":[{"start":{"line":249,"column":16},"end":{"line":249,"column":28}},{"start":{"line":249,"column":32},"end":{"line":249,"column":41}}]},"15":{"line":253,"type":"binary-expr","locations":[{"start":{"line":253,"column":20},"end":{"line":253,"column":36}},{"start":{"line":253,"column":40},"end":{"line":253,"column":55}},{"start":{"line":253,"column":59},"end":{"line":253,"column":61}}]},"16":{"line":254,"type":"binary-expr","locations":[{"start":{"line":254,"column":20},"end":{"line":254,"column":36}},{"start":{"line":254,"column":40},"end":{"line":254,"column":45}}]},"17":{"line":260,"type":"if","locations":[{"start":{"line":260,"column":4},"end":{"line":260,"column":4}},{"start":{"line":260,"column":4},"end":{"line":260,"column":4}}]},"18":{"line":266,"type":"if","locations":[{"start":{"line":266,"column":4},"end":{"line":266,"column":4}},{"start":{"line":266,"column":4},"end":{"line":266,"column":4}}]},"19":{"line":269,"type":"if","locations":[{"start":{"line":269,"column":11},"end":{"line":269,"column":11}},{"start":{"line":269,"column":11},"end":{"line":269,"column":11}}]},"20":{"line":269,"type":"binary-expr","locations":[{"start":{"line":269,"column":16},"end":{"line":269,"column":28}},{"start":{"line":269,"column":32},"end":{"line":269,"column":51}},{"start":{"line":269,"column":56},"end":{"line":269,"column":67}}]},"21":{"line":271,"type":"binary-expr","locations":[{"start":{"line":271,"column":27},"end":{"line":271,"column":46}},{"start":{"line":271,"column":50},"end":{"line":271,"column":62}}]},"22":{"line":273,"type":"binary-expr","locations":[{"start":{"line":273,"column":26},"end":{"line":273,"column":44}},{"start":{"line":273,"column":48},"end":{"line":273,"column":52}}]},"23":{"line":285,"type":"if","locations":[{"start":{"line":285,"column":11},"end":{"line":285,"column":11}},{"start":{"line":285,"column":11},"end":{"line":285,"column":11}}]},"24":{"line":293,"type":"if","locations":[{"start":{"line":293,"column":4},"end":{"line":293,"column":4}},{"start":{"line":293,"column":4},"end":{"line":293,"column":4}}]},"25":{"line":293,"type":"binary-expr","locations":[{"start":{"line":293,"column":8},"end":{"line":293,"column":31}},{"start":{"line":293,"column":35},"end":{"line":293,"column":73}}]},"26":{"line":302,"type":"if","locations":[{"start":{"line":302,"column":8},"end":{"line":302,"column":8}},{"start":{"line":302,"column":8},"end":{"line":302,"column":8}}]},"27":{"line":307,"type":"if","locations":[{"start":{"line":307,"column":8},"end":{"line":307,"column":8}},{"start":{"line":307,"column":8},"end":{"line":307,"column":8}}]},"28":{"line":315,"type":"if","locations":[{"start":{"line":315,"column":4},"end":{"line":315,"column":4}},{"start":{"line":315,"column":4},"end":{"line":315,"column":4}}]},"29":{"line":327,"type":"if","locations":[{"start":{"line":327,"column":8},"end":{"line":327,"column":8}},{"start":{"line":327,"column":8},"end":{"line":327,"column":8}}]},"30":{"line":327,"type":"binary-expr","locations":[{"start":{"line":327,"column":12},"end":{"line":327,"column":28}},{"start":{"line":327,"column":32},"end":{"line":327,"column":65}}]},"31":{"line":345,"type":"if","locations":[{"start":{"line":345,"column":8},"end":{"line":345,"column":8}},{"start":{"line":345,"column":8},"end":{"line":345,"column":8}}]},"32":{"line":352,"type":"if","locations":[{"start":{"line":352,"column":8},"end":{"line":352,"column":8}},{"start":{"line":352,"column":8},"end":{"line":352,"column":8}}]},"33":{"line":354,"type":"if","locations":[{"start":{"line":354,"column":15},"end":{"line":354,"column":15}},{"start":{"line":354,"column":15},"end":{"line":354,"column":15}}]},"34":{"line":360,"type":"if","locations":[{"start":{"line":360,"column":8},"end":{"line":360,"column":8}},{"start":{"line":360,"column":8},"end":{"line":360,"column":8}}]},"35":{"line":361,"type":"cond-expr","locations":[{"start":{"line":362,"column":16},"end":{"line":362,"column":40}},{"start":{"line":362,"column":43},"end":{"line":362,"column":55}}]},"36":{"line":417,"type":"if","locations":[{"start":{"line":417,"column":4},"end":{"line":417,"column":4}},{"start":{"line":417,"column":4},"end":{"line":417,"column":4}}]},"37":{"line":422,"type":"cond-expr","locations":[{"start":{"line":422,"column":27},"end":{"line":422,"column":37}},{"start":{"line":422,"column":40},"end":{"line":422,"column":45}}]},"38":{"line":449,"type":"if","locations":[{"start":{"line":449,"column":12},"end":{"line":449,"column":12}},{"start":{"line":449,"column":12},"end":{"line":449,"column":12}}]},"39":{"line":449,"type":"binary-expr","locations":[{"start":{"line":449,"column":16},"end":{"line":449,"column":38}},{"start":{"line":449,"column":42},"end":{"line":449,"column":68}}]},"40":{"line":453,"type":"if","locations":[{"start":{"line":453,"column":19},"end":{"line":453,"column":19}},{"start":{"line":453,"column":19},"end":{"line":453,"column":19}}]},"41":{"line":459,"type":"if","locations":[{"start":{"line":459,"column":12},"end":{"line":459,"column":12}},{"start":{"line":459,"column":12},"end":{"line":459,"column":12}}]},"42":{"line":473,"type":"if","locations":[{"start":{"line":473,"column":12},"end":{"line":473,"column":12}},{"start":{"line":473,"column":12},"end":{"line":473,"column":12}}]},"43":{"line":477,"type":"if","locations":[{"start":{"line":477,"column":12},"end":{"line":477,"column":12}},{"start":{"line":477,"column":12},"end":{"line":477,"column":12}}]},"44":{"line":481,"type":"binary-expr","locations":[{"start":{"line":481,"column":28},"end":{"line":481,"column":41}},{"start":{"line":481,"column":45},"end":{"line":481,"column":57}},{"start":{"line":481,"column":61},"end":{"line":481,"column":74}}]},"45":{"line":483,"type":"if","locations":[{"start":{"line":483,"column":12},"end":{"line":483,"column":12}},{"start":{"line":483,"column":12},"end":{"line":483,"column":12}}]},"46":{"line":487,"type":"if","locations":[{"start":{"line":487,"column":12},"end":{"line":487,"column":12}},{"start":{"line":487,"column":12},"end":{"line":487,"column":12}}]},"47":{"line":488,"type":"binary-expr","locations":[{"start":{"line":488,"column":44},"end":{"line":488,"column":53}},{"start":{"line":488,"column":57},"end":{"line":488,"column":65}}]},"48":{"line":490,"type":"if","locations":[{"start":{"line":490,"column":16},"end":{"line":490,"column":16}},{"start":{"line":490,"column":16},"end":{"line":490,"column":16}}]},"49":{"line":496,"type":"if","locations":[{"start":{"line":496,"column":16},"end":{"line":496,"column":16}},{"start":{"line":496,"column":16},"end":{"line":496,"column":16}}]},"50":{"line":504,"type":"if","locations":[{"start":{"line":504,"column":12},"end":{"line":504,"column":12}},{"start":{"line":504,"column":12},"end":{"line":504,"column":12}}]},"51":{"line":539,"type":"if","locations":[{"start":{"line":539,"column":8},"end":{"line":539,"column":8}},{"start":{"line":539,"column":8},"end":{"line":539,"column":8}}]},"52":{"line":539,"type":"binary-expr","locations":[{"start":{"line":539,"column":12},"end":{"line":539,"column":22}},{"start":{"line":539,"column":26},"end":{"line":539,"column":42}}]},"53":{"line":572,"type":"if","locations":[{"start":{"line":572,"column":4},"end":{"line":572,"column":4}},{"start":{"line":572,"column":4},"end":{"line":572,"column":4}}]},"54":{"line":578,"type":"if","locations":[{"start":{"line":578,"column":8},"end":{"line":578,"column":8}},{"start":{"line":578,"column":8},"end":{"line":578,"column":8}}]},"55":{"line":586,"type":"if","locations":[{"start":{"line":586,"column":8},"end":{"line":586,"column":8}},{"start":{"line":586,"column":8},"end":{"line":586,"column":8}}]},"56":{"line":586,"type":"binary-expr","locations":[{"start":{"line":586,"column":12},"end":{"line":586,"column":33}},{"start":{"line":587,"column":13},"end":{"line":588,"column":39}}]},"57":{"line":587,"type":"binary-expr","locations":[{"start":{"line":587,"column":19},"end":{"line":588,"column":30}},{"start":{"line":588,"column":34},"end":{"line":588,"column":39}}]},"58":{"line":611,"type":"if","locations":[{"start":{"line":611,"column":4},"end":{"line":611,"column":4}},{"start":{"line":611,"column":4},"end":{"line":611,"column":4}}]},"59":{"line":611,"type":"binary-expr","locations":[{"start":{"line":611,"column":8},"end":{"line":611,"column":9}},{"start":{"line":611,"column":13},"end":{"line":611,"column":27}}]},"60":{"line":631,"type":"binary-expr","locations":[{"start":{"line":631,"column":5},"end":{"line":631,"column":32}},{"start":{"line":631,"column":36},"end":{"line":631,"column":38}}]},"61":{"line":672,"type":"binary-expr","locations":[{"start":{"line":672,"column":20},"end":{"line":672,"column":26}},{"start":{"line":672,"column":30},"end":{"line":672,"column":40}}]},"62":{"line":689,"type":"cond-expr","locations":[{"start":{"line":690,"column":19},"end":{"line":690,"column":39}},{"start":{"line":691,"column":19},"end":{"line":691,"column":32}}]},"63":{"line":715,"type":"cond-expr","locations":[{"start":{"line":715,"column":28},"end":{"line":715,"column":38}},{"start":{"line":715,"column":41},"end":{"line":715,"column":45}}]},"64":{"line":724,"type":"if","locations":[{"start":{"line":724,"column":4},"end":{"line":724,"column":4}},{"start":{"line":724,"column":4},"end":{"line":724,"column":4}}]},"65":{"line":726,"type":"if","locations":[{"start":{"line":726,"column":12},"end":{"line":726,"column":12}},{"start":{"line":726,"column":12},"end":{"line":726,"column":12}}]},"66":{"line":749,"type":"if","locations":[{"start":{"line":749,"column":4},"end":{"line":749,"column":4}},{"start":{"line":749,"column":4},"end":{"line":749,"column":4}}]},"67":{"line":754,"type":"cond-expr","locations":[{"start":{"line":754,"column":28},"end":{"line":754,"column":38}},{"start":{"line":754,"column":41},"end":{"line":754,"column":45}}]},"68":{"line":756,"type":"if","locations":[{"start":{"line":756,"column":12},"end":{"line":756,"column":12}},{"start":{"line":756,"column":12},"end":{"line":756,"column":12}}]},"69":{"line":757,"type":"if","locations":[{"start":{"line":757,"column":16},"end":{"line":757,"column":16}},{"start":{"line":757,"column":16},"end":{"line":757,"column":16}}]},"70":{"line":762,"type":"if","locations":[{"start":{"line":762,"column":19},"end":{"line":762,"column":19}},{"start":{"line":762,"column":19},"end":{"line":762,"column":19}}]},"71":{"line":766,"type":"if","locations":[{"start":{"line":766,"column":19},"end":{"line":766,"column":19}},{"start":{"line":766,"column":19},"end":{"line":766,"column":19}}]},"72":{"line":766,"type":"binary-expr","locations":[{"start":{"line":766,"column":23},"end":{"line":766,"column":25}},{"start":{"line":766,"column":29},"end":{"line":766,"column":44}}]},"73":{"line":775,"type":"if","locations":[{"start":{"line":775,"column":12},"end":{"line":775,"column":12}},{"start":{"line":775,"column":12},"end":{"line":775,"column":12}}]},"74":{"line":813,"type":"if","locations":[{"start":{"line":813,"column":4},"end":{"line":813,"column":4}},{"start":{"line":813,"column":4},"end":{"line":813,"column":4}}]},"75":{"line":826,"type":"if","locations":[{"start":{"line":826,"column":4},"end":{"line":826,"column":4}},{"start":{"line":826,"column":4},"end":{"line":826,"column":4}}]},"76":{"line":833,"type":"if","locations":[{"start":{"line":833,"column":8},"end":{"line":833,"column":8}},{"start":{"line":833,"column":8},"end":{"line":833,"column":8}}]},"77":{"line":834,"type":"if","locations":[{"start":{"line":834,"column":12},"end":{"line":834,"column":12}},{"start":{"line":834,"column":12},"end":{"line":834,"column":12}}]},"78":{"line":837,"type":"binary-expr","locations":[{"start":{"line":837,"column":21},"end":{"line":837,"column":29}},{"start":{"line":837,"column":33},"end":{"line":837,"column":40}}]},"79":{"line":839,"type":"if","locations":[{"start":{"line":839,"column":16},"end":{"line":839,"column":16}},{"start":{"line":839,"column":16},"end":{"line":839,"column":16}}]},"80":{"line":842,"type":"cond-expr","locations":[{"start":{"line":842,"column":37},"end":{"line":842,"column":44}},{"start":{"line":842,"column":47},"end":{"line":842,"column":51}}]},"81":{"line":849,"type":"if","locations":[{"start":{"line":849,"column":19},"end":{"line":849,"column":19}},{"start":{"line":849,"column":19},"end":{"line":849,"column":19}}]},"82":{"line":850,"type":"if","locations":[{"start":{"line":850,"column":16},"end":{"line":850,"column":16}},{"start":{"line":850,"column":16},"end":{"line":850,"column":16}}]},"83":{"line":871,"type":"binary-expr","locations":[{"start":{"line":871,"column":34},"end":{"line":871,"column":53}},{"start":{"line":871,"column":57},"end":{"line":871,"column":59}}]},"84":{"line":877,"type":"if","locations":[{"start":{"line":877,"column":20},"end":{"line":877,"column":20}},{"start":{"line":877,"column":20},"end":{"line":877,"column":20}}]},"85":{"line":877,"type":"binary-expr","locations":[{"start":{"line":877,"column":24},"end":{"line":877,"column":35}},{"start":{"line":877,"column":39},"end":{"line":877,"column":47}},{"start":{"line":877,"column":51},"end":{"line":877,"column":66}}]},"86":{"line":885,"type":"if","locations":[{"start":{"line":885,"column":8},"end":{"line":885,"column":8}},{"start":{"line":885,"column":8},"end":{"line":885,"column":8}}]},"87":{"line":890,"type":"if","locations":[{"start":{"line":890,"column":8},"end":{"line":890,"column":8}},{"start":{"line":890,"column":8},"end":{"line":890,"column":8}}]},"88":{"line":890,"type":"binary-expr","locations":[{"start":{"line":890,"column":12},"end":{"line":890,"column":23}},{"start":{"line":890,"column":27},"end":{"line":890,"column":35}},{"start":{"line":890,"column":39},"end":{"line":890,"column":54}}]},"89":{"line":895,"type":"if","locations":[{"start":{"line":895,"column":8},"end":{"line":895,"column":8}},{"start":{"line":895,"column":8},"end":{"line":895,"column":8}}]},"90":{"line":895,"type":"binary-expr","locations":[{"start":{"line":895,"column":12},"end":{"line":895,"column":17}},{"start":{"line":895,"column":21},"end":{"line":895,"column":31}}]},"91":{"line":896,"type":"if","locations":[{"start":{"line":896,"column":12},"end":{"line":896,"column":12}},{"start":{"line":896,"column":12},"end":{"line":896,"column":12}}]},"92":{"line":900,"type":"if","locations":[{"start":{"line":900,"column":12},"end":{"line":900,"column":12}},{"start":{"line":900,"column":12},"end":{"line":900,"column":12}}]},"93":{"line":901,"type":"binary-expr","locations":[{"start":{"line":901,"column":40},"end":{"line":901,"column":53}},{"start":{"line":901,"column":57},"end":{"line":901,"column":60}}]},"94":{"line":904,"type":"cond-expr","locations":[{"start":{"line":904,"column":50},"end":{"line":904,"column":60}},{"start":{"line":904,"column":63},"end":{"line":904,"column":68}}]},"95":{"line":905,"type":"binary-expr","locations":[{"start":{"line":905,"column":27},"end":{"line":905,"column":40}},{"start":{"line":906,"column":28},"end":{"line":906,"column":61}}]},"96":{"line":918,"type":"cond-expr","locations":[{"start":{"line":918,"column":33},"end":{"line":918,"column":43}},{"start":{"line":918,"column":46},"end":{"line":918,"column":51}}]},"97":{"line":920,"type":"binary-expr","locations":[{"start":{"line":920,"column":16},"end":{"line":920,"column":30}},{"start":{"line":920,"column":34},"end":{"line":920,"column":37}}]},"98":{"line":925,"type":"if","locations":[{"start":{"line":925,"column":8},"end":{"line":925,"column":8}},{"start":{"line":925,"column":8},"end":{"line":925,"column":8}}]},"99":{"line":933,"type":"if","locations":[{"start":{"line":933,"column":8},"end":{"line":933,"column":8}},{"start":{"line":933,"column":8},"end":{"line":933,"column":8}}]},"100":{"line":934,"type":"cond-expr","locations":[{"start":{"line":934,"column":25},"end":{"line":934,"column":32}},{"start":{"line":934,"column":35},"end":{"line":934,"column":39}}]},"101":{"line":946,"type":"cond-expr","locations":[{"start":{"line":946,"column":29},"end":{"line":946,"column":39}},{"start":{"line":946,"column":42},"end":{"line":946,"column":47}}]},"102":{"line":954,"type":"if","locations":[{"start":{"line":954,"column":4},"end":{"line":954,"column":4}},{"start":{"line":954,"column":4},"end":{"line":954,"column":4}}]},"103":{"line":964,"type":"if","locations":[{"start":{"line":964,"column":8},"end":{"line":964,"column":8}},{"start":{"line":964,"column":8},"end":{"line":964,"column":8}}]}},"code":["// Copyright 2012 Mark Cavage, Inc.  All rights reserved.","","'use strict';","","var domain = require('domain');","var EventEmitter = require('events').EventEmitter;","var http = require('http');","var https = require('https');","var util = require('util');","","var assert = require('assert-plus');","var mime = require('mime');","var once = require('once');","var spdy = require('spdy');","var uuid = require('node-uuid');","","var dtrace = require('./dtrace');","var errors = require('./errors');","var formatters = require('./formatters');","var shallowCopy = require('./utils').shallowCopy;","var upgrade = require('./upgrade');","","var semver = require('semver');","var maxSatisfying = semver.maxSatisfying;","","// Ensure these are loaded","require('./request');","require('./response');","","","///--- Globals","","var sprintf = util.format;","","var ResourceNotFoundError = errors.ResourceNotFoundError;","","var PROXY_EVENTS = [","    'clientError',","    'close',","    'connection',","    'error',","    'listening',","    'secureConnection'","];","","","///--- Helpers","","/**"," * helper function to help verify and flatten an array of arrays."," * takes an arguments object and an index frmo which to slice, then"," * merges that into a single array."," * @private"," * @function argumentsToChain"," * @throws   {TypeError}"," * @param    {Object} args  pass through of funcs from server.[method]"," * @param    {Number} start index of args at which to start working with"," * @returns  {Array}"," */","function argumentsToChain(args, start) {","    assert.ok(args);","","    args = Array.prototype.slice.call(args, start);","","    if (args.length < 0) {","        throw new TypeError('handler (function) required');","    }","","    var chain = [];","","    function process(handlers) {","        for (var i = 0; i < handlers.length; i++) {","            if (Array.isArray(handlers[i])) {","                process(handlers[i], 0);","            } else {","                assert.func(handlers[i], 'handler');","                chain.push(handlers[i]);","            }","        }","","        return (chain);","    }","","    return (process(args));","}","","/**"," * merge optional formatters with the default formatters to create a single"," * formatters object. the passed in optional formatters object looks like:"," * formatters: {"," *   'application/foo': function formatFoo(req, res, body) {...}"," * }"," * @private"," * @function mergeFormatters"," * @param    {Object} fmt user specified formatters object"," * @returns  {Object}"," */","","function mergeFormatters(fmt) {","    var arr = [];","    var obj = {};","","    function addFormatter(src, k) {","        assert.func(src[k], 'formatter');","","        var q = 1.0; // RFC 2616 sec14 - The default value is q=1","        var t = k;","","        if (k.indexOf(';') !== -1) {","            var tmp = k.split(/\\s*;\\s*/);","            t = tmp[0];","","            if (tmp[1].indexOf('q=') !== -1) {","                q = parseFloat(tmp[1].split('=')[1]);","            }","        }","","        if (k.indexOf('/') === -1) {","            k = mime.lookup(k);","        }","","        obj[t] = src[k];","        arr.push({","            q: q,","            t: t","        });","    }","","    Object.keys(formatters).forEach(addFormatter.bind(this, formatters));","    Object.keys(fmt || {}).forEach(addFormatter.bind(this, fmt || {}));","","    arr = arr.sort(function (a, b) {","        return (b.q - a.q);","    }).map(function (a) {","            return (a.t);","        });","","    return ({","        formatters: obj,","        acceptable: arr","    });","}","","","/**"," * attaches ifError function attached to the `next` function in handler chain."," * uses a closure to maintain ref to next."," * @private"," * @function ifError"," * @param    {Function} n the next function"," * @returns  {Function}"," */","function ifError(n) {","    /**","     * @throws   will throw if an error is passed in.","     * @private","     * @function _ifError","     * @param    {Object} err an error object","     * @returns  {undefined}","     */","    function _ifError(err) {","        if (err) {","            err._restify_next = n;","            throw err;","        }","    }","","    return (_ifError);","}","","","/**"," * when an error occurrs, this is used to emit an error to consumers"," * via EventEmitter."," * @private"," * @function emitRouteError"," * @param    {Object} server the server object"," * @param    {Object} req    the request object"," * @param    {Object} res    the response object"," * @param    {Object} err    an error object"," * @returns  {undefined}"," */","function emitRouteError(server, req, res, err) {","    var name;","","    if (err.name === 'ResourceNotFoundError') {","        name = 'NotFound';","    } else if (err.name === 'InvalidVersionError') {","        name = 'VersionNotAllowed';","    } else {","        name = err.name.replace(/Error$/, '');","    }","","    req.log.trace({name: name, err: err}, 'entering emitRouteError');","","    if (server.listeners(name).length > 0) {","        server.emit(name, req, res, err, once(function () {","            server.emit('after', req, res, null);","        }));","    } else {","        res.send(err);","        server.emit('after', req, res, null);","    }","}","","","/**"," * returns true if an error generated is for an options request."," * @private"," * @function optionsError"," * @param    {Object}     err an error object"," * @param    {Object}     req the request object"," * @param    {Object}     res the response object"," * @returns  {Boolean}"," */","function optionsError(err, req, res) {","    var code = err.statusCode;","    var ok = false;","","    if (code === 404 && req.method === 'OPTIONS' && req.url === '*') {","        res.send(200);","        ok = true;","    }","","    return (ok);","}","","","///--- API","","/**"," * Creates a new Server."," * @public"," * @class"," * @param {Object} options an options object"," */","function Server(options) {","    assert.object(options, 'options');","    assert.object(options.log, 'options.log');","    assert.object(options.router, 'options.router');","","    var self = this;","","    EventEmitter.call(this);","","    this.before = [];","    this.chain = [];","    this.log = options.log;","    this.name = options.name || 'restify';","    this.router = options.router;","    this.routes = {};","    this.secure = false;","    this.versions = options.versions || options.version || [];","    this.socketio = options.socketio || false;","","    var fmt = mergeFormatters(options.formatters);","    this.acceptable = fmt.acceptable;","    this.formatters = fmt.formatters;","","    if (options.hasOwnProperty('handleUncaughtExceptions')) {","        this.handleUncaughtExceptions = options.handleUncaughtExceptions;","    } else {","        this.handleUncaughtExceptions = true;","    }","","    if (options.spdy) {","        this.spdy = true;","        this.server = spdy.createServer(options.spdy);","    } else if ((options.cert || options.certificate) && options.key) {","        this.ca = options.ca;","        this.certificate = options.certificate || options.cert;","        this.key = options.key;","        this.passphrase = options.passphrase || null;","        this.secure = true;","","        this.server = https.createServer({","            ca: self.ca,","            cert: self.certificate,","            key: self.key,","            passphrase: self.passphrase,","            rejectUnauthorized: options.rejectUnauthorized,","            requestCert: options.requestCert,","            ciphers: options.ciphers","        });","    } else if (options.httpsServerOptions) {","        this.server = https.createServer(options.httpsServerOptions);","    } else {","        this.server = http.createServer();","    }","","    this.router.on('mount', this.emit.bind(this, 'mount'));","","    if (!options.handleUpgrades && PROXY_EVENTS.indexOf('upgrade') === -1) {","        PROXY_EVENTS.push('upgrade');","    }","    PROXY_EVENTS.forEach(function (e) {","        self.server.on(e, self.emit.bind(self, e));","    });","","    // Now the things we can't blindly proxy","    this.server.on('checkContinue', function onCheckContinue(req, res) {","        if (self.listeners('checkContinue').length > 0) {","            self.emit('checkContinue', req, res);","            return;","        }","","        if (!options.noWriteContinue) {","            res.writeContinue();","        }","","        self._setupRequest(req, res);","        self._handle(req, res, true);","    });","","    if (options.handleUpgrades) {","        this.server.on('upgrade', function onUpgrade(req, socket, head) {","            req._upgradeRequest = true;","            var res = upgrade.createResponse(req, socket, head);","            self._setupRequest(req, res);","            self._handle(req, res);","        });","    }","","    this.server.on('request', function onRequest(req, res) {","        self.emit('request', req, res);","","        if (options.socketio && (/^\\/socket\\.io.*/).test(req.url)) {","            return;","        }","","        self._setupRequest(req, res);","        self._handle(req, res);","    });","","    this.__defineGetter__('maxHeadersCount', function () {","        return (self.server.maxHeadersCount);","    });","","    this.__defineSetter__('maxHeadersCount', function (c) {","        self.server.maxHeadersCount = c;","        return (c);","    });","","    this.__defineGetter__('url', function () {","        if (self.socketPath) {","            return ('http://' + self.socketPath);","        }","","        var addr = self.address();","        var str = '';","","        if (self.spdy) {","            str += 'spdy://';","        } else if (self.secure) {","            str += 'https://';","        } else {","            str += 'http://';","        }","","        if (addr) {","            str += addr.family === 'IPv6' ?","                '[' + addr.address + ']' : addr.address;","            str += ':';","            str += addr.port;","        } else {","            str += '169.254.0.1:0000';","        }","","        return (str);","    });","}","util.inherits(Server, EventEmitter);","","module.exports = Server;","","","/**"," * Returns the server address. Wraps node's address()."," * @public"," * @function address"," * @returns  {String}"," */","Server.prototype.address = function address() {","    return (this.server.address());","};","","","/**"," * Gets the server up and listening. Wraps node's listen()."," *"," * You can call like:"," *  server.listen(80)"," *  server.listen(80, '127.0.0.1')"," *  server.listen('/tmp/server.sock')"," *"," * @public"," * @function listen"," * @throws   {TypeError}"," * @param    {Function}  callback optionally get notified when listening."," * @returns  {undefined}"," */","Server.prototype.listen = function listen() {","    var args = Array.prototype.slice.call(arguments);","    return (this.server.listen.apply(this.server, args));","};","","","/**"," * Shuts down this server, and invokes callback (optionally) when done."," * Wraps node's close()."," * @public"," * @function close"," * @param    {Function}  callback optional callback to invoke when done."," * @returns  {undefined}"," */","Server.prototype.close = function close(callback) {","    if (callback) {","        assert.func(callback, 'callback');","    }","","    this.server.once('close', function onClose() {","        return (callback ? callback() : false);","    });","","    return (this.server.close());","};","","","// Register all the routing methods","/**"," * Mounts a chain on the given path against this HTTP verb"," *"," * @public"," * @function del, get, head, opts, post, put, patch"," * @param   {String | Object} opts if string, the URL to handle."," *                                 if options, the URL to handle, at minimum."," * @returns {Route}                the newly created route."," */","[","    'del',","    'get',","    'head',","    'opts',","    'post',","    'put',","    'patch'","].forEach(function (method) {","        Server.prototype[method] = function (opts) {","            if (opts instanceof RegExp || typeof (opts) === 'string') {","                opts = {","                    path: opts","                };","            } else if (typeof (opts) === 'object') {","                opts = shallowCopy(opts);","            } else {","                throw new TypeError('path (string) required');","            }","","            if (arguments.length < 2) {","                throw new TypeError('handler (function) required');","            }","","            var chain = [];","            var route;","            var self = this;","","            function addHandler(h) {","                assert.func(h, 'handler');","","                chain.push(h);","            }","","            if (method === 'del') {","                method = 'DELETE';","            }","","            if (method === 'opts') {","                method = 'OPTIONS';","            }","            opts.method = method.toUpperCase();","            opts.versions = opts.versions || opts.version || self.versions;","","            if (!Array.isArray(opts.versions)) {","                opts.versions = [opts.versions];","            }","","            if (!opts.name) {","                opts.name = method + '-' + (opts.path || opts.url);","","                if (opts.versions.length > 0) {","                    opts.name += '-' + opts.versions.join('--');","                }","","                opts.name = opts.name.replace(/\\W/g, '').toLowerCase();","","                if (this.router.mounts[opts.name]) { // GH-401","                    opts.name += uuid.v4().substr(0, 7);","                }","            } else {","                opts.name = opts.name.replace(/\\W/g, '').toLowerCase();","            }","","","            if (!(route = this.router.mount(opts))) {","                return (false);","            }","","            this.chain.forEach(addHandler);","            argumentsToChain(arguments, 1).forEach(addHandler);","            this.routes[route] = chain;","","            return (route);","        };","    });","","","/**"," * Minimal port of the functionality offered by Express.js Route Param"," * Pre-conditions"," * @link http://expressjs.com/guide.html#route-param%20pre-conditions"," *"," * This basically piggy-backs on the `server.use` method. It attaches a"," * new middleware function that only fires if the specified parameter exists"," * in req.params"," *"," * Exposes an API:"," *   server.param(\"user\", function (req, res, next) {"," *     // load the user's information here, always making sure to call next()"," *   });"," *"," * @public"," * @function param"," * @param    {String}   name The name of the URL param to respond to"," * @param    {Function} fn   The middleware function to execute"," * @returns  {Object}        returns self"," */","Server.prototype.param = function param(name, fn) {","    this.use(function _param(req, res, next) {","        if (req.params && req.params[name]) {","            fn.call(this, req, res, next, req.params[name], name);","        } else {","            next();","        }","    });","","    return (this);","};","","","/**"," * Piggy-backs on the `server.use` method. It attaches a new middleware"," * function that only fires if the specified version matchtes the request."," *"," * Note that if the client does not request a specific version, the middleware"," * function always fires. If you don't want this set a default version with a"," * pre handler on requests where the client omits one."," *"," * Exposes an API:"," *   server.versionedUse(\"version\", function (req, res, next, ver) {"," *     // do stuff that only applies to routes of this API version"," *   });"," *"," * @public"," * @function versionedUse"," * @param    {String|Array} versions the version(s) the URL to respond to"," * @param    {Function}     fn       the middleware function to execute, the"," *                                   fourth parameter will be the selected"," *                                   version"," * @returns  {undefined}"," */","Server.prototype.versionedUse = function versionedUse(versions, fn) {","    if (!Array.isArray(versions)) {","        versions = [versions];","    }","    assert.arrayOfString(versions, 'versions');","","    versions.forEach(function (v) {","        if (!semver.valid(v)) {","            throw new TypeError('%s is not a valid semver', v);","        }","    });","","    this.use(function _versionedUse(req, res, next) {","        var ver;","","        if (req.version() === '*' ||","            (ver = maxSatisfying(versions,","                req.version()) || false)) {","            fn.call(this, req, res, next, ver);","        } else {","            next();","        }","    });","","    return (this);","};","","","/**"," * Removes a route from the server."," * You pass in the route 'blob' you got from a mount call."," * @public"," * @function rm"," * @throws   {TypeError} on bad input."," * @param    {String}    route the route name."," * @returns  {Boolean}         true if route was removed, false if not."," */","Server.prototype.rm = function rm(route) {","    var r = this.router.unmount(route);","","    if (r && this.routes[r]) {","        delete this.routes[r];","    }","","    return (r);","};","","","/**"," * Installs a list of handlers to run _before_ the \"normal\" handlers of all"," * routes."," *"," * You can pass in any combination of functions or array of functions."," * @public"," * @function use"," * @returns {Object} returns self"," */","Server.prototype.use = function use() {","    var self = this;","","    (argumentsToChain(arguments) || []).forEach(function (h) {","        self.chain.push(h);","    });","","    return (this);","};","","","/**"," * Gives you hooks to run _before_ any routes are located.  This gives you"," * a chance to intercept the request and change headers, etc., that routing"," * depends on.  Note that req.params will _not_ be set yet."," * @public"," * @function pre"," * @returns {Object} returns self"," */","Server.prototype.pre = function pre() {","    var self = this;","","    argumentsToChain(arguments).forEach(function (h) {","        self.before.push(h);","    });","","    return (this);","};","","","/**"," * toString() the server for easy reading/output."," * @public"," * @function toString"," * @returns  {String}"," */","Server.prototype.toString = function toString() {","    var LINE_FMT = '\\t%s: %s\\n';","    var SUB_LINE_FMT = '\\t\\t%s: %s\\n';","    var self = this;","    var str = '';","","    function handlersToString(arr) {","        var s = '[' + arr.map(function (b) {","            return (b.name || 'function');","        }).join(', ') + ']';","","        return (s);","    }","","    str += sprintf(LINE_FMT, 'Accepts', this.acceptable.join(', '));","    str += sprintf(LINE_FMT, 'Name', this.name);","    str += sprintf(LINE_FMT, 'Pre', handlersToString(this.before));","    str += sprintf(LINE_FMT, 'Router', this.router.toString());","    str += sprintf(LINE_FMT, 'Routes', '');","    Object.keys(this.routes).forEach(function (k) {","        var handlers = handlersToString(self.routes[k]);","        str += sprintf(SUB_LINE_FMT, k, handlers);","    });","    str += sprintf(LINE_FMT, 'Secure', this.secure);","    str += sprintf(LINE_FMT, 'Url', this.url);","    str += sprintf(LINE_FMT, 'Version', Array.isArray(this.versions) ?","                   this.versions.join() :","                   this.versions);","","    return (str);","};","","","///--- Private methods","","/**"," * upon receivng a request, route the request, then run the chain of handlers."," * @private"," * @function _handle"," * @param    {Object} req the request object"," * @param    {Object} res the response object"," * @returns  {undefined}"," */","Server.prototype._handle = function _handle(req, res) {","    var self = this;","","    function routeAndRun() {","        self._route(req, res, function (route, context) {","            req.context = req.params = context;","            req.route = route.spec;","","            var r = route ? route.name : null;","            var chain = self.routes[r];","","            self._run(req, res, route, chain, function done(e) {","                self.emit('after', req, res, route, e);","            });","        });","    }","","    if (this.before.length > 0) {","        this._run(req, res, null, this.before, function (err) {","            if (!err) {","                routeAndRun();","            }","        });","    } else {","        routeAndRun();","    }","};","","","/**"," * look into the router, find the route object that should match this request."," * @private"," * @function _route"," * @param    {Object}    req    the request object"," * @param    {Object}    res    the response object"," * @param    {String}    [name] name of the route"," * @param    {Function}  cb     callback function"," * @returns  {undefined}"," */","Server.prototype._route = function _route(req, res, name, cb) {","    var self = this;","","    if (typeof (name) === 'function') {","        cb = name;","        name = null;","","        this.router.find(req, res, function onRoute(err, route, ctx) {","            var r = route ? route.name : null;","","            if (err) {","                if (optionsError(err, req, res)) {","                    self.emit('after', req, res, err);","                } else {","                    emitRouteError(self, req, res, err);","                }","            } else if (r === 'preflight') {","                res.writeHead(200);","                res.end();","                self.emit('after', req, res, null);","            } else if (!r || !self.routes[r]) {","                err = new ResourceNotFoundError(req.path());","                emitRouteError(self, res, res, err);","            } else {","                cb(route, ctx);","            }","        });","    } else {","        this.router.get(name, req, function (err, route, ctx) {","            if (err) {","                emitRouteError(self, req, res, err);","            } else {","                cb(route, ctx);","            }","        });","    }","};","","","/*"," * The goofy checks in next() are to make sure we fire the DTrace"," * probes after an error might have been sent, as in a handler"," * return next(new Error) is basically shorthand for sending an"," * error via res.send(), so we do that before firing the dtrace"," * probe (namely so the status codes get updated in the"," * response)."," *"," * Callers can stop the chain from proceding if they do"," * return next(false); This is useful for non-errors, but where"," * a response was sent and you don't want the chain to keep"," * going."," *"," * @private"," * @function _run"," * @param    {Object}    req   the request object"," * @param    {Object}    res   the response object"," * @param    {Object}    route the route object"," * @param    {Array}     chain array of handler functions"," * @param    {Function}  cb    callback function"," * @returns  {undefined}"," */","Server.prototype._run = function _run(req, res, route, chain, cb) {","    var d;","    var i = -1;","    var id = dtrace.nextId();","    req._dtraceId = id;","","    if (!req._anonFuncCount) {","        // Counter used to keep track of anonymous functions. Used when a","        // handler function is anonymous. This ensures we're using a","        // monotonically increasing int for anonymous handlers through out the","        // the lifetime of this request","        req._anonFuncCount = 0;","    }","    var log = this.log;","    var self = this;","    var handlerName = null;","    var errName;","    var emittedError = false;","","    if (cb) {","        cb = once(cb);","    }","","    function next(arg) {","        var done = false;","","        if (arg) {","            if (arg instanceof Error) {","                errName = arg.name.replace(/Error$/, '');","                log.trace({err: arg, errName: errName}, 'next(err=%s)',","                    (arg.name || 'Error'));","","                if (self.listeners(errName).length > 0) {","                    self.emit(errName, req, res, arg, once(function () {","                        res.send(arg);","                        return (cb ? cb(arg) : true);","                    }));","                    emittedError = true;","                } else {","                    res.send(arg);","                }","                done = true;","            } else if (typeof (arg) === 'string') { // GH-193, allow redirect","                if (req._rstfy_chained_route) {","                    var _e = new errors.InternalError();","                    log.error({","                        err: _e","                    }, 'Multiple next(\"chain\") calls not ' +","                        'supported');","                    res.send(_e);","                    return (false);","                }","","                // Stop running the rest of this route since we're redirecting","                return self._route(req, res, arg, function (r, ctx) {","                    req.context = req.params = ctx;","                    req.route = r.spec;","","                    var _c = chain.slice(0, i + 1);","","                    function _uniq(fn) {","                        return (_c.indexOf(fn) === -1);","                    }","","                    var _routes = self.routes[r.name] || [];","                    var _chain = _routes.filter(_uniq);","","                    req._rstfy_chained_route = true;","","                    // Need to fire DTrace done for previous handler here too.","                    if ((i + 1) > 0 && chain[i] && !chain[i]._skip) {","                        req.endHandlerTimer(handlerName);","                    }","                    self._run(req, res, r, _chain, cb);","                });","            }","        }","","        if (arg === false) {","            done = true;","        }","","        // Fire DTrace done for the previous handler.","        if ((i + 1) > 0 && chain[i] && !chain[i]._skip) {","            req.endHandlerTimer(handlerName);","        }","","        // Run the next handler up","        if (!done && chain[++i]) {","            if (chain[i]._skip) {","                return (next());","            }","","            if (log.trace()) {","                log.trace('running %s', chain[i].name || '?');","            }","","            req._currentRoute = (route !== null ? route.name : 'pre');","            handlerName = (chain[i].name ||","                           ('handler-' + req._anonFuncCount++));","            req._currentHandler = handlerName;","            req.startHandlerTimer(handlerName);","","            var n = once(next);","            n.ifError = ifError(n);","            return (chain[i].call(self, req, res, n));","        }","","        dtrace._rstfy_probes['route-done'].fire(function () {","            return ([","                self.name,","                route !== null ? route.name : 'pre',","                id,","                res.statusCode || 200,","                res.headers()","            ]);","        });","","        if (route === null) {","            self.emit('preDone', req, res);","        } else {","            self.emit('done', req, res, route);","        }","","        // Don't return cb here if we emit an error since we will cb after the","        // handler fires.","        if (!emittedError) {","            return (cb ? cb(arg) : true);","        } else {","            return (true);","        }","    }","","    var n1 = once(next);","    n1.ifError = ifError(n1);","","    dtrace._rstfy_probes['route-start'].fire(function () {","        return ([","            self.name,","            route !== null ? route.name : 'pre',","            id,","            req.method,","            req.href(),","            req.headers","        ]);","    });","","    if (!self.handleUncaughtExceptions) {","        n1();","        return;","    }","","    // Add the uncaughtException error handler.","    d = domain.create();","    d.add(req);","    d.add(res);","    d.on('error', function onError(err) {","        if (err._restify_next) {","            err._restify_next(err);","        } else {","            log.trace({err: err}, 'uncaughtException');","            self.emit('uncaughtException', req, res, route, err);","        }","    });","    d.run(n1);","};","","","/**"," * set up the request by before routing and executing handler chain."," * @private"," * @function _setupRequest"," * @param    {Object}    req the request object"," * @param    {Object}    res the response object"," * @returns  {undefined}"," */","Server.prototype._setupRequest = function _setupRequest(req, res) {","    req.log = res.log = this.log;","    req._time = res._time = Date.now();","    req.serverName = this.name;","","    res.acceptable = this.acceptable;","    res.formatters = this.formatters;","    res.req = req;","    res.serverName = this.name;","    res.version = this.router.versions[this.router.versions.length - 1];","};",""],"l":{"5":1,"6":1,"7":1,"8":1,"9":1,"11":1,"12":1,"13":1,"14":1,"15":1,"17":1,"18":1,"19":1,"20":1,"21":1,"23":1,"24":1,"27":1,"28":1,"33":1,"35":1,"37":1,"60":1,"61":0,"63":0,"65":0,"66":0,"69":0,"71":1,"72":0,"73":0,"74":0,"76":0,"77":0,"81":0,"84":0,"99":1,"100":0,"101":0,"103":1,"104":0,"106":0,"107":0,"109":0,"110":0,"111":0,"113":0,"114":0,"118":0,"119":0,"122":0,"123":0,"129":0,"130":0,"132":0,"133":0,"135":0,"138":0,"153":1,"161":1,"162":0,"163":0,"164":0,"168":0,"183":1,"184":0,"186":0,"187":0,"188":0,"189":0,"191":0,"194":0,"196":0,"197":0,"198":0,"201":0,"202":0,"216":1,"217":0,"218":0,"220":0,"221":0,"222":0,"225":0,"237":1,"238":0,"239":0,"240":0,"242":0,"244":0,"246":0,"247":0,"248":0,"249":0,"250":0,"251":0,"252":0,"253":0,"254":0,"256":0,"257":0,"258":0,"260":0,"261":0,"263":0,"266":0,"267":0,"268":0,"269":0,"270":0,"271":0,"272":0,"273":0,"274":0,"276":0,"285":0,"286":0,"288":0,"291":0,"293":0,"294":0,"296":0,"297":0,"301":0,"302":0,"303":0,"304":0,"307":0,"308":0,"311":0,"312":0,"315":0,"316":0,"317":0,"318":0,"319":0,"320":0,"324":0,"325":0,"327":0,"328":0,"331":0,"332":0,"335":0,"336":0,"339":0,"340":0,"341":0,"344":0,"345":0,"346":0,"349":0,"350":0,"352":0,"353":0,"354":0,"355":0,"357":0,"360":0,"361":0,"363":0,"364":0,"366":0,"369":0,"372":1,"374":1,"383":1,"384":0,"402":1,"403":0,"404":0,"416":1,"417":0,"418":0,"421":0,"422":0,"425":0,"439":1,"448":7,"449":0,"450":0,"453":0,"454":0,"456":0,"459":0,"460":0,"463":0,"464":0,"465":0,"467":1,"468":0,"470":0,"473":0,"474":0,"477":0,"478":0,"480":0,"481":0,"483":0,"484":0,"487":0,"488":0,"490":0,"491":0,"494":0,"496":0,"497":0,"500":0,"504":0,"505":0,"508":0,"509":0,"510":0,"512":0,"537":1,"538":0,"539":0,"540":0,"542":0,"546":0,"571":1,"572":0,"573":0,"575":0,"577":0,"578":0,"579":0,"583":0,"584":0,"586":0,"589":0,"591":0,"595":0,"608":1,"609":0,"611":0,"612":0,"615":0,"628":1,"629":0,"631":0,"632":0,"635":0,"647":1,"648":0,"650":0,"651":0,"654":0,"664":1,"665":0,"666":0,"667":0,"668":0,"670":1,"671":0,"672":0,"675":0,"678":0,"679":0,"680":0,"681":0,"682":0,"683":0,"684":0,"685":0,"687":0,"688":0,"689":0,"693":0,"707":1,"708":0,"710":1,"711":0,"712":0,"713":0,"715":0,"716":0,"718":0,"719":0,"724":0,"725":0,"726":0,"727":0,"731":0,"746":1,"747":0,"749":0,"750":0,"751":0,"753":0,"754":0,"756":0,"757":0,"758":0,"760":0,"762":0,"763":0,"764":0,"765":0,"766":0,"767":0,"768":0,"770":0,"774":0,"775":0,"776":0,"778":0,"807":1,"808":0,"809":0,"810":0,"811":0,"813":0,"818":0,"820":0,"821":0,"822":0,"823":0,"824":0,"826":0,"827":0,"830":1,"831":0,"833":0,"834":0,"835":0,"836":0,"839":0,"840":0,"841":0,"842":0,"844":0,"846":0,"848":0,"849":0,"850":0,"851":0,"852":0,"856":0,"857":0,"861":0,"862":0,"863":0,"865":0,"867":1,"868":0,"871":0,"872":0,"874":0,"877":0,"878":0,"880":0,"885":0,"886":0,"890":0,"891":0,"895":0,"896":0,"897":0,"900":0,"901":0,"904":0,"905":0,"907":0,"908":0,"910":0,"911":0,"912":0,"915":0,"916":0,"925":0,"926":0,"928":0,"933":0,"934":0,"936":0,"940":0,"941":0,"943":0,"944":0,"954":0,"955":0,"956":0,"960":0,"961":0,"962":0,"963":0,"964":0,"965":0,"967":0,"968":0,"971":0,"983":1,"984":0,"985":0,"986":0,"988":0,"989":0,"990":0,"991":0,"992":0}},"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/upgrade.js":{"path":"/home/travis/build/npmtest/node-npmtest-restify/node_modules/restify/lib/upgrade.js","s":{"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":1,"10":1,"11":0,"12":1,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":1,"22":1,"23":14,"24":12,"25":0,"26":2,"27":0,"28":1,"29":1,"30":14,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":0,"43":0,"44":0,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":1,"56":0,"57":0,"58":0,"59":1,"60":0,"61":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":1,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":1},"b":{"1":[0,0],"2":[12,2],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"f":{"1":0,"2":0,"3":0,"4":14,"5":0,"6":0,"7":14,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"fnMap":{"1":{"name":"InvalidUpgradeStateError","line":15,"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":39}}},"2":{"name":"createServerUpgradeResponse","line":59,"loc":{"start":{"line":59,"column":0},"end":{"line":59,"column":56}}},"3":{"name":"ServerUpgradeResponse","line":72,"loc":{"start":{"line":72,"column":0},"end":{"line":72,"column":45}}},"4":{"name":"notImplemented","line":100,"loc":{"start":{"line":100,"column":0},"end":{"line":100,"column":32}}},"5":{"name":"(anonymous_5)","line":102,"loc":{"start":{"line":102,"column":15},"end":{"line":102,"column":27}}},"6":{"name":"(anonymous_6)","line":106,"loc":{"start":{"line":106,"column":15},"end":{"line":106,"column":27}}},"7":{"name":"(anonymous_7)","line":131,"loc":{"start":{"line":131,"column":24},"end":{"line":131,"column":42}}},"8":{"name":"_writeHeadImpl","line":145,"loc":{"start":{"line":145,"column":4},"end":{"line":145,"column":48}}},"9":{"name":"status","line":175,"loc":{"start":{"line":175,"column":41},"end":{"line":175,"column":63}}},"10":{"name":"send","line":190,"loc":{"start":{"line":190,"column":39},"end":{"line":190,"column":65}}},"11":{"name":"end","line":217,"loc":{"start":{"line":217,"column":38},"end":{"line":217,"column":53}}},"12":{"name":"write","line":230,"loc":{"start":{"line":230,"column":40},"end":{"line":230,"column":57}}},"13":{"name":"writeHead","line":245,"loc":{"start":{"line":245,"column":4},"end":{"line":245,"column":43}}},"14":{"name":"claimUpgrade","line":269,"loc":{"start":{"line":269,"column":47},"end":{"line":269,"column":71}}}},"statementMap":{"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":50}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}},"4":{"start":{"line":15,"column":0},"end":{"line":22,"column":1}},"5":{"start":{"line":16,"column":4},"end":{"line":18,"column":5}},"6":{"start":{"line":17,"column":8},"end":{"line":17,"column":64}},"7":{"start":{"line":20,"column":4},"end":{"line":20,"column":23}},"8":{"start":{"line":21,"column":4},"end":{"line":21,"column":43}},"9":{"start":{"line":23,"column":0},"end":{"line":23,"column":47}},"10":{"start":{"line":59,"column":0},"end":{"line":61,"column":1}},"11":{"start":{"line":60,"column":4},"end":{"line":60,"column":53}},"12":{"start":{"line":72,"column":0},"end":{"line":88,"column":1}},"13":{"start":{"line":73,"column":4},"end":{"line":73,"column":36}},"14":{"start":{"line":74,"column":4},"end":{"line":74,"column":32}},"15":{"start":{"line":76,"column":4},"end":{"line":76,"column":28}},"16":{"start":{"line":78,"column":4},"end":{"line":78,"column":25}},"17":{"start":{"line":79,"column":4},"end":{"line":79,"column":26}},"18":{"start":{"line":81,"column":4},"end":{"line":84,"column":6}},"19":{"start":{"line":86,"column":4},"end":{"line":86,"column":30}},"20":{"start":{"line":87,"column":4},"end":{"line":87,"column":33}},"21":{"start":{"line":89,"column":0},"end":{"line":89,"column":51}},"22":{"start":{"line":100,"column":0},"end":{"line":111,"column":1}},"23":{"start":{"line":101,"column":4},"end":{"line":110,"column":5}},"24":{"start":{"line":102,"column":8},"end":{"line":104,"column":10}},"25":{"start":{"line":103,"column":12},"end":{"line":103,"column":36}},"26":{"start":{"line":106,"column":8},"end":{"line":109,"column":10}},"27":{"start":{"line":107,"column":12},"end":{"line":108,"column":33}},"28":{"start":{"line":113,"column":0},"end":{"line":128,"column":2}},"29":{"start":{"line":131,"column":0},"end":{"line":133,"column":3}},"30":{"start":{"line":132,"column":4},"end":{"line":132,"column":74}},"31":{"start":{"line":144,"column":0},"end":{"line":165,"column":6}},"32":{"start":{"line":146,"column":8},"end":{"line":148,"column":9}},"33":{"start":{"line":147,"column":12},"end":{"line":147,"column":19}},"34":{"start":{"line":149,"column":8},"end":{"line":149,"column":33}},"35":{"start":{"line":151,"column":8},"end":{"line":153,"column":9}},"36":{"start":{"line":152,"column":12},"end":{"line":152,"column":75}},"37":{"start":{"line":155,"column":8},"end":{"line":158,"column":10}},"38":{"start":{"line":160,"column":8},"end":{"line":162,"column":9}},"39":{"start":{"line":161,"column":12},"end":{"line":161,"column":59}},"40":{"start":{"line":164,"column":8},"end":{"line":164,"column":63}},"41":{"start":{"line":175,"column":0},"end":{"line":179,"column":2}},"42":{"start":{"line":176,"column":4},"end":{"line":176,"column":32}},"43":{"start":{"line":177,"column":4},"end":{"line":177,"column":27}},"44":{"start":{"line":178,"column":4},"end":{"line":178,"column":18}},"45":{"start":{"line":190,"column":0},"end":{"line":208,"column":2}},"46":{"start":{"line":191,"column":4},"end":{"line":195,"column":5}},"47":{"start":{"line":192,"column":8},"end":{"line":192,"column":31}},"48":{"start":{"line":194,"column":8},"end":{"line":194,"column":20}},"49":{"start":{"line":197,"column":4},"end":{"line":205,"column":5}},"50":{"start":{"line":198,"column":8},"end":{"line":200,"column":9}},"51":{"start":{"line":199,"column":12},"end":{"line":199,"column":46}},"52":{"start":{"line":202,"column":8},"end":{"line":204,"column":9}},"53":{"start":{"line":203,"column":12},"end":{"line":203,"column":45}},"54":{"start":{"line":207,"column":4},"end":{"line":207,"column":24}},"55":{"start":{"line":217,"column":0},"end":{"line":221,"column":2}},"56":{"start":{"line":218,"column":4},"end":{"line":218,"column":68}},"57":{"start":{"line":219,"column":4},"end":{"line":219,"column":37}},"58":{"start":{"line":220,"column":4},"end":{"line":220,"column":18}},"59":{"start":{"line":230,"column":0},"end":{"line":233,"column":2}},"60":{"start":{"line":231,"column":4},"end":{"line":231,"column":68}},"61":{"start":{"line":232,"column":4},"end":{"line":232,"column":18}},"62":{"start":{"line":244,"column":0},"end":{"line":260,"column":6}},"63":{"start":{"line":246,"column":8},"end":{"line":246,"column":48}},"64":{"start":{"line":247,"column":8},"end":{"line":247,"column":48}},"65":{"start":{"line":249,"column":8},"end":{"line":249,"column":37}},"66":{"start":{"line":251,"column":8},"end":{"line":253,"column":9}},"67":{"start":{"line":252,"column":12},"end":{"line":252,"column":47}},"68":{"start":{"line":255,"column":8},"end":{"line":257,"column":9}},"69":{"start":{"line":256,"column":12},"end":{"line":256,"column":53}},"70":{"start":{"line":259,"column":8},"end":{"line":259,"column":57}},"71":{"start":{"line":269,"column":0},"end":{"line":281,"column":2}},"72":{"start":{"line":270,"column":4},"end":{"line":272,"column":5}},"73":{"start":{"line":271,"column":8},"end":{"line":271,"column":71}},"74":{"start":{"line":274,"column":4},"end":{"line":276,"column":5}},"75":{"start":{"line":275,"column":8},"end":{"line":275,"column":71}},"76":{"start":{"line":278,"column":4},"end":{"line":278,"column":32}},"77":{"start":{"line":280,"column":4},"end":{"line":280,"column":27}},"78":{"start":{"line":284,"column":0},"end":{"line":287,"column":2}}},"branchMap":{"1":{"line":16,"type":"if","locations":[{"start":{"line":16,"column":4},"end":{"line":16,"column":4}},{"start":{"line":16,"column":4},"end":{"line":16,"column":4}}]},"2":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":4},"end":{"line":101,"column":4}},{"start":{"line":101,"column":4},"end":{"line":101,"column":4}}]},"3":{"line":146,"type":"if","locations":[{"start":{"line":146,"column":8},"end":{"line":146,"column":8}},{"start":{"line":146,"column":8},"end":{"line":146,"column":8}}]},"4":{"line":151,"type":"if","locations":[{"start":{"line":151,"column":8},"end":{"line":151,"column":8}},{"start":{"line":151,"column":8},"end":{"line":151,"column":8}}]},"5":{"line":160,"type":"if","locations":[{"start":{"line":160,"column":8},"end":{"line":160,"column":8}},{"start":{"line":160,"column":8},"end":{"line":160,"column":8}}]},"6":{"line":191,"type":"if","locations":[{"start":{"line":191,"column":4},"end":{"line":191,"column":4}},{"start":{"line":191,"column":4},"end":{"line":191,"column":4}}]},"7":{"line":197,"type":"if","locations":[{"start":{"line":197,"column":4},"end":{"line":197,"column":4}},{"start":{"line":197,"column":4},"end":{"line":197,"column":4}}]},"8":{"line":198,"type":"if","locations":[{"start":{"line":198,"column":8},"end":{"line":198,"column":8}},{"start":{"line":198,"column":8},"end":{"line":198,"column":8}}]},"9":{"line":202,"type":"if","locations":[{"start":{"line":202,"column":8},"end":{"line":202,"column":8}},{"start":{"line":202,"column":8},"end":{"line":202,"column":8}}]},"10":{"line":251,"type":"if","locations":[{"start":{"line":251,"column":8},"end":{"line":251,"column":8}},{"start":{"line":251,"column":8},"end":{"line":251,"column":8}}]},"11":{"line":255,"type":"if","locations":[{"start":{"line":255,"column":8},"end":{"line":255,"column":8}},{"start":{"line":255,"column":8},"end":{"line":255,"column":8}}]},"12":{"line":270,"type":"if","locations":[{"start":{"line":270,"column":4},"end":{"line":270,"column":4}},{"start":{"line":270,"column":4},"end":{"line":270,"column":4}}]},"13":{"line":274,"type":"if","locations":[{"start":{"line":274,"column":4},"end":{"line":274,"column":4}},{"start":{"line":274,"column":4},"end":{"line":274,"column":4}}]}},"code":["// Copyright (c) 2013, Joyent, Inc. All rights reserved.","","'use strict';","","var EventEmitter = require('events').EventEmitter;","var util = require('util');","var assert = require('assert-plus');","","/**"," * an custom error for capturing an invalid upgrade state."," * @public"," * @class"," * @param {String} msg an error message"," */","function InvalidUpgradeStateError(msg) {","    if (Error.captureStackTrace) {","        Error.captureStackTrace(this, InvalidUpgradeStateError);","    }","","    this.message = msg;","    this.name = 'InvalidUpgradeStateError';","}","util.inherits(InvalidUpgradeStateError, Error);","","//","// The Node HTTP Server will, if we handle the 'upgrade' event, swallow any","// Request with the 'Connection: upgrade' header set.  While doing this it","// detaches from the 'data' events on the Socket and passes the socket to","// us, so that we may take over handling for the connection.","//","// Unfortunately, the API does not presently provide a http.ServerResponse","// for us to use in the event that we do not wish to upgrade the connection.","// This factory method provides a skeletal implementation of a","// restify-compatible response that is sufficient to allow the existing","// request handling path to work, while allowing us to perform _at most_ one","// of either:","//","//   - Return a basic HTTP Response with a provided Status Code and","//     close the socket.","//   - Upgrade the connection and stop further processing.","//","// To determine if an upgrade is requested, a route handler would check for","// the 'claimUpgrade' method on the Response.  The object this method","// returns will have the 'socket' and 'head' Buffer emitted with the","// 'upgrade' event by the http.Server.  If the upgrade is not possible, such","// as when the HTTP head (or a full request) has already been sent by some","// other handler, this method will throw.","//","","/**"," * create a new upgraded response."," * @public"," * @function createServerUpgradeResponse"," * @param    {Object} req    the request object"," * @param    {Object} socket the network socket"," * @param    {Object} head   a buffer, the first packet of the upgraded stream"," * @returns  {Object}        an upgraded reponses"," */","function createServerUpgradeResponse(req, socket, head) {","    return (new ServerUpgradeResponse(socket, head));","}","","","/**"," * upgrade the http response"," * @private"," * @class"," * @param   {Object}    socket the network socket"," * @param   {Object}    head   a buffer, the first packet of the upgraded stream"," * @returns {undefined}"," */","function ServerUpgradeResponse(socket, head) {","    assert.object(socket, 'socket');","    assert.buffer(head, 'head');","","    EventEmitter.call(this);","","    this.sendDate = true;","    this.statusCode = 400;","","    this._upgrade = {","        socket: socket,","        head: head","    };","","    this._headWritten = false;","    this._upgradeClaimed = false;","}","util.inherits(ServerUpgradeResponse, EventEmitter);","","","/**"," * a function generator for all programatically attaching methods on to"," * the ServerUpgradeResponse class."," * @private"," * @function notImplemented"," * @param    {Object}   method an object containing configuration"," * @returns  {Function}"," */","function notImplemented(method) {","    if (!method.throws) {","        return function () {","            return (method.returns);","        };","    } else {","        return function () {","            throw (new Error('Method ' + method.name + ' is not ' +","                'implemented!'));","        };","    }","}","","var NOT_IMPLEMENTED = [","    { name: 'writeContinue', throws: true },","    { name: 'setHeader', throws: false, returns: null },","    { name: 'getHeader', throws: false, returns: null },","    { name: 'getHeaders', throws: false, returns: {} },","    { name: 'removeHeader', throws: false, returns: null },","    { name: 'addTrailer', throws: false, returns: null },","    { name: 'cache', throws: false, returns: 'public' },","    { name: 'format', throws: true },","    { name: 'set', throws: false, returns: null },","    { name: 'get', throws: false, returns: null },","    { name: 'headers', throws: false, returns: {} },","    { name: 'header', throws: false, returns: null },","    { name: 'json', throws: false, returns: null },","    { name: 'link', throws: false, returns: null }","];","","// programatically add a bunch of methods to the ServerUpgradeResponse proto","NOT_IMPLEMENTED.forEach(function (method) {","    ServerUpgradeResponse.prototype[method.name] = notImplemented(method);","});","","","/**"," * internal implementation of writeHead"," * @private"," * @function _writeHeadImpl"," * @param   {Number} statusCode the http status code"," * @param   {String} reason     a message"," * @returns {undefined}"," */","ServerUpgradeResponse.prototype._writeHeadImpl =","    function _writeHeadImpl(statusCode, reason) {","        if (this._headWritten) {","            return;","        }","        this._headWritten = true;","","        if (this._upgradeClaimed) {","            throw new InvalidUpgradeStateError('Upgrade already claimed!');","        }","","        var head = [","            'HTTP/1.1 ' + statusCode + ' ' + reason,","            'Connection: close'","        ];","","        if (this.sendDate) {","            head.push('Date: ' + new Date().toUTCString());","        }","","        this._upgrade.socket.write(head.join('\\r\\n') + '\\r\\n');","    };","","","/**"," * set the status code of the response"," * @public"," * @function  status"," * @param     {Number} code the http status code"," * @returns   {undefined}"," */","ServerUpgradeResponse.prototype.status = function status(code) {","    assert.number(code, 'code');","    this.statusCode = code;","    return (code);","};","","","/**"," * sends the response"," * @public"," * @function  send"," * @param     {Number}           code the http status code"," * @param     {Object | String}  body the response to send out"," * @returns   {undefined}"," */","ServerUpgradeResponse.prototype.send = function send(code, body) {","    if (typeof (code) === 'number') {","        this.statusCode = code;","    } else {","        body = code;","    }","","    if (typeof (body) === 'object') {","        if (typeof (body.statusCode) === 'number') {","            this.statusCode = body.statusCode;","        }","","        if (typeof (body.message) === 'string') {","            this.statusReason = body.message;","        }","    }","","    return (this.end());","};","","","/**"," * end the response"," * @public"," * @function end"," * @returns  {Boolean} always returns true"," */","ServerUpgradeResponse.prototype.end = function end() {","    this._writeHeadImpl(this.statusCode, 'Connection Not Upgraded');","    this._upgrade.socket.end('\\r\\n');","    return (true);","};","","","/**"," * write to the response"," * @public"," * @function write"," * @returns  {Boolean} always returns true"," */","ServerUpgradeResponse.prototype.write = function write() {","    this._writeHeadImpl(this.statusCode, 'Connection Not Upgraded');","    return (true);","};","","","/**"," * write to the head of the response"," * @public"," * @function writeHead"," * @param   {Number} statusCode the http status code"," * @param   {String} reason     a message"," * @returns {undefined}"," */","ServerUpgradeResponse.prototype.writeHead =","    function writeHead(statusCode, reason) {","        assert.number(statusCode, 'statusCode');","        assert.optionalString(reason, 'reason');","","        this.statusCode = statusCode;","","        if (!reason) {","            reason = 'Connection Not Upgraded';","        }","","        if (this._headWritten) {","            throw new Error('Head already written!');","        }","","        return (this._writeHeadImpl(statusCode, reason));","    };","","","/**"," * attempt to upgrade"," * @public"," * @function claimUpgrade"," * @returns  {Object}     an object containing the socket and head"," */","ServerUpgradeResponse.prototype.claimUpgrade = function claimUpgrade() {","    if (this._upgradeClaimed) {","        throw new InvalidUpgradeStateError('Upgrade already claimed!');","    }","","    if (this._headWritten) {","        throw new InvalidUpgradeStateError('Upgrade already aborted!');","    }","","    this._upgradeClaimed = true;","","    return (this._upgrade);","};","","","module.exports = {","    createResponse: createServerUpgradeResponse,","    InvalidUpgradeStateError: InvalidUpgradeStateError","};","",""],"l":{"5":1,"6":1,"7":1,"15":1,"16":0,"17":0,"20":0,"21":0,"23":1,"59":1,"60":0,"72":1,"73":0,"74":0,"76":0,"78":0,"79":0,"81":0,"86":0,"87":0,"89":1,"100":1,"101":14,"102":12,"103":0,"106":2,"107":0,"113":1,"131":1,"132":14,"144":1,"146":0,"147":0,"149":0,"151":0,"152":0,"155":0,"160":0,"161":0,"164":0,"175":1,"176":0,"177":0,"178":0,"190":1,"191":0,"192":0,"194":0,"197":0,"198":0,"199":0,"202":0,"203":0,"207":0,"217":1,"218":0,"219":0,"220":0,"230":1,"231":0,"232":0,"244":1,"246":0,"247":0,"249":0,"251":0,"252":0,"255":0,"256":0,"259":0,"269":1,"270":0,"271":0,"274":0,"275":0,"278":0,"280":0,"284":1}}}